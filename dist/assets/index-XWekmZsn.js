(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var kr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fw(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function YS(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var JS={exports:{}},Pm={},ZS={exports:{}},er={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yd=Symbol.for("react.element"),$L=Symbol.for("react.portal"),qL=Symbol.for("react.fragment"),zL=Symbol.for("react.strict_mode"),XL=Symbol.for("react.profiler"),YL=Symbol.for("react.provider"),JL=Symbol.for("react.context"),ZL=Symbol.for("react.forward_ref"),eI=Symbol.for("react.suspense"),tI=Symbol.for("react.memo"),rI=Symbol.for("react.lazy"),X5=Symbol.iterator;function nI(e){return e===null||typeof e!="object"?null:(e=X5&&e[X5]||e["@@iterator"],typeof e=="function"?e:null)}var eE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},tE=Object.assign,rE={};function ef(e,t,r){this.props=e,this.context=t,this.refs=rE,this.updater=r||eE}ef.prototype.isReactComponent={};ef.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ef.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function nE(){}nE.prototype=ef.prototype;function hw(e,t,r){this.props=e,this.context=t,this.refs=rE,this.updater=r||eE}var dw=hw.prototype=new nE;dw.constructor=hw;tE(dw,ef.prototype);dw.isPureReactComponent=!0;var Y5=Array.isArray,iE=Object.prototype.hasOwnProperty,pw={current:null},aE={key:!0,ref:!0,__self:!0,__source:!0};function sE(e,t,r){var n,i={},a=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(a=""+t.key),t)iE.call(t,n)&&!aE.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),A=0;A<o;A++)l[A]=arguments[A+2];i.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:Yd,type:e,key:a,ref:s,props:i,_owner:pw.current}}function iI(e,t){return{$$typeof:Yd,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function gw(e){return typeof e=="object"&&e!==null&&e.$$typeof===Yd}function aI(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var J5=/\/+/g;function _v(e,t){return typeof e=="object"&&e!==null&&e.key!=null?aI(""+e.key):t.toString(36)}function hg(e,t,r,n,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(a){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case Yd:case $L:s=!0}}if(s)return s=e,i=i(s),e=n===""?"."+_v(s,0):n,Y5(i)?(r="",e!=null&&(r=e.replace(J5,"$&/")+"/"),hg(i,t,r,"",function(A){return A})):i!=null&&(gw(i)&&(i=iI(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(J5,"$&/")+"/")+e)),t.push(i)),1;if(s=0,n=n===""?".":n+":",Y5(e))for(var o=0;o<e.length;o++){a=e[o];var l=n+_v(a,o);s+=hg(a,t,r,l,i)}else if(l=nI(e),typeof l=="function")for(e=l.call(e),o=0;!(a=e.next()).done;)a=a.value,l=n+_v(a,o++),s+=hg(a,t,r,l,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function np(e,t,r){if(e==null)return e;var n=[],i=0;return hg(e,n,"","",function(a){return t.call(r,a,i++)}),n}function sI(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Hi={current:null},dg={transition:null},oI={ReactCurrentDispatcher:Hi,ReactCurrentBatchConfig:dg,ReactCurrentOwner:pw};function oE(){throw Error("act(...) is not supported in production builds of React.")}er.Children={map:np,forEach:function(e,t,r){np(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return np(e,function(){t++}),t},toArray:function(e){return np(e,function(t){return t})||[]},only:function(e){if(!gw(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};er.Component=ef;er.Fragment=qL;er.Profiler=XL;er.PureComponent=hw;er.StrictMode=zL;er.Suspense=eI;er.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oI;er.act=oE;er.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=tE({},e.props),i=e.key,a=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,s=pw.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)iE.call(t,l)&&!aE.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var A=0;A<l;A++)o[A]=arguments[A+2];n.children=o}return{$$typeof:Yd,type:e.type,key:i,ref:a,props:n,_owner:s}};er.createContext=function(e){return e={$$typeof:JL,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:YL,_context:e},e.Consumer=e};er.createElement=sE;er.createFactory=function(e){var t=sE.bind(null,e);return t.type=e,t};er.createRef=function(){return{current:null}};er.forwardRef=function(e){return{$$typeof:ZL,render:e}};er.isValidElement=gw;er.lazy=function(e){return{$$typeof:rI,_payload:{_status:-1,_result:e},_init:sI}};er.memo=function(e,t){return{$$typeof:tI,type:e,compare:t===void 0?null:t}};er.startTransition=function(e){var t=dg.transition;dg.transition={};try{e()}finally{dg.transition=t}};er.unstable_act=oE;er.useCallback=function(e,t){return Hi.current.useCallback(e,t)};er.useContext=function(e){return Hi.current.useContext(e)};er.useDebugValue=function(){};er.useDeferredValue=function(e){return Hi.current.useDeferredValue(e)};er.useEffect=function(e,t){return Hi.current.useEffect(e,t)};er.useId=function(){return Hi.current.useId()};er.useImperativeHandle=function(e,t,r){return Hi.current.useImperativeHandle(e,t,r)};er.useInsertionEffect=function(e,t){return Hi.current.useInsertionEffect(e,t)};er.useLayoutEffect=function(e,t){return Hi.current.useLayoutEffect(e,t)};er.useMemo=function(e,t){return Hi.current.useMemo(e,t)};er.useReducer=function(e,t,r){return Hi.current.useReducer(e,t,r)};er.useRef=function(e){return Hi.current.useRef(e)};er.useState=function(e){return Hi.current.useState(e)};er.useSyncExternalStore=function(e,t,r){return Hi.current.useSyncExternalStore(e,t,r)};er.useTransition=function(){return Hi.current.useTransition()};er.version="18.3.1";ZS.exports=er;var ve=ZS.exports;const es=fw(ve);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lI=ve,AI=Symbol.for("react.element"),cI=Symbol.for("react.fragment"),uI=Object.prototype.hasOwnProperty,fI=lI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,hI={key:!0,ref:!0,__self:!0,__source:!0};function lE(e,t,r){var n,i={},a=null,s=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)uI.call(t,n)&&!hI.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:AI,type:e,key:a,ref:s,props:i,_owner:fI.current}}Pm.Fragment=cI;Pm.jsx=lE;Pm.jsxs=lE;JS.exports=Pm;var c=JS.exports,AE={exports:{}},Fa={},cE={exports:{}},uE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(X,Q){var K=X.length;X.push(Q);e:for(;0<K;){var H=K-1>>>1,k=X[H];if(0<i(k,Q))X[H]=Q,X[K]=k,K=H;else break e}}function r(X){return X.length===0?null:X[0]}function n(X){if(X.length===0)return null;var Q=X[0],K=X.pop();if(K!==Q){X[0]=K;e:for(var H=0,k=X.length,U=k>>>1;H<U;){var P=2*(H+1)-1,D=X[P],O=P+1,z=X[O];if(0>i(D,K))O<k&&0>i(z,D)?(X[H]=z,X[O]=K,H=O):(X[H]=D,X[P]=K,H=P);else if(O<k&&0>i(z,K))X[H]=z,X[O]=K,H=O;else break e}}return Q}function i(X,Q){var K=X.sortIndex-Q.sortIndex;return K!==0?K:X.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],A=[],u=1,f=null,h=3,d=!1,m=!1,g=!1,x=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(X){for(var Q=r(A);Q!==null;){if(Q.callback===null)n(A);else if(Q.startTime<=X)n(A),Q.sortIndex=Q.expirationTime,t(l,Q);else break;Q=r(A)}}function w(X){if(g=!1,y(X),!m)if(r(l)!==null)m=!0,G(B);else{var Q=r(A);Q!==null&&V(w,Q.startTime-X)}}function B(X,Q){m=!1,g&&(g=!1,p(F),F=-1),d=!0;var K=h;try{for(y(Q),f=r(l);f!==null&&(!(f.expirationTime>Q)||X&&!S());){var H=f.callback;if(typeof H=="function"){f.callback=null,h=f.priorityLevel;var k=H(f.expirationTime<=Q);Q=e.unstable_now(),typeof k=="function"?f.callback=k:f===r(l)&&n(l),y(Q)}else n(l);f=r(l)}if(f!==null)var U=!0;else{var P=r(A);P!==null&&V(w,P.startTime-Q),U=!1}return U}finally{f=null,h=K,d=!1}}var E=!1,_=null,F=-1,T=5,I=-1;function S(){return!(e.unstable_now()-I<T)}function C(){if(_!==null){var X=e.unstable_now();I=X;var Q=!0;try{Q=_(!0,X)}finally{Q?L():(E=!1,_=null)}}else E=!1}var L;if(typeof v=="function")L=function(){v(C)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,W=R.port2;R.port1.onmessage=C,L=function(){W.postMessage(null)}}else L=function(){x(C,0)};function G(X){_=X,E||(E=!0,L())}function V(X,Q){F=x(function(){X(e.unstable_now())},Q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(X){X.callback=null},e.unstable_continueExecution=function(){m||d||(m=!0,G(B))},e.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<X?Math.floor(1e3/X):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(X){switch(h){case 1:case 2:case 3:var Q=3;break;default:Q=h}var K=h;h=Q;try{return X()}finally{h=K}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(X,Q){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var K=h;h=X;try{return Q()}finally{h=K}},e.unstable_scheduleCallback=function(X,Q,K){var H=e.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?H+K:H):K=H,X){case 1:var k=-1;break;case 2:k=250;break;case 5:k=1073741823;break;case 4:k=1e4;break;default:k=5e3}return k=K+k,X={id:u++,callback:Q,priorityLevel:X,startTime:K,expirationTime:k,sortIndex:-1},K>H?(X.sortIndex=K,t(A,X),r(l)===null&&X===r(A)&&(g?(p(F),F=-1):g=!0,V(w,K-H))):(X.sortIndex=k,t(l,X),m||d||(m=!0,G(B))),X},e.unstable_shouldYield=S,e.unstable_wrapCallback=function(X){var Q=h;return function(){var K=h;h=Q;try{return X.apply(this,arguments)}finally{h=K}}}})(uE);cE.exports=uE;var dI=cE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pI=ve,Ca=dI;function ot(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var fE=new Set,cd={};function cc(e,t){Ru(e,t),Ru(e+"Capture",t)}function Ru(e,t){for(cd[e]=t,e=0;e<t.length;e++)fE.add(t[e])}var Qo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),o2=Object.prototype.hasOwnProperty,gI=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Z5={},eB={};function mI(e){return o2.call(eB,e)?!0:o2.call(Z5,e)?!1:gI.test(e)?eB[e]=!0:(Z5[e]=!0,!1)}function vI(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function xI(e,t,r,n){if(t===null||typeof t>"u"||vI(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ki(e,t,r,n,i,a,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var si={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){si[e]=new Ki(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];si[t]=new Ki(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){si[e]=new Ki(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){si[e]=new Ki(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){si[e]=new Ki(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){si[e]=new Ki(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){si[e]=new Ki(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){si[e]=new Ki(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){si[e]=new Ki(e,5,!1,e.toLowerCase(),null,!1,!1)});var mw=/[\-:]([a-z])/g;function vw(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(mw,vw);si[t]=new Ki(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(mw,vw);si[t]=new Ki(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(mw,vw);si[t]=new Ki(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){si[e]=new Ki(e,1,!1,e.toLowerCase(),null,!1,!1)});si.xlinkHref=new Ki("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){si[e]=new Ki(e,1,!1,e.toLowerCase(),null,!0,!0)});function xw(e,t,r,n){var i=si.hasOwnProperty(t)?si[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(xI(t,r,i,n)&&(r=null),n||i===null?mI(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Vo=pI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ip=Symbol.for("react.element"),pu=Symbol.for("react.portal"),gu=Symbol.for("react.fragment"),yw=Symbol.for("react.strict_mode"),l2=Symbol.for("react.profiler"),hE=Symbol.for("react.provider"),dE=Symbol.for("react.context"),ww=Symbol.for("react.forward_ref"),A2=Symbol.for("react.suspense"),c2=Symbol.for("react.suspense_list"),bw=Symbol.for("react.memo"),vl=Symbol.for("react.lazy"),pE=Symbol.for("react.offscreen"),tB=Symbol.iterator;function qf(e){return e===null||typeof e!="object"?null:(e=tB&&e[tB]||e["@@iterator"],typeof e=="function"?e:null)}var en=Object.assign,Cv;function dh(e){if(Cv===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Cv=t&&t[1]||""}return`
`+Cv+e}var Sv=!1;function Ev(e,t){if(!e||Sv)return"";Sv=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(A){var n=A}Reflect.construct(e,[],t)}else{try{t.call()}catch(A){n=A}e.call(t.prototype)}else{try{throw Error()}catch(A){n=A}e()}}catch(A){if(A&&n&&typeof A.stack=="string"){for(var i=A.stack.split(`
`),a=n.stack.split(`
`),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(s!==1||o!==1)do if(s--,o--,0>o||i[s]!==a[o]){var l=`
`+i[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=s&&0<=o);break}}}finally{Sv=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?dh(e):""}function yI(e){switch(e.tag){case 5:return dh(e.type);case 16:return dh("Lazy");case 13:return dh("Suspense");case 19:return dh("SuspenseList");case 0:case 2:case 15:return e=Ev(e.type,!1),e;case 11:return e=Ev(e.type.render,!1),e;case 1:return e=Ev(e.type,!0),e;default:return""}}function u2(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case gu:return"Fragment";case pu:return"Portal";case l2:return"Profiler";case yw:return"StrictMode";case A2:return"Suspense";case c2:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case dE:return(e.displayName||"Context")+".Consumer";case hE:return(e._context.displayName||"Context")+".Provider";case ww:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case bw:return t=e.displayName||null,t!==null?t:u2(e.type)||"Memo";case vl:t=e._payload,e=e._init;try{return u2(e(t))}catch{}}return null}function wI(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return u2(t);case 8:return t===yw?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function zl(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function gE(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function bI(e){var t=gE(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(s){n=""+s,a.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ap(e){e._valueTracker||(e._valueTracker=bI(e))}function mE(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=gE(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Ng(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function f2(e,t){var r=t.checked;return en({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function rB(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=zl(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function vE(e,t){t=t.checked,t!=null&&xw(e,"checked",t,!1)}function h2(e,t){vE(e,t);var r=zl(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?d2(e,t.type,r):t.hasOwnProperty("defaultValue")&&d2(e,t.type,zl(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function nB(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function d2(e,t,r){(t!=="number"||Ng(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var ph=Array.isArray;function Fu(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+zl(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function p2(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ot(91));return en({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function iB(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ot(92));if(ph(r)){if(1<r.length)throw Error(ot(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:zl(r)}}function xE(e,t){var r=zl(t.value),n=zl(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function aB(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function yE(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function g2(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?yE(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var sp,wE=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(sp=sp||document.createElement("div"),sp.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=sp.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ud(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Nh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},BI=["Webkit","ms","Moz","O"];Object.keys(Nh).forEach(function(e){BI.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Nh[t]=Nh[e]})});function bE(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Nh.hasOwnProperty(e)&&Nh[e]?(""+t).trim():t+"px"}function BE(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=bE(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var _I=en({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function m2(e,t){if(t){if(_I[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ot(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ot(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ot(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ot(62))}}function v2(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var x2=null;function Bw(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var y2=null,Nu=null,Tu=null;function sB(e){if(e=e0(e)){if(typeof y2!="function")throw Error(ot(280));var t=e.stateNode;t&&(t=Km(t),y2(e.stateNode,e.type,t))}}function _E(e){Nu?Tu?Tu.push(e):Tu=[e]:Nu=e}function CE(){if(Nu){var e=Nu,t=Tu;if(Tu=Nu=null,sB(e),t)for(e=0;e<t.length;e++)sB(t[e])}}function SE(e,t){return e(t)}function EE(){}var kv=!1;function kE(e,t,r){if(kv)return e(t,r);kv=!0;try{return SE(e,t,r)}finally{kv=!1,(Nu!==null||Tu!==null)&&(EE(),CE())}}function fd(e,t){var r=e.stateNode;if(r===null)return null;var n=Km(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ot(231,t,typeof r));return r}var w2=!1;if(Qo)try{var zf={};Object.defineProperty(zf,"passive",{get:function(){w2=!0}}),window.addEventListener("test",zf,zf),window.removeEventListener("test",zf,zf)}catch{w2=!1}function CI(e,t,r,n,i,a,s,o,l){var A=Array.prototype.slice.call(arguments,3);try{t.apply(r,A)}catch(u){this.onError(u)}}var Th=!1,Tg=null,Lg=!1,b2=null,SI={onError:function(e){Th=!0,Tg=e}};function EI(e,t,r,n,i,a,s,o,l){Th=!1,Tg=null,CI.apply(SI,arguments)}function kI(e,t,r,n,i,a,s,o,l){if(EI.apply(this,arguments),Th){if(Th){var A=Tg;Th=!1,Tg=null}else throw Error(ot(198));Lg||(Lg=!0,b2=A)}}function uc(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function FE(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function oB(e){if(uc(e)!==e)throw Error(ot(188))}function FI(e){var t=e.alternate;if(!t){if(t=uc(e),t===null)throw Error(ot(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return oB(i),e;if(a===n)return oB(i),t;a=a.sibling}throw Error(ot(188))}if(r.return!==n.return)r=i,n=a;else{for(var s=!1,o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s){for(o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s)throw Error(ot(189))}}if(r.alternate!==n)throw Error(ot(190))}if(r.tag!==3)throw Error(ot(188));return r.stateNode.current===r?e:t}function NE(e){return e=FI(e),e!==null?TE(e):null}function TE(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=TE(e);if(t!==null)return t;e=e.sibling}return null}var LE=Ca.unstable_scheduleCallback,lB=Ca.unstable_cancelCallback,NI=Ca.unstable_shouldYield,TI=Ca.unstable_requestPaint,vn=Ca.unstable_now,LI=Ca.unstable_getCurrentPriorityLevel,_w=Ca.unstable_ImmediatePriority,IE=Ca.unstable_UserBlockingPriority,Ig=Ca.unstable_NormalPriority,II=Ca.unstable_LowPriority,UE=Ca.unstable_IdlePriority,Qm=null,ro=null;function UI(e){if(ro&&typeof ro.onCommitFiberRoot=="function")try{ro.onCommitFiberRoot(Qm,e,void 0,(e.current.flags&128)===128)}catch{}}var ks=Math.clz32?Math.clz32:DI,OI=Math.log,jI=Math.LN2;function DI(e){return e>>>=0,e===0?32:31-(OI(e)/jI|0)|0}var op=64,lp=4194304;function gh(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ug(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,s=r&268435455;if(s!==0){var o=s&~i;o!==0?n=gh(o):(a&=s,a!==0&&(n=gh(a)))}else s=r&~i,s!==0?n=gh(s):a!==0&&(n=gh(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-ks(t),i=1<<r,n|=e[r],t&=~i;return n}function PI(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function QI(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-ks(a),o=1<<s,l=i[s];l===-1?(!(o&r)||o&n)&&(i[s]=PI(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}function B2(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function OE(){var e=op;return op<<=1,!(op&4194240)&&(op=64),e}function Fv(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Jd(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ks(t),e[t]=r}function RI(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-ks(r),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~a}}function Cw(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-ks(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Cr=0;function jE(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var DE,Sw,PE,QE,RE,_2=!1,Ap=[],jl=null,Dl=null,Pl=null,hd=new Map,dd=new Map,bl=[],MI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function AB(e,t){switch(e){case"focusin":case"focusout":jl=null;break;case"dragenter":case"dragleave":Dl=null;break;case"mouseover":case"mouseout":Pl=null;break;case"pointerover":case"pointerout":hd.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":dd.delete(t.pointerId)}}function Xf(e,t,r,n,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},t!==null&&(t=e0(t),t!==null&&Sw(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function HI(e,t,r,n,i){switch(t){case"focusin":return jl=Xf(jl,e,t,r,n,i),!0;case"dragenter":return Dl=Xf(Dl,e,t,r,n,i),!0;case"mouseover":return Pl=Xf(Pl,e,t,r,n,i),!0;case"pointerover":var a=i.pointerId;return hd.set(a,Xf(hd.get(a)||null,e,t,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,dd.set(a,Xf(dd.get(a)||null,e,t,r,n,i)),!0}return!1}function ME(e){var t=IA(e.target);if(t!==null){var r=uc(t);if(r!==null){if(t=r.tag,t===13){if(t=FE(r),t!==null){e.blockedOn=t,RE(e.priority,function(){PE(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function pg(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=C2(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);x2=n,r.target.dispatchEvent(n),x2=null}else return t=e0(r),t!==null&&Sw(t),e.blockedOn=r,!1;t.shift()}return!0}function cB(e,t,r){pg(e)&&r.delete(t)}function KI(){_2=!1,jl!==null&&pg(jl)&&(jl=null),Dl!==null&&pg(Dl)&&(Dl=null),Pl!==null&&pg(Pl)&&(Pl=null),hd.forEach(cB),dd.forEach(cB)}function Yf(e,t){e.blockedOn===t&&(e.blockedOn=null,_2||(_2=!0,Ca.unstable_scheduleCallback(Ca.unstable_NormalPriority,KI)))}function pd(e){function t(i){return Yf(i,e)}if(0<Ap.length){Yf(Ap[0],e);for(var r=1;r<Ap.length;r++){var n=Ap[r];n.blockedOn===e&&(n.blockedOn=null)}}for(jl!==null&&Yf(jl,e),Dl!==null&&Yf(Dl,e),Pl!==null&&Yf(Pl,e),hd.forEach(t),dd.forEach(t),r=0;r<bl.length;r++)n=bl[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<bl.length&&(r=bl[0],r.blockedOn===null);)ME(r),r.blockedOn===null&&bl.shift()}var Lu=Vo.ReactCurrentBatchConfig,Og=!0;function GI(e,t,r,n){var i=Cr,a=Lu.transition;Lu.transition=null;try{Cr=1,Ew(e,t,r,n)}finally{Cr=i,Lu.transition=a}}function VI(e,t,r,n){var i=Cr,a=Lu.transition;Lu.transition=null;try{Cr=4,Ew(e,t,r,n)}finally{Cr=i,Lu.transition=a}}function Ew(e,t,r,n){if(Og){var i=C2(e,t,r,n);if(i===null)Qv(e,t,n,jg,r),AB(e,n);else if(HI(i,e,t,r,n))n.stopPropagation();else if(AB(e,n),t&4&&-1<MI.indexOf(e)){for(;i!==null;){var a=e0(i);if(a!==null&&DE(a),a=C2(e,t,r,n),a===null&&Qv(e,t,n,jg,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else Qv(e,t,n,null,r)}}var jg=null;function C2(e,t,r,n){if(jg=null,e=Bw(n),e=IA(e),e!==null)if(t=uc(e),t===null)e=null;else if(r=t.tag,r===13){if(e=FE(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return jg=e,null}function HE(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(LI()){case _w:return 1;case IE:return 4;case Ig:case II:return 16;case UE:return 536870912;default:return 16}default:return 16}}var El=null,kw=null,gg=null;function KE(){if(gg)return gg;var e,t=kw,r=t.length,n,i="value"in El?El.value:El.textContent,a=i.length;for(e=0;e<r&&t[e]===i[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===i[a-n];n++);return gg=i.slice(e,1<n?1-n:void 0)}function mg(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function cp(){return!0}function uB(){return!1}function Na(e){function t(r,n,i,a,s){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?cp:uB,this.isPropagationStopped=uB,this}return en(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=cp)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=cp)},persist:function(){},isPersistent:cp}),t}var tf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fw=Na(tf),Zd=en({},tf,{view:0,detail:0}),WI=Na(Zd),Nv,Tv,Jf,Rm=en({},Zd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Nw,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Jf&&(Jf&&e.type==="mousemove"?(Nv=e.screenX-Jf.screenX,Tv=e.screenY-Jf.screenY):Tv=Nv=0,Jf=e),Nv)},movementY:function(e){return"movementY"in e?e.movementY:Tv}}),fB=Na(Rm),$I=en({},Rm,{dataTransfer:0}),qI=Na($I),zI=en({},Zd,{relatedTarget:0}),Lv=Na(zI),XI=en({},tf,{animationName:0,elapsedTime:0,pseudoElement:0}),YI=Na(XI),JI=en({},tf,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ZI=Na(JI),e8=en({},tf,{data:0}),hB=Na(e8),t8={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},r8={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},n8={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function i8(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=n8[e])?!!t[e]:!1}function Nw(){return i8}var a8=en({},Zd,{key:function(e){if(e.key){var t=t8[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=mg(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?r8[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Nw,charCode:function(e){return e.type==="keypress"?mg(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?mg(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),s8=Na(a8),o8=en({},Rm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dB=Na(o8),l8=en({},Zd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Nw}),A8=Na(l8),c8=en({},tf,{propertyName:0,elapsedTime:0,pseudoElement:0}),u8=Na(c8),f8=en({},Rm,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),h8=Na(f8),d8=[9,13,27,32],Tw=Qo&&"CompositionEvent"in window,Lh=null;Qo&&"documentMode"in document&&(Lh=document.documentMode);var p8=Qo&&"TextEvent"in window&&!Lh,GE=Qo&&(!Tw||Lh&&8<Lh&&11>=Lh),pB=" ",gB=!1;function VE(e,t){switch(e){case"keyup":return d8.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function WE(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var mu=!1;function g8(e,t){switch(e){case"compositionend":return WE(t);case"keypress":return t.which!==32?null:(gB=!0,pB);case"textInput":return e=t.data,e===pB&&gB?null:e;default:return null}}function m8(e,t){if(mu)return e==="compositionend"||!Tw&&VE(e,t)?(e=KE(),gg=kw=El=null,mu=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return GE&&t.locale!=="ko"?null:t.data;default:return null}}var v8={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mB(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!v8[e.type]:t==="textarea"}function $E(e,t,r,n){_E(n),t=Dg(t,"onChange"),0<t.length&&(r=new Fw("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Ih=null,gd=null;function x8(e){i3(e,0)}function Mm(e){var t=yu(e);if(mE(t))return e}function y8(e,t){if(e==="change")return t}var qE=!1;if(Qo){var Iv;if(Qo){var Uv="oninput"in document;if(!Uv){var vB=document.createElement("div");vB.setAttribute("oninput","return;"),Uv=typeof vB.oninput=="function"}Iv=Uv}else Iv=!1;qE=Iv&&(!document.documentMode||9<document.documentMode)}function xB(){Ih&&(Ih.detachEvent("onpropertychange",zE),gd=Ih=null)}function zE(e){if(e.propertyName==="value"&&Mm(gd)){var t=[];$E(t,gd,e,Bw(e)),kE(x8,t)}}function w8(e,t,r){e==="focusin"?(xB(),Ih=t,gd=r,Ih.attachEvent("onpropertychange",zE)):e==="focusout"&&xB()}function b8(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Mm(gd)}function B8(e,t){if(e==="click")return Mm(t)}function _8(e,t){if(e==="input"||e==="change")return Mm(t)}function C8(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Us=typeof Object.is=="function"?Object.is:C8;function md(e,t){if(Us(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!o2.call(t,i)||!Us(e[i],t[i]))return!1}return!0}function yB(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function wB(e,t){var r=yB(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=yB(r)}}function XE(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?XE(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function YE(){for(var e=window,t=Ng();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Ng(e.document)}return t}function Lw(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function S8(e){var t=YE(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&XE(r.ownerDocument.documentElement,r)){if(n!==null&&Lw(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!e.extend&&a>n&&(i=n,n=a,a=i),i=wB(r,a);var s=wB(r,n);i&&s&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var E8=Qo&&"documentMode"in document&&11>=document.documentMode,vu=null,S2=null,Uh=null,E2=!1;function bB(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;E2||vu==null||vu!==Ng(n)||(n=vu,"selectionStart"in n&&Lw(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Uh&&md(Uh,n)||(Uh=n,n=Dg(S2,"onSelect"),0<n.length&&(t=new Fw("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=vu)))}function up(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var xu={animationend:up("Animation","AnimationEnd"),animationiteration:up("Animation","AnimationIteration"),animationstart:up("Animation","AnimationStart"),transitionend:up("Transition","TransitionEnd")},Ov={},JE={};Qo&&(JE=document.createElement("div").style,"AnimationEvent"in window||(delete xu.animationend.animation,delete xu.animationiteration.animation,delete xu.animationstart.animation),"TransitionEvent"in window||delete xu.transitionend.transition);function Hm(e){if(Ov[e])return Ov[e];if(!xu[e])return e;var t=xu[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in JE)return Ov[e]=t[r];return e}var ZE=Hm("animationend"),e3=Hm("animationiteration"),t3=Hm("animationstart"),r3=Hm("transitionend"),n3=new Map,BB="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function sA(e,t){n3.set(e,t),cc(t,[e])}for(var jv=0;jv<BB.length;jv++){var Dv=BB[jv],k8=Dv.toLowerCase(),F8=Dv[0].toUpperCase()+Dv.slice(1);sA(k8,"on"+F8)}sA(ZE,"onAnimationEnd");sA(e3,"onAnimationIteration");sA(t3,"onAnimationStart");sA("dblclick","onDoubleClick");sA("focusin","onFocus");sA("focusout","onBlur");sA(r3,"onTransitionEnd");Ru("onMouseEnter",["mouseout","mouseover"]);Ru("onMouseLeave",["mouseout","mouseover"]);Ru("onPointerEnter",["pointerout","pointerover"]);Ru("onPointerLeave",["pointerout","pointerover"]);cc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));cc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));cc("onBeforeInput",["compositionend","keypress","textInput","paste"]);cc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));cc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));cc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),N8=new Set("cancel close invalid load scroll toggle".split(" ").concat(mh));function _B(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,kI(n,t,void 0,e),e.currentTarget=null}function i3(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],l=o.instance,A=o.currentTarget;if(o=o.listener,l!==a&&i.isPropagationStopped())break e;_B(i,o,A),a=l}else for(s=0;s<n.length;s++){if(o=n[s],l=o.instance,A=o.currentTarget,o=o.listener,l!==a&&i.isPropagationStopped())break e;_B(i,o,A),a=l}}}if(Lg)throw e=b2,Lg=!1,b2=null,e}function Pr(e,t){var r=t[L2];r===void 0&&(r=t[L2]=new Set);var n=e+"__bubble";r.has(n)||(a3(t,e,2,!1),r.add(n))}function Pv(e,t,r){var n=0;t&&(n|=4),a3(r,e,n,t)}var fp="_reactListening"+Math.random().toString(36).slice(2);function vd(e){if(!e[fp]){e[fp]=!0,fE.forEach(function(r){r!=="selectionchange"&&(N8.has(r)||Pv(r,!1,e),Pv(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[fp]||(t[fp]=!0,Pv("selectionchange",!1,t))}}function a3(e,t,r,n){switch(HE(t)){case 1:var i=GI;break;case 4:i=VI;break;default:i=Ew}r=i.bind(null,t,r,e),i=void 0,!w2||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Qv(e,t,r,n,i){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(s===4)for(s=n.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;o!==null;){if(s=IA(o),s===null)return;if(l=s.tag,l===5||l===6){n=a=s;continue e}o=o.parentNode}}n=n.return}kE(function(){var A=a,u=Bw(r),f=[];e:{var h=n3.get(e);if(h!==void 0){var d=Fw,m=e;switch(e){case"keypress":if(mg(r)===0)break e;case"keydown":case"keyup":d=s8;break;case"focusin":m="focus",d=Lv;break;case"focusout":m="blur",d=Lv;break;case"beforeblur":case"afterblur":d=Lv;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=fB;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=qI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=A8;break;case ZE:case e3:case t3:d=YI;break;case r3:d=u8;break;case"scroll":d=WI;break;case"wheel":d=h8;break;case"copy":case"cut":case"paste":d=ZI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=dB}var g=(t&4)!==0,x=!g&&e==="scroll",p=g?h!==null?h+"Capture":null:h;g=[];for(var v=A,y;v!==null;){y=v;var w=y.stateNode;if(y.tag===5&&w!==null&&(y=w,p!==null&&(w=fd(v,p),w!=null&&g.push(xd(v,w,y)))),x)break;v=v.return}0<g.length&&(h=new d(h,m,null,r,u),f.push({event:h,listeners:g}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",d=e==="mouseout"||e==="pointerout",h&&r!==x2&&(m=r.relatedTarget||r.fromElement)&&(IA(m)||m[Ro]))break e;if((d||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,d?(m=r.relatedTarget||r.toElement,d=A,m=m?IA(m):null,m!==null&&(x=uc(m),m!==x||m.tag!==5&&m.tag!==6)&&(m=null)):(d=null,m=A),d!==m)){if(g=fB,w="onMouseLeave",p="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(g=dB,w="onPointerLeave",p="onPointerEnter",v="pointer"),x=d==null?h:yu(d),y=m==null?h:yu(m),h=new g(w,v+"leave",d,r,u),h.target=x,h.relatedTarget=y,w=null,IA(u)===A&&(g=new g(p,v+"enter",m,r,u),g.target=y,g.relatedTarget=x,w=g),x=w,d&&m)t:{for(g=d,p=m,v=0,y=g;y;y=Hc(y))v++;for(y=0,w=p;w;w=Hc(w))y++;for(;0<v-y;)g=Hc(g),v--;for(;0<y-v;)p=Hc(p),y--;for(;v--;){if(g===p||p!==null&&g===p.alternate)break t;g=Hc(g),p=Hc(p)}g=null}else g=null;d!==null&&CB(f,h,d,g,!1),m!==null&&x!==null&&CB(f,x,m,g,!0)}}e:{if(h=A?yu(A):window,d=h.nodeName&&h.nodeName.toLowerCase(),d==="select"||d==="input"&&h.type==="file")var B=y8;else if(mB(h))if(qE)B=_8;else{B=b8;var E=w8}else(d=h.nodeName)&&d.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(B=B8);if(B&&(B=B(e,A))){$E(f,B,r,u);break e}E&&E(e,h,A),e==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&d2(h,"number",h.value)}switch(E=A?yu(A):window,e){case"focusin":(mB(E)||E.contentEditable==="true")&&(vu=E,S2=A,Uh=null);break;case"focusout":Uh=S2=vu=null;break;case"mousedown":E2=!0;break;case"contextmenu":case"mouseup":case"dragend":E2=!1,bB(f,r,u);break;case"selectionchange":if(E8)break;case"keydown":case"keyup":bB(f,r,u)}var _;if(Tw)e:{switch(e){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else mu?VE(e,r)&&(F="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(F="onCompositionStart");F&&(GE&&r.locale!=="ko"&&(mu||F!=="onCompositionStart"?F==="onCompositionEnd"&&mu&&(_=KE()):(El=u,kw="value"in El?El.value:El.textContent,mu=!0)),E=Dg(A,F),0<E.length&&(F=new hB(F,e,null,r,u),f.push({event:F,listeners:E}),_?F.data=_:(_=WE(r),_!==null&&(F.data=_)))),(_=p8?g8(e,r):m8(e,r))&&(A=Dg(A,"onBeforeInput"),0<A.length&&(u=new hB("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:A}),u.data=_))}i3(f,t)})}function xd(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Dg(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=fd(e,r),a!=null&&n.unshift(xd(e,a,i)),a=fd(e,t),a!=null&&n.push(xd(e,a,i))),e=e.return}return n}function Hc(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function CB(e,t,r,n,i){for(var a=t._reactName,s=[];r!==null&&r!==n;){var o=r,l=o.alternate,A=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&A!==null&&(o=A,i?(l=fd(r,a),l!=null&&s.unshift(xd(r,l,o))):i||(l=fd(r,a),l!=null&&s.push(xd(r,l,o)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var T8=/\r\n?/g,L8=/\u0000|\uFFFD/g;function SB(e){return(typeof e=="string"?e:""+e).replace(T8,`
`).replace(L8,"")}function hp(e,t,r){if(t=SB(t),SB(e)!==t&&r)throw Error(ot(425))}function Pg(){}var k2=null,F2=null;function N2(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var T2=typeof setTimeout=="function"?setTimeout:void 0,I8=typeof clearTimeout=="function"?clearTimeout:void 0,EB=typeof Promise=="function"?Promise:void 0,U8=typeof queueMicrotask=="function"?queueMicrotask:typeof EB<"u"?function(e){return EB.resolve(null).then(e).catch(O8)}:T2;function O8(e){setTimeout(function(){throw e})}function Rv(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),pd(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);pd(t)}function Ql(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function kB(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var rf=Math.random().toString(36).slice(2),Js="__reactFiber$"+rf,yd="__reactProps$"+rf,Ro="__reactContainer$"+rf,L2="__reactEvents$"+rf,j8="__reactListeners$"+rf,D8="__reactHandles$"+rf;function IA(e){var t=e[Js];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ro]||r[Js]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=kB(e);e!==null;){if(r=e[Js])return r;e=kB(e)}return t}e=r,r=e.parentNode}return null}function e0(e){return e=e[Js]||e[Ro],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function yu(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ot(33))}function Km(e){return e[yd]||null}var I2=[],wu=-1;function oA(e){return{current:e}}function Hr(e){0>wu||(e.current=I2[wu],I2[wu]=null,wu--)}function Dr(e,t){wu++,I2[wu]=e.current,e.current=t}var Xl={},Fi=oA(Xl),na=oA(!1),JA=Xl;function Mu(e,t){var r=e.type.contextTypes;if(!r)return Xl;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function ia(e){return e=e.childContextTypes,e!=null}function Qg(){Hr(na),Hr(Fi)}function FB(e,t,r){if(Fi.current!==Xl)throw Error(ot(168));Dr(Fi,t),Dr(na,r)}function s3(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(ot(108,wI(e)||"Unknown",i));return en({},r,n)}function Rg(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Xl,JA=Fi.current,Dr(Fi,e),Dr(na,na.current),!0}function NB(e,t,r){var n=e.stateNode;if(!n)throw Error(ot(169));r?(e=s3(e,t,JA),n.__reactInternalMemoizedMergedChildContext=e,Hr(na),Hr(Fi),Dr(Fi,e)):Hr(na),Dr(na,r)}var Fo=null,Gm=!1,Mv=!1;function o3(e){Fo===null?Fo=[e]:Fo.push(e)}function P8(e){Gm=!0,o3(e)}function lA(){if(!Mv&&Fo!==null){Mv=!0;var e=0,t=Cr;try{var r=Fo;for(Cr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Fo=null,Gm=!1}catch(i){throw Fo!==null&&(Fo=Fo.slice(e+1)),LE(_w,lA),i}finally{Cr=t,Mv=!1}}return null}var bu=[],Bu=0,Mg=null,Hg=0,$a=[],qa=0,ZA=null,To=1,Lo="";function CA(e,t){bu[Bu++]=Hg,bu[Bu++]=Mg,Mg=e,Hg=t}function l3(e,t,r){$a[qa++]=To,$a[qa++]=Lo,$a[qa++]=ZA,ZA=e;var n=To;e=Lo;var i=32-ks(n)-1;n&=~(1<<i),r+=1;var a=32-ks(t)+i;if(30<a){var s=i-i%5;a=(n&(1<<s)-1).toString(32),n>>=s,i-=s,To=1<<32-ks(t)+i|r<<i|n,Lo=a+e}else To=1<<a|r<<i|n,Lo=e}function Iw(e){e.return!==null&&(CA(e,1),l3(e,1,0))}function Uw(e){for(;e===Mg;)Mg=bu[--Bu],bu[Bu]=null,Hg=bu[--Bu],bu[Bu]=null;for(;e===ZA;)ZA=$a[--qa],$a[qa]=null,Lo=$a[--qa],$a[qa]=null,To=$a[--qa],$a[qa]=null}var Ba=null,wa=null,$r=!1,Cs=null;function A3(e,t){var r=Ya(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function TB(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ba=e,wa=Ql(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ba=e,wa=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=ZA!==null?{id:To,overflow:Lo}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ya(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Ba=e,wa=null,!0):!1;default:return!1}}function U2(e){return(e.mode&1)!==0&&(e.flags&128)===0}function O2(e){if($r){var t=wa;if(t){var r=t;if(!TB(e,t)){if(U2(e))throw Error(ot(418));t=Ql(r.nextSibling);var n=Ba;t&&TB(e,t)?A3(n,r):(e.flags=e.flags&-4097|2,$r=!1,Ba=e)}}else{if(U2(e))throw Error(ot(418));e.flags=e.flags&-4097|2,$r=!1,Ba=e}}}function LB(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ba=e}function dp(e){if(e!==Ba)return!1;if(!$r)return LB(e),$r=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!N2(e.type,e.memoizedProps)),t&&(t=wa)){if(U2(e))throw c3(),Error(ot(418));for(;t;)A3(e,t),t=Ql(t.nextSibling)}if(LB(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ot(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){wa=Ql(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}wa=null}}else wa=Ba?Ql(e.stateNode.nextSibling):null;return!0}function c3(){for(var e=wa;e;)e=Ql(e.nextSibling)}function Hu(){wa=Ba=null,$r=!1}function Ow(e){Cs===null?Cs=[e]:Cs.push(e)}var Q8=Vo.ReactCurrentBatchConfig;function Zf(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ot(309));var n=r.stateNode}if(!n)throw Error(ot(147,e));var i=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(s){var o=i.refs;s===null?delete o[a]:o[a]=s},t._stringRef=a,t)}if(typeof e!="string")throw Error(ot(284));if(!r._owner)throw Error(ot(290,e))}return e}function pp(e,t){throw e=Object.prototype.toString.call(t),Error(ot(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function IB(e){var t=e._init;return t(e._payload)}function u3(e){function t(p,v){if(e){var y=p.deletions;y===null?(p.deletions=[v],p.flags|=16):y.push(v)}}function r(p,v){if(!e)return null;for(;v!==null;)t(p,v),v=v.sibling;return null}function n(p,v){for(p=new Map;v!==null;)v.key!==null?p.set(v.key,v):p.set(v.index,v),v=v.sibling;return p}function i(p,v){return p=Kl(p,v),p.index=0,p.sibling=null,p}function a(p,v,y){return p.index=y,e?(y=p.alternate,y!==null?(y=y.index,y<v?(p.flags|=2,v):y):(p.flags|=2,v)):(p.flags|=1048576,v)}function s(p){return e&&p.alternate===null&&(p.flags|=2),p}function o(p,v,y,w){return v===null||v.tag!==6?(v=qv(y,p.mode,w),v.return=p,v):(v=i(v,y),v.return=p,v)}function l(p,v,y,w){var B=y.type;return B===gu?u(p,v,y.props.children,w,y.key):v!==null&&(v.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===vl&&IB(B)===v.type)?(w=i(v,y.props),w.ref=Zf(p,v,y),w.return=p,w):(w=_g(y.type,y.key,y.props,null,p.mode,w),w.ref=Zf(p,v,y),w.return=p,w)}function A(p,v,y,w){return v===null||v.tag!==4||v.stateNode.containerInfo!==y.containerInfo||v.stateNode.implementation!==y.implementation?(v=zv(y,p.mode,w),v.return=p,v):(v=i(v,y.children||[]),v.return=p,v)}function u(p,v,y,w,B){return v===null||v.tag!==7?(v=MA(y,p.mode,w,B),v.return=p,v):(v=i(v,y),v.return=p,v)}function f(p,v,y){if(typeof v=="string"&&v!==""||typeof v=="number")return v=qv(""+v,p.mode,y),v.return=p,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case ip:return y=_g(v.type,v.key,v.props,null,p.mode,y),y.ref=Zf(p,null,v),y.return=p,y;case pu:return v=zv(v,p.mode,y),v.return=p,v;case vl:var w=v._init;return f(p,w(v._payload),y)}if(ph(v)||qf(v))return v=MA(v,p.mode,y,null),v.return=p,v;pp(p,v)}return null}function h(p,v,y,w){var B=v!==null?v.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return B!==null?null:o(p,v,""+y,w);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ip:return y.key===B?l(p,v,y,w):null;case pu:return y.key===B?A(p,v,y,w):null;case vl:return B=y._init,h(p,v,B(y._payload),w)}if(ph(y)||qf(y))return B!==null?null:u(p,v,y,w,null);pp(p,y)}return null}function d(p,v,y,w,B){if(typeof w=="string"&&w!==""||typeof w=="number")return p=p.get(y)||null,o(v,p,""+w,B);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ip:return p=p.get(w.key===null?y:w.key)||null,l(v,p,w,B);case pu:return p=p.get(w.key===null?y:w.key)||null,A(v,p,w,B);case vl:var E=w._init;return d(p,v,y,E(w._payload),B)}if(ph(w)||qf(w))return p=p.get(y)||null,u(v,p,w,B,null);pp(v,w)}return null}function m(p,v,y,w){for(var B=null,E=null,_=v,F=v=0,T=null;_!==null&&F<y.length;F++){_.index>F?(T=_,_=null):T=_.sibling;var I=h(p,_,y[F],w);if(I===null){_===null&&(_=T);break}e&&_&&I.alternate===null&&t(p,_),v=a(I,v,F),E===null?B=I:E.sibling=I,E=I,_=T}if(F===y.length)return r(p,_),$r&&CA(p,F),B;if(_===null){for(;F<y.length;F++)_=f(p,y[F],w),_!==null&&(v=a(_,v,F),E===null?B=_:E.sibling=_,E=_);return $r&&CA(p,F),B}for(_=n(p,_);F<y.length;F++)T=d(_,p,F,y[F],w),T!==null&&(e&&T.alternate!==null&&_.delete(T.key===null?F:T.key),v=a(T,v,F),E===null?B=T:E.sibling=T,E=T);return e&&_.forEach(function(S){return t(p,S)}),$r&&CA(p,F),B}function g(p,v,y,w){var B=qf(y);if(typeof B!="function")throw Error(ot(150));if(y=B.call(y),y==null)throw Error(ot(151));for(var E=B=null,_=v,F=v=0,T=null,I=y.next();_!==null&&!I.done;F++,I=y.next()){_.index>F?(T=_,_=null):T=_.sibling;var S=h(p,_,I.value,w);if(S===null){_===null&&(_=T);break}e&&_&&S.alternate===null&&t(p,_),v=a(S,v,F),E===null?B=S:E.sibling=S,E=S,_=T}if(I.done)return r(p,_),$r&&CA(p,F),B;if(_===null){for(;!I.done;F++,I=y.next())I=f(p,I.value,w),I!==null&&(v=a(I,v,F),E===null?B=I:E.sibling=I,E=I);return $r&&CA(p,F),B}for(_=n(p,_);!I.done;F++,I=y.next())I=d(_,p,F,I.value,w),I!==null&&(e&&I.alternate!==null&&_.delete(I.key===null?F:I.key),v=a(I,v,F),E===null?B=I:E.sibling=I,E=I);return e&&_.forEach(function(C){return t(p,C)}),$r&&CA(p,F),B}function x(p,v,y,w){if(typeof y=="object"&&y!==null&&y.type===gu&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case ip:e:{for(var B=y.key,E=v;E!==null;){if(E.key===B){if(B=y.type,B===gu){if(E.tag===7){r(p,E.sibling),v=i(E,y.props.children),v.return=p,p=v;break e}}else if(E.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===vl&&IB(B)===E.type){r(p,E.sibling),v=i(E,y.props),v.ref=Zf(p,E,y),v.return=p,p=v;break e}r(p,E);break}else t(p,E);E=E.sibling}y.type===gu?(v=MA(y.props.children,p.mode,w,y.key),v.return=p,p=v):(w=_g(y.type,y.key,y.props,null,p.mode,w),w.ref=Zf(p,v,y),w.return=p,p=w)}return s(p);case pu:e:{for(E=y.key;v!==null;){if(v.key===E)if(v.tag===4&&v.stateNode.containerInfo===y.containerInfo&&v.stateNode.implementation===y.implementation){r(p,v.sibling),v=i(v,y.children||[]),v.return=p,p=v;break e}else{r(p,v);break}else t(p,v);v=v.sibling}v=zv(y,p.mode,w),v.return=p,p=v}return s(p);case vl:return E=y._init,x(p,v,E(y._payload),w)}if(ph(y))return m(p,v,y,w);if(qf(y))return g(p,v,y,w);pp(p,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,v!==null&&v.tag===6?(r(p,v.sibling),v=i(v,y),v.return=p,p=v):(r(p,v),v=qv(y,p.mode,w),v.return=p,p=v),s(p)):r(p,v)}return x}var Ku=u3(!0),f3=u3(!1),Kg=oA(null),Gg=null,_u=null,jw=null;function Dw(){jw=_u=Gg=null}function Pw(e){var t=Kg.current;Hr(Kg),e._currentValue=t}function j2(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Iu(e,t){Gg=e,jw=_u=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ra=!0),e.firstContext=null)}function is(e){var t=e._currentValue;if(jw!==e)if(e={context:e,memoizedValue:t,next:null},_u===null){if(Gg===null)throw Error(ot(308));_u=e,Gg.dependencies={lanes:0,firstContext:e}}else _u=_u.next=e;return t}var UA=null;function Qw(e){UA===null?UA=[e]:UA.push(e)}function h3(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,Qw(t)):(r.next=i.next,i.next=r),t.interleaved=r,Mo(e,n)}function Mo(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var xl=!1;function Rw(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function d3(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Uo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Rl(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,lr&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Mo(e,r)}return i=n.interleaved,i===null?(t.next=t,Qw(n)):(t.next=i.next,i.next=t),n.interleaved=t,Mo(e,r)}function vg(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Cw(e,r)}}function UB(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=s:a=a.next=s,r=r.next}while(r!==null);a===null?i=a=t:a=a.next=t}else i=a=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Vg(e,t,r,n){var i=e.updateQueue;xl=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,A=l.next;l.next=null,s===null?a=A:s.next=A,s=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==s&&(o===null?u.firstBaseUpdate=A:o.next=A,u.lastBaseUpdate=l))}if(a!==null){var f=i.baseState;s=0,u=A=l=null,o=a;do{var h=o.lane,d=o.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:d,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,g=o;switch(h=t,d=r,g.tag){case 1:if(m=g.payload,typeof m=="function"){f=m.call(d,f,h);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,h=typeof m=="function"?m.call(d,f,h):m,h==null)break e;f=en({},f,h);break e;case 2:xl=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[o]:h.push(o))}else d={eventTime:d,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(A=u=d,l=f):u=u.next=d,s|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;h=o,o=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(u===null&&(l=f),i.baseState=l,i.firstBaseUpdate=A,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do s|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);tc|=s,e.lanes=s,e.memoizedState=f}}function OB(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(ot(191,i));i.call(n)}}}var t0={},no=oA(t0),wd=oA(t0),bd=oA(t0);function OA(e){if(e===t0)throw Error(ot(174));return e}function Mw(e,t){switch(Dr(bd,t),Dr(wd,e),Dr(no,t0),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:g2(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=g2(t,e)}Hr(no),Dr(no,t)}function Gu(){Hr(no),Hr(wd),Hr(bd)}function p3(e){OA(bd.current);var t=OA(no.current),r=g2(t,e.type);t!==r&&(Dr(wd,e),Dr(no,r))}function Hw(e){wd.current===e&&(Hr(no),Hr(wd))}var zr=oA(0);function Wg(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Hv=[];function Kw(){for(var e=0;e<Hv.length;e++)Hv[e]._workInProgressVersionPrimary=null;Hv.length=0}var xg=Vo.ReactCurrentDispatcher,Kv=Vo.ReactCurrentBatchConfig,ec=0,Jr=null,In=null,$n=null,$g=!1,Oh=!1,Bd=0,R8=0;function ci(){throw Error(ot(321))}function Gw(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Us(e[r],t[r]))return!1;return!0}function Vw(e,t,r,n,i,a){if(ec=a,Jr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,xg.current=e===null||e.memoizedState===null?G8:V8,e=r(n,i),Oh){a=0;do{if(Oh=!1,Bd=0,25<=a)throw Error(ot(301));a+=1,$n=In=null,t.updateQueue=null,xg.current=W8,e=r(n,i)}while(Oh)}if(xg.current=qg,t=In!==null&&In.next!==null,ec=0,$n=In=Jr=null,$g=!1,t)throw Error(ot(300));return e}function Ww(){var e=Bd!==0;return Bd=0,e}function Ys(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $n===null?Jr.memoizedState=$n=e:$n=$n.next=e,$n}function as(){if(In===null){var e=Jr.alternate;e=e!==null?e.memoizedState:null}else e=In.next;var t=$n===null?Jr.memoizedState:$n.next;if(t!==null)$n=t,In=e;else{if(e===null)throw Error(ot(310));In=e,e={memoizedState:In.memoizedState,baseState:In.baseState,baseQueue:In.baseQueue,queue:In.queue,next:null},$n===null?Jr.memoizedState=$n=e:$n=$n.next=e}return $n}function _d(e,t){return typeof t=="function"?t(e):t}function Gv(e){var t=as(),r=t.queue;if(r===null)throw Error(ot(311));r.lastRenderedReducer=e;var n=In,i=n.baseQueue,a=r.pending;if(a!==null){if(i!==null){var s=i.next;i.next=a.next,a.next=s}n.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,n=n.baseState;var o=s=null,l=null,A=a;do{var u=A.lane;if((ec&u)===u)l!==null&&(l=l.next={lane:0,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null}),n=A.hasEagerState?A.eagerState:e(n,A.action);else{var f={lane:u,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null};l===null?(o=l=f,s=n):l=l.next=f,Jr.lanes|=u,tc|=u}A=A.next}while(A!==null&&A!==a);l===null?s=n:l.next=o,Us(n,t.memoizedState)||(ra=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do a=i.lane,Jr.lanes|=a,tc|=a,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Vv(e){var t=as(),r=t.queue;if(r===null)throw Error(ot(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,a=t.memoizedState;if(i!==null){r.pending=null;var s=i=i.next;do a=e(a,s.action),s=s.next;while(s!==i);Us(a,t.memoizedState)||(ra=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function g3(){}function m3(e,t){var r=Jr,n=as(),i=t(),a=!Us(n.memoizedState,i);if(a&&(n.memoizedState=i,ra=!0),n=n.queue,$w(y3.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||$n!==null&&$n.memoizedState.tag&1){if(r.flags|=2048,Cd(9,x3.bind(null,r,n,i,t),void 0,null),Xn===null)throw Error(ot(349));ec&30||v3(r,t,i)}return i}function v3(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Jr.updateQueue,t===null?(t={lastEffect:null,stores:null},Jr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function x3(e,t,r,n){t.value=r,t.getSnapshot=n,w3(t)&&b3(e)}function y3(e,t,r){return r(function(){w3(t)&&b3(e)})}function w3(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Us(e,r)}catch{return!0}}function b3(e){var t=Mo(e,1);t!==null&&Fs(t,e,1,-1)}function jB(e){var t=Ys();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_d,lastRenderedState:e},t.queue=e,e=e.dispatch=K8.bind(null,Jr,e),[t.memoizedState,e]}function Cd(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Jr.updateQueue,t===null?(t={lastEffect:null,stores:null},Jr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function B3(){return as().memoizedState}function yg(e,t,r,n){var i=Ys();Jr.flags|=e,i.memoizedState=Cd(1|t,r,void 0,n===void 0?null:n)}function Vm(e,t,r,n){var i=as();n=n===void 0?null:n;var a=void 0;if(In!==null){var s=In.memoizedState;if(a=s.destroy,n!==null&&Gw(n,s.deps)){i.memoizedState=Cd(t,r,a,n);return}}Jr.flags|=e,i.memoizedState=Cd(1|t,r,a,n)}function DB(e,t){return yg(8390656,8,e,t)}function $w(e,t){return Vm(2048,8,e,t)}function _3(e,t){return Vm(4,2,e,t)}function C3(e,t){return Vm(4,4,e,t)}function S3(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function E3(e,t,r){return r=r!=null?r.concat([e]):null,Vm(4,4,S3.bind(null,t,e),r)}function qw(){}function k3(e,t){var r=as();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Gw(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function F3(e,t){var r=as();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Gw(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function N3(e,t,r){return ec&21?(Us(r,t)||(r=OE(),Jr.lanes|=r,tc|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ra=!0),e.memoizedState=r)}function M8(e,t){var r=Cr;Cr=r!==0&&4>r?r:4,e(!0);var n=Kv.transition;Kv.transition={};try{e(!1),t()}finally{Cr=r,Kv.transition=n}}function T3(){return as().memoizedState}function H8(e,t,r){var n=Hl(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},L3(e))I3(t,r);else if(r=h3(e,t,r,n),r!==null){var i=Ri();Fs(r,e,n,i),U3(r,t,n)}}function K8(e,t,r){var n=Hl(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(L3(e))I3(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var s=t.lastRenderedState,o=a(s,r);if(i.hasEagerState=!0,i.eagerState=o,Us(o,s)){var l=t.interleaved;l===null?(i.next=i,Qw(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}r=h3(e,t,i,n),r!==null&&(i=Ri(),Fs(r,e,n,i),U3(r,t,n))}}function L3(e){var t=e.alternate;return e===Jr||t!==null&&t===Jr}function I3(e,t){Oh=$g=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function U3(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Cw(e,r)}}var qg={readContext:is,useCallback:ci,useContext:ci,useEffect:ci,useImperativeHandle:ci,useInsertionEffect:ci,useLayoutEffect:ci,useMemo:ci,useReducer:ci,useRef:ci,useState:ci,useDebugValue:ci,useDeferredValue:ci,useTransition:ci,useMutableSource:ci,useSyncExternalStore:ci,useId:ci,unstable_isNewReconciler:!1},G8={readContext:is,useCallback:function(e,t){return Ys().memoizedState=[e,t===void 0?null:t],e},useContext:is,useEffect:DB,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,yg(4194308,4,S3.bind(null,t,e),r)},useLayoutEffect:function(e,t){return yg(4194308,4,e,t)},useInsertionEffect:function(e,t){return yg(4,2,e,t)},useMemo:function(e,t){var r=Ys();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Ys();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=H8.bind(null,Jr,e),[n.memoizedState,e]},useRef:function(e){var t=Ys();return e={current:e},t.memoizedState=e},useState:jB,useDebugValue:qw,useDeferredValue:function(e){return Ys().memoizedState=e},useTransition:function(){var e=jB(!1),t=e[0];return e=M8.bind(null,e[1]),Ys().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Jr,i=Ys();if($r){if(r===void 0)throw Error(ot(407));r=r()}else{if(r=t(),Xn===null)throw Error(ot(349));ec&30||v3(n,t,r)}i.memoizedState=r;var a={value:r,getSnapshot:t};return i.queue=a,DB(y3.bind(null,n,a,e),[e]),n.flags|=2048,Cd(9,x3.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=Ys(),t=Xn.identifierPrefix;if($r){var r=Lo,n=To;r=(n&~(1<<32-ks(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Bd++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=R8++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},V8={readContext:is,useCallback:k3,useContext:is,useEffect:$w,useImperativeHandle:E3,useInsertionEffect:_3,useLayoutEffect:C3,useMemo:F3,useReducer:Gv,useRef:B3,useState:function(){return Gv(_d)},useDebugValue:qw,useDeferredValue:function(e){var t=as();return N3(t,In.memoizedState,e)},useTransition:function(){var e=Gv(_d)[0],t=as().memoizedState;return[e,t]},useMutableSource:g3,useSyncExternalStore:m3,useId:T3,unstable_isNewReconciler:!1},W8={readContext:is,useCallback:k3,useContext:is,useEffect:$w,useImperativeHandle:E3,useInsertionEffect:_3,useLayoutEffect:C3,useMemo:F3,useReducer:Vv,useRef:B3,useState:function(){return Vv(_d)},useDebugValue:qw,useDeferredValue:function(e){var t=as();return In===null?t.memoizedState=e:N3(t,In.memoizedState,e)},useTransition:function(){var e=Vv(_d)[0],t=as().memoizedState;return[e,t]},useMutableSource:g3,useSyncExternalStore:m3,useId:T3,unstable_isNewReconciler:!1};function ws(e,t){if(e&&e.defaultProps){t=en({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function D2(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:en({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Wm={isMounted:function(e){return(e=e._reactInternals)?uc(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Ri(),i=Hl(e),a=Uo(n,i);a.payload=t,r!=null&&(a.callback=r),t=Rl(e,a,i),t!==null&&(Fs(t,e,i,n),vg(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Ri(),i=Hl(e),a=Uo(n,i);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=Rl(e,a,i),t!==null&&(Fs(t,e,i,n),vg(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ri(),n=Hl(e),i=Uo(r,n);i.tag=2,t!=null&&(i.callback=t),t=Rl(e,i,n),t!==null&&(Fs(t,e,n,r),vg(t,e,n))}};function PB(e,t,r,n,i,a,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,s):t.prototype&&t.prototype.isPureReactComponent?!md(r,n)||!md(i,a):!0}function O3(e,t,r){var n=!1,i=Xl,a=t.contextType;return typeof a=="object"&&a!==null?a=is(a):(i=ia(t)?JA:Fi.current,n=t.contextTypes,a=(n=n!=null)?Mu(e,i):Xl),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Wm,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function QB(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Wm.enqueueReplaceState(t,t.state,null)}function P2(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},Rw(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=is(a):(a=ia(t)?JA:Fi.current,i.context=Mu(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(D2(e,t,a,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Wm.enqueueReplaceState(i,i.state,null),Vg(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Vu(e,t){try{var r="",n=t;do r+=yI(n),n=n.return;while(n);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function Wv(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Q2(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var $8=typeof WeakMap=="function"?WeakMap:Map;function j3(e,t,r){r=Uo(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Xg||(Xg=!0,z2=n),Q2(e,t)},r}function D3(e,t,r){r=Uo(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Q2(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Q2(e,t),typeof n!="function"&&(Ml===null?Ml=new Set([this]):Ml.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function RB(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new $8;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=oU.bind(null,e,t,r),t.then(e,e))}function MB(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function HB(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Uo(-1,1),t.tag=2,Rl(r,t,1))),r.lanes|=1),e)}var q8=Vo.ReactCurrentOwner,ra=!1;function Di(e,t,r,n){t.child=e===null?f3(t,null,r,n):Ku(t,e.child,r,n)}function KB(e,t,r,n,i){r=r.render;var a=t.ref;return Iu(t,i),n=Vw(e,t,r,n,a,i),r=Ww(),e!==null&&!ra?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ho(e,t,i)):($r&&r&&Iw(t),t.flags|=1,Di(e,t,n,i),t.child)}function GB(e,t,r,n,i){if(e===null){var a=r.type;return typeof a=="function"&&!rb(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,P3(e,t,a,n,i)):(e=_g(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var s=a.memoizedProps;if(r=r.compare,r=r!==null?r:md,r(s,n)&&e.ref===t.ref)return Ho(e,t,i)}return t.flags|=1,e=Kl(a,n),e.ref=t.ref,e.return=t,t.child=e}function P3(e,t,r,n,i){if(e!==null){var a=e.memoizedProps;if(md(a,n)&&e.ref===t.ref)if(ra=!1,t.pendingProps=n=a,(e.lanes&i)!==0)e.flags&131072&&(ra=!0);else return t.lanes=e.lanes,Ho(e,t,i)}return R2(e,t,r,n,i)}function Q3(e,t,r){var n=t.pendingProps,i=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Dr(Su,ga),ga|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Dr(Su,ga),ga|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Dr(Su,ga),ga|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,Dr(Su,ga),ga|=n;return Di(e,t,i,r),t.child}function R3(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function R2(e,t,r,n,i){var a=ia(r)?JA:Fi.current;return a=Mu(t,a),Iu(t,i),r=Vw(e,t,r,n,a,i),n=Ww(),e!==null&&!ra?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ho(e,t,i)):($r&&n&&Iw(t),t.flags|=1,Di(e,t,r,i),t.child)}function VB(e,t,r,n,i){if(ia(r)){var a=!0;Rg(t)}else a=!1;if(Iu(t,i),t.stateNode===null)wg(e,t),O3(t,r,n),P2(t,r,n,i),n=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,A=r.contextType;typeof A=="object"&&A!==null?A=is(A):(A=ia(r)?JA:Fi.current,A=Mu(t,A));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||l!==A)&&QB(t,s,n,A),xl=!1;var h=t.memoizedState;s.state=h,Vg(t,n,s,i),l=t.memoizedState,o!==n||h!==l||na.current||xl?(typeof u=="function"&&(D2(t,r,u,n),l=t.memoizedState),(o=xl||PB(t,r,o,n,h,l,A))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),s.props=n,s.state=l,s.context=A,n=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,d3(e,t),o=t.memoizedProps,A=t.type===t.elementType?o:ws(t.type,o),s.props=A,f=t.pendingProps,h=s.context,l=r.contextType,typeof l=="object"&&l!==null?l=is(l):(l=ia(r)?JA:Fi.current,l=Mu(t,l));var d=r.getDerivedStateFromProps;(u=typeof d=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==f||h!==l)&&QB(t,s,n,l),xl=!1,h=t.memoizedState,s.state=h,Vg(t,n,s,i);var m=t.memoizedState;o!==f||h!==m||na.current||xl?(typeof d=="function"&&(D2(t,r,d,n),m=t.memoizedState),(A=xl||PB(t,r,A,n,h,m,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,m,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,m,l)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),s.props=n,s.state=m,s.context=l,n=A):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return M2(e,t,r,n,a,i)}function M2(e,t,r,n,i,a){R3(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return i&&NB(t,r,!1),Ho(e,t,a);n=t.stateNode,q8.current=t;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=Ku(t,e.child,null,a),t.child=Ku(t,null,o,a)):Di(e,t,o,a),t.memoizedState=n.state,i&&NB(t,r,!0),t.child}function M3(e){var t=e.stateNode;t.pendingContext?FB(e,t.pendingContext,t.pendingContext!==t.context):t.context&&FB(e,t.context,!1),Mw(e,t.containerInfo)}function WB(e,t,r,n,i){return Hu(),Ow(i),t.flags|=256,Di(e,t,r,n),t.child}var H2={dehydrated:null,treeContext:null,retryLane:0};function K2(e){return{baseLanes:e,cachePool:null,transitions:null}}function H3(e,t,r){var n=t.pendingProps,i=zr.current,a=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Dr(zr,i&1),e===null)return O2(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,a?(n=t.mode,a=t.child,s={mode:"hidden",children:s},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=s):a=zm(s,n,0,null),e=MA(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=K2(r),t.memoizedState=H2,e):zw(t,s));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return z8(e,t,s,n,o,i,r);if(a){a=n.fallback,s=t.mode,i=e.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(s&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Kl(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?a=Kl(o,a):(a=MA(a,s,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,s=e.child.memoizedState,s=s===null?K2(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},a.memoizedState=s,a.childLanes=e.childLanes&~r,t.memoizedState=H2,n}return a=e.child,e=a.sibling,n=Kl(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function zw(e,t){return t=zm({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function gp(e,t,r,n){return n!==null&&Ow(n),Ku(t,e.child,null,r),e=zw(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function z8(e,t,r,n,i,a,s){if(r)return t.flags&256?(t.flags&=-257,n=Wv(Error(ot(422))),gp(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,i=t.mode,n=zm({mode:"visible",children:n.children},i,0,null),a=MA(a,i,s,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&Ku(t,e.child,null,s),t.child.memoizedState=K2(s),t.memoizedState=H2,a);if(!(t.mode&1))return gp(e,t,s,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(ot(419)),n=Wv(a,n,void 0),gp(e,t,s,n)}if(o=(s&e.childLanes)!==0,ra||o){if(n=Xn,n!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|s)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,Mo(e,i),Fs(n,e,i,-1))}return tb(),n=Wv(Error(ot(421))),gp(e,t,s,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=lU.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,wa=Ql(i.nextSibling),Ba=t,$r=!0,Cs=null,e!==null&&($a[qa++]=To,$a[qa++]=Lo,$a[qa++]=ZA,To=e.id,Lo=e.overflow,ZA=t),t=zw(t,n.children),t.flags|=4096,t)}function $B(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),j2(e.return,t,r)}function $v(e,t,r,n,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function K3(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(Di(e,t,n.children,r),n=zr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&$B(e,r,t);else if(e.tag===19)$B(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Dr(zr,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Wg(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),$v(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Wg(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}$v(t,!0,r,null,a);break;case"together":$v(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function wg(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ho(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),tc|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ot(153));if(t.child!==null){for(e=t.child,r=Kl(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Kl(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function X8(e,t,r){switch(t.tag){case 3:M3(t),Hu();break;case 5:p3(t);break;case 1:ia(t.type)&&Rg(t);break;case 4:Mw(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Dr(Kg,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Dr(zr,zr.current&1),t.flags|=128,null):r&t.child.childLanes?H3(e,t,r):(Dr(zr,zr.current&1),e=Ho(e,t,r),e!==null?e.sibling:null);Dr(zr,zr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return K3(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Dr(zr,zr.current),n)break;return null;case 22:case 23:return t.lanes=0,Q3(e,t,r)}return Ho(e,t,r)}var G3,G2,V3,W3;G3=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};G2=function(){};V3=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,OA(no.current);var a=null;switch(r){case"input":i=f2(e,i),n=f2(e,n),a=[];break;case"select":i=en({},i,{value:void 0}),n=en({},n,{value:void 0}),a=[];break;case"textarea":i=p2(e,i),n=p2(e,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Pg)}m2(r,n);var s;r=null;for(A in i)if(!n.hasOwnProperty(A)&&i.hasOwnProperty(A)&&i[A]!=null)if(A==="style"){var o=i[A];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else A!=="dangerouslySetInnerHTML"&&A!=="children"&&A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(cd.hasOwnProperty(A)?a||(a=[]):(a=a||[]).push(A,null));for(A in n){var l=n[A];if(o=i!=null?i[A]:void 0,n.hasOwnProperty(A)&&l!==o&&(l!=null||o!=null))if(A==="style")if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(r||(r={}),r[s]=l[s])}else r||(a||(a=[]),a.push(A,r)),r=l;else A==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(A,l)):A==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(A,""+l):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&(cd.hasOwnProperty(A)?(l!=null&&A==="onScroll"&&Pr("scroll",e),a||o===l||(a=[])):(a=a||[]).push(A,l))}r&&(a=a||[]).push("style",r);var A=a;(t.updateQueue=A)&&(t.flags|=4)}};W3=function(e,t,r,n){r!==n&&(t.flags|=4)};function eh(e,t){if(!$r)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function ui(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Y8(e,t,r){var n=t.pendingProps;switch(Uw(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ui(t),null;case 1:return ia(t.type)&&Qg(),ui(t),null;case 3:return n=t.stateNode,Gu(),Hr(na),Hr(Fi),Kw(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(dp(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Cs!==null&&(J2(Cs),Cs=null))),G2(e,t),ui(t),null;case 5:Hw(t);var i=OA(bd.current);if(r=t.type,e!==null&&t.stateNode!=null)V3(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ot(166));return ui(t),null}if(e=OA(no.current),dp(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[Js]=t,n[yd]=a,e=(t.mode&1)!==0,r){case"dialog":Pr("cancel",n),Pr("close",n);break;case"iframe":case"object":case"embed":Pr("load",n);break;case"video":case"audio":for(i=0;i<mh.length;i++)Pr(mh[i],n);break;case"source":Pr("error",n);break;case"img":case"image":case"link":Pr("error",n),Pr("load",n);break;case"details":Pr("toggle",n);break;case"input":rB(n,a),Pr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Pr("invalid",n);break;case"textarea":iB(n,a),Pr("invalid",n)}m2(r,a),i=null;for(var s in a)if(a.hasOwnProperty(s)){var o=a[s];s==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&hp(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&hp(n.textContent,o,e),i=["children",""+o]):cd.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&Pr("scroll",n)}switch(r){case"input":ap(n),nB(n,a,!0);break;case"textarea":ap(n),aB(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=Pg)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=yE(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[Js]=t,e[yd]=n,G3(e,t,!1,!1),t.stateNode=e;e:{switch(s=v2(r,n),r){case"dialog":Pr("cancel",e),Pr("close",e),i=n;break;case"iframe":case"object":case"embed":Pr("load",e),i=n;break;case"video":case"audio":for(i=0;i<mh.length;i++)Pr(mh[i],e);i=n;break;case"source":Pr("error",e),i=n;break;case"img":case"image":case"link":Pr("error",e),Pr("load",e),i=n;break;case"details":Pr("toggle",e),i=n;break;case"input":rB(e,n),i=f2(e,n),Pr("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=en({},n,{value:void 0}),Pr("invalid",e);break;case"textarea":iB(e,n),i=p2(e,n),Pr("invalid",e);break;default:i=n}m2(r,i),o=i;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?BE(e,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&wE(e,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&ud(e,l):typeof l=="number"&&ud(e,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(cd.hasOwnProperty(a)?l!=null&&a==="onScroll"&&Pr("scroll",e):l!=null&&xw(e,a,l,s))}switch(r){case"input":ap(e),nB(e,n,!1);break;case"textarea":ap(e),aB(e);break;case"option":n.value!=null&&e.setAttribute("value",""+zl(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Fu(e,!!n.multiple,a,!1):n.defaultValue!=null&&Fu(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Pg)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ui(t),null;case 6:if(e&&t.stateNode!=null)W3(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ot(166));if(r=OA(bd.current),OA(no.current),dp(t)){if(n=t.stateNode,r=t.memoizedProps,n[Js]=t,(a=n.nodeValue!==r)&&(e=Ba,e!==null))switch(e.tag){case 3:hp(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&hp(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Js]=t,t.stateNode=n}return ui(t),null;case 13:if(Hr(zr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if($r&&wa!==null&&t.mode&1&&!(t.flags&128))c3(),Hu(),t.flags|=98560,a=!1;else if(a=dp(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(ot(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ot(317));a[Js]=t}else Hu(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ui(t),a=!1}else Cs!==null&&(J2(Cs),Cs=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||zr.current&1?Dn===0&&(Dn=3):tb())),t.updateQueue!==null&&(t.flags|=4),ui(t),null);case 4:return Gu(),G2(e,t),e===null&&vd(t.stateNode.containerInfo),ui(t),null;case 10:return Pw(t.type._context),ui(t),null;case 17:return ia(t.type)&&Qg(),ui(t),null;case 19:if(Hr(zr),a=t.memoizedState,a===null)return ui(t),null;if(n=(t.flags&128)!==0,s=a.rendering,s===null)if(n)eh(a,!1);else{if(Dn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=Wg(e),s!==null){for(t.flags|=128,eh(a,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,s=a.alternate,s===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,a.type=s.type,e=s.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Dr(zr,zr.current&1|2),t.child}e=e.sibling}a.tail!==null&&vn()>Wu&&(t.flags|=128,n=!0,eh(a,!1),t.lanes=4194304)}else{if(!n)if(e=Wg(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),eh(a,!0),a.tail===null&&a.tailMode==="hidden"&&!s.alternate&&!$r)return ui(t),null}else 2*vn()-a.renderingStartTime>Wu&&r!==1073741824&&(t.flags|=128,n=!0,eh(a,!1),t.lanes=4194304);a.isBackwards?(s.sibling=t.child,t.child=s):(r=a.last,r!==null?r.sibling=s:t.child=s,a.last=s)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=vn(),t.sibling=null,r=zr.current,Dr(zr,n?r&1|2:r&1),t):(ui(t),null);case 22:case 23:return eb(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?ga&1073741824&&(ui(t),t.subtreeFlags&6&&(t.flags|=8192)):ui(t),null;case 24:return null;case 25:return null}throw Error(ot(156,t.tag))}function J8(e,t){switch(Uw(t),t.tag){case 1:return ia(t.type)&&Qg(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Gu(),Hr(na),Hr(Fi),Kw(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Hw(t),null;case 13:if(Hr(zr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ot(340));Hu()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Hr(zr),null;case 4:return Gu(),null;case 10:return Pw(t.type._context),null;case 22:case 23:return eb(),null;case 24:return null;default:return null}}var mp=!1,bi=!1,Z8=typeof WeakSet=="function"?WeakSet:Set,bt=null;function Cu(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){on(e,t,n)}else r.current=null}function V2(e,t,r){try{r()}catch(n){on(e,t,n)}}var qB=!1;function eU(e,t){if(k2=Og,e=YE(),Lw(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var s=0,o=-1,l=-1,A=0,u=0,f=e,h=null;t:for(;;){for(var d;f!==r||i!==0&&f.nodeType!==3||(o=s+i),f!==a||n!==0&&f.nodeType!==3||(l=s+n),f.nodeType===3&&(s+=f.nodeValue.length),(d=f.firstChild)!==null;)h=f,f=d;for(;;){if(f===e)break t;if(h===r&&++A===i&&(o=s),h===a&&++u===n&&(l=s),(d=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=d}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(F2={focusedElem:e,selectionRange:r},Og=!1,bt=t;bt!==null;)if(t=bt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,bt=e;else for(;bt!==null;){t=bt;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,x=m.memoizedState,p=t.stateNode,v=p.getSnapshotBeforeUpdate(t.elementType===t.type?g:ws(t.type,g),x);p.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ot(163))}}catch(w){on(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,bt=e;break}bt=t.return}return m=qB,qB=!1,m}function jh(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&V2(t,r,a)}i=i.next}while(i!==n)}}function $m(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function W2(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function $3(e){var t=e.alternate;t!==null&&(e.alternate=null,$3(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Js],delete t[yd],delete t[L2],delete t[j8],delete t[D8])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function q3(e){return e.tag===5||e.tag===3||e.tag===4}function zB(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||q3(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function $2(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Pg));else if(n!==4&&(e=e.child,e!==null))for($2(e,t,r),e=e.sibling;e!==null;)$2(e,t,r),e=e.sibling}function q2(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(q2(e,t,r),e=e.sibling;e!==null;)q2(e,t,r),e=e.sibling}var ei=null,Bs=!1;function cl(e,t,r){for(r=r.child;r!==null;)z3(e,t,r),r=r.sibling}function z3(e,t,r){if(ro&&typeof ro.onCommitFiberUnmount=="function")try{ro.onCommitFiberUnmount(Qm,r)}catch{}switch(r.tag){case 5:bi||Cu(r,t);case 6:var n=ei,i=Bs;ei=null,cl(e,t,r),ei=n,Bs=i,ei!==null&&(Bs?(e=ei,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):ei.removeChild(r.stateNode));break;case 18:ei!==null&&(Bs?(e=ei,r=r.stateNode,e.nodeType===8?Rv(e.parentNode,r):e.nodeType===1&&Rv(e,r),pd(e)):Rv(ei,r.stateNode));break;case 4:n=ei,i=Bs,ei=r.stateNode.containerInfo,Bs=!0,cl(e,t,r),ei=n,Bs=i;break;case 0:case 11:case 14:case 15:if(!bi&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,s=a.destroy;a=a.tag,s!==void 0&&(a&2||a&4)&&V2(r,t,s),i=i.next}while(i!==n)}cl(e,t,r);break;case 1:if(!bi&&(Cu(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){on(r,t,o)}cl(e,t,r);break;case 21:cl(e,t,r);break;case 22:r.mode&1?(bi=(n=bi)||r.memoizedState!==null,cl(e,t,r),bi=n):cl(e,t,r);break;default:cl(e,t,r)}}function XB(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Z8),t.forEach(function(n){var i=AU.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function ps(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var a=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:ei=o.stateNode,Bs=!1;break e;case 3:ei=o.stateNode.containerInfo,Bs=!0;break e;case 4:ei=o.stateNode.containerInfo,Bs=!0;break e}o=o.return}if(ei===null)throw Error(ot(160));z3(a,s,i),ei=null,Bs=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(A){on(i,t,A)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)X3(t,e),t=t.sibling}function X3(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ps(t,e),Gs(e),n&4){try{jh(3,e,e.return),$m(3,e)}catch(g){on(e,e.return,g)}try{jh(5,e,e.return)}catch(g){on(e,e.return,g)}}break;case 1:ps(t,e),Gs(e),n&512&&r!==null&&Cu(r,r.return);break;case 5:if(ps(t,e),Gs(e),n&512&&r!==null&&Cu(r,r.return),e.flags&32){var i=e.stateNode;try{ud(i,"")}catch(g){on(e,e.return,g)}}if(n&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,s=r!==null?r.memoizedProps:a,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&vE(i,a),v2(o,s);var A=v2(o,a);for(s=0;s<l.length;s+=2){var u=l[s],f=l[s+1];u==="style"?BE(i,f):u==="dangerouslySetInnerHTML"?wE(i,f):u==="children"?ud(i,f):xw(i,u,f,A)}switch(o){case"input":h2(i,a);break;case"textarea":xE(i,a);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var d=a.value;d!=null?Fu(i,!!a.multiple,d,!1):h!==!!a.multiple&&(a.defaultValue!=null?Fu(i,!!a.multiple,a.defaultValue,!0):Fu(i,!!a.multiple,a.multiple?[]:"",!1))}i[yd]=a}catch(g){on(e,e.return,g)}}break;case 6:if(ps(t,e),Gs(e),n&4){if(e.stateNode===null)throw Error(ot(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(g){on(e,e.return,g)}}break;case 3:if(ps(t,e),Gs(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{pd(t.containerInfo)}catch(g){on(e,e.return,g)}break;case 4:ps(t,e),Gs(e);break;case 13:ps(t,e),Gs(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(Jw=vn())),n&4&&XB(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(bi=(A=bi)||u,ps(t,e),bi=A):ps(t,e),Gs(e),n&8192){if(A=e.memoizedState!==null,(e.stateNode.isHidden=A)&&!u&&e.mode&1)for(bt=e,u=e.child;u!==null;){for(f=bt=u;bt!==null;){switch(h=bt,d=h.child,h.tag){case 0:case 11:case 14:case 15:jh(4,h,h.return);break;case 1:Cu(h,h.return);var m=h.stateNode;if(typeof m.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){on(n,r,g)}}break;case 5:Cu(h,h.return);break;case 22:if(h.memoizedState!==null){JB(f);continue}}d!==null?(d.return=h,bt=d):JB(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{i=f.stateNode,A?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=f.stateNode,l=f.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=bE("display",s))}catch(g){on(e,e.return,g)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=A?"":f.memoizedProps}catch(g){on(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:ps(t,e),Gs(e),n&4&&XB(e);break;case 21:break;default:ps(t,e),Gs(e)}}function Gs(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(q3(r)){var n=r;break e}r=r.return}throw Error(ot(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(ud(i,""),n.flags&=-33);var a=zB(e);q2(e,a,i);break;case 3:case 4:var s=n.stateNode.containerInfo,o=zB(e);$2(e,o,s);break;default:throw Error(ot(161))}}catch(l){on(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function tU(e,t,r){bt=e,Y3(e)}function Y3(e,t,r){for(var n=(e.mode&1)!==0;bt!==null;){var i=bt,a=i.child;if(i.tag===22&&n){var s=i.memoizedState!==null||mp;if(!s){var o=i.alternate,l=o!==null&&o.memoizedState!==null||bi;o=mp;var A=bi;if(mp=s,(bi=l)&&!A)for(bt=i;bt!==null;)s=bt,l=s.child,s.tag===22&&s.memoizedState!==null?ZB(i):l!==null?(l.return=s,bt=l):ZB(i);for(;a!==null;)bt=a,Y3(a),a=a.sibling;bt=i,mp=o,bi=A}YB(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,bt=a):YB(e)}}function YB(e){for(;bt!==null;){var t=bt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:bi||$m(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!bi)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:ws(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&OB(t,a,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}OB(t,s,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var A=t.alternate;if(A!==null){var u=A.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&pd(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ot(163))}bi||t.flags&512&&W2(t)}catch(h){on(t,t.return,h)}}if(t===e){bt=null;break}if(r=t.sibling,r!==null){r.return=t.return,bt=r;break}bt=t.return}}function JB(e){for(;bt!==null;){var t=bt;if(t===e){bt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,bt=r;break}bt=t.return}}function ZB(e){for(;bt!==null;){var t=bt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{$m(4,t)}catch(l){on(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(l){on(t,i,l)}}var a=t.return;try{W2(t)}catch(l){on(t,a,l)}break;case 5:var s=t.return;try{W2(t)}catch(l){on(t,s,l)}}}catch(l){on(t,t.return,l)}if(t===e){bt=null;break}var o=t.sibling;if(o!==null){o.return=t.return,bt=o;break}bt=t.return}}var rU=Math.ceil,zg=Vo.ReactCurrentDispatcher,Xw=Vo.ReactCurrentOwner,ts=Vo.ReactCurrentBatchConfig,lr=0,Xn=null,Tn=null,ai=0,ga=0,Su=oA(0),Dn=0,Sd=null,tc=0,qm=0,Yw=0,Dh=null,ea=null,Jw=0,Wu=1/0,So=null,Xg=!1,z2=null,Ml=null,vp=!1,kl=null,Yg=0,Ph=0,X2=null,bg=-1,Bg=0;function Ri(){return lr&6?vn():bg!==-1?bg:bg=vn()}function Hl(e){return e.mode&1?lr&2&&ai!==0?ai&-ai:Q8.transition!==null?(Bg===0&&(Bg=OE()),Bg):(e=Cr,e!==0||(e=window.event,e=e===void 0?16:HE(e.type)),e):1}function Fs(e,t,r,n){if(50<Ph)throw Ph=0,X2=null,Error(ot(185));Jd(e,r,n),(!(lr&2)||e!==Xn)&&(e===Xn&&(!(lr&2)&&(qm|=r),Dn===4&&Bl(e,ai)),aa(e,n),r===1&&lr===0&&!(t.mode&1)&&(Wu=vn()+500,Gm&&lA()))}function aa(e,t){var r=e.callbackNode;QI(e,t);var n=Ug(e,e===Xn?ai:0);if(n===0)r!==null&&lB(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&lB(r),t===1)e.tag===0?P8(e4.bind(null,e)):o3(e4.bind(null,e)),U8(function(){!(lr&6)&&lA()}),r=null;else{switch(jE(n)){case 1:r=_w;break;case 4:r=IE;break;case 16:r=Ig;break;case 536870912:r=UE;break;default:r=Ig}r=ak(r,J3.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function J3(e,t){if(bg=-1,Bg=0,lr&6)throw Error(ot(327));var r=e.callbackNode;if(Uu()&&e.callbackNode!==r)return null;var n=Ug(e,e===Xn?ai:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Jg(e,n);else{t=n;var i=lr;lr|=2;var a=ek();(Xn!==e||ai!==t)&&(So=null,Wu=vn()+500,RA(e,t));do try{aU();break}catch(o){Z3(e,o)}while(!0);Dw(),zg.current=a,lr=i,Tn!==null?t=0:(Xn=null,ai=0,t=Dn)}if(t!==0){if(t===2&&(i=B2(e),i!==0&&(n=i,t=Y2(e,i))),t===1)throw r=Sd,RA(e,0),Bl(e,n),aa(e,vn()),r;if(t===6)Bl(e,n);else{if(i=e.current.alternate,!(n&30)&&!nU(i)&&(t=Jg(e,n),t===2&&(a=B2(e),a!==0&&(n=a,t=Y2(e,a))),t===1))throw r=Sd,RA(e,0),Bl(e,n),aa(e,vn()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(ot(345));case 2:SA(e,ea,So);break;case 3:if(Bl(e,n),(n&130023424)===n&&(t=Jw+500-vn(),10<t)){if(Ug(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Ri(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=T2(SA.bind(null,e,ea,So),t);break}SA(e,ea,So);break;case 4:if(Bl(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var s=31-ks(n);a=1<<s,s=t[s],s>i&&(i=s),n&=~a}if(n=i,n=vn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*rU(n/1960))-n,10<n){e.timeoutHandle=T2(SA.bind(null,e,ea,So),n);break}SA(e,ea,So);break;case 5:SA(e,ea,So);break;default:throw Error(ot(329))}}}return aa(e,vn()),e.callbackNode===r?J3.bind(null,e):null}function Y2(e,t){var r=Dh;return e.current.memoizedState.isDehydrated&&(RA(e,t).flags|=256),e=Jg(e,t),e!==2&&(t=ea,ea=r,t!==null&&J2(t)),e}function J2(e){ea===null?ea=e:ea.push.apply(ea,e)}function nU(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!Us(a(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Bl(e,t){for(t&=~Yw,t&=~qm,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ks(t),n=1<<r;e[r]=-1,t&=~n}}function e4(e){if(lr&6)throw Error(ot(327));Uu();var t=Ug(e,0);if(!(t&1))return aa(e,vn()),null;var r=Jg(e,t);if(e.tag!==0&&r===2){var n=B2(e);n!==0&&(t=n,r=Y2(e,n))}if(r===1)throw r=Sd,RA(e,0),Bl(e,t),aa(e,vn()),r;if(r===6)throw Error(ot(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,SA(e,ea,So),aa(e,vn()),null}function Zw(e,t){var r=lr;lr|=1;try{return e(t)}finally{lr=r,lr===0&&(Wu=vn()+500,Gm&&lA())}}function rc(e){kl!==null&&kl.tag===0&&!(lr&6)&&Uu();var t=lr;lr|=1;var r=ts.transition,n=Cr;try{if(ts.transition=null,Cr=1,e)return e()}finally{Cr=n,ts.transition=r,lr=t,!(lr&6)&&lA()}}function eb(){ga=Su.current,Hr(Su)}function RA(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,I8(r)),Tn!==null)for(r=Tn.return;r!==null;){var n=r;switch(Uw(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Qg();break;case 3:Gu(),Hr(na),Hr(Fi),Kw();break;case 5:Hw(n);break;case 4:Gu();break;case 13:Hr(zr);break;case 19:Hr(zr);break;case 10:Pw(n.type._context);break;case 22:case 23:eb()}r=r.return}if(Xn=e,Tn=e=Kl(e.current,null),ai=ga=t,Dn=0,Sd=null,Yw=qm=tc=0,ea=Dh=null,UA!==null){for(t=0;t<UA.length;t++)if(r=UA[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,a=r.pending;if(a!==null){var s=a.next;a.next=i,n.next=s}r.pending=n}UA=null}return e}function Z3(e,t){do{var r=Tn;try{if(Dw(),xg.current=qg,$g){for(var n=Jr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}$g=!1}if(ec=0,$n=In=Jr=null,Oh=!1,Bd=0,Xw.current=null,r===null||r.return===null){Dn=1,Sd=t,Tn=null;break}e:{var a=e,s=r.return,o=r,l=t;if(t=ai,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var A=l,u=o,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var d=MB(s);if(d!==null){d.flags&=-257,HB(d,s,o,a,t),d.mode&1&&RB(a,A,t),t=d,l=A;var m=t.updateQueue;if(m===null){var g=new Set;g.add(l),t.updateQueue=g}else m.add(l);break e}else{if(!(t&1)){RB(a,A,t),tb();break e}l=Error(ot(426))}}else if($r&&o.mode&1){var x=MB(s);if(x!==null){!(x.flags&65536)&&(x.flags|=256),HB(x,s,o,a,t),Ow(Vu(l,o));break e}}a=l=Vu(l,o),Dn!==4&&(Dn=2),Dh===null?Dh=[a]:Dh.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var p=j3(a,l,t);UB(a,p);break e;case 1:o=l;var v=a.type,y=a.stateNode;if(!(a.flags&128)&&(typeof v.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Ml===null||!Ml.has(y)))){a.flags|=65536,t&=-t,a.lanes|=t;var w=D3(a,o,t);UB(a,w);break e}}a=a.return}while(a!==null)}rk(r)}catch(B){t=B,Tn===r&&r!==null&&(Tn=r=r.return);continue}break}while(!0)}function ek(){var e=zg.current;return zg.current=qg,e===null?qg:e}function tb(){(Dn===0||Dn===3||Dn===2)&&(Dn=4),Xn===null||!(tc&268435455)&&!(qm&268435455)||Bl(Xn,ai)}function Jg(e,t){var r=lr;lr|=2;var n=ek();(Xn!==e||ai!==t)&&(So=null,RA(e,t));do try{iU();break}catch(i){Z3(e,i)}while(!0);if(Dw(),lr=r,zg.current=n,Tn!==null)throw Error(ot(261));return Xn=null,ai=0,Dn}function iU(){for(;Tn!==null;)tk(Tn)}function aU(){for(;Tn!==null&&!NI();)tk(Tn)}function tk(e){var t=ik(e.alternate,e,ga);e.memoizedProps=e.pendingProps,t===null?rk(e):Tn=t,Xw.current=null}function rk(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=J8(r,t),r!==null){r.flags&=32767,Tn=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Dn=6,Tn=null;return}}else if(r=Y8(r,t,ga),r!==null){Tn=r;return}if(t=t.sibling,t!==null){Tn=t;return}Tn=t=e}while(t!==null);Dn===0&&(Dn=5)}function SA(e,t,r){var n=Cr,i=ts.transition;try{ts.transition=null,Cr=1,sU(e,t,r,n)}finally{ts.transition=i,Cr=n}return null}function sU(e,t,r,n){do Uu();while(kl!==null);if(lr&6)throw Error(ot(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ot(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(RI(e,a),e===Xn&&(Tn=Xn=null,ai=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||vp||(vp=!0,ak(Ig,function(){return Uu(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=ts.transition,ts.transition=null;var s=Cr;Cr=1;var o=lr;lr|=4,Xw.current=null,eU(e,r),X3(r,e),S8(F2),Og=!!k2,F2=k2=null,e.current=r,tU(r),TI(),lr=o,Cr=s,ts.transition=a}else e.current=r;if(vp&&(vp=!1,kl=e,Yg=i),a=e.pendingLanes,a===0&&(Ml=null),UI(r.stateNode),aa(e,vn()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Xg)throw Xg=!1,e=z2,z2=null,e;return Yg&1&&e.tag!==0&&Uu(),a=e.pendingLanes,a&1?e===X2?Ph++:(Ph=0,X2=e):Ph=0,lA(),null}function Uu(){if(kl!==null){var e=jE(Yg),t=ts.transition,r=Cr;try{if(ts.transition=null,Cr=16>e?16:e,kl===null)var n=!1;else{if(e=kl,kl=null,Yg=0,lr&6)throw Error(ot(331));var i=lr;for(lr|=4,bt=e.current;bt!==null;){var a=bt,s=a.child;if(bt.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var A=o[l];for(bt=A;bt!==null;){var u=bt;switch(u.tag){case 0:case 11:case 15:jh(8,u,a)}var f=u.child;if(f!==null)f.return=u,bt=f;else for(;bt!==null;){u=bt;var h=u.sibling,d=u.return;if($3(u),u===A){bt=null;break}if(h!==null){h.return=d,bt=h;break}bt=d}}}var m=a.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var x=g.sibling;g.sibling=null,g=x}while(g!==null)}}bt=a}}if(a.subtreeFlags&2064&&s!==null)s.return=a,bt=s;else e:for(;bt!==null;){if(a=bt,a.flags&2048)switch(a.tag){case 0:case 11:case 15:jh(9,a,a.return)}var p=a.sibling;if(p!==null){p.return=a.return,bt=p;break e}bt=a.return}}var v=e.current;for(bt=v;bt!==null;){s=bt;var y=s.child;if(s.subtreeFlags&2064&&y!==null)y.return=s,bt=y;else e:for(s=v;bt!==null;){if(o=bt,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:$m(9,o)}}catch(B){on(o,o.return,B)}if(o===s){bt=null;break e}var w=o.sibling;if(w!==null){w.return=o.return,bt=w;break e}bt=o.return}}if(lr=i,lA(),ro&&typeof ro.onPostCommitFiberRoot=="function")try{ro.onPostCommitFiberRoot(Qm,e)}catch{}n=!0}return n}finally{Cr=r,ts.transition=t}}return!1}function t4(e,t,r){t=Vu(r,t),t=j3(e,t,1),e=Rl(e,t,1),t=Ri(),e!==null&&(Jd(e,1,t),aa(e,t))}function on(e,t,r){if(e.tag===3)t4(e,e,r);else for(;t!==null;){if(t.tag===3){t4(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ml===null||!Ml.has(n))){e=Vu(r,e),e=D3(t,e,1),t=Rl(t,e,1),e=Ri(),t!==null&&(Jd(t,1,e),aa(t,e));break}}t=t.return}}function oU(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Ri(),e.pingedLanes|=e.suspendedLanes&r,Xn===e&&(ai&r)===r&&(Dn===4||Dn===3&&(ai&130023424)===ai&&500>vn()-Jw?RA(e,0):Yw|=r),aa(e,t)}function nk(e,t){t===0&&(e.mode&1?(t=lp,lp<<=1,!(lp&130023424)&&(lp=4194304)):t=1);var r=Ri();e=Mo(e,t),e!==null&&(Jd(e,t,r),aa(e,r))}function lU(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),nk(e,r)}function AU(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ot(314))}n!==null&&n.delete(t),nk(e,r)}var ik;ik=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||na.current)ra=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return ra=!1,X8(e,t,r);ra=!!(e.flags&131072)}else ra=!1,$r&&t.flags&1048576&&l3(t,Hg,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;wg(e,t),e=t.pendingProps;var i=Mu(t,Fi.current);Iu(t,r),i=Vw(null,t,n,e,i,r);var a=Ww();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ia(n)?(a=!0,Rg(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Rw(t),i.updater=Wm,t.stateNode=i,i._reactInternals=t,P2(t,n,e,r),t=M2(null,t,n,!0,a,r)):(t.tag=0,$r&&a&&Iw(t),Di(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(wg(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=uU(n),e=ws(n,e),i){case 0:t=R2(null,t,n,e,r);break e;case 1:t=VB(null,t,n,e,r);break e;case 11:t=KB(null,t,n,e,r);break e;case 14:t=GB(null,t,n,ws(n.type,e),r);break e}throw Error(ot(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ws(n,i),R2(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ws(n,i),VB(e,t,n,i,r);case 3:e:{if(M3(t),e===null)throw Error(ot(387));n=t.pendingProps,a=t.memoizedState,i=a.element,d3(e,t),Vg(t,n,null,r);var s=t.memoizedState;if(n=s.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=Vu(Error(ot(423)),t),t=WB(e,t,n,r,i);break e}else if(n!==i){i=Vu(Error(ot(424)),t),t=WB(e,t,n,r,i);break e}else for(wa=Ql(t.stateNode.containerInfo.firstChild),Ba=t,$r=!0,Cs=null,r=f3(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Hu(),n===i){t=Ho(e,t,r);break e}Di(e,t,n,r)}t=t.child}return t;case 5:return p3(t),e===null&&O2(t),n=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,s=i.children,N2(n,i)?s=null:a!==null&&N2(n,a)&&(t.flags|=32),R3(e,t),Di(e,t,s,r),t.child;case 6:return e===null&&O2(t),null;case 13:return H3(e,t,r);case 4:return Mw(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Ku(t,null,n,r):Di(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ws(n,i),KB(e,t,n,i,r);case 7:return Di(e,t,t.pendingProps,r),t.child;case 8:return Di(e,t,t.pendingProps.children,r),t.child;case 12:return Di(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,a=t.memoizedProps,s=i.value,Dr(Kg,n._currentValue),n._currentValue=s,a!==null)if(Us(a.value,s)){if(a.children===i.children&&!na.current){t=Ho(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){s=a.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=Uo(-1,r&-r),l.tag=2;var A=a.updateQueue;if(A!==null){A=A.shared;var u=A.pending;u===null?l.next=l:(l.next=u.next,u.next=l),A.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),j2(a.return,r,t),o.lanes|=r;break}l=l.next}}else if(a.tag===10)s=a.type===t.type?null:a.child;else if(a.tag===18){if(s=a.return,s===null)throw Error(ot(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),j2(s,r,t),s=a.sibling}else s=a.child;if(s!==null)s.return=a;else for(s=a;s!==null;){if(s===t){s=null;break}if(a=s.sibling,a!==null){a.return=s.return,s=a;break}s=s.return}a=s}Di(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Iu(t,r),i=is(i),n=n(i),t.flags|=1,Di(e,t,n,r),t.child;case 14:return n=t.type,i=ws(n,t.pendingProps),i=ws(n.type,i),GB(e,t,n,i,r);case 15:return P3(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ws(n,i),wg(e,t),t.tag=1,ia(n)?(e=!0,Rg(t)):e=!1,Iu(t,r),O3(t,n,i),P2(t,n,i,r),M2(null,t,n,!0,e,r);case 19:return K3(e,t,r);case 22:return Q3(e,t,r)}throw Error(ot(156,t.tag))};function ak(e,t){return LE(e,t)}function cU(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ya(e,t,r,n){return new cU(e,t,r,n)}function rb(e){return e=e.prototype,!(!e||!e.isReactComponent)}function uU(e){if(typeof e=="function")return rb(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ww)return 11;if(e===bw)return 14}return 2}function Kl(e,t){var r=e.alternate;return r===null?(r=Ya(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function _g(e,t,r,n,i,a){var s=2;if(n=e,typeof e=="function")rb(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case gu:return MA(r.children,i,a,t);case yw:s=8,i|=8;break;case l2:return e=Ya(12,r,t,i|2),e.elementType=l2,e.lanes=a,e;case A2:return e=Ya(13,r,t,i),e.elementType=A2,e.lanes=a,e;case c2:return e=Ya(19,r,t,i),e.elementType=c2,e.lanes=a,e;case pE:return zm(r,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case hE:s=10;break e;case dE:s=9;break e;case ww:s=11;break e;case bw:s=14;break e;case vl:s=16,n=null;break e}throw Error(ot(130,e==null?e:typeof e,""))}return t=Ya(s,r,t,i),t.elementType=e,t.type=n,t.lanes=a,t}function MA(e,t,r,n){return e=Ya(7,e,n,t),e.lanes=r,e}function zm(e,t,r,n){return e=Ya(22,e,n,t),e.elementType=pE,e.lanes=r,e.stateNode={isHidden:!1},e}function qv(e,t,r){return e=Ya(6,e,null,t),e.lanes=r,e}function zv(e,t,r){return t=Ya(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function fU(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Fv(0),this.expirationTimes=Fv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fv(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function nb(e,t,r,n,i,a,s,o,l){return e=new fU(e,t,r,o,l),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Ya(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Rw(a),e}function hU(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:pu,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function sk(e){if(!e)return Xl;e=e._reactInternals;e:{if(uc(e)!==e||e.tag!==1)throw Error(ot(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ia(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ot(171))}if(e.tag===1){var r=e.type;if(ia(r))return s3(e,r,t)}return t}function ok(e,t,r,n,i,a,s,o,l){return e=nb(r,n,!0,e,i,a,s,o,l),e.context=sk(null),r=e.current,n=Ri(),i=Hl(r),a=Uo(n,i),a.callback=t??null,Rl(r,a,i),e.current.lanes=i,Jd(e,i,n),aa(e,n),e}function Xm(e,t,r,n){var i=t.current,a=Ri(),s=Hl(i);return r=sk(r),t.context===null?t.context=r:t.pendingContext=r,t=Uo(a,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Rl(i,t,s),e!==null&&(Fs(e,i,s,a),vg(e,i,s)),s}function Zg(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function r4(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function ib(e,t){r4(e,t),(e=e.alternate)&&r4(e,t)}function dU(){return null}var lk=typeof reportError=="function"?reportError:function(e){console.error(e)};function ab(e){this._internalRoot=e}Ym.prototype.render=ab.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ot(409));Xm(e,t,null,null)};Ym.prototype.unmount=ab.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;rc(function(){Xm(null,e,null,null)}),t[Ro]=null}};function Ym(e){this._internalRoot=e}Ym.prototype.unstable_scheduleHydration=function(e){if(e){var t=QE();e={blockedOn:null,target:e,priority:t};for(var r=0;r<bl.length&&t!==0&&t<bl[r].priority;r++);bl.splice(r,0,e),r===0&&ME(e)}};function sb(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Jm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function n4(){}function pU(e,t,r,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var A=Zg(s);a.call(A)}}var s=ok(t,n,e,0,null,!1,!1,"",n4);return e._reactRootContainer=s,e[Ro]=s.current,vd(e.nodeType===8?e.parentNode:e),rc(),s}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var A=Zg(l);o.call(A)}}var l=nb(e,0,!1,null,null,!1,!1,"",n4);return e._reactRootContainer=l,e[Ro]=l.current,vd(e.nodeType===8?e.parentNode:e),rc(function(){Xm(t,l,r,n)}),l}function Zm(e,t,r,n,i){var a=r._reactRootContainer;if(a){var s=a;if(typeof i=="function"){var o=i;i=function(){var l=Zg(s);o.call(l)}}Xm(t,s,e,i)}else s=pU(r,t,e,i,n);return Zg(s)}DE=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=gh(t.pendingLanes);r!==0&&(Cw(t,r|1),aa(t,vn()),!(lr&6)&&(Wu=vn()+500,lA()))}break;case 13:rc(function(){var n=Mo(e,1);if(n!==null){var i=Ri();Fs(n,e,1,i)}}),ib(e,1)}};Sw=function(e){if(e.tag===13){var t=Mo(e,134217728);if(t!==null){var r=Ri();Fs(t,e,134217728,r)}ib(e,134217728)}};PE=function(e){if(e.tag===13){var t=Hl(e),r=Mo(e,t);if(r!==null){var n=Ri();Fs(r,e,t,n)}ib(e,t)}};QE=function(){return Cr};RE=function(e,t){var r=Cr;try{return Cr=e,t()}finally{Cr=r}};y2=function(e,t,r){switch(t){case"input":if(h2(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=Km(n);if(!i)throw Error(ot(90));mE(n),h2(n,i)}}}break;case"textarea":xE(e,r);break;case"select":t=r.value,t!=null&&Fu(e,!!r.multiple,t,!1)}};SE=Zw;EE=rc;var gU={usingClientEntryPoint:!1,Events:[e0,yu,Km,_E,CE,Zw]},th={findFiberByHostInstance:IA,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},mU={bundleType:th.bundleType,version:th.version,rendererPackageName:th.rendererPackageName,rendererConfig:th.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Vo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=NE(e),e===null?null:e.stateNode},findFiberByHostInstance:th.findFiberByHostInstance||dU,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xp.isDisabled&&xp.supportsFiber)try{Qm=xp.inject(mU),ro=xp}catch{}}Fa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gU;Fa.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sb(t))throw Error(ot(200));return hU(e,t,null,r)};Fa.createRoot=function(e,t){if(!sb(e))throw Error(ot(299));var r=!1,n="",i=lk;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=nb(e,1,!1,null,null,r,!1,n,i),e[Ro]=t.current,vd(e.nodeType===8?e.parentNode:e),new ab(t)};Fa.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ot(188)):(e=Object.keys(e).join(","),Error(ot(268,e)));return e=NE(t),e=e===null?null:e.stateNode,e};Fa.flushSync=function(e){return rc(e)};Fa.hydrate=function(e,t,r){if(!Jm(t))throw Error(ot(200));return Zm(null,e,t,!0,r)};Fa.hydrateRoot=function(e,t,r){if(!sb(e))throw Error(ot(405));var n=r!=null&&r.hydratedSources||null,i=!1,a="",s=lk;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=ok(t,null,e,1,r??null,i,!1,a,s),e[Ro]=t.current,vd(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Ym(t)};Fa.render=function(e,t,r){if(!Jm(t))throw Error(ot(200));return Zm(null,e,t,!1,r)};Fa.unmountComponentAtNode=function(e){if(!Jm(e))throw Error(ot(40));return e._reactRootContainer?(rc(function(){Zm(null,null,e,!1,function(){e._reactRootContainer=null,e[Ro]=null})}),!0):!1};Fa.unstable_batchedUpdates=Zw;Fa.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Jm(r))throw Error(ot(200));if(e==null||e._reactInternals===void 0)throw Error(ot(38));return Zm(e,t,r,!1,n)};Fa.version="18.3.1-next-f1338f8080-20240426";function Ak(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ak)}catch(e){console.error(e)}}Ak(),AE.exports=Fa;var ck=AE.exports,uk,i4=ck;uk=i4.createRoot,i4.hydrateRoot;const vU="modulepreload",xU=function(e){return"/"+e},a4={},Yl=function(t,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),o=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));i=Promise.allSettled(r.map(l=>{if(l=xU(l),l in a4)return;a4[l]=!0;const A=l.endsWith(".css"),u=A?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const f=document.createElement("link");if(f.rel=A?"stylesheet":vU,A||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),A)return new Promise((h,d)=>{f.addEventListener("load",h),f.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${l}`)))})}))}function a(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return i.then(s=>{for(const o of s||[])o.status==="rejected"&&a(o.reason);return t().catch(a)})},yU=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Yl(async()=>{const{default:n}=await Promise.resolve().then(()=>nf);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class ob extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class wU extends ob{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class bU extends ob{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class BU extends ob{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Z2;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Z2||(Z2={}));var _U=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(u){try{A(n.next(u))}catch(f){s(f)}}function l(u){try{A(n.throw(u))}catch(f){s(f)}}function A(u){u.done?a(u.value):i(u.value).then(o,l)}A((n=n.apply(e,t||[])).next())})};class CU{constructor(t,{headers:r={},customFetch:n,region:i=Z2.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=yU(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return _U(this,void 0,void 0,function*(){try{const{headers:i,method:a,body:s}=r;let o={},{region:l}=r;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let A;s&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&s instanceof Blob||s instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",A=s):typeof s=="string"?(o["Content-Type"]="text/plain",A=s):typeof FormData<"u"&&s instanceof FormData?A=s:(o["Content-Type"]="application/json",A=JSON.stringify(s)));const u=yield this.fetch(`${this.url}/${t}`,{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),i),body:A}).catch(m=>{throw new wU(m)}),f=u.headers.get("x-relay-error");if(f&&f==="true")throw new bU(u);if(!u.ok)throw new BU(u);let h=((n=u.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),d;return h==="application/json"?d=yield u.json():h==="application/octet-stream"?d=yield u.blob():h==="text/event-stream"?d=u:h==="multipart/form-data"?d=yield u.formData():d=yield u.text(),{data:d,error:null}}catch(i){return{data:null,error:i}}})}}var ta={},lb={},e1={},r0={},t1={},r1={},SU=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},$u=SU();const EU=$u.fetch,fk=$u.fetch.bind($u),hk=$u.Headers,kU=$u.Request,FU=$u.Response,nf=Object.freeze(Object.defineProperty({__proto__:null,Headers:hk,Request:kU,Response:FU,default:fk,fetch:EU},Symbol.toStringTag,{value:"Module"})),NU=YS(nf);var n1={};Object.defineProperty(n1,"__esModule",{value:!0});let TU=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};n1.default=TU;var dk=kr&&kr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r1,"__esModule",{value:!0});const LU=dk(NU),IU=dk(n1);let UU=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=LU.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var s,o,l;let A=null,u=null,f=null,h=a.status,d=a.statusText;if(a.ok){if(this.method!=="HEAD"){const p=await a.text();p===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=p:u=JSON.parse(p))}const g=(s=this.headers.Prefer)===null||s===void 0?void 0:s.match(/count=(exact|planned|estimated)/),x=(o=a.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");g&&x&&x.length>1&&(f=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(A={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,f=null,h=406,d="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const g=await a.text();try{A=JSON.parse(g),Array.isArray(A)&&a.status===404&&(u=[],A=null,h=200,d="OK")}catch{a.status===404&&g===""?(h=204,d="No Content"):A={message:g}}if(A&&this.isMaybeSingle&&(!((l=A==null?void 0:A.details)===null||l===void 0)&&l.includes("0 rows"))&&(A=null,h=200,d="OK"),A&&this.shouldThrowOnError)throw new IU.default(A)}return{error:A,data:u,count:f,status:h,statusText:d}});return this.shouldThrowOnError||(i=i.catch(a=>{var s,o,l;return{error:{message:`${(s=a==null?void 0:a.name)!==null&&s!==void 0?s:"FetchError"}: ${a==null?void 0:a.message}`,details:`${(o=a==null?void 0:a.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=a==null?void 0:a.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(t,r)}returns(){return this}overrideTypes(){return this}};r1.default=UU;var OU=kr&&kr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t1,"__esModule",{value:!0});const jU=OU(r1);let DU=class extends jU.default{select(t){let r=!1;const n=(t??"*").split("").map(i=>/\s/.test(i)&&!r?"":(i==='"'&&(r=!r),i)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:i,referencedTable:a=i}={}){const s=a?`${a}.order`:"order",o=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:i=n}={}){const a=typeof i>"u"?"offset":`${i}.offset`,s=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(a,`${t}`),this.url.searchParams.set(s,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:i=!1,wal:a=!1,format:s="text"}={}){var o;const l=[t?"analyze":null,r?"verbose":null,n?"settings":null,i?"buffers":null,a?"wal":null].filter(Boolean).join("|"),A=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${s}; for="${A}"; options=${l};`,s==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};t1.default=DU;var PU=kr&&kr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r0,"__esModule",{value:!0});const QU=PU(t1);let RU=class extends QU.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:i}={}){let a="";i==="plain"?a="pl":i==="phrase"?a="ph":i==="websearch"&&(a="w");const s=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${a}fts${s}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const i=n?`${n}.or`:"or";return this.url.searchParams.append(i,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};r0.default=RU;var MU=kr&&kr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e1,"__esModule",{value:!0});const rh=MU(r0);let HU=class{constructor(t,{headers:r={},schema:n,fetch:i}){this.url=t,this.headers=r,this.schema=n,this.fetch=i}select(t,{head:r=!1,count:n}={}){const i=r?"HEAD":"GET";let a=!1;const s=(t??"*").split("").map(o=>/\s/.test(o)&&!a?"":(o==='"'&&(a=!a),o)).join("");return this.url.searchParams.set("select",s),n&&(this.headers.Prefer=`count=${n}`),new rh.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const i="POST",a=[];if(this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),n||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(t)){const s=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(s.length>0){const o=[...new Set(s)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new rh.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:i,defaultToNull:a=!0}={}){const s="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),i&&o.push(`count=${i}`),a||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const l=t.reduce((A,u)=>A.concat(Object.keys(u)),[]);if(l.length>0){const A=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",A.join(","))}}return new rh.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),this.headers.Prefer=i.join(","),new rh.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new rh.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};e1.default=HU;var i1={},a1={};Object.defineProperty(a1,"__esModule",{value:!0});a1.version=void 0;a1.version="0.0.0-automated";Object.defineProperty(i1,"__esModule",{value:!0});i1.DEFAULT_HEADERS=void 0;const KU=a1;i1.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${KU.version}`};var pk=kr&&kr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(lb,"__esModule",{value:!0});const GU=pk(e1),VU=pk(r0),WU=i1;let $U=class gk{constructor(t,{headers:r={},schema:n,fetch:i}={}){this.url=t,this.headers=Object.assign(Object.assign({},WU.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=i}from(t){const r=new URL(`${this.url}/${t}`);return new GU.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new gk(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:i=!1,count:a}={}){let s;const o=new URL(`${this.url}/rpc/${t}`);let l;n||i?(s=n?"HEAD":"GET",Object.entries(r).filter(([u,f])=>f!==void 0).map(([u,f])=>[u,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([u,f])=>{o.searchParams.append(u,f)})):(s="POST",l=r);const A=Object.assign({},this.headers);return a&&(A.Prefer=`count=${a}`),new VU.default({method:s,url:o,headers:A,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};lb.default=$U;var af=kr&&kr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ta,"__esModule",{value:!0});ta.PostgrestError=ta.PostgrestBuilder=ta.PostgrestTransformBuilder=ta.PostgrestFilterBuilder=ta.PostgrestQueryBuilder=ta.PostgrestClient=void 0;const mk=af(lb);ta.PostgrestClient=mk.default;const vk=af(e1);ta.PostgrestQueryBuilder=vk.default;const xk=af(r0);ta.PostgrestFilterBuilder=xk.default;const yk=af(t1);ta.PostgrestTransformBuilder=yk.default;const wk=af(r1);ta.PostgrestBuilder=wk.default;const bk=af(n1);ta.PostgrestError=bk.default;var qU=ta.default={PostgrestClient:mk.default,PostgrestQueryBuilder:vk.default,PostgrestFilterBuilder:xk.default,PostgrestTransformBuilder:yk.default,PostgrestBuilder:wk.default,PostgrestError:bk.default};const{PostgrestClient:zU,PostgrestQueryBuilder:Xle,PostgrestFilterBuilder:Yle,PostgrestTransformBuilder:Jle,PostgrestBuilder:Zle,PostgrestError:eAe}=qU;function XU(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const YU=XU(),JU="2.11.15",ZU=`realtime-js/${JU}`,eO="1.0.0",Bk=1e4,tO=1e3;var Qh;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Qh||(Qh={}));var mi;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(mi||(mi={}));var _s;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(_s||(_s={}));var ey;(function(e){e.websocket="websocket"})(ey||(ey={}));var NA;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(NA||(NA={}));class rO{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const i=r.getUint8(1),a=r.getUint8(2);let s=this.HEADER_LENGTH+2;const o=n.decode(t.slice(s,s+i));s=s+i;const l=n.decode(t.slice(s,s+a));s=s+a;const A=JSON.parse(n.decode(t.slice(s,t.byteLength)));return{ref:null,topic:o,event:l,payload:A}}}class _k{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Or;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Or||(Or={}));const s4=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((a,s)=>(a[s]=nO(s,e,t,i),a),{})},nO=(e,t,r,n)=>{const i=t.find(o=>o.name===e),a=i==null?void 0:i.type,s=r[e];return a&&!n.includes(a)?Ck(a,s):ty(s)},Ck=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return oO(t,r)}switch(e){case Or.bool:return iO(t);case Or.float4:case Or.float8:case Or.int2:case Or.int4:case Or.int8:case Or.numeric:case Or.oid:return aO(t);case Or.json:case Or.jsonb:return sO(t);case Or.timestamp:return lO(t);case Or.abstime:case Or.date:case Or.daterange:case Or.int4range:case Or.int8range:case Or.money:case Or.reltime:case Or.text:case Or.time:case Or.timestamptz:case Or.timetz:case Or.tsrange:case Or.tstzrange:return ty(t);default:return ty(t)}},ty=e=>e,iO=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},aO=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},sO=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},oO=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let a;const s=e.slice(1,r);try{a=JSON.parse("["+s+"]")}catch{a=s?s.split(","):[]}return a.map(o=>Ck(t,o))}return e},lO=e=>typeof e=="string"?e.replace(" ","T"):e,Sk=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Xv{constructor(t,r,n={},i=Bk){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var o4;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(o4||(o4={}));class Rh{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:a,onLeave:s,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Rh.syncState(this.state,i,a,s),this.pendingDiffs.forEach(l=>{this.state=Rh.syncDiff(this.state,l,a,s)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:a,onLeave:s,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Rh.syncDiff(this.state,i,a,s),o())}),this.onJoin((i,a,s)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:a,newPresences:s})}),this.onLeave((i,a,s)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:a,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const a=this.cloneDeep(t),s=this.transformState(r),o={},l={};return this.map(a,(A,u)=>{s[A]||(l[A]=u)}),this.map(s,(A,u)=>{const f=a[A];if(f){const h=u.map(x=>x.presence_ref),d=f.map(x=>x.presence_ref),m=u.filter(x=>d.indexOf(x.presence_ref)<0),g=f.filter(x=>h.indexOf(x.presence_ref)<0);m.length>0&&(o[A]=m),g.length>0&&(l[A]=g)}else o[A]=u}),this.syncDiff(a,{joins:o,leaves:l},n,i)}static syncDiff(t,r,n,i){const{joins:a,leaves:s}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(a,(o,l)=>{var A;const u=(A=t[o])!==null&&A!==void 0?A:[];if(t[o]=this.cloneDeep(l),u.length>0){const f=t[o].map(d=>d.presence_ref),h=u.filter(d=>f.indexOf(d.presence_ref)<0);t[o].unshift(...h)}n(o,u,l)}),this.map(s,(o,l)=>{let A=t[o];if(!A)return;const u=l.map(f=>f.presence_ref);A=A.filter(f=>u.indexOf(f.presence_ref)<0),t[o]=A,i(o,A,l),A.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var l4;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(l4||(l4={}));var A4;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(A4||(A4={}));var Eo;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Eo||(Eo={}));class Ab{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=mi.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Xv(this,_s.join,this.params,this.timeout),this.rejoinTimer=new _k(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=mi.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=mi.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=mi.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=mi.errored,this.rejoinTimer.scheduleTimeout())}),this._on(_s.reply,{},(i,a)=>{this._trigger(this._replyEventName(a),i)}),this.presence=new Rh(this),this.broadcastEndpointURL=Sk(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,i;if(this.socket.isConnected()||this.socket.connect(),this.state==mi.closed){const{config:{broadcast:a,presence:s,private:o}}=this.params;this._onError(u=>t==null?void 0:t(Eo.CHANNEL_ERROR,u)),this._onClose(()=>t==null?void 0:t(Eo.CLOSED));const l={},A={broadcast:a,presence:s,postgres_changes:(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&i!==void 0?i:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:A},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var f;if(this.socket.setAuth(),u===void 0){t==null||t(Eo.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,d=(f=h==null?void 0:h.length)!==null&&f!==void 0?f:0,m=[];for(let g=0;g<d;g++){const x=h[g],{filter:{event:p,schema:v,table:y,filter:w}}=x,B=u&&u[g];if(B&&B.event===p&&B.schema===v&&B.table===y&&B.filter===w)m.push(Object.assign(Object.assign({},x),{id:B.id}));else{this.unsubscribe(),this.state=mi.errored,t==null||t(Eo.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,t&&t(Eo.SUBSCRIBED);return}}).receive("error",u=>{this.state=mi.errored,t==null||t(Eo.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Eo.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){const{event:a,payload:s}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:s,private:this.private}]})};try{const A=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=A.body)===null||i===void 0?void 0:i.cancel()),A.ok?"ok":"error"}catch(A){return A.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var s,o,l;const A=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(s=this.params)===null||s===void 0?void 0:s.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&a("ok"),A.receive("ok",()=>a("ok")),A.receive("error",()=>a("error")),A.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=mi.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(_s.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new Xv(this,_s.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,r,n){const i=new AbortController,a=setTimeout(()=>i.abort(),n),s=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(a),s}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Xv(this,t,r,n);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,a;const s=t.toLocaleLowerCase(),{close:o,error:l,leave:A,join:u}=_s;if(n&&[o,l,A,u].indexOf(s)>=0&&n!==this._joinRef())return;let h=this._onMessage(s,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(d=>{var m,g,x;return((m=d.filter)===null||m===void 0?void 0:m.event)==="*"||((x=(g=d.filter)===null||g===void 0?void 0:g.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===s}).map(d=>d.callback(h,n)):(a=this.bindings[s])===null||a===void 0||a.filter(d=>{var m,g,x,p,v,y;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in d){const w=d.id,B=(m=d.filter)===null||m===void 0?void 0:m.event;return w&&((g=r.ids)===null||g===void 0?void 0:g.includes(w))&&(B==="*"||(B==null?void 0:B.toLocaleLowerCase())===((x=r.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const w=(v=(p=d==null?void 0:d.filter)===null||p===void 0?void 0:p.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return w==="*"||w===((y=r==null?void 0:r.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return d.type.toLocaleLowerCase()===s}).map(d=>{if(typeof h=="object"&&"ids"in h){const m=h.data,{schema:g,table:x,commit_timestamp:p,type:v,errors:y}=m;h=Object.assign(Object.assign({},{schema:g,table:x,commit_timestamp:p,eventType:v,new:{},old:{},errors:y}),this._getPayloadRecords(m))}d.callback(h,n)})}_isClosed(){return this.state===mi.closed}_isJoined(){return this.state===mi.joined}_isJoining(){return this.state===mi.joining}_isLeaving(){return this.state===mi.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),a={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(a):this.bindings[i]=[a],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(i=>{var a;return!(((a=i.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&Ab.isEqual(i.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(_s.close,{},t)}_onError(t){this._on(_s.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=mi.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=s4(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=s4(t.columns,t.old_record)),r}}const c4=()=>{},AO=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class cO{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Bk,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=c4,this.ref=0,this.logger=c4,this.conn=null,this.sendBuffer=[],this.serializer=new rO,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=a=>{let s;return a?s=a:typeof fetch>"u"?s=(...o)=>Yl(async()=>{const{default:l}=await Promise.resolve().then(()=>nf);return{default:l}},void 0).then(({default:l})=>l(...o)):s=fetch,(...o)=>s(...o)},this.endPoint=`${t}/${ey.websocket}`,this.httpEndpoint=Sk(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const i=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:a=>[1e3,2e3,5e3,1e4][a-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(a,s)=>s(JSON.stringify(a)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new _k(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=YU),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:eO}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Qh.connecting:return NA.Connecting;case Qh.open:return NA.Open;case Qh.closing:return NA.Closing;default:return NA.Closed}}isConnected(){return this.connectionState()===NA.Open}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(a=>a.topic===n);if(i)return i;{const a=new Ab(`realtime:${t}`,r,this);return this.channels.push(a),a}}push(t){const{topic:r,event:n,payload:i,ref:a}=t,s=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${a})`,i),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:ZU};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(_s.access_token,{access_token:r})}))}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close(tO,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:i,payload:a,ref:s}=r;n==="phoenix"&&i==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),s&&s===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${a.status||""} ${n} ${i} ${s&&"("+s+")"||""}`,a),Array.from(this.channels).filter(o=>o._isMember(n)).forEach(o=>o._trigger(i,a,s)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(t=>t())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",`${t}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(_s.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([AO],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class cb extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Vn(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class uO extends cb{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class ry extends cb{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var fO=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(u){try{A(n.next(u))}catch(f){s(f)}}function l(u){try{A(n.throw(u))}catch(f){s(f)}}function A(u){u.done?a(u.value):i(u.value).then(o,l)}A((n=n.apply(e,t||[])).next())})};const Ek=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Yl(async()=>{const{default:n}=await Promise.resolve().then(()=>nf);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},hO=()=>fO(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Yl(()=>Promise.resolve().then(()=>nf),void 0)).Response:Response}),ny=e=>{if(Array.isArray(e))return e.map(r=>ny(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[i]=ny(n)}),t};var fc=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(u){try{A(n.next(u))}catch(f){s(f)}}function l(u){try{A(n.throw(u))}catch(f){s(f)}}function A(u){u.done?a(u.value):i(u.value).then(o,l)}A((n=n.apply(e,t||[])).next())})};const Yv=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),dO=(e,t,r)=>fc(void 0,void 0,void 0,function*(){const n=yield hO();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(i=>{t(new uO(Yv(i),e.status||500))}).catch(i=>{t(new ry(Yv(i),i))}):t(new ry(Yv(e),e))}),pO=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(i.body=JSON.stringify(n)),Object.assign(Object.assign({},i),r))};function n0(e,t,r,n,i,a){return fc(this,void 0,void 0,function*(){return new Promise((s,o)=>{e(r,pO(t,n,i,a)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>s(l)).catch(l=>dO(l,o,n))})})}function em(e,t,r,n){return fc(this,void 0,void 0,function*(){return n0(e,"GET",t,r,n)})}function yl(e,t,r,n,i){return fc(this,void 0,void 0,function*(){return n0(e,"POST",t,n,i,r)})}function gO(e,t,r,n,i){return fc(this,void 0,void 0,function*(){return n0(e,"PUT",t,n,i,r)})}function mO(e,t,r,n){return fc(this,void 0,void 0,function*(){return n0(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function kk(e,t,r,n,i){return fc(this,void 0,void 0,function*(){return n0(e,"DELETE",t,n,i,r)})}var Yi=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(u){try{A(n.next(u))}catch(f){s(f)}}function l(u){try{A(n.throw(u))}catch(f){s(f)}}function A(u){u.done?a(u.value):i(u.value).then(o,l)}A((n=n.apply(e,t||[])).next())})};const vO={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},u4={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class xO{constructor(t,r={},n,i){this.url=t,this.headers=r,this.bucketId=n,this.fetch=Ek(i)}uploadOrUpdate(t,r,n,i){return Yi(this,void 0,void 0,function*(){try{let a;const s=Object.assign(Object.assign({},u4),i);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(s.upsert)});const l=s.metadata;typeof Blob<"u"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",s.cacheControl),l&&a.append("metadata",this.encodeMetadata(l)),a.append("",n)):typeof FormData<"u"&&n instanceof FormData?(a=n,a.append("cacheControl",s.cacheControl),l&&a.append("metadata",this.encodeMetadata(l))):(a=n,o["cache-control"]=`max-age=${s.cacheControl}`,o["content-type"]=s.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(o=Object.assign(Object.assign({},o),i.headers));const A=this._removeEmptyFolders(r),u=this._getFinalPath(A),f=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:t,body:a,headers:o},s!=null&&s.duplex?{duplex:s.duplex}:{})),h=yield f.json();return f.ok?{data:{path:A,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(a){if(Vn(a))return{data:null,error:a};throw a}})}upload(t,r,n){return Yi(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,i){return Yi(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(t),s=this._getFinalPath(a),o=new URL(this.url+`/object/upload/sign/${s}`);o.searchParams.set("token",r);try{let l;const A=Object.assign({upsert:u4.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(A.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",A.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",A.cacheControl)):(l=n,u["cache-control"]=`max-age=${A.cacheControl}`,u["content-type"]=A.contentType);const f=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:u}),h=yield f.json();return f.ok?{data:{path:a,fullPath:h.Key},error:null}:{data:null,error:h}}catch(l){if(Vn(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return Yi(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const a=yield yl(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),s=new URL(this.url+a.url),o=s.searchParams.get("token");if(!o)throw new cb("No token returned by API");return{data:{signedUrl:s.toString(),path:t,token:o},error:null}}catch(n){if(Vn(n))return{data:null,error:n};throw n}})}update(t,r,n){return Yi(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Yi(this,void 0,void 0,function*(){try{return{data:yield yl(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(Vn(i))return{data:null,error:i};throw i}})}copy(t,r,n){return Yi(this,void 0,void 0,function*(){try{return{data:{path:(yield yl(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(Vn(i))return{data:null,error:i};throw i}})}createSignedUrl(t,r,n){return Yi(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),a=yield yl(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${s}`)},{data:a,error:null}}catch(i){if(Vn(i))return{data:null,error:i};throw i}})}createSignedUrls(t,r,n){return Yi(this,void 0,void 0,function*(){try{const i=yield yl(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${a}`):null})),error:null}}catch(i){if(Vn(i))return{data:null,error:i};throw i}})}download(t,r){return Yi(this,void 0,void 0,function*(){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),s=a?`?${a}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield em(this.fetch,`${this.url}/${i}/${o}${s}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Vn(o))return{data:null,error:o};throw o}})}info(t){return Yi(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield em(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:ny(n),error:null}}catch(n){if(Vn(n))return{data:null,error:n};throw n}})}exists(t){return Yi(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield mO(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Vn(n)&&n instanceof ry){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),i=[],a=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";a!==""&&i.push(a);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&i.push(l);let A=i.join("&");return A!==""&&(A=`?${A}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${A}`)}}}remove(t){return Yi(this,void 0,void 0,function*(){try{return{data:yield kk(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Vn(r))return{data:null,error:r};throw r}})}list(t,r,n){return Yi(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},vO),r),{prefix:t||""});return{data:yield yl(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(Vn(i))return{data:null,error:i};throw i}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const yO="2.7.1",wO={"X-Client-Info":`storage-js/${yO}`};var Kc=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(u){try{A(n.next(u))}catch(f){s(f)}}function l(u){try{A(n.throw(u))}catch(f){s(f)}}function A(u){u.done?a(u.value):i(u.value).then(o,l)}A((n=n.apply(e,t||[])).next())})};class bO{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},wO),r),this.fetch=Ek(n)}listBuckets(){return Kc(this,void 0,void 0,function*(){try{return{data:yield em(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Vn(t))return{data:null,error:t};throw t}})}getBucket(t){return Kc(this,void 0,void 0,function*(){try{return{data:yield em(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Vn(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Kc(this,void 0,void 0,function*(){try{return{data:yield yl(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Vn(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Kc(this,void 0,void 0,function*(){try{return{data:yield gO(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Vn(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Kc(this,void 0,void 0,function*(){try{return{data:yield yl(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Vn(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Kc(this,void 0,void 0,function*(){try{return{data:yield kk(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Vn(r))return{data:null,error:r};throw r}})}}class BO extends bO{constructor(t,r={},n){super(t,r,n)}from(t){return new xO(this.url,this.headers,t,this.fetch)}}const _O="2.50.2";let vh="";typeof Deno<"u"?vh="deno":typeof document<"u"?vh="web":typeof navigator<"u"&&navigator.product==="ReactNative"?vh="react-native":vh="node";const CO={"X-Client-Info":`supabase-js-${vh}/${_O}`},SO={headers:CO},EO={schema:"public"},kO={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},FO={};var NO=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(u){try{A(n.next(u))}catch(f){s(f)}}function l(u){try{A(n.throw(u))}catch(f){s(f)}}function A(u){u.done?a(u.value):i(u.value).then(o,l)}A((n=n.apply(e,t||[])).next())})};const TO=e=>{let t;return e?t=e:typeof fetch>"u"?t=fk:t=fetch,(...r)=>t(...r)},LO=()=>typeof Headers>"u"?hk:Headers,IO=(e,t,r)=>{const n=TO(r),i=LO();return(a,s)=>NO(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let A=new i(s==null?void 0:s.headers);return A.has("apikey")||A.set("apikey",e),A.has("Authorization")||A.set("Authorization",`Bearer ${l}`),n(a,Object.assign(Object.assign({},s),{headers:A}))})};var UO=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(u){try{A(n.next(u))}catch(f){s(f)}}function l(u){try{A(n.throw(u))}catch(f){s(f)}}function A(u){u.done?a(u.value):i(u.value).then(o,l)}A((n=n.apply(e,t||[])).next())})};function OO(e){return e.endsWith("/")?e:e+"/"}function jO(e,t){var r,n;const{db:i,auth:a,realtime:s,global:o}=e,{db:l,auth:A,realtime:u,global:f}=t,h={db:Object.assign(Object.assign({},l),i),auth:Object.assign(Object.assign({},A),a),realtime:Object.assign(Object.assign({},u),s),global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>UO(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}const Fk="2.70.0",lu=30*1e3,iy=3,Jv=iy*lu,DO="http://localhost:9999",PO="supabase.auth.token",QO={"X-Client-Info":`gotrue-js/${Fk}`},ay="X-Supabase-Api-Version",Nk={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},RO=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,MO=6e5;class ub extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Wt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class HO extends ub{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function KO(e){return Wt(e)&&e.name==="AuthApiError"}class Tk extends ub{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class AA extends ub{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class dl extends AA{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function GO(e){return Wt(e)&&e.name==="AuthSessionMissingError"}class yp extends AA{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class wp extends AA{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class bp extends AA{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function VO(e){return Wt(e)&&e.name==="AuthImplicitGrantRedirectError"}class f4 extends AA{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class sy extends AA{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Zv(e){return Wt(e)&&e.name==="AuthRetryableFetchError"}class h4 extends AA{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Mh extends AA{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const tm="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),d4=` 	
\r=`.split(""),WO=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<d4.length;t+=1)e[d4[t].charCodeAt(0)]=-2;for(let t=0;t<tm.length;t+=1)e[tm[t].charCodeAt(0)]=t;return e})();function p4(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(tm[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(tm[n]),t.queuedBits-=6}}function Lk(e,t,r){const n=WO[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function g4(e){const t=[],r=s=>{t.push(String.fromCodePoint(s))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},a=s=>{zO(s,n,r)};for(let s=0;s<e.length;s+=1)Lk(e.charCodeAt(s),i,a);return t.join("")}function $O(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function qO(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}$O(n,t)}}function zO(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function XO(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)Lk(e.charCodeAt(i),r,n);return new Uint8Array(t)}function YO(e){const t=[];return qO(e,r=>t.push(r)),new Uint8Array(t)}function JO(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>p4(i,r,n)),p4(null,r,n),t.join("")}function ZO(e){return Math.round(Date.now()/1e3)+e}function ej(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const xs=()=>typeof window<"u"&&typeof document<"u",BA={tested:!1,writable:!1},Hh=()=>{if(!xs())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(BA.tested)return BA.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),BA.tested=!0,BA.writable=!0}catch{BA.tested=!0,BA.writable=!1}return BA.writable};function tj(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,a)=>{t[a]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const Ik=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Yl(async()=>{const{default:n}=await Promise.resolve().then(()=>nf);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},rj=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Uk=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Bp=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},_p=async(e,t)=>{await e.removeItem(t)};class s1{constructor(){this.promise=new s1.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}s1.promiseConstructor=Promise;function ex(e){const t=e.split(".");if(t.length!==3)throw new Mh("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!RO.test(t[n]))throw new Mh("JWT not in base64url format");return{header:JSON.parse(g4(t[0])),payload:JSON.parse(g4(t[1])),signature:XO(t[2]),raw:{header:t[0],payload:t[1]}}}async function nj(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function ij(e,t){return new Promise((n,i)=>{(async()=>{for(let a=0;a<1/0;a++)try{const s=await e(a);if(!t(a,null,s)){n(s);return}}catch(s){if(!t(a,s)){i(s);return}}})()})}function aj(e){return("0"+e.toString(16)).substr(-2)}function sj(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let a=0;a<56;a++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,aj).join("")}async function oj(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(a=>String.fromCharCode(a)).join("")}async function lj(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await oj(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Gc(e,t,r=!1){const n=sj();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await Uk(e,`${t}-code-verifier`,i);const a=await lj(n);return[a,n===a?"plain":"s256"]}const Aj=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function cj(e){const t=e.headers.get(ay);if(!t||!t.match(Aj))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function uj(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function fj(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const hj=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Vc(e){if(!hj.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var dj=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};const EA=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),pj=[502,503,504];async function m4(e){var t;if(!rj(e))throw new sy(EA(e),0);if(pj.includes(e.status))throw new sy(EA(e),e.status);let r;try{r=await e.json()}catch(a){throw new Tk(EA(a),a)}let n;const i=cj(e);if(i&&i.getTime()>=Nk["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new h4(EA(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new dl}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,s)=>a&&typeof s=="string",!0))throw new h4(EA(r),e.status,r.weak_password.reasons);throw new HO(EA(r),e.status||500,n)}const gj=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function Zt(e,t,r,n){var i;const a=Object.assign({},n==null?void 0:n.headers);a[ay]||(a[ay]=Nk["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const s=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(s.redirect_to=n.redirectTo);const o=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",l=await mj(e,t,r+o,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function mj(e,t,r,n,i,a){const s=gj(t,n,i,a);let o;try{o=await e(r,Object.assign({},s))}catch(l){throw console.error(l),new sy(EA(l),0)}if(o.ok||await m4(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await m4(l)}}function Co(e){var t;let r=null;wj(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=ZO(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function v4(e){const t=Co(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function _l(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function vj(e){return{data:e,error:null}}function xj(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:a}=e,s=dj(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:a},l=Object.assign({},s);return{data:{properties:o,user:l},error:null}}function yj(e){return e}function wj(e){return e.access_token&&e.refresh_token&&e.expires_in}const tx=["global","local","others"];var bj=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};class Bj{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=Ik(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=tx[0]){if(tx.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${tx.join(", ")}`);try{return await Zt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Wt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Zt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:_l})}catch(n){if(Wt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=bj(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await Zt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:xj,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Wt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Zt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:_l})}catch(r){if(Wt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,a,s,o,l;try{const A={nextPage:null,lastPage:0,total:0},u=await Zt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:yj});if(u.error)throw u.error;const f=await u.json(),h=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,d=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return d.length>0&&(d.forEach(m=>{const g=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(m.split(";")[1].split("=")[1]);A[`${x}Page`]=g}),A.total=parseInt(h)),{data:Object.assign(Object.assign({},f),A),error:null}}catch(A){if(Wt(A))return{data:{users:[]},error:A};throw A}}async getUserById(t){Vc(t);try{return await Zt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:_l})}catch(r){if(Wt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Vc(t);try{return await Zt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:_l})}catch(n){if(Wt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Vc(t);try{return await Zt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:_l})}catch(n){if(Wt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Vc(t.userId);try{const{data:r,error:n}=await Zt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(Wt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Vc(t.userId),Vc(t.id);try{return{data:await Zt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Wt(r))return{data:null,error:r};throw r}}}const _j={getItem:e=>Hh()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Hh()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Hh()&&globalThis.localStorage.removeItem(e)}};function x4(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function Cj(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Wc={debug:!!(globalThis&&Hh()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Ok extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Sj extends Ok{}async function Ej(e,t,r){Wc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Wc.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){Wc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{Wc.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw Wc.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Sj(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Wc.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}Cj();const kj={url:DO,storageKey:PO,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:QO,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function y4(e,t,r){return await r()}class Ed{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ed.nextInstanceID,Ed.nextInstanceID+=1,this.instanceID>0&&xs()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},kj),t);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Bj({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Ik(i.fetch),this.lock=i.lock||y4,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:xs()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=Ej:this.lock=y4,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:Hh()?this.storage=_j:(this.memoryStorage={},this.storage=x4(this.memoryStorage)):(this.memoryStorage={},this.storage=x4(this.memoryStorage)),xs()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Fk}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=tj(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),xs()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:a}=await this._getSessionFromURL(r,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),VO(a)){const l=(t=a.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:s,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",s,"redirect type",o),await this._saveSession(s),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Wt(r)?{error:r}:{error:new Tk("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const a=await Zt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:Co}),{data:s,error:o}=a;if(o||!s)return{data:{user:null,session:null},error:o};const l=s.session,A=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:A,session:l},error:null}}catch(a){if(Wt(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(t){var r,n,i;try{let a;if("email"in t){const{email:u,password:f,options:h}=t;let d=null,m=null;this.flowType==="pkce"&&([d,m]=await Gc(this.storage,this.storageKey)),a=await Zt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:f,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:d,code_challenge_method:m},xform:Co})}else if("phone"in t){const{phone:u,password:f,options:h}=t;a=await Zt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(i=h==null?void 0:h.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Co})}else throw new wp("You must provide either an email or phone number and a password");const{data:s,error:o}=a;if(o||!s)return{data:{user:null,session:null},error:o};const l=s.session,A=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:A,session:l},error:null}}catch(a){if(Wt(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(t){try{let r;if("email"in t){const{email:a,password:s,options:o}=t;r=await Zt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:v4})}else if("phone"in t){const{phone:a,password:s,options:o}=t;r=await Zt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:v4})}else throw new wp("You must provide either an email or phone number and a password");const{data:n,error:i}=r;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new yp}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(Wt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,i,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,i,a,s,o,l,A,u,f,h,d;let m,g;if("message"in t)m=t.message,g=t.signature;else{const{chain:x,wallet:p,statement:v,options:y}=t;let w;if(xs())if(typeof p=="object")w=p;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))w=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof p!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=p}const B=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in w&&w.signIn){const E=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y==null?void 0:y.signInWithSolana),{version:"1",domain:B.host,uri:B.href}),v?{statement:v}:null));let _;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")_=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)_=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in _&&"signature"in _&&(typeof _.signedMessage=="string"||_.signedMessage instanceof Uint8Array)&&_.signature instanceof Uint8Array)m=typeof _.signedMessage=="string"?_.signedMessage:new TextDecoder().decode(_.signedMessage),g=_.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${B.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${B.href}`,`Issued At: ${(i=(n=y==null?void 0:y.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((a=y==null?void 0:y.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((s=y==null?void 0:y.signInWithSolana)===null||s===void 0)&&s.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((o=y==null?void 0:y.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((l=y==null?void 0:y.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((A=y==null?void 0:y.signInWithSolana)===null||A===void 0)&&A.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((f=(u=y==null?void 0:y.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...y.signInWithSolana.resources.map(_=>`- ${_}`)]:[]].join(`
`);const E=await w.signMessage(new TextEncoder().encode(m),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=E}}try{const{data:x,error:p}=await Zt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:JO(g)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(d=t.options)===null||d===void 0?void 0:d.captchaToken}}:null),xform:Co});if(p)throw p;return!x||!x.session||!x.user?{data:{user:null,session:null},error:new yp}:(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),{data:Object.assign({},x),error:p})}catch(x){if(Wt(x))return{data:{user:null,session:null},error:x};throw x}}async _exchangeCodeForSession(t){const r=await Bp(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:a,error:s}=await Zt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Co});if(await _p(this.storage,`${this.storageKey}-code-verifier`),s)throw s;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new yp}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:i??null}),error:s})}catch(a){if(Wt(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:a,nonce:s}=t,o=await Zt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:a,nonce:s,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Co}),{data:l,error:A}=o;return A?{data:{user:null,session:null},error:A}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new yp}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:A})}catch(r){if(Wt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,i,a,s;try{if("email"in t){const{email:o,options:l}=t;let A=null,u=null;this.flowType==="pkce"&&([A,u]=await Gc(this.storage,this.storageKey));const{error:f}=await Zt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:A,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:o,options:l}=t,{data:A,error:u}=await Zt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(a=l==null?void 0:l.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(s=l==null?void 0:l.channel)!==null&&s!==void 0?s:"sms"}});return{data:{user:null,session:null,messageId:A==null?void 0:A.message_id},error:u}}throw new wp("You must provide either an email or phone number.")}catch(o){if(Wt(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let i,a;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,a=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:s,error:o}=await Zt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:i,xform:Co});if(o)throw o;if(!s)throw new Error("An error occurred on token verification.");const l=s.session,A=s.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:A,session:l},error:null}}catch(i){if(Wt(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(t){var r,n,i;try{let a=null,s=null;return this.flowType==="pkce"&&([a,s]=await Gc(this.storage,this.storageKey)),await Zt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:s}),headers:this.headers,xform:vj})}catch(a){if(Wt(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new dl;const{error:i}=await Zt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:i}})}catch(t){if(Wt(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:a}=t,{error:s}=await Zt(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:s}}else if("phone"in t){const{phone:n,type:i,options:a}=t,{data:s,error:o}=await Zt(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:s==null?void 0:s.message_id},error:o}}throw new wp("You must provide either an email or phone number and a type")}catch(r){if(Wt(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Bp(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Jv:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let s=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,A,u)=>(!s&&A==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),s=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,A,u))})}return{data:{session:t},error:null}}const{session:i,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{session:null},error:a}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Zt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:_l}):await this._useSession(async r=>{var n,i,a;const{data:s,error:o}=r;if(o)throw o;return!(!((n=s.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new dl}:await Zt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(i=s.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0,xform:_l})})}catch(r){if(Wt(r))return GO(r)&&(await this._removeSession(),await _p(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:a}=n;if(a)throw a;if(!i.session)throw new dl;const s=i.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await Gc(this.storage,this.storageKey));const{data:A,error:u}=await Zt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:s.access_token,xform:_l});if(u)throw u;return s.user=A.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(n){if(Wt(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new dl;const r=Date.now()/1e3;let n=r,i=!0,a=null;const{payload:s}=ex(t.access_token);if(s.exp&&(n=s.exp,i=n<=r),i){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};a=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;a={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(r){if(Wt(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:s,error:o}=r;if(o)throw o;t=(n=s.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new dl;const{session:i,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{user:null,session:null},error:a}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Wt(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!xs())throw new bp("No browser detected.");if(t.error||t.error_description||t.error_code)throw new bp(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new f4("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new bp("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new f4("No code detected.");const{data:v,error:y}=await this._exchangeCodeForSession(t.code);if(y)throw y;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:a,refresh_token:s,expires_in:o,expires_at:l,token_type:A}=t;if(!a||!o||!s||!A)throw new bp("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(o);let h=u+f;l&&(h=parseInt(l));const d=h-u;d*1e3<=lu&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${f}s`);const m=h-f;u-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,h,u):u-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,h,u);const{data:g,error:x}=await this._getUser(a);if(x)throw x;const p={provider_token:n,provider_refresh_token:i,access_token:a,expires_in:f,expires_at:h,refresh_token:s,token_type:A,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:p,redirectType:t.type},error:null}}catch(n){if(Wt(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Bp(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:a}=r;if(a)return{error:a};const s=(n=i.session)===null||n===void 0?void 0:n.access_token;if(s){const{error:o}=await this.admin.signOut(s,t);if(o&&!(KO(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await _p(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=ej(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:a},error:s}=r;if(s)throw s;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await Gc(this.storage,this.storageKey,!0));try{return await Zt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(Wt(a))return{data:null,error:a};throw a}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Wt(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:i}=await this._useSession(async a=>{var s,o,l,A,u;const{data:f,error:h}=a;if(h)throw h;const d=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(s=t.options)===null||s===void 0?void 0:s.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Zt(this.fetch,"GET",d,{headers:this.headers,jwt:(u=(A=f.session)===null||A===void 0?void 0:A.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return xs()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Wt(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:a,error:s}=r;if(s)throw s;return await Zt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(Wt(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await ij(async i=>(i>0&&await nj(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await Zt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Co})),(i,a)=>{const s=200*Math.pow(2,i);return a&&Zv(a)&&Date.now()+s-n<lu})}catch(n){if(this._debug(r,"error",n),Wt(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),xs()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await Bp(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const i=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Jv;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${Jv}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:a}=await this._callRefreshToken(n.refresh_token);a&&(console.error(a),Zv(a)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new dl;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new s1;const{data:a,error:s}=await this._refreshAccessToken(t);if(s)throw s;if(!a.session)throw new dl;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const o={session:a.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(a){if(this._debug(i,"error",a),Wt(a)){const s={session:null,error:a};return Zv(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(s),s}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const a=[],s=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){a.push(l)}});if(await Promise.all(s),a.length>0){for(let o=0;o<a.length;o+=1)console.error(a[o]);throw a[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Uk(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await _p(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&xs()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),lu);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/lu);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${lu}ms, refresh threshold is ${iy} ticks`),i<=iy&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Ok)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!xs()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,s]=await Gc(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(s)}`});i.push(o.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);i.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:a}=r;return a?{data:null,error:a}:await Zt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Wt(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:a,error:s}=r;if(s)return{data:null,error:s};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:A}=await Zt(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return A?{data:null,error:A}:(t.factorType==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(Wt(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:a}=r;if(a)return{data:null,error:a};const{data:s,error:o}=await Zt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:o})})}catch(r){if(Wt(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:a}=r;return a?{data:null,error:a}:await Zt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Wt(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],i=n.filter(s=>s.factor_type==="totp"&&s.status==="verified"),a=n.filter(s=>s.factor_type==="phone"&&s.status==="verified");return{data:{all:n,totp:i,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:i},error:a}=t;if(a)return{data:null,error:a};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=ex(i.access_token);let o=null;s.aal&&(o=s.aal);let l=o;((n=(r=i.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=s.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(s=>s.kid===t);if(n||(n=this.jwks.keys.find(s=>s.kid===t),n&&this.jwks_cached_at+MO>Date.now()))return n;const{data:i,error:a}=await Zt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;if(!i.keys||i.keys.length===0)throw new Mh("JWKS is empty");if(this.jwks=i,this.jwks_cached_at=Date.now(),n=i.keys.find(s=>s.kid===t),!n)throw new Mh("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:d,error:m}=await this.getSession();if(m||!d.session)return{data:null,error:m};n=d.session.access_token}const{header:i,payload:a,signature:s,raw:{header:o,payload:l}}=ex(n);if(uj(a.exp),!i.kid||i.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:d}=await this.getUser(n);if(d)throw d;return{data:{claims:a,header:i,signature:s},error:null}}const A=fj(i.alg),u=await this.fetchJwk(i.kid,r),f=await crypto.subtle.importKey("jwk",u,A,!0,["verify"]);if(!await crypto.subtle.verify(A,f,s,YO(`${o}.${l}`)))throw new Mh("Invalid JWT signature");return{data:{claims:a,header:i,signature:s},error:null}}catch(n){if(Wt(n))return{data:null,error:n};throw n}}}Ed.nextInstanceID=0;const Fj=Ed;class Nj extends Fj{constructor(t){super(t)}}var Tj=function(e,t,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(u){try{A(n.next(u))}catch(f){s(f)}}function l(u){try{A(n.throw(u))}catch(f){s(f)}}function A(u){u.done?a(u.value):i(u.value).then(o,l)}A((n=n.apply(e,t||[])).next())})};class Lj{constructor(t,r,n){var i,a,s;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=OO(t),l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const A=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:EO,realtime:FO,auth:Object.assign(Object.assign({},kO),{storageKey:A}),global:SO},f=jO(n??{},u);this.storageKey=(i=f.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(a=f.global.headers)!==null&&a!==void 0?a:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(h,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((s=f.auth)!==null&&s!==void 0?s:{},this.headers,f.global.fetch),this.fetch=IO(r,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new zU(new URL("rest/v1",l).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),f.accessToken||this._listenForAuthEvents()}get functions(){return new CU(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new BO(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return Tj(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,storageKey:a,flowType:s,lock:o,debug:l},A,u){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Nj({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),A),storageKey:a,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,flowType:s,lock:o,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new cO(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Ij=(e,t,r)=>new Lj(e,t,r),Uj="https://wiudrzdkbpyziaodqoog.supabase.co",jk="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndpdWRyemRrYnB5emlhb2Rxb29nIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA5MzgxNzcsImV4cCI6MjA2NjUxNDE3N30.LpD82hY_1wYzroA09nYfaz13iNx5gRJzmPTt0gPCLMI",or=Ij(Uj,jk),mn={ACTIVITIES:"activities",LESSONS:"lessons",LESSON_PLANS:"lesson_plans",EYFS_STATEMENTS:"eyfs_statements"},Wr=()=>!!jk,Au={getAll:async()=>{try{const{data:e,error:t}=await or.from(mn.ACTIVITIES).select("id, activity, description, activity_text, time, video_link, music_link, backing_link, resource_link, link, vocals_link, image_link, teaching_unit, category, level, unit_name, lesson_number, eyfs_standards");if(t)throw t;return(e||[]).map(r=>({_id:r.id,activity:r.activity,description:r.description,activityText:r.activity_text,time:r.time,videoLink:r.video_link,musicLink:r.music_link,backingLink:r.backing_link,resourceLink:r.resource_link,link:r.link,vocalsLink:r.vocals_link,imageLink:r.image_link,teachingUnit:r.teaching_unit,category:r.category,level:r.level,unitName:r.unit_name,lessonNumber:r.lesson_number,eyfsStandards:r.eyfs_standards}))}catch(e){throw console.warn("Failed to get activities from Supabase:",e),e}},create:async e=>{try{const{uniqueId:t,...r}=e,n={activity:r.activity,description:r.description,activity_text:r.activityText,time:r.time,video_link:r.videoLink,music_link:r.musicLink,backing_link:r.backingLink,resource_link:r.resourceLink,link:r.link,vocals_link:r.vocalsLink,image_link:r.imageLink,teaching_unit:r.teachingUnit,category:r.category,level:r.level,unit_name:r.unitName,lesson_number:r.lessonNumber,eyfs_standards:r.eyfsStandards},{data:i,error:a}=await or.from(mn.ACTIVITIES).insert([n]).select().single();if(a)throw a;return{_id:i.id,activity:i.activity,description:i.description,activityText:i.activity_text,time:i.time,videoLink:i.video_link,musicLink:i.music_link,backingLink:i.backing_link,resourceLink:i.resource_link,link:i.link,vocalsLink:i.vocals_link,imageLink:i.image_link,teachingUnit:i.teaching_unit,category:i.category,level:i.level,unitName:i.unit_name,lessonNumber:i.lesson_number,eyfsStandards:i.eyfs_standards}}catch(t){throw console.warn("Failed to create activity in Supabase:",t),t}},update:async(e,t)=>{try{const{uniqueId:r,...n}=t,i={activity:n.activity,description:n.description,activity_text:n.activityText,time:n.time,video_link:n.videoLink,music_link:n.musicLink,backing_link:n.backingLink,resource_link:n.resourceLink,link:n.link,vocals_link:n.vocalsLink,image_link:n.imageLink,teaching_unit:n.teachingUnit,category:n.category,level:n.level,unit_name:n.unitName,lesson_number:n.lessonNumber,eyfs_standards:n.eyfsStandards},{data:a,error:s}=await or.from(mn.ACTIVITIES).update(i).eq("id",e).select().single();if(s)throw s;return{_id:a.id,activity:a.activity,description:a.description,activityText:a.activity_text,time:a.time,videoLink:a.video_link,musicLink:a.music_link,backingLink:a.backing_link,resourceLink:a.resource_link,link:a.link,vocalsLink:a.vocals_link,imageLink:a.image_link,teachingUnit:a.teaching_unit,category:a.category,level:a.level,unitName:a.unit_name,lessonNumber:a.lesson_number,eyfsStandards:a.eyfs_standards}}catch(r){throw console.warn("Failed to update activity in Supabase:",r),r}},delete:async e=>{try{const{error:t}=await or.from(mn.ACTIVITIES).delete().eq("id",e);if(t)throw t;return{success:!0}}catch(t){throw console.warn("Failed to delete activity from Supabase:",t),t}},import:async e=>{try{const t=e.map(({uniqueId:i,...a})=>({activity:a.activity,description:a.description,activity_text:a.activityText,time:a.time,video_link:a.videoLink,music_link:a.musicLink,backing_link:a.backingLink,resource_link:a.resourceLink,link:a.link,vocals_link:a.vocalsLink,image_link:a.imageLink,teaching_unit:a.teachingUnit,category:a.category,level:a.level,unit_name:a.unitName,lesson_number:a.lessonNumber,eyfs_standards:a.eyfsStandards})),{data:r,error:n}=await or.from(mn.ACTIVITIES).upsert(t,{onConflict:"activity,category,lesson_number",ignoreDuplicates:!1});if(n)throw n;return r||[]}catch(t){throw console.warn("Failed to import activities to Supabase:",t),t}}},nh={getBySheet:async e=>{try{const{data:t,error:r}=await or.from(mn.LESSONS).select("*").eq("sheet_name",e).maybeSingle();if(r)throw r;return t?{allLessonsData:t.data||{},lessonNumbers:t.lesson_numbers||[],teachingUnits:t.teaching_units||[],eyfsStatements:t.eyfs_statements_map||{}}:null}catch(t){throw console.warn(`Failed to get lessons for ${e} from Supabase:`,t),t}},updateSheet:async(e,t)=>{try{const{error:r}=await or.from(mn.LESSONS).upsert({sheet_name:e,data:t.allLessonsData,lesson_numbers:t.lessonNumbers,teaching_units:t.teachingUnits,eyfs_statements_map:t.eyfsStatements},{onConflict:"sheet_name"});if(r)throw r;return{success:!0}}catch(r){throw console.warn(`Failed to update lessons for ${e} in Supabase:`,r),r}}},w4={getBySheet:async e=>{try{const{data:t,error:r}=await or.from(mn.EYFS_STATEMENTS).select("*").eq("sheet_name",e).maybeSingle();if(r)throw r;return t?{allStatements:t.all_statements||[],structuredStatements:t.structured_statements||{}}:null}catch(t){throw console.warn(`Failed to get EYFS standards for ${e} from Supabase:`,t),t}},updateSheet:async(e,t)=>{try{const{error:r}=await or.from(mn.EYFS_STATEMENTS).upsert({sheet_name:e,all_statements:t.allStatements,structured_statements:t.structuredStatements},{onConflict:"sheet_name"});if(r)throw r;return{success:!0}}catch(r){throw console.warn(`Failed to update EYFS standards for ${e} in Supabase:`,r),r}}},b4={exportAll:async()=>{try{const[e,t,r,n]=await Promise.all([or.from(mn.ACTIVITIES).select("*"),or.from(mn.LESSONS).select("*"),or.from(mn.LESSON_PLANS).select("*"),or.from(mn.EYFS_STATEMENTS).select("*")]);if(e.error)throw e.error;if(t.error)throw t.error;if(r.error)throw r.error;if(n.error)throw n.error;return{activities:e.data||[],lessons:t.data||[],lessonPlans:r.data||[],eyfsStatements:n.data||[]}}catch(e){throw console.warn("Failed to export data from Supabase:",e),e}},importAll:async e=>{try{const t=[];if(e.activities&&e.activities.length>0){const r=e.activities.map(({uniqueId:n,...i})=>({activity:i.activity,description:i.description,activity_text:i.activityText,time:i.time,video_link:i.videoLink,music_link:i.musicLink,backing_link:i.backingLink,resource_link:i.resourceLink,link:i.link,vocals_link:i.vocalsLink,image_link:i.imageLink,teaching_unit:i.teachingUnit,category:i.category,level:i.level,unit_name:i.unitName,lesson_number:i.lessonNumber,eyfs_standards:i.eyfsStandards}));t.push(or.from(mn.ACTIVITIES).upsert(r,{onConflict:"activity,category,lesson_number",ignoreDuplicates:!1}))}if(e.lessons){const r=Object.entries(e.lessons).map(([n,i])=>({sheet_name:n,data:i.allLessonsData||{},lesson_numbers:i.lessonNumbers||[],teaching_units:i.teachingUnits||[],eyfs_statements_map:i.eyfsStatements||{}}));t.push(or.from(mn.LESSONS).upsert(r,{onConflict:"sheet_name"}))}if(e.lessonPlans&&e.lessonPlans.length>0){const r=e.lessonPlans.map(n=>({id:n.id,date:new Date(n.date).toISOString(),week:n.week,class_name:n.className,activities:n.activities,duration:n.duration,notes:n.notes,status:n.status,unit_id:n.unitId,unit_name:n.unitName,lesson_number:n.lessonNumber,title:n.title,term:n.term,time:n.time}));t.push(or.from(mn.LESSON_PLANS).upsert(r,{onConflict:"id"}))}if(e.eyfs){const r=Object.entries(e.eyfs).map(([n,i])=>({sheet_name:n,all_statements:i.allStatements||[],structured_statements:i.structuredStatements||{}}));t.push(or.from(mn.EYFS_STATEMENTS).upsert(r,{onConflict:"sheet_name"}))}return await Promise.all(t),{success:!0}}catch(t){throw console.warn("Failed to import data to Supabase:",t),t}}};const Dk=ve.createContext(void 0),B4=[{id:"1",email:"rob.reichstorer@gmail.com",password:"mubqaZ-piske5-xecdur",name:"Rob Reichstorer",avatar:"https://images.pexels.com/photos/1407322/pexels-photo-1407322.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&dpr=2",role:"administrator"}];function Oj({children:e}){const[t,r]=ve.useState(null),[n,i]=ve.useState(!0);ve.useEffect(()=>{a()},[]);const a=async()=>{try{const A=localStorage.getItem("rhythmstix_auth_token");if(A)if(A.startsWith("rhythmstix_local_")){const u=A.replace("rhythmstix_local_",""),f=B4.find(h=>h.id===u);if(f){const h={id:f.id,email:f.email,name:f.name,avatar:f.avatar,role:f.role};r(h)}else localStorage.removeItem("rhythmstix_auth_token")}else localStorage.removeItem("rhythmstix_auth_token")}catch(A){console.error("Auth check failed:",A),localStorage.removeItem("rhythmstix_auth_token")}finally{i(!1)}},l={user:t,loading:n,login:async(A,u)=>{try{i(!0);const f=B4.find(d=>d.email===A&&d.password===u);if(f){const d={id:f.id,email:f.email,name:f.name,avatar:f.avatar,role:f.role};localStorage.setItem("rhythmstix_auth_token",`rhythmstix_local_${f.id}`),r(d);return}const h=void 0;throw new Error("Invalid credentials. Please check your email and password.")}catch(f){throw console.error("Login failed:",f),f}finally{i(!1)}},logout:()=>{localStorage.removeItem("rhythmstix_auth_token"),r(null)}};return c.jsx(Dk.Provider,{value:l,children:e})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var rm={};rm.version="0.18.5";var Pk=1252,jj=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],fb={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},hb=function(e){jj.indexOf(e)!=-1&&(Pk=fb[0]=e)};function Dj(){hb(1252)}var Ss=function(e){hb(e)};function db(){Ss(1200),Dj()}function _4(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Pj(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Qk(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var xh=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Pj(e.slice(2)):t==254&&r==255?Qk(e.slice(2)):t==65279?e.slice(1):e},Cp=function(t){return String.fromCharCode(t)},C4=function(t){return String.fromCharCode(t)},Cl,Fl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function kd(e){for(var t="",r=0,n=0,i=0,a=0,s=0,o=0,l=0,A=0;A<e.length;)r=e.charCodeAt(A++),a=r>>2,n=e.charCodeAt(A++),s=(r&3)<<4|n>>4,i=e.charCodeAt(A++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),t+=Fl.charAt(a)+Fl.charAt(s)+Fl.charAt(o)+Fl.charAt(l);return t}function Sa(e){var t="",r=0,n=0,i=0,a=0,s=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var A=0;A<e.length;)a=Fl.indexOf(e.charAt(A++)),s=Fl.indexOf(e.charAt(A++)),r=a<<2|s>>4,t+=String.fromCharCode(r),o=Fl.indexOf(e.charAt(A++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Fl.indexOf(e.charAt(A++)),i=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var Yt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Wo=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Jl(e){return Yt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function S4(e){return Yt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var xa=function(t){return Yt?Wo(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function o1(e){if(typeof ArrayBuffer>"u")return xa(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function cA(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Qj(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function pb(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return pb(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var qn=Yt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Wo(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function Rj(e){for(var t=[],r=0,n=e.length+250,i=Jl(e.length+255),a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s<128)i[r++]=s;else if(s<2048)i[r++]=192|s>>6&31,i[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++a)&1023;i[r++]=240|s>>8&7,i[r++]=128|s>>2&63,i[r++]=128|o>>6&15|(s&3)<<4,i[r++]=128|o&63}else i[r++]=224|s>>12&15,i[r++]=128|s>>6&63,i[r++]=128|s&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Jl(65535),n=65530)}return t.push(i.slice(0,r)),qn(t)}var Mi=/\u0000/g,yh=/[\u0001-\u0006]/g;function Ou(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Es(e,t){var r=""+e;return r.length>=t?r:ln("0",t-r.length)+r}function gb(e,t){var r=""+e;return r.length>=t?r:ln(" ",t-r.length)+r}function nm(e,t){var r=""+e;return r.length>=t?r:r+ln(" ",t-r.length)}function Mj(e,t){var r=""+Math.round(e);return r.length>=t?r:ln("0",t-r.length)+r}function Hj(e,t){var r=""+e;return r.length>=t?r:ln("0",t-r.length)+r}var E4=Math.pow(2,32);function $c(e,t){if(e>E4||e<-E4)return Mj(e,t);var r=Math.round(e);return Hj(r,t)}function im(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var k4=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],rx=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Kj(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Ot={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},F4={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Gj={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function am(e,t,r){for(var n=e<0?-1:1,i=e*n,a=0,s=1,o=0,l=1,A=0,u=0,f=Math.floor(i);A<t&&(f=Math.floor(i),o=f*s+a,u=f*A+l,!(i-f<5e-8));)i=1/(i-f),a=s,s=o,l=A,A=u;if(u>t&&(A>t?(u=l,o=a):(u=A,o=s)),!r)return[0,n*o,u];var h=Math.floor(n*o/u);return[h,n*o-h*u,u]}function jA(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),a=0,s=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=Xj(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=a,o}var Rk=new Date(1899,11,31,0,0,0),Vj=Rk.getTime(),Wj=new Date(1900,2,1,0,0,0);function Mk(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Wj&&(r+=24*60*60*1e3),(r-(Vj+(e.getTimezoneOffset()-Rk.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function mb(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function $j(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function qj(e){var t=e<0?12:11,r=mb(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function zj(e){var t=mb(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Fd(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=qj(e):t===10?r=e.toFixed(10).substr(0,12):r=zj(e),mb($j(r.toUpperCase()))}function nc(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Fd(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ss(14,Mk(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Xj(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Yj(e,t,r,n){var i="",a=0,s=0,o=r.y,l,A=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,A=2;break;default:l=o%1e4,A=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,A=t.length;break;case 3:return rx[r.m-1][1];case 5:return rx[r.m-1][0];default:return rx[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,A=t.length;break;case 3:return k4[r.q][0];default:return k4[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,A=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,A=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,A=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Es(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,a=Math.round(s*(r.S+r.u)),a>=60*s&&(a=0),t==="s"?a===0?"0":""+a/s:(i=Es(a,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}A=t.length===3?1:2;break;case 101:l=o,A=1;break}var u=A>0?Es(l,A):"";return u}function Nl(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Hk=/%/g;function Jj(e,t,r){var n=t.replace(Hk,""),i=t.length-n.length;return Oo(e,n,r*Math.pow(10,2*i))+ln("%",i)}function Zj(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Oo(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Kk(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Kk(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,A,u){return l+A+u.substr(0,(i+a)%i)+"."+u.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Gk=/# (\?+)( ?)\/( ?)(\d+)/;function eD(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),a=Math.floor(i/n),s=i-a*n,o=n;return r+(a===0?"":""+a)+" "+(s===0?ln(" ",e[1].length+1+e[4].length):gb(s,e[1].length)+e[2]+"/"+e[3]+Es(o,e[4].length))}function tD(e,t,r){return r+(t===0?"":""+t)+ln(" ",e[1].length+2+e[4].length)}var Vk=/^#*0*\.([0#]+)/,Wk=/\).*[0#]/,$k=/\(###\) ###\\?-####/;function Pi(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function N4(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function T4(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function rD(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function nD(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ma(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Wk)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ma("n",n,r):"("+Ma("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Zj(e,t,r);if(t.indexOf("%")!==-1)return Jj(e,t,r);if(t.indexOf("E")!==-1)return Kk(t,r);if(t.charCodeAt(0)===36)return"$"+Ma(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,s,o,l=Math.abs(r),A=r<0?"-":"";if(t.match(/^00+$/))return A+$c(l,t.length);if(t.match(/^[#?]+$/))return i=$c(r,0),i==="0"&&(i=""),i.length>t.length?i:Pi(t.substr(0,t.length-i.length))+i;if(a=t.match(Gk))return eD(a,l,A);if(t.match(/^#+0+$/))return A+$c(l,t.length-t.indexOf("0"));if(a=t.match(Vk))return i=N4(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Pi(a[1])).replace(/\.$/,"."+Pi(a[1])).replace(/\.(\d*)$/,function(m,g){return"."+g+ln("0",Pi(a[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return A+N4(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return A+Nl($c(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ma(e,t,-r):Nl(""+(Math.floor(r)+rD(r,a[1].length)))+"."+Es(T4(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Ma(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ou(Ma(e,t.replace(/[\\-]/g,""),r)),s=0,Ou(Ou(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<i.length?i.charAt(s++):m==="0"?"0":""}));if(t.match($k))return i=Ma(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=am(l,Math.pow(10,s)-1,!1),i=""+A,u=Oo("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+a[2]+"/"+a[3],u=nm(o[2],s),u.length<a[4].length&&(u=Pi(a[4].substr(a[4].length-u.length))+u),i+=u,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=am(l,Math.pow(10,s)-1,!0),A+(o[0]||(o[1]?"":"0"))+" "+(o[1]?gb(o[1],s)+a[2]+"/"+a[3]+nm(o[2],s):ln(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=$c(r,0),t.length<=i.length?i:Pi(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var f=t.indexOf(".")-s,h=t.length-i.length-f;return Pi(t.substr(0,f)+i+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return s=T4(r,a[1].length),r<0?"-"+Ma(e,t,-r):Nl(nD(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Es(0,3-m.length):"")+m})+"."+Es(s,a[1].length);switch(t){case"###,##0.00":return Ma(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=Nl($c(l,0));return d!=="0"?A+d:"";case"###,###.00":return Ma(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ma(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function iD(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Oo(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function aD(e,t,r){var n=t.replace(Hk,""),i=t.length-n.length;return Oo(e,n,r*Math.pow(10,2*i))+ln("%",i)}function qk(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+qk(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,A,u){return l+A+u.substr(0,(i+a)%i)+"."+u.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function qs(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Wk)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?qs("n",n,r):"("+qs("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return iD(e,t,r);if(t.indexOf("%")!==-1)return aD(e,t,r);if(t.indexOf("E")!==-1)return qk(t,r);if(t.charCodeAt(0)===36)return"$"+qs(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,s,o,l=Math.abs(r),A=r<0?"-":"";if(t.match(/^00+$/))return A+Es(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Pi(t.substr(0,t.length-i.length))+i;if(a=t.match(Gk))return tD(a,l,A);if(t.match(/^#+0+$/))return A+Es(l,t.length-t.indexOf("0"));if(a=t.match(Vk))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Pi(a[1])).replace(/\.$/,"."+Pi(a[1])),i=i.replace(/\.(\d*)$/,function(m,g){return"."+g+ln("0",Pi(a[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return A+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return A+Nl(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+qs(e,t,-r):Nl(""+r)+"."+ln("0",a[1].length);if(a=t.match(/^#,#*,#0/))return qs(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ou(qs(e,t.replace(/[\\-]/g,""),r)),s=0,Ou(Ou(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<i.length?i.charAt(s++):m==="0"?"0":""}));if(t.match($k))return i=qs(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=am(l,Math.pow(10,s)-1,!1),i=""+A,u=Oo("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+a[2]+"/"+a[3],u=nm(o[2],s),u.length<a[4].length&&(u=Pi(a[4].substr(a[4].length-u.length))+u),i+=u,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=am(l,Math.pow(10,s)-1,!0),A+(o[0]||(o[1]?"":"0"))+" "+(o[1]?gb(o[1],s)+a[2]+"/"+a[3]+nm(o[2],s):ln(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Pi(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var f=t.indexOf(".")-s,h=t.length-i.length-f;return Pi(t.substr(0,f)+i+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+qs(e,t,-r):Nl(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Es(0,3-m.length):"")+m})+"."+Es(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=Nl(""+l);return d!=="0"?A+d:"";default:if(t.match(/\.[0#?]*$/))return qs(e,t.slice(0,t.lastIndexOf(".")),r)+Pi(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Oo(e,t,r){return(r|0)===r?qs(e,t,r):Ma(e,t,r)}function sD(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var zk=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function sf(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":im(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(zk))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function oD(e,t,r,n){for(var i=[],a="",s=0,o="",l="t",A,u,f,h="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!im(e,s))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},s+=7;break;case'"':for(a="";(f=e.charCodeAt(++s))!==34&&s<e.length;)a+=String.fromCharCode(f);i[i.length]={t:"t",v:a},++s;break;case"\\":var d=e.charAt(++s),m=d==="("||d===")"?d:"t";i[i.length]={t:m,v:d},++s;break;case"_":i[i.length]={t:"t",v:" "},s+=2;break;case"@":i[i.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(A==null&&(A=jA(t,r,e.charAt(s+1)==="2"),A==null))return"";i[i.length]={t:"X",v:e.substr(s,2)},l=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||A==null&&(A=jA(t,r),A==null))return"";for(a=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),i[i.length]={t:o,v:a},l=o;break;case"A":case"a":case"上":var g={t:o,v:o};if(A==null&&(A=jA(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(A!=null&&(g.v=A.H>=12?"P":"A"),g.t="T",h="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(A!=null&&(g.v=A.H>=12?"PM":"AM"),g.t="T",s+=5,h="h"):e.substr(s,5).toUpperCase()==="上午/下午"?(A!=null&&(g.v=A.H>=12?"下午":"上午"),g.t="T",s+=5,h="h"):(g.t="t",++s),A==null&&g.t==="T")return"";i[i.length]=g,l=o;break;case"[":for(a=o;e.charAt(s++)!=="]"&&s<e.length;)a+=e.charAt(s);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(zk)){if(A==null&&(A=jA(t,r),A==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",sf(e)||(i[i.length]={t:"t",v:a}));break;case".":if(A!=null){for(a=o;++s<e.length&&(o=e.charAt(s))==="0";)a+=o;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)a+=o;i[i.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++s)===o;)a+=o;i[i.length]={t:o,v:a},l=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)a+=e.charAt(s);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:o,v:o},++s;break;case"$":i[i.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++s;break}var x=0,p=0,v;for(s=i.length-1,l="t";s>=0;--s)switch(i[s].t){case"h":case"H":i[s].t=h,l="h",x<1&&(x=1);break;case"s":(v=i[s].v.match(/\.0+$/))&&(p=Math.max(p,v[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":l=i[s].t;break;case"m":l==="s"&&(i[s].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&i[s].v.match(/[Hh]/)&&(x=1),x<2&&i[s].v.match(/[Mm]/)&&(x=2),x<3&&i[s].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:A.u>=.5&&(A.u=0,++A.S),A.S>=60&&(A.S=0,++A.M),A.M>=60&&(A.M=0,++A.H);break;case 2:A.u>=.5&&(A.u=0,++A.S),A.S>=60&&(A.S=0,++A.M);break}var y="",w;for(s=0;s<i.length;++s)switch(i[s].t){case"t":case"T":case" ":case"D":break;case"X":i[s].v="",i[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[s].v=Yj(i[s].t.charCodeAt(0),i[s].v,A,p),i[s].t="t";break;case"n":case"?":for(w=s+1;i[w]!=null&&((o=i[w].t)==="?"||o==="D"||(o===" "||o==="t")&&i[w+1]!=null&&(i[w+1].t==="?"||i[w+1].t==="t"&&i[w+1].v==="/")||i[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[w].v==="/"||i[w].v===" "&&i[w+1]!=null&&i[w+1].t=="?"));)i[s].v+=i[w].v,i[w]={v:"",t:";"},++w;y+=i[s].v,s=w-1;break;case"G":i[s].t="t",i[s].v=nc(t,r);break}var B="",E,_;if(y.length>0){y.charCodeAt(0)==40?(E=t<0&&y.charCodeAt(0)===45?-t:t,_=Oo("n",y,E)):(E=t<0&&n>1?-t:t,_=Oo("n",y,E),E<0&&i[0]&&i[0].t=="t"&&(_=_.substr(1),i[0].v="-"+i[0].v)),w=_.length-1;var F=i.length;for(s=0;s<i.length;++s)if(i[s]!=null&&i[s].t!="t"&&i[s].v.indexOf(".")>-1){F=s;break}var T=i.length;if(F===i.length&&_.indexOf("E")===-1){for(s=i.length-1;s>=0;--s)i[s]==null||"n?".indexOf(i[s].t)===-1||(w>=i[s].v.length-1?(w-=i[s].v.length,i[s].v=_.substr(w+1,i[s].v.length)):w<0?i[s].v="":(i[s].v=_.substr(0,w+1),w=-1),i[s].t="t",T=s);w>=0&&T<i.length&&(i[T].v=_.substr(0,w+1)+i[T].v)}else if(F!==i.length&&_.indexOf("E")===-1){for(w=_.indexOf(".")-1,s=F;s>=0;--s)if(!(i[s]==null||"n?".indexOf(i[s].t)===-1)){for(u=i[s].v.indexOf(".")>-1&&s===F?i[s].v.indexOf(".")-1:i[s].v.length-1,B=i[s].v.substr(u+1);u>=0;--u)w>=0&&(i[s].v.charAt(u)==="0"||i[s].v.charAt(u)==="#")&&(B=_.charAt(w--)+B);i[s].v=B,i[s].t="t",T=s}for(w>=0&&T<i.length&&(i[T].v=_.substr(0,w+1)+i[T].v),w=_.indexOf(".")+1,s=F;s<i.length;++s)if(!(i[s]==null||"n?(".indexOf(i[s].t)===-1&&s!==F)){for(u=i[s].v.indexOf(".")>-1&&s===F?i[s].v.indexOf(".")+1:0,B=i[s].v.substr(0,u);u<i[s].v.length;++u)w<_.length&&(B+=_.charAt(w++));i[s].v=B,i[s].t="t",T=s}}}for(s=0;s<i.length;++s)i[s]!=null&&"n?".indexOf(i[s].t)>-1&&(E=n>1&&t<0&&s>0&&i[s-1].v==="-"?-t:t,i[s].v=Oo(i[s].t,i[s].v,E),i[s].t="t");var I="";for(s=0;s!==i.length;++s)i[s]!=null&&(I+=i[s].v);return I}var L4=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function I4(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function lD(e,t){var r=sD(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(L4),o=r[1].match(L4);return I4(t,s)?[n,r[0]]:I4(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,a]}function ss(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ot)[e],n==null&&(n=r.table&&r.table[F4[e]]||Ot[F4[e]]),n==null&&(n=Gj[e]||"General");break}if(im(n,0))return nc(t,r);t instanceof Date&&(t=Mk(t,r.date1904));var i=lD(n,t);if(im(i[1]))return nc(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return oD(i[1],t,r,i[0])}function jo(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ot[r]==null){t<0&&(t=r);continue}if(Ot[r]==e){t=r;break}}t<0&&(t=391)}return Ot[t]=e,t}function l1(e){for(var t=0;t!=392;++t)e[t]!==void 0&&jo(e[t],t)}function of(){Ot=Kj()}var AD={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Xk=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function cD(e){var t=typeof e=="number"?Ot[e]:e;return t=t.replace(Xk,"(\\d+)"),new RegExp("^"+t+"$")}function uD(e,t,r){var n=-1,i=-1,a=-1,s=-1,o=-1,l=-1;(t.match(Xk)||[]).forEach(function(f,h){var d=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=d;break;case"d":a=d;break;case"h":s=d;break;case"s":l=d;break;case"m":s>=0?o=d:i=d;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var A=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);A.length==7&&(A="0"+A),A.length==8&&(A="20"+A);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&o==-1&&l==-1?A:n==-1&&i==-1&&a==-1?u:A+"T"+u}var fD=function(){var e={};e.version="1.2.0";function t(){for(var _=0,F=new Array(256),T=0;T!=256;++T)_=T,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,F[T]=_;return typeof Int32Array<"u"?new Int32Array(F):F}var r=t();function n(_){var F=0,T=0,I=0,S=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)S[I]=_[I];for(I=0;I!=256;++I)for(T=_[I],F=256+I;F<4096;F+=256)T=S[F]=T>>>8^_[T&255];var C=[];for(I=1;I!=16;++I)C[I-1]=typeof Int32Array<"u"?S.subarray(I*256,I*256+256):S.slice(I*256,I*256+256);return C}var i=n(r),a=i[0],s=i[1],o=i[2],l=i[3],A=i[4],u=i[5],f=i[6],h=i[7],d=i[8],m=i[9],g=i[10],x=i[11],p=i[12],v=i[13],y=i[14];function w(_,F){for(var T=F^-1,I=0,S=_.length;I<S;)T=T>>>8^r[(T^_.charCodeAt(I++))&255];return~T}function B(_,F){for(var T=F^-1,I=_.length-15,S=0;S<I;)T=y[_[S++]^T&255]^v[_[S++]^T>>8&255]^p[_[S++]^T>>16&255]^x[_[S++]^T>>>24]^g[_[S++]]^m[_[S++]]^d[_[S++]]^h[_[S++]]^f[_[S++]]^u[_[S++]]^A[_[S++]]^l[_[S++]]^o[_[S++]]^s[_[S++]]^a[_[S++]]^r[_[S++]];for(I+=15;S<I;)T=T>>>8^r[(T^_[S++])&255];return~T}function E(_,F){for(var T=F^-1,I=0,S=_.length,C=0,L=0;I<S;)C=_.charCodeAt(I++),C<128?T=T>>>8^r[(T^C)&255]:C<2048?(T=T>>>8^r[(T^(192|C>>6&31))&255],T=T>>>8^r[(T^(128|C&63))&255]):C>=55296&&C<57344?(C=(C&1023)+64,L=_.charCodeAt(I++)&1023,T=T>>>8^r[(T^(240|C>>8&7))&255],T=T>>>8^r[(T^(128|C>>2&63))&255],T=T>>>8^r[(T^(128|L>>6&15|(C&3)<<4))&255],T=T>>>8^r[(T^(128|L&63))&255]):(T=T>>>8^r[(T^(224|C>>12&15))&255],T=T>>>8^r[(T^(128|C>>6&63))&255],T=T>>>8^r[(T^(128|C&63))&255]);return~T}return e.table=r,e.bstr=w,e.buf=B,e.str=E,e}(),Lt=function(){var t={};t.version="1.2.1";function r(te,ue){for(var ae=te.split("/"),Ae=ue.split("/"),fe=0,ge=0,Oe=Math.min(ae.length,Ae.length);fe<Oe;++fe){if(ge=ae[fe].length-Ae[fe].length)return ge;if(ae[fe]!=Ae[fe])return ae[fe]<Ae[fe]?-1:1}return ae.length-Ae.length}function n(te){if(te.charAt(te.length-1)=="/")return te.slice(0,-1).indexOf("/")===-1?te:n(te.slice(0,-1));var ue=te.lastIndexOf("/");return ue===-1?te:te.slice(0,ue+1)}function i(te){if(te.charAt(te.length-1)=="/")return i(te.slice(0,-1));var ue=te.lastIndexOf("/");return ue===-1?te:te.slice(ue+1)}function a(te,ue){typeof ue=="string"&&(ue=new Date(ue));var ae=ue.getHours();ae=ae<<6|ue.getMinutes(),ae=ae<<5|ue.getSeconds()>>>1,te.write_shift(2,ae);var Ae=ue.getFullYear()-1980;Ae=Ae<<4|ue.getMonth()+1,Ae=Ae<<5|ue.getDate(),te.write_shift(2,Ae)}function s(te){var ue=te.read_shift(2)&65535,ae=te.read_shift(2)&65535,Ae=new Date,fe=ae&31;ae>>>=5;var ge=ae&15;ae>>>=4,Ae.setMilliseconds(0),Ae.setFullYear(ae+1980),Ae.setMonth(ge-1),Ae.setDate(fe);var Oe=ue&31;ue>>>=5;var Ke=ue&63;return ue>>>=6,Ae.setHours(ue),Ae.setMinutes(Ke),Ae.setSeconds(Oe<<1),Ae}function o(te){ri(te,0);for(var ue={},ae=0;te.l<=te.length-4;){var Ae=te.read_shift(2),fe=te.read_shift(2),ge=te.l+fe,Oe={};switch(Ae){case 21589:ae=te.read_shift(1),ae&1&&(Oe.mtime=te.read_shift(4)),fe>5&&(ae&2&&(Oe.atime=te.read_shift(4)),ae&4&&(Oe.ctime=te.read_shift(4))),Oe.mtime&&(Oe.mt=new Date(Oe.mtime*1e3));break}te.l=ge,ue[Ae]=Oe}return ue}var l;function A(){return l||(l={})}function u(te,ue){if(te[0]==80&&te[1]==75)return Nr(te,ue);if((te[0]|32)==109&&(te[1]|32)==105)return De(te,ue);if(te.length<512)throw new Error("CFB file size "+te.length+" < 512");var ae=3,Ae=512,fe=0,ge=0,Oe=0,Ke=0,Ie=0,Re=[],He=te.slice(0,512);ri(He,0);var nt=f(He);switch(ae=nt[0],ae){case 3:Ae=512;break;case 4:Ae=4096;break;case 0:if(nt[1]==0)return Nr(te,ue);default:throw new Error("Major Version: Expected 3 or 4 saw "+ae)}Ae!==512&&(He=te.slice(0,Ae),ri(He,28));var lt=te.slice(0,Ae);h(He,ae);var pt=He.read_shift(4,"i");if(ae===3&&pt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+pt);He.l+=4,Oe=He.read_shift(4,"i"),He.l+=4,He.chk("00100000","Mini Stream Cutoff Size: "),Ke=He.read_shift(4,"i"),fe=He.read_shift(4,"i"),Ie=He.read_shift(4,"i"),ge=He.read_shift(4,"i");for(var st=-1,dt=0;dt<109&&(st=He.read_shift(4,"i"),!(st<0));++dt)Re[dt]=st;var Nt=d(te,Ae);x(Ie,ge,Nt,Ae,Re);var pr=v(Nt,Oe,Re,Ae);pr[Oe].name="!Directory",fe>0&&Ke!==L&&(pr[Ke].name="!MiniFAT"),pr[Re[0]].name="!FAT",pr.fat_addrs=Re,pr.ssz=Ae;var Rt={},rn=[],Vi=[],uo=[];y(Oe,pr,Nt,rn,fe,Rt,Vi,Ke),m(Vi,uo,rn),rn.shift();var Ps={FileIndex:Vi,FullPaths:uo};return ue&&ue.raw&&(Ps.raw={header:lt,sectors:Nt}),Ps}function f(te){if(te[te.l]==80&&te[te.l+1]==75)return[0,0];te.chk(R,"Header Signature: "),te.l+=16;var ue=te.read_shift(2,"u");return[te.read_shift(2,"u"),ue]}function h(te,ue){var ae=9;switch(te.l+=2,ae=te.read_shift(2)){case 9:if(ue!=3)throw new Error("Sector Shift: Expected 9 saw "+ae);break;case 12:if(ue!=4)throw new Error("Sector Shift: Expected 12 saw "+ae);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ae)}te.chk("0600","Mini Sector Shift: "),te.chk("000000000000","Reserved: ")}function d(te,ue){for(var ae=Math.ceil(te.length/ue)-1,Ae=[],fe=1;fe<ae;++fe)Ae[fe-1]=te.slice(fe*ue,(fe+1)*ue);return Ae[ae-1]=te.slice(ae*ue),Ae}function m(te,ue,ae){for(var Ae=0,fe=0,ge=0,Oe=0,Ke=0,Ie=ae.length,Re=[],He=[];Ae<Ie;++Ae)Re[Ae]=He[Ae]=Ae,ue[Ae]=ae[Ae];for(;Ke<He.length;++Ke)Ae=He[Ke],fe=te[Ae].L,ge=te[Ae].R,Oe=te[Ae].C,Re[Ae]===Ae&&(fe!==-1&&Re[fe]!==fe&&(Re[Ae]=Re[fe]),ge!==-1&&Re[ge]!==ge&&(Re[Ae]=Re[ge])),Oe!==-1&&(Re[Oe]=Ae),fe!==-1&&Ae!=Re[Ae]&&(Re[fe]=Re[Ae],He.lastIndexOf(fe)<Ke&&He.push(fe)),ge!==-1&&Ae!=Re[Ae]&&(Re[ge]=Re[Ae],He.lastIndexOf(ge)<Ke&&He.push(ge));for(Ae=1;Ae<Ie;++Ae)Re[Ae]===Ae&&(ge!==-1&&Re[ge]!==ge?Re[Ae]=Re[ge]:fe!==-1&&Re[fe]!==fe&&(Re[Ae]=Re[fe]));for(Ae=1;Ae<Ie;++Ae)if(te[Ae].type!==0){if(Ke=Ae,Ke!=Re[Ke])do Ke=Re[Ke],ue[Ae]=ue[Ke]+"/"+ue[Ae];while(Ke!==0&&Re[Ke]!==-1&&Ke!=Re[Ke]);Re[Ae]=-1}for(ue[0]+="/",Ae=1;Ae<Ie;++Ae)te[Ae].type!==2&&(ue[Ae]+="/")}function g(te,ue,ae){for(var Ae=te.start,fe=te.size,ge=[],Oe=Ae;ae&&fe>0&&Oe>=0;)ge.push(ue.slice(Oe*C,Oe*C+C)),fe-=C,Oe=TA(ae,Oe*4);return ge.length===0?ze(0):qn(ge).slice(0,te.size)}function x(te,ue,ae,Ae,fe){var ge=L;if(te===L){if(ue!==0)throw new Error("DIFAT chain shorter than expected")}else if(te!==-1){var Oe=ae[te],Ke=(Ae>>>2)-1;if(!Oe)return;for(var Ie=0;Ie<Ke&&(ge=TA(Oe,Ie*4))!==L;++Ie)fe.push(ge);x(TA(Oe,Ae-4),ue-1,ae,Ae,fe)}}function p(te,ue,ae,Ae,fe){var ge=[],Oe=[];fe||(fe=[]);var Ke=Ae-1,Ie=0,Re=0;for(Ie=ue;Ie>=0;){fe[Ie]=!0,ge[ge.length]=Ie,Oe.push(te[Ie]);var He=ae[Math.floor(Ie*4/Ae)];if(Re=Ie*4&Ke,Ae<4+Re)throw new Error("FAT boundary crossed: "+Ie+" 4 "+Ae);if(!te[He])break;Ie=TA(te[He],Re)}return{nodes:ge,data:V4([Oe])}}function v(te,ue,ae,Ae){var fe=te.length,ge=[],Oe=[],Ke=[],Ie=[],Re=Ae-1,He=0,nt=0,lt=0,pt=0;for(He=0;He<fe;++He)if(Ke=[],lt=He+ue,lt>=fe&&(lt-=fe),!Oe[lt]){Ie=[];var st=[];for(nt=lt;nt>=0;){st[nt]=!0,Oe[nt]=!0,Ke[Ke.length]=nt,Ie.push(te[nt]);var dt=ae[Math.floor(nt*4/Ae)];if(pt=nt*4&Re,Ae<4+pt)throw new Error("FAT boundary crossed: "+nt+" 4 "+Ae);if(!te[dt]||(nt=TA(te[dt],pt),st[nt]))break}ge[lt]={nodes:Ke,data:V4([Ie])}}return ge}function y(te,ue,ae,Ae,fe,ge,Oe,Ke){for(var Ie=0,Re=Ae.length?2:0,He=ue[te].data,nt=0,lt=0,pt;nt<He.length;nt+=128){var st=He.slice(nt,nt+128);ri(st,64),lt=st.read_shift(2),pt=_b(st,0,lt-Re),Ae.push(pt);var dt={name:pt,type:st.read_shift(1),color:st.read_shift(1),L:st.read_shift(4,"i"),R:st.read_shift(4,"i"),C:st.read_shift(4,"i"),clsid:st.read_shift(16),state:st.read_shift(4,"i"),start:0,size:0},Nt=st.read_shift(2)+st.read_shift(2)+st.read_shift(2)+st.read_shift(2);Nt!==0&&(dt.ct=w(st,st.l-8));var pr=st.read_shift(2)+st.read_shift(2)+st.read_shift(2)+st.read_shift(2);pr!==0&&(dt.mt=w(st,st.l-8)),dt.start=st.read_shift(4,"i"),dt.size=st.read_shift(4,"i"),dt.size<0&&dt.start<0&&(dt.size=dt.type=0,dt.start=L,dt.name=""),dt.type===5?(Ie=dt.start,fe>0&&Ie!==L&&(ue[Ie].name="!StreamData")):dt.size>=4096?(dt.storage="fat",ue[dt.start]===void 0&&(ue[dt.start]=p(ae,dt.start,ue.fat_addrs,ue.ssz)),ue[dt.start].name=dt.name,dt.content=ue[dt.start].data.slice(0,dt.size)):(dt.storage="minifat",dt.size<0?dt.size=0:Ie!==L&&dt.start!==L&&ue[Ie]&&(dt.content=g(dt,ue[Ie].data,(ue[Ke]||{}).data))),dt.content&&ri(dt.content,0),ge[pt]=dt,Oe.push(dt)}}function w(te,ue){return new Date((va(te,ue+4)/1e7*Math.pow(2,32)+va(te,ue)/1e7-11644473600)*1e3)}function B(te,ue){return A(),u(l.readFileSync(te),ue)}function E(te,ue){var ae=ue&&ue.type;switch(ae||Yt&&Buffer.isBuffer(te)&&(ae="buffer"),ae||"base64"){case"file":return B(te,ue);case"base64":return u(xa(Sa(te)),ue);case"binary":return u(xa(te),ue)}return u(te,ue)}function _(te,ue){var ae=ue||{},Ae=ae.root||"Root Entry";if(te.FullPaths||(te.FullPaths=[]),te.FileIndex||(te.FileIndex=[]),te.FullPaths.length!==te.FileIndex.length)throw new Error("inconsistent CFB structure");te.FullPaths.length===0&&(te.FullPaths[0]=Ae+"/",te.FileIndex[0]={name:Ae,type:5}),ae.CLSID&&(te.FileIndex[0].clsid=ae.CLSID),F(te)}function F(te){var ue="Sh33tJ5";if(!Lt.find(te,"/"+ue)){var ae=ze(4);ae[0]=55,ae[1]=ae[3]=50,ae[2]=54,te.FileIndex.push({name:ue,type:2,content:ae,size:4,L:69,R:69,C:69}),te.FullPaths.push(te.FullPaths[0]+ue),T(te)}}function T(te,ue){_(te);for(var ae=!1,Ae=!1,fe=te.FullPaths.length-1;fe>=0;--fe){var ge=te.FileIndex[fe];switch(ge.type){case 0:Ae?ae=!0:(te.FileIndex.pop(),te.FullPaths.pop());break;case 1:case 2:case 5:Ae=!0,isNaN(ge.R*ge.L*ge.C)&&(ae=!0),ge.R>-1&&ge.L>-1&&ge.R==ge.L&&(ae=!0);break;default:ae=!0;break}}if(!(!ae&&!ue)){var Oe=new Date(1987,1,19),Ke=0,Ie=Object.create?Object.create(null):{},Re=[];for(fe=0;fe<te.FullPaths.length;++fe)Ie[te.FullPaths[fe]]=!0,te.FileIndex[fe].type!==0&&Re.push([te.FullPaths[fe],te.FileIndex[fe]]);for(fe=0;fe<Re.length;++fe){var He=n(Re[fe][0]);Ae=Ie[He],Ae||(Re.push([He,{name:i(He).replace("/",""),type:1,clsid:G,ct:Oe,mt:Oe,content:null}]),Ie[He]=!0)}for(Re.sort(function(pt,st){return r(pt[0],st[0])}),te.FullPaths=[],te.FileIndex=[],fe=0;fe<Re.length;++fe)te.FullPaths[fe]=Re[fe][0],te.FileIndex[fe]=Re[fe][1];for(fe=0;fe<Re.length;++fe){var nt=te.FileIndex[fe],lt=te.FullPaths[fe];if(nt.name=i(lt).replace("/",""),nt.L=nt.R=nt.C=-(nt.color=1),nt.size=nt.content?nt.content.length:0,nt.start=0,nt.clsid=nt.clsid||G,fe===0)nt.C=Re.length>1?1:-1,nt.size=0,nt.type=5;else if(lt.slice(-1)=="/"){for(Ke=fe+1;Ke<Re.length&&n(te.FullPaths[Ke])!=lt;++Ke);for(nt.C=Ke>=Re.length?-1:Ke,Ke=fe+1;Ke<Re.length&&n(te.FullPaths[Ke])!=n(lt);++Ke);nt.R=Ke>=Re.length?-1:Ke,nt.type=1}else n(te.FullPaths[fe+1]||"")==n(lt)&&(nt.R=fe+1),nt.type=2}}}function I(te,ue){var ae=ue||{};if(ae.fileType=="mad")return ye(te,ae);switch(T(te),ae.fileType){case"zip":return Aa(te,ae)}var Ae=function(pt){for(var st=0,dt=0,Nt=0;Nt<pt.FileIndex.length;++Nt){var pr=pt.FileIndex[Nt];if(pr.content){var Rt=pr.content.length;Rt>0&&(Rt<4096?st+=Rt+63>>6:dt+=Rt+511>>9)}}for(var rn=pt.FullPaths.length+3>>2,Vi=st+7>>3,uo=st+127>>7,Ps=Vi+dt+rn+uo,As=Ps+127>>7,Qs=As<=109?0:Math.ceil((As-109)/127);Ps+As+Qs+127>>7>As;)Qs=++As<=109?0:Math.ceil((As-109)/127);var ca=[1,Qs,As,uo,rn,dt,st,0];return pt.FileIndex[0].size=st<<6,ca[7]=(pt.FileIndex[0].start=ca[0]+ca[1]+ca[2]+ca[3]+ca[4]+ca[5])+(ca[6]+7>>3),ca}(te),fe=ze(Ae[7]<<9),ge=0,Oe=0;{for(ge=0;ge<8;++ge)fe.write_shift(1,W[ge]);for(ge=0;ge<8;++ge)fe.write_shift(2,0);for(fe.write_shift(2,62),fe.write_shift(2,3),fe.write_shift(2,65534),fe.write_shift(2,9),fe.write_shift(2,6),ge=0;ge<3;++ge)fe.write_shift(2,0);for(fe.write_shift(4,0),fe.write_shift(4,Ae[2]),fe.write_shift(4,Ae[0]+Ae[1]+Ae[2]+Ae[3]-1),fe.write_shift(4,0),fe.write_shift(4,4096),fe.write_shift(4,Ae[3]?Ae[0]+Ae[1]+Ae[2]-1:L),fe.write_shift(4,Ae[3]),fe.write_shift(-4,Ae[1]?Ae[0]-1:L),fe.write_shift(4,Ae[1]),ge=0;ge<109;++ge)fe.write_shift(-4,ge<Ae[2]?Ae[1]+ge:-1)}if(Ae[1])for(Oe=0;Oe<Ae[1];++Oe){for(;ge<236+Oe*127;++ge)fe.write_shift(-4,ge<Ae[2]?Ae[1]+ge:-1);fe.write_shift(-4,Oe===Ae[1]-1?L:Oe+1)}var Ke=function(pt){for(Oe+=pt;ge<Oe-1;++ge)fe.write_shift(-4,ge+1);pt&&(++ge,fe.write_shift(-4,L))};for(Oe=ge=0,Oe+=Ae[1];ge<Oe;++ge)fe.write_shift(-4,V.DIFSECT);for(Oe+=Ae[2];ge<Oe;++ge)fe.write_shift(-4,V.FATSECT);Ke(Ae[3]),Ke(Ae[4]);for(var Ie=0,Re=0,He=te.FileIndex[0];Ie<te.FileIndex.length;++Ie)He=te.FileIndex[Ie],He.content&&(Re=He.content.length,!(Re<4096)&&(He.start=Oe,Ke(Re+511>>9)));for(Ke(Ae[6]+7>>3);fe.l&511;)fe.write_shift(-4,V.ENDOFCHAIN);for(Oe=ge=0,Ie=0;Ie<te.FileIndex.length;++Ie)He=te.FileIndex[Ie],He.content&&(Re=He.content.length,!(!Re||Re>=4096)&&(He.start=Oe,Ke(Re+63>>6)));for(;fe.l&511;)fe.write_shift(-4,V.ENDOFCHAIN);for(ge=0;ge<Ae[4]<<2;++ge){var nt=te.FullPaths[ge];if(!nt||nt.length===0){for(Ie=0;Ie<17;++Ie)fe.write_shift(4,0);for(Ie=0;Ie<3;++Ie)fe.write_shift(4,-1);for(Ie=0;Ie<12;++Ie)fe.write_shift(4,0);continue}He=te.FileIndex[ge],ge===0&&(He.start=He.size?He.start-1:L);var lt=ge===0&&ae.root||He.name;if(Re=2*(lt.length+1),fe.write_shift(64,lt,"utf16le"),fe.write_shift(2,Re),fe.write_shift(1,He.type),fe.write_shift(1,He.color),fe.write_shift(-4,He.L),fe.write_shift(-4,He.R),fe.write_shift(-4,He.C),He.clsid)fe.write_shift(16,He.clsid,"hex");else for(Ie=0;Ie<4;++Ie)fe.write_shift(4,0);fe.write_shift(4,He.state||0),fe.write_shift(4,0),fe.write_shift(4,0),fe.write_shift(4,0),fe.write_shift(4,0),fe.write_shift(4,He.start),fe.write_shift(4,He.size),fe.write_shift(4,0)}for(ge=1;ge<te.FileIndex.length;++ge)if(He=te.FileIndex[ge],He.size>=4096)if(fe.l=He.start+1<<9,Yt&&Buffer.isBuffer(He.content))He.content.copy(fe,fe.l,0,He.size),fe.l+=He.size+511&-512;else{for(Ie=0;Ie<He.size;++Ie)fe.write_shift(1,He.content[Ie]);for(;Ie&511;++Ie)fe.write_shift(1,0)}for(ge=1;ge<te.FileIndex.length;++ge)if(He=te.FileIndex[ge],He.size>0&&He.size<4096)if(Yt&&Buffer.isBuffer(He.content))He.content.copy(fe,fe.l,0,He.size),fe.l+=He.size+63&-64;else{for(Ie=0;Ie<He.size;++Ie)fe.write_shift(1,He.content[Ie]);for(;Ie&63;++Ie)fe.write_shift(1,0)}if(Yt)fe.l=fe.length;else for(;fe.l<fe.length;)fe.write_shift(1,0);return fe}function S(te,ue){var ae=te.FullPaths.map(function(Ie){return Ie.toUpperCase()}),Ae=ae.map(function(Ie){var Re=Ie.split("/");return Re[Re.length-(Ie.slice(-1)=="/"?2:1)]}),fe=!1;ue.charCodeAt(0)===47?(fe=!0,ue=ae[0].slice(0,-1)+ue):fe=ue.indexOf("/")!==-1;var ge=ue.toUpperCase(),Oe=fe===!0?ae.indexOf(ge):Ae.indexOf(ge);if(Oe!==-1)return te.FileIndex[Oe];var Ke=!ge.match(yh);for(ge=ge.replace(Mi,""),Ke&&(ge=ge.replace(yh,"!")),Oe=0;Oe<ae.length;++Oe)if((Ke?ae[Oe].replace(yh,"!"):ae[Oe]).replace(Mi,"")==ge||(Ke?Ae[Oe].replace(yh,"!"):Ae[Oe]).replace(Mi,"")==ge)return te.FileIndex[Oe];return null}var C=64,L=-2,R="d0cf11e0a1b11ae1",W=[208,207,17,224,161,177,26,225],G="00000000000000000000000000000000",V={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:L,FREESECT:-1,HEADER_SIGNATURE:R,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:G,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function X(te,ue,ae){A();var Ae=I(te,ae);l.writeFileSync(ue,Ae)}function Q(te){for(var ue=new Array(te.length),ae=0;ae<te.length;++ae)ue[ae]=String.fromCharCode(te[ae]);return ue.join("")}function K(te,ue){var ae=I(te,ue);switch(ue&&ue.type||"buffer"){case"file":return A(),l.writeFileSync(ue.filename,ae),ae;case"binary":return typeof ae=="string"?ae:Q(ae);case"base64":return kd(typeof ae=="string"?ae:Q(ae));case"buffer":if(Yt)return Buffer.isBuffer(ae)?ae:Wo(ae);case"array":return typeof ae=="string"?xa(ae):ae}return ae}var H;function k(te){try{var ue=te.InflateRaw,ae=new ue;if(ae._processChunk(new Uint8Array([3,0]),ae._finishFlushFlag),ae.bytesRead)H=te;else throw new Error("zlib does not expose bytesRead")}catch(Ae){console.error("cannot use native zlib: "+(Ae.message||Ae))}}function U(te,ue){if(!H)return nr(te,ue);var ae=H.InflateRaw,Ae=new ae,fe=Ae._processChunk(te.slice(te.l),Ae._finishFlushFlag);return te.l+=Ae.bytesRead,fe}function P(te){return H?H.deflateRawSync(te):at(te)}var D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],O=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function J(te){var ue=(te<<1|te<<11)&139536|(te<<5|te<<15)&558144;return(ue>>16|ue>>8|ue)&255}for(var Y=typeof Uint8Array<"u",le=Y?new Uint8Array(256):[],we=0;we<256;++we)le[we]=J(we);function ne(te,ue){var ae=le[te&255];return ue<=8?ae>>>8-ue:(ae=ae<<8|le[te>>8&255],ue<=16?ae>>>16-ue:(ae=ae<<8|le[te>>16&255],ae>>>24-ue))}function Me(te,ue){var ae=ue&7,Ae=ue>>>3;return(te[Ae]|(ae<=6?0:te[Ae+1]<<8))>>>ae&3}function qe(te,ue){var ae=ue&7,Ae=ue>>>3;return(te[Ae]|(ae<=5?0:te[Ae+1]<<8))>>>ae&7}function Fe(te,ue){var ae=ue&7,Ae=ue>>>3;return(te[Ae]|(ae<=4?0:te[Ae+1]<<8))>>>ae&15}function he(te,ue){var ae=ue&7,Ae=ue>>>3;return(te[Ae]|(ae<=3?0:te[Ae+1]<<8))>>>ae&31}function Be(te,ue){var ae=ue&7,Ae=ue>>>3;return(te[Ae]|(ae<=1?0:te[Ae+1]<<8))>>>ae&127}function xe(te,ue,ae){var Ae=ue&7,fe=ue>>>3,ge=(1<<ae)-1,Oe=te[fe]>>>Ae;return ae<8-Ae||(Oe|=te[fe+1]<<8-Ae,ae<16-Ae)||(Oe|=te[fe+2]<<16-Ae,ae<24-Ae)||(Oe|=te[fe+3]<<24-Ae),Oe&ge}function se(te,ue,ae){var Ae=ue&7,fe=ue>>>3;return Ae<=5?te[fe]|=(ae&7)<<Ae:(te[fe]|=ae<<Ae&255,te[fe+1]=(ae&7)>>8-Ae),ue+3}function be(te,ue,ae){var Ae=ue&7,fe=ue>>>3;return ae=(ae&1)<<Ae,te[fe]|=ae,ue+1}function Te(te,ue,ae){var Ae=ue&7,fe=ue>>>3;return ae<<=Ae,te[fe]|=ae&255,ae>>>=8,te[fe+1]=ae,ue+8}function pe(te,ue,ae){var Ae=ue&7,fe=ue>>>3;return ae<<=Ae,te[fe]|=ae&255,ae>>>=8,te[fe+1]=ae&255,te[fe+2]=ae>>>8,ue+16}function je(te,ue){var ae=te.length,Ae=2*ae>ue?2*ae:ue+5,fe=0;if(ae>=ue)return te;if(Yt){var ge=S4(Ae);if(te.copy)te.copy(ge);else for(;fe<te.length;++fe)ge[fe]=te[fe];return ge}else if(Y){var Oe=new Uint8Array(Ae);if(Oe.set)Oe.set(te);else for(;fe<ae;++fe)Oe[fe]=te[fe];return Oe}return te.length=Ae,te}function Ve(te){for(var ue=new Array(te),ae=0;ae<te;++ae)ue[ae]=0;return ue}function We(te,ue,ae){var Ae=1,fe=0,ge=0,Oe=0,Ke=0,Ie=te.length,Re=Y?new Uint16Array(32):Ve(32);for(ge=0;ge<32;++ge)Re[ge]=0;for(ge=Ie;ge<ae;++ge)te[ge]=0;Ie=te.length;var He=Y?new Uint16Array(Ie):Ve(Ie);for(ge=0;ge<Ie;++ge)Re[fe=te[ge]]++,Ae<fe&&(Ae=fe),He[ge]=0;for(Re[0]=0,ge=1;ge<=Ae;++ge)Re[ge+16]=Ke=Ke+Re[ge-1]<<1;for(ge=0;ge<Ie;++ge)Ke=te[ge],Ke!=0&&(He[ge]=Re[Ke+16]++);var nt=0;for(ge=0;ge<Ie;++ge)if(nt=te[ge],nt!=0)for(Ke=ne(He[ge],Ae)>>Ae-nt,Oe=(1<<Ae+4-nt)-1;Oe>=0;--Oe)ue[Ke|Oe<<nt]=nt&15|ge<<4;return Ae}var ft=Y?new Uint16Array(512):Ve(512),Et=Y?new Uint16Array(32):Ve(32);if(!Y){for(var ut=0;ut<512;++ut)ft[ut]=0;for(ut=0;ut<32;++ut)Et[ut]=0}(function(){for(var te=[],ue=0;ue<32;ue++)te.push(5);We(te,Et,32);var ae=[];for(ue=0;ue<=143;ue++)ae.push(8);for(;ue<=255;ue++)ae.push(9);for(;ue<=279;ue++)ae.push(7);for(;ue<=287;ue++)ae.push(8);We(ae,ft,288)})();var wt=function(){for(var ue=Y?new Uint8Array(32768):[],ae=0,Ae=0;ae<z.length-1;++ae)for(;Ae<z[ae+1];++Ae)ue[Ae]=ae;for(;Ae<32768;++Ae)ue[Ae]=29;var fe=Y?new Uint8Array(259):[];for(ae=0,Ae=0;ae<O.length-1;++ae)for(;Ae<O[ae+1];++Ae)fe[Ae]=ae;function ge(Ke,Ie){for(var Re=0;Re<Ke.length;){var He=Math.min(65535,Ke.length-Re),nt=Re+He==Ke.length;for(Ie.write_shift(1,+nt),Ie.write_shift(2,He),Ie.write_shift(2,~He&65535);He-- >0;)Ie[Ie.l++]=Ke[Re++]}return Ie.l}function Oe(Ke,Ie){for(var Re=0,He=0,nt=Y?new Uint16Array(32768):[];He<Ke.length;){var lt=Math.min(65535,Ke.length-He);if(lt<10){for(Re=se(Ie,Re,+(He+lt==Ke.length)),Re&7&&(Re+=8-(Re&7)),Ie.l=Re/8|0,Ie.write_shift(2,lt),Ie.write_shift(2,~lt&65535);lt-- >0;)Ie[Ie.l++]=Ke[He++];Re=Ie.l*8;continue}Re=se(Ie,Re,+(He+lt==Ke.length)+2);for(var pt=0;lt-- >0;){var st=Ke[He];pt=(pt<<5^st)&32767;var dt=-1,Nt=0;if((dt=nt[pt])&&(dt|=He&-32768,dt>He&&(dt-=32768),dt<He))for(;Ke[dt+Nt]==Ke[He+Nt]&&Nt<250;)++Nt;if(Nt>2){st=fe[Nt],st<=22?Re=Te(Ie,Re,le[st+1]>>1)-1:(Te(Ie,Re,3),Re+=5,Te(Ie,Re,le[st-23]>>5),Re+=3);var pr=st<8?0:st-4>>2;pr>0&&(pe(Ie,Re,Nt-O[st]),Re+=pr),st=ue[He-dt],Re=Te(Ie,Re,le[st]>>3),Re-=3;var Rt=st<4?0:st-2>>1;Rt>0&&(pe(Ie,Re,He-dt-z[st]),Re+=Rt);for(var rn=0;rn<Nt;++rn)nt[pt]=He&32767,pt=(pt<<5^Ke[He])&32767,++He;lt-=Nt-1}else st<=143?st=st+48:Re=be(Ie,Re,1),Re=Te(Ie,Re,le[st]),nt[pt]=He&32767,++He}Re=Te(Ie,Re,0)-1}return Ie.l=(Re+7)/8|0,Ie.l}return function(Ie,Re){return Ie.length<8?ge(Ie,Re):Oe(Ie,Re)}}();function at(te){var ue=ze(50+Math.floor(te.length*1.1)),ae=wt(te,ue);return ue.slice(0,ae)}var et=Y?new Uint16Array(32768):Ve(32768),ur=Y?new Uint16Array(32768):Ve(32768),Ft=Y?new Uint16Array(128):Ve(128),tn=1,fr=1;function dr(te,ue){var ae=he(te,ue)+257;ue+=5;var Ae=he(te,ue)+1;ue+=5;var fe=Fe(te,ue)+4;ue+=4;for(var ge=0,Oe=Y?new Uint8Array(19):Ve(19),Ke=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ie=1,Re=Y?new Uint8Array(8):Ve(8),He=Y?new Uint8Array(8):Ve(8),nt=Oe.length,lt=0;lt<fe;++lt)Oe[D[lt]]=ge=qe(te,ue),Ie<ge&&(Ie=ge),Re[ge]++,ue+=3;var pt=0;for(Re[0]=0,lt=1;lt<=Ie;++lt)He[lt]=pt=pt+Re[lt-1]<<1;for(lt=0;lt<nt;++lt)(pt=Oe[lt])!=0&&(Ke[lt]=He[pt]++);var st=0;for(lt=0;lt<nt;++lt)if(st=Oe[lt],st!=0){pt=le[Ke[lt]]>>8-st;for(var dt=(1<<7-st)-1;dt>=0;--dt)Ft[pt|dt<<st]=st&7|lt<<3}var Nt=[];for(Ie=1;Nt.length<ae+Ae;)switch(pt=Ft[Be(te,ue)],ue+=pt&7,pt>>>=3){case 16:for(ge=3+Me(te,ue),ue+=2,pt=Nt[Nt.length-1];ge-- >0;)Nt.push(pt);break;case 17:for(ge=3+qe(te,ue),ue+=3;ge-- >0;)Nt.push(0);break;case 18:for(ge=11+Be(te,ue),ue+=7;ge-- >0;)Nt.push(0);break;default:Nt.push(pt),Ie<pt&&(Ie=pt);break}var pr=Nt.slice(0,ae),Rt=Nt.slice(ae);for(lt=ae;lt<286;++lt)pr[lt]=0;for(lt=Ae;lt<30;++lt)Rt[lt]=0;return tn=We(pr,et,286),fr=We(Rt,ur,30),ue}function Rn(te,ue){if(te[0]==3&&!(te[1]&3))return[Jl(ue),2];for(var ae=0,Ae=0,fe=S4(ue||1<<18),ge=0,Oe=fe.length>>>0,Ke=0,Ie=0;!(Ae&1);){if(Ae=qe(te,ae),ae+=3,Ae>>>1)Ae>>1==1?(Ke=9,Ie=5):(ae=dr(te,ae),Ke=tn,Ie=fr);else{ae&7&&(ae+=8-(ae&7));var Re=te[ae>>>3]|te[(ae>>>3)+1]<<8;if(ae+=32,Re>0)for(!ue&&Oe<ge+Re&&(fe=je(fe,ge+Re),Oe=fe.length);Re-- >0;)fe[ge++]=te[ae>>>3],ae+=8;continue}for(;;){!ue&&Oe<ge+32767&&(fe=je(fe,ge+32767),Oe=fe.length);var He=xe(te,ae,Ke),nt=Ae>>>1==1?ft[He]:et[He];if(ae+=nt&15,nt>>>=4,!(nt>>>8&255))fe[ge++]=nt;else{if(nt==256)break;nt-=257;var lt=nt<8?0:nt-4>>2;lt>5&&(lt=0);var pt=ge+O[nt];lt>0&&(pt+=xe(te,ae,lt),ae+=lt),He=xe(te,ae,Ie),nt=Ae>>>1==1?Et[He]:ur[He],ae+=nt&15,nt>>>=4;var st=nt<4?0:nt-2>>1,dt=z[nt];for(st>0&&(dt+=xe(te,ae,st),ae+=st),!ue&&Oe<pt&&(fe=je(fe,pt+100),Oe=fe.length);ge<pt;)fe[ge]=fe[ge-dt],++ge}}}return ue?[fe,ae+7>>>3]:[fe.slice(0,ge),ae+7>>>3]}function nr(te,ue){var ae=te.slice(te.l||0),Ae=Rn(ae,ue);return te.l+=Ae[1],Ae[0]}function Ta(te,ue){if(te)typeof console<"u"&&console.error(ue);else throw new Error(ue)}function Nr(te,ue){var ae=te;ri(ae,0);var Ae=[],fe=[],ge={FileIndex:Ae,FullPaths:fe};_(ge,{root:ue.root});for(var Oe=ae.length-4;(ae[Oe]!=80||ae[Oe+1]!=75||ae[Oe+2]!=5||ae[Oe+3]!=6)&&Oe>=0;)--Oe;ae.l=Oe+4,ae.l+=4;var Ke=ae.read_shift(2);ae.l+=6;var Ie=ae.read_shift(4);for(ae.l=Ie,Oe=0;Oe<Ke;++Oe){ae.l+=20;var Re=ae.read_shift(4),He=ae.read_shift(4),nt=ae.read_shift(2),lt=ae.read_shift(2),pt=ae.read_shift(2);ae.l+=8;var st=ae.read_shift(4),dt=o(ae.slice(ae.l+nt,ae.l+nt+lt));ae.l+=nt+lt+pt;var Nt=ae.l;ae.l=st+4,Li(ae,Re,He,ge,dt),ae.l=Nt}return ge}function Li(te,ue,ae,Ae,fe){te.l+=2;var ge=te.read_shift(2),Oe=te.read_shift(2),Ke=s(te);if(ge&8257)throw new Error("Unsupported ZIP encryption");for(var Ie=te.read_shift(4),Re=te.read_shift(4),He=te.read_shift(4),nt=te.read_shift(2),lt=te.read_shift(2),pt="",st=0;st<nt;++st)pt+=String.fromCharCode(te[te.l++]);if(lt){var dt=o(te.slice(te.l,te.l+lt));(dt[21589]||{}).mt&&(Ke=dt[21589].mt),((fe||{})[21589]||{}).mt&&(Ke=fe[21589].mt)}te.l+=lt;var Nt=te.slice(te.l,te.l+Re);switch(Oe){case 8:Nt=U(te,He);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Oe)}var pr=!1;ge&8&&(Ie=te.read_shift(4),Ie==134695760&&(Ie=te.read_shift(4),pr=!0),Re=te.read_shift(4),He=te.read_shift(4)),Re!=ue&&Ta(pr,"Bad compressed size: "+ue+" != "+Re),He!=ae&&Ta(pr,"Bad uncompressed size: "+ae+" != "+He),Ct(Ae,pt,Nt,{unsafe:!0,mt:Ke})}function Aa(te,ue){var ae=ue||{},Ae=[],fe=[],ge=ze(1),Oe=ae.compression?8:0,Ke=0,Ie=0,Re=0,He=0,nt=0,lt=te.FullPaths[0],pt=lt,st=te.FileIndex[0],dt=[],Nt=0;for(Ie=1;Ie<te.FullPaths.length;++Ie)if(pt=te.FullPaths[Ie].slice(lt.length),st=te.FileIndex[Ie],!(!st.size||!st.content||pt=="Sh33tJ5")){var pr=He,Rt=ze(pt.length);for(Re=0;Re<pt.length;++Re)Rt.write_shift(1,pt.charCodeAt(Re)&127);Rt=Rt.slice(0,Rt.l),dt[nt]=fD.buf(st.content,0);var rn=st.content;Oe==8&&(rn=P(rn)),ge=ze(30),ge.write_shift(4,67324752),ge.write_shift(2,20),ge.write_shift(2,Ke),ge.write_shift(2,Oe),st.mt?a(ge,st.mt):ge.write_shift(4,0),ge.write_shift(-4,dt[nt]),ge.write_shift(4,rn.length),ge.write_shift(4,st.content.length),ge.write_shift(2,Rt.length),ge.write_shift(2,0),He+=ge.length,Ae.push(ge),He+=Rt.length,Ae.push(Rt),He+=rn.length,Ae.push(rn),ge=ze(46),ge.write_shift(4,33639248),ge.write_shift(2,0),ge.write_shift(2,20),ge.write_shift(2,Ke),ge.write_shift(2,Oe),ge.write_shift(4,0),ge.write_shift(-4,dt[nt]),ge.write_shift(4,rn.length),ge.write_shift(4,st.content.length),ge.write_shift(2,Rt.length),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(4,0),ge.write_shift(4,pr),Nt+=ge.l,fe.push(ge),Nt+=Rt.length,fe.push(Rt),++nt}return ge=ze(22),ge.write_shift(4,101010256),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(2,nt),ge.write_shift(2,nt),ge.write_shift(4,Nt),ge.write_shift(4,He),ge.write_shift(2,0),qn([qn(Ae),qn(fe),ge])}var vr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Pt(te,ue){if(te.ctype)return te.ctype;var ae=te.name||"",Ae=ae.match(/\.([^\.]+)$/);return Ae&&vr[Ae[1]]||ue&&(Ae=(ae=ue).match(/[\.\\]([^\.\\])+$/),Ae&&vr[Ae[1]])?vr[Ae[1]]:"application/octet-stream"}function ir(te){for(var ue=kd(te),ae=[],Ae=0;Ae<ue.length;Ae+=76)ae.push(ue.slice(Ae,Ae+76));return ae.join(`\r
`)+`\r
`}function ls(te){var ue=te.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Re){var He=Re.charCodeAt(0).toString(16).toUpperCase();return"="+(He.length==1?"0"+He:He)});ue=ue.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ue.charAt(0)==`
`&&(ue="=0D"+ue.slice(1)),ue=ue.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ae=[],Ae=ue.split(`\r
`),fe=0;fe<Ae.length;++fe){var ge=Ae[fe];if(ge.length==0){ae.push("");continue}for(var Oe=0;Oe<ge.length;){var Ke=76,Ie=ge.slice(Oe,Oe+Ke);Ie.charAt(Ke-1)=="="?Ke--:Ie.charAt(Ke-2)=="="?Ke-=2:Ie.charAt(Ke-3)=="="&&(Ke-=3),Ie=ge.slice(Oe,Oe+Ke),Oe+=Ke,Oe<ge.length&&(Ie+="="),ae.push(Ie)}}return ae.join(`\r
`)}function _e(te){for(var ue=[],ae=0;ae<te.length;++ae){for(var Ae=te[ae];ae<=te.length&&Ae.charAt(Ae.length-1)=="=";)Ae=Ae.slice(0,Ae.length-1)+te[++ae];ue.push(Ae)}for(var fe=0;fe<ue.length;++fe)ue[fe]=ue[fe].replace(/[=][0-9A-Fa-f]{2}/g,function(ge){return String.fromCharCode(parseInt(ge.slice(1),16))});return xa(ue.join(`\r
`))}function Ce(te,ue,ae){for(var Ae="",fe="",ge="",Oe,Ke=0;Ke<10;++Ke){var Ie=ue[Ke];if(!Ie||Ie.match(/^\s*$/))break;var Re=Ie.match(/^(.*?):\s*([^\s].*)$/);if(Re)switch(Re[1].toLowerCase()){case"content-location":Ae=Re[2].trim();break;case"content-type":ge=Re[2].trim();break;case"content-transfer-encoding":fe=Re[2].trim();break}}switch(++Ke,fe.toLowerCase()){case"base64":Oe=xa(Sa(ue.slice(Ke).join("")));break;case"quoted-printable":Oe=_e(ue.slice(Ke));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+fe)}var He=Ct(te,Ae.slice(ae.length),Oe,{unsafe:!0});ge&&(He.ctype=ge)}function De(te,ue){if(Q(te.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ae=ue&&ue.root||"",Ae=(Yt&&Buffer.isBuffer(te)?te.toString("binary"):Q(te)).split(`\r
`),fe=0,ge="";for(fe=0;fe<Ae.length;++fe)if(ge=Ae[fe],!!/^Content-Location:/i.test(ge)&&(ge=ge.slice(ge.indexOf("file")),ae||(ae=ge.slice(0,ge.lastIndexOf("/")+1)),ge.slice(0,ae.length)!=ae))for(;ae.length>0&&(ae=ae.slice(0,ae.length-1),ae=ae.slice(0,ae.lastIndexOf("/")+1),ge.slice(0,ae.length)!=ae););var Oe=(Ae[1]||"").match(/boundary="(.*?)"/);if(!Oe)throw new Error("MAD cannot find boundary");var Ke="--"+(Oe[1]||""),Ie=[],Re=[],He={FileIndex:Ie,FullPaths:Re};_(He);var nt,lt=0;for(fe=0;fe<Ae.length;++fe){var pt=Ae[fe];pt!==Ke&&pt!==Ke+"--"||(lt++&&Ce(He,Ae.slice(nt,fe),ae),nt=fe)}return He}function ye(te,ue){var ae=ue||{},Ae=ae.boundary||"SheetJS";Ae="------="+Ae;for(var fe=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Ae.slice(2)+'"',"","",""],ge=te.FullPaths[0],Oe=ge,Ke=te.FileIndex[0],Ie=1;Ie<te.FullPaths.length;++Ie)if(Oe=te.FullPaths[Ie].slice(ge.length),Ke=te.FileIndex[Ie],!(!Ke.size||!Ke.content||Oe=="Sh33tJ5")){Oe=Oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Nt){return"_x"+Nt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Nt){return"_u"+Nt.charCodeAt(0).toString(16)+"_"});for(var Re=Ke.content,He=Yt&&Buffer.isBuffer(Re)?Re.toString("binary"):Q(Re),nt=0,lt=Math.min(1024,He.length),pt=0,st=0;st<=lt;++st)(pt=He.charCodeAt(st))>=32&&pt<128&&++nt;var dt=nt>=lt*4/5;fe.push(Ae),fe.push("Content-Location: "+(ae.root||"file:///C:/SheetJS/")+Oe),fe.push("Content-Transfer-Encoding: "+(dt?"quoted-printable":"base64")),fe.push("Content-Type: "+Pt(Ke,Oe)),fe.push(""),fe.push(dt?ls(He):ir(He))}return fe.push(Ae+`--\r
`),fe.join(`\r
`)}function rt(te){var ue={};return _(ue,te),ue}function Ct(te,ue,ae,Ae){var fe=Ae&&Ae.unsafe;fe||_(te);var ge=!fe&&Lt.find(te,ue);if(!ge){var Oe=te.FullPaths[0];ue.slice(0,Oe.length)==Oe?Oe=ue:(Oe.slice(-1)!="/"&&(Oe+="/"),Oe=(Oe+ue).replace("//","/")),ge={name:i(ue),type:2},te.FileIndex.push(ge),te.FullPaths.push(Oe),fe||Lt.utils.cfb_gc(te)}return ge.content=ae,ge.size=ae?ae.length:0,Ae&&(Ae.CLSID&&(ge.clsid=Ae.CLSID),Ae.mt&&(ge.mt=Ae.mt),Ae.ct&&(ge.ct=Ae.ct)),ge}function St(te,ue){_(te);var ae=Lt.find(te,ue);if(ae){for(var Ae=0;Ae<te.FileIndex.length;++Ae)if(te.FileIndex[Ae]==ae)return te.FileIndex.splice(Ae,1),te.FullPaths.splice(Ae,1),!0}return!1}function kt(te,ue,ae){_(te);var Ae=Lt.find(te,ue);if(Ae){for(var fe=0;fe<te.FileIndex.length;++fe)if(te.FileIndex[fe]==Ae)return te.FileIndex[fe].name=i(ae),te.FullPaths[fe]=ae,!0}return!1}function Xt(te){T(te,!0)}return t.find=S,t.read=E,t.parse=u,t.write=K,t.writeFile=X,t.utils={cfb_new:rt,cfb_add:Ct,cfb_del:St,cfb_mov:kt,cfb_gc:Xt,ReadShift:Kh,CheckField:vF,prep_blob:ri,bconcat:qn,use_zlib:k,_deflateRaw:at,_inflateRaw:nr,consts:V},t}();function hD(e){return typeof e=="string"?o1(e):Array.isArray(e)?Qj(e):e}function i0(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=o1(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Zs(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([hD(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=a,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=cA(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function dD(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function cn(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function U4(e,t){for(var r=[],n=cn(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function A1(e){for(var t=[],r=cn(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function c1(e){for(var t=[],r=cn(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function pD(e){for(var t=[],r=cn(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var sm=new Date(1899,11,30,0,0,0);function Qn(e,t){var r=e.getTime(),n=sm.getTime()+(e.getTimezoneOffset()-sm.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Yk=new Date,gD=sm.getTime()+(Yk.getTimezoneOffset()-sm.getTimezoneOffset())*6e4,O4=Yk.getTimezoneOffset();function u1(e){var t=new Date;return t.setTime(e*24*60*60*1e3+gD),t.getTimezoneOffset()!==O4&&t.setTime(t.getTime()+(t.getTimezoneOffset()-O4)*6e4),t}function mD(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(r=1,a>3&&(n=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[a],10)}return t}var j4=new Date("2017-02-19T19:06:09.000Z"),Jk=isNaN(j4.getFullYear())?new Date("2/19/17"):j4,vD=Jk.getFullYear()==2017;function Kr(e,t){var r=new Date(e);if(vD)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Jk.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function ic(e,t){if(Yt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Zs(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Zs(Qk(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Zs(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Zs(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(a){return r[a]||a})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function Gr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Gr(e[r]));return t}function ln(e,t){for(var r="";r.length<t;)r+=e;return r}function Ns(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var xD=["january","february","march","april","may","june","july","august","september","october","november","december"];function qu(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&xD.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var yD=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),s=[a[0]],o=1;o<a.length;++o)s.push(i),s.push(a[o]);return s}}();function Zk(e){return e?e.content&&e.type?ic(e.content,!0):e.data?xh(e.data):e.asNodeBuffer&&Yt?xh(e.asNodeBuffer().toString("binary")):e.asBinary?xh(e.asBinary()):e._data&&e._data.getContent?xh(ic(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function eF(e){if(!e)return null;if(e.data)return _4(e.data);if(e.asNodeBuffer&&Yt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?_4(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function wD(e){return e&&e.name.slice(-4)===".bin"?eF(e):Zk(e)}function Ga(e,t){for(var r=e.FullPaths||cn(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var s=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||i==s)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function vb(e,t){var r=Ga(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function kn(e,t,r){if(!r)return wD(vb(e,t));if(!t)return null;try{return kn(e,t)}catch{return null}}function ya(e,t,r){if(!r)return Zk(vb(e,t));if(!t)return null;try{return ya(e,t)}catch{return null}}function bD(e,t,r){return eF(vb(e,t))}function D4(e){for(var t=e.FullPaths||cn(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function zt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Yt?n=Wo(r):n=Rj(r),Lt.utils.cfb_add(e,t,n)}Lt.utils.cfb_add(e,t,r)}else e.file(t,r)}function xb(){return Lt.utils.cfb_new()}function tF(e,t){switch(t.type){case"base64":return Lt.read(e,{type:"base64"});case"binary":return Lt.read(e,{type:"binary"});case"buffer":case"array":return Lt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function wh(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Bn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,BD=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,P4=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,_D=/<[^>]*>/g,Ti=Bn.match(P4)?P4:_D,CD=/<\w*:/,SD=/<(\/?)\w+:/;function Qt(e,t,r){for(var n={},i=0,a=0;i!==e.length&&!((a=e.charCodeAt(i))===32||a===10||a===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var s=e.match(BD),o=0,l="",A=0,u="",f="",h=1;if(s)for(A=0;A!=s.length;++A){for(f=s[A],a=0;a!=f.length&&f.charCodeAt(a)!==61;++a);for(u=f.slice(0,a).trim();f.charCodeAt(a+1)==32;)++a;for(h=(i=f.charCodeAt(a+1))==34||i==39?1:0,l=f.slice(a+1+h,f.length-h),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var d=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[d]&&u.slice(o-3,o)=="ext")continue;n[d]=l,n[d.toLowerCase()]=l}}return n}function so(e){return e.replace(SD,"<$1")}var rF={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},yb=A1(rF),Ar=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",a=i.indexOf("<![CDATA[");if(a==-1)return i.replace(e,function(o,l){return rF[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var s=i.indexOf("]]>");return r(i.slice(0,a))+i.slice(a+9,s)+r(i.slice(s+3))}}(),wb=/[&<>'"]/g,ED=/[\u0000-\u0008\u000b-\u001f]/g;function Br(e){var t=e+"";return t.replace(wb,function(r){return yb[r]}).replace(ED,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Q4(e){return Br(e).replace(/ /g,"_x0020_")}var nF=/[\u0000-\u001f]/g;function bb(e){var t=e+"";return t.replace(wb,function(r){return yb[r]}).replace(/\n/g,"<br/>").replace(nF,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function kD(e){var t=e+"";return t.replace(wb,function(r){return yb[r]}).replace(nF,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var R4=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function FD(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Rr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function nx(e){for(var t="",r=0,n=0,i=0,a=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=i&63,t+=String.fromCharCode(s);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(a&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function M4(e){var t=Jl(2*e.length),r,n,i=1,a=0,s=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[a++]=s&255,t[a++]=s>>>8,s=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function H4(e){return Wo(e,"binary").toString("utf8")}var Sp="foo bar bazâð£",Fr=Yt&&(H4(Sp)==nx(Sp)&&H4||M4(Sp)==nx(Sp)&&M4)||nx,Zs=Yt?function(e){return Wo(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Nd=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),iF=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),ND=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),TD=/<\/?(?:vt:)?variant>/g,LD=/<(?:vt:)([^>]*)>([\s\S]*)</;function K4(e,t){var r=Qt(e),n=e.match(ND(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(a){var s=a.replace(TD,"").match(LD);s&&i.push({v:Fr(s[2]),t:s[1]})}),i}var aF=/(^\s|\s$|\n)/;function ni(e,t){return"<"+e+(t.match(aF)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Td(e){return cn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function At(e,t,r){return"<"+e+(r!=null?Td(r):"")+(t!=null?(t.match(aF)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function oy(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function ID(e,t){switch(typeof e){case"string":var r=At("vt:lpwstr",Br(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return At((e|0)==e?"vt:i4":"vt:r8",Br(String(e)));case"boolean":return At("vt:bool",e?"true":"false")}if(e instanceof Date)return At("vt:filetime",oy(e));throw new Error("Unable to serialize "+e)}function Bb(e){if(Yt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Fr(cA(pb(e)));throw new Error("Bad input format: expected Buffer or string")}var Ld=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,jn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},hc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ma={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function UD(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,a=5;a>=0;--a)i=i*256+e[t+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function OD(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,s=n?-t:t;isFinite(s)?s==0?i=a=0:(i=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(i&15)<<4|a&15,e[r+7]=i>>4|n}var G4=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,a=e[0][n].length;i<a;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},V4=Yt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Wo(t)})):G4(e)}:G4,W4=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Io(e,i)));return n.join("").replace(Mi,"")},_b=Yt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Mi,""):W4(e,t,r)}:W4,$4=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},sF=Yt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):$4(e,t,r)}:$4,q4=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(cu(e,i)));return n.join("")},a0=Yt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):q4(t,r,n)}:q4,oF=function(e,t){var r=va(e,t);return r>0?a0(e,t+4,t+4+r-1):""},lF=oF,AF=function(e,t){var r=va(e,t);return r>0?a0(e,t+4,t+4+r-1):""},cF=AF,uF=function(e,t){var r=2*va(e,t);return r>0?a0(e,t+4,t+4+r-1):""},fF=uF,hF=function(t,r){var n=va(t,r);return n>0?_b(t,r+4,r+4+n):""},dF=hF,pF=function(e,t){var r=va(e,t);return r>0?a0(e,t+4,t+4+r):""},gF=pF,mF=function(e,t){return UD(e,t)},om=mF,Cb=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Yt&&(lF=function(t,r){if(!Buffer.isBuffer(t))return oF(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},cF=function(t,r){if(!Buffer.isBuffer(t))return AF(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},fF=function(t,r){if(!Buffer.isBuffer(t))return uF(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},dF=function(t,r){if(!Buffer.isBuffer(t))return hF(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},gF=function(t,r){if(!Buffer.isBuffer(t))return pF(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},om=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):mF(t,r)},Cb=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var cu=function(e,t){return e[t]},Io=function(e,t){return e[t+1]*256+e[t]},jD=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},va=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},TA=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},DD=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Kh(e,t){var r="",n,i,a=[],s,o,l,A;switch(t){case"dbcs":if(A=this.l,Yt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Io(this,A)),A+=2;e*=2;break;case"utf8":r=a0(this,this.l,this.l+e);break;case"utf16le":e*=2,r=_b(this,this.l,this.l+e);break;case"wstr":return Kh.call(this,e,"dbcs");case"lpstr-ansi":r=lF(this,this.l),e=4+va(this,this.l);break;case"lpstr-cp":r=cF(this,this.l),e=4+va(this,this.l);break;case"lpwstr":r=fF(this,this.l),e=4+2*va(this,this.l);break;case"lpp4":e=4+va(this,this.l),r=dF(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+va(this,this.l),r=gF(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=cu(this,this.l+e++))!==0;)a.push(Cp(s));r=a.join("");break;case"_wstr":for(e=0,r="";(s=Io(this,this.l+e))!==0;)a.push(Cp(s)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",A=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(A)!==-1)return s=cu(this,A),this.l=A+1,o=Kh.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Cp(Io(this,A))),A+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",A=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(A)!==-1)return s=cu(this,A),this.l=A+1,o=Kh.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Cp(cu(this,A))),A+=1}r=a.join("");break;default:switch(e){case 1:return n=cu(this,this.l),this.l++,n;case 2:return n=(t==="i"?jD:Io)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?TA:DD)(this,this.l),this.l+=4,n):(i=va(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=om(this,this.l):i=om([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=sF(this,this.l,e);break}}return this.l+=e,r}var PD=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},QD=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},RD=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function MD(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)RD(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var s=t.charCodeAt(i);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,PD(this,t,this.l);break;case 8:if(n=8,r==="f"){OD(this,t,this.l);break}case 16:break;case-4:n=4,QD(this,t,this.l);break}return this.l+=n,this}function vF(e,t){var r=sF(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ri(e,t){e.l=t,e.read_shift=Kh,e.chk=vF,e.write_shift=MD}function Ni(e,t){e.l+=t}function ze(e){var t=Jl(e);return ri(t,0),t}function $o(e,t,r){if(e){var n,i,a;ri(e,e.l||0);for(var s=e.length,o=0,l=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var A=Pd[o]||Pd[65535];for(n=e.read_shift(1),a=n&127,i=1;i<4&&n&128;++i)a+=((n=e.read_shift(1))&127)<<7*i;l=e.l+a;var u=A.f&&A.f(e,a,r);if(e.l=l,t(u,A,o))return}}}function sa(){var e=[],t=Yt?256:2048,r=function(A){var u=ze(A);return ri(u,0),u},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(A){return n&&A<n.length-n.l?n:(i(),n=r(Math.max(A+1,t)))},s=function(){return i(),qn(e)},o=function(A){i(),n=A,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:s,_bufs:e}}function Ze(e,t,r,n){var i=+t,a;if(!isNaN(i)){n||(n=Pd[i].p||(r||[]).length||0),a=1+(i>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var s=e.next(a);i<=127?s.write_shift(1,i):(s.write_shift(1,(i&127)+128),s.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&Cb(r)&&e.push(r)}}function Gh(e,t,r){var n=Gr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function z4(e,t,r){var n=Gr(e);return n.s=Gh(n.s,t.s,r),n.e=Gh(n.e,t.s,r),n}function Vh(e,t){if(e.cRel&&e.c<0)for(e=Gr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Gr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Dt(e);return!e.cRel&&e.cRel!=null&&(r=GD(r)),!e.rRel&&e.rRel!=null&&(r=HD(r)),r}function ix(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Xr(e.s.c)+":"+(e.e.cRel?"":"$")+Xr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+bn(e.s.r)+":"+(e.e.rRel?"":"$")+bn(e.e.r):Vh(e.s,t.biff)+":"+Vh(e.e,t.biff)}function Sb(e){return parseInt(KD(e),10)-1}function bn(e){return""+(e+1)}function HD(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function KD(e){return e.replace(/\$(\d+)$/,"$1")}function Eb(e){for(var t=VD(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Xr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function GD(e){return e.replace(/^([A-Z])/,"$$$1")}function VD(e){return e.replace(/^\$([A-Z])/,"$1")}function WD(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Yr(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Dt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function oa(e){var t=e.indexOf(":");return t==-1?{s:Yr(e),e:Yr(e)}:{s:Yr(e.slice(0,t)),e:Yr(e.slice(t+1))}}function qt(e,t){return typeof t>"u"||typeof t=="number"?qt(e.s,e.e):(typeof e!="string"&&(e=Dt(e)),typeof t!="string"&&(t=Dt(t)),e==t?e:e+":"+t)}function cr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=e.length;for(r=0;n<a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===a||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function X4(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ss(e.z,r?Qn(t):t)}catch{}try{return e.w=ss((e.XF||{}).numFmtId||(r?14:0),r?Qn(t):t)}catch{return""+t}}function Ko(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?qo[e.v]||e.v:t==null?X4(e,e.v):X4(e,t))}function uA(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function xF(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,a=e||(i?[]:{}),s=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?Yr(n.origin):n.origin;s=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var A={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var u=cr(a["!ref"]);A.s.c=u.s.c,A.s.r=u.s.r,A.e.c=Math.max(A.e.c,u.e.c),A.e.r=Math.max(A.e.r,u.e.r),s==-1&&(A.e.r=s=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var d={v:t[f][h]},m=s+f,g=o+h;if(A.s.r>m&&(A.s.r=m),A.s.c>g&&(A.s.c=g),A.e.r<m&&(A.e.r=m),A.e.c<g&&(A.e.c=g),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))d=t[f][h];else if(Array.isArray(d.v)&&(d.f=t[f][h][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||Ot[14],n.cellDates?(d.t="d",d.w=ss(d.z,Qn(d.v))):(d.t="n",d.v=Qn(d.v),d.w=ss(d.z,d.v))):d.t="s";if(i)a[m]||(a[m]=[]),a[m][g]&&a[m][g].z&&(d.z=a[m][g].z),a[m][g]=d;else{var x=Dt({c:g,r:m});a[x]&&a[x].z&&(d.z=a[x].z),a[x]=d}}}return A.s.c<1e7&&(a["!ref"]=qt(A)),a}function lf(e,t){return xF(null,e,t)}function $D(e){return e.read_shift(4,"i")}function Ts(e,t){return t||(t=ze(4)),t.write_shift(4,e),t}function Ei(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function zn(e,t){var r=!1;return t==null&&(r=!0,t=ze(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function qD(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function zD(e,t){return t||(t=ze(4)),t.write_shift(2,0),t.write_shift(2,0),t}function kb(e,t){var r=e.l,n=e.read_shift(1),i=Ei(e),a=[],s={t:i,h:i};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)a.push(qD(e));s.r=a}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function XD(e,t){var r=!1;return t==null&&(r=!0,t=ze(15+4*e.t.length)),t.write_shift(1,0),zn(e.t,t),r?t.slice(0,t.l):t}var YD=kb;function JD(e,t){var r=!1;return t==null&&(r=!0,t=ze(23+4*e.t.length)),t.write_shift(1,1),zn(e.t,t),t.write_shift(4,1),zD({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function os(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function dc(e,t){return t==null&&(t=ze(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function pc(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function gc(e,t){return t==null&&(t=ze(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var ZD=Ei,yF=zn;function Fb(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function lm(e,t){var r=!1;return t==null&&(r=!0,t=ze(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var eP=Ei,ly=Fb,Nb=lm;function Tb(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?om([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):TA(t,0)>>2;return r?i/100:i}function wF(e,t){t==null&&(t=ze(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function bF(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function tP(e,t){return t||(t=ze(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var mc=bF,Af=tP;function Ci(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ac(e,t){return(t||ze(8)).write_shift(8,e,"f")}function rP(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var A=HA[i];A&&(t.rgb=Ud(A));break;case 2:t.rgb=Ud([s,o,l]);break;case 3:t.theme=i;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function Am(e,t){if(t||(t=ze(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function nP(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function iP(e,t){t||(t=ze(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function BF(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function aP(e){return BF(e,1)}function sP(e){return BF(e,2)}var Lb=2,Ji=3,Ep=11,Y4=12,cm=19,kp=64,oP=65,lP=71,AP=4108,cP=4126,Wn=80,_F=81,uP=[Wn,_F],Ay={1:{n:"CodePage",t:Lb},2:{n:"Category",t:Wn},3:{n:"PresentationFormat",t:Wn},4:{n:"ByteCount",t:Ji},5:{n:"LineCount",t:Ji},6:{n:"ParagraphCount",t:Ji},7:{n:"SlideCount",t:Ji},8:{n:"NoteCount",t:Ji},9:{n:"HiddenCount",t:Ji},10:{n:"MultimediaClipCount",t:Ji},11:{n:"ScaleCrop",t:Ep},12:{n:"HeadingPairs",t:AP},13:{n:"TitlesOfParts",t:cP},14:{n:"Manager",t:Wn},15:{n:"Company",t:Wn},16:{n:"LinksUpToDate",t:Ep},17:{n:"CharacterCount",t:Ji},19:{n:"SharedDoc",t:Ep},22:{n:"HyperlinksChanged",t:Ep},23:{n:"AppVersion",t:Ji,p:"version"},24:{n:"DigSig",t:oP},26:{n:"ContentType",t:Wn},27:{n:"ContentStatus",t:Wn},28:{n:"Language",t:Wn},29:{n:"Version",t:Wn},255:{},2147483648:{n:"Locale",t:cm},2147483651:{n:"Behavior",t:cm},1919054434:{}},cy={1:{n:"CodePage",t:Lb},2:{n:"Title",t:Wn},3:{n:"Subject",t:Wn},4:{n:"Author",t:Wn},5:{n:"Keywords",t:Wn},6:{n:"Comments",t:Wn},7:{n:"Template",t:Wn},8:{n:"LastAuthor",t:Wn},9:{n:"RevNumber",t:Wn},10:{n:"EditTime",t:kp},11:{n:"LastPrinted",t:kp},12:{n:"CreatedDate",t:kp},13:{n:"ModifiedDate",t:kp},14:{n:"PageCount",t:Ji},15:{n:"WordCount",t:Ji},16:{n:"CharCount",t:Ji},17:{n:"Thumbnail",t:lP},18:{n:"Application",t:Wn},19:{n:"DocSecurity",t:Ji},255:{},2147483648:{n:"Locale",t:cm},2147483651:{n:"Behavior",t:cm},1919054434:{}},J4={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},fP=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function hP(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var dP=hP([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),HA=Gr(dP),qo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},CF={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},uy={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Fp={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Ib(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function pP(e){var t=Ib();if(!e||!e.match)return t;var r={};if((e.match(Ti)||[]).forEach(function(n){var i=Qt(n);switch(i[0].replace(CD,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[uy[i.ContentType]]!==void 0&&t[uy[i.ContentType]].push(i.PartName);break}}),t.xmlns!==jn.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function SF(e,t){var r=pD(uy),n=[],i;n[n.length]=Bn,n[n.length]=At("Types",null,{xmlns:jn.CT,"xmlns:xsd":jn.xsd,"xmlns:xsi":jn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return At("Default",null,{Extension:l[0],ContentType:l[1]})}));var a=function(l){e[l]&&e[l].length>0&&(i=e[l][0],n[n.length]=At("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Fp[l][t.bookType]||Fp[l].xlsx}))},s=function(l){(e[l]||[]).forEach(function(A){n[n.length]=At("Override",null,{PartName:(A[0]=="/"?"":"/")+A,ContentType:Fp[l][t.bookType]||Fp[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(A){n[n.length]=At("Override",null,{PartName:(A[0]=="/"?"":"/")+A,ContentType:r[l][0]})})};return a("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Jt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Id(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Wh(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Ti)||[]).forEach(function(i){var a=Qt(i);if(a[0]==="<Relationship"){var s={};s.Type=a.Type,s.Target=a.Target,s.Id=a.Id,a.TargetMode&&(s.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:wh(a.Target,t);r[o]=s,n[a.Id]=s}}),r["!id"]=n,r}function ju(e){var t=[Bn,At("Relationships",null,{xmlns:jn.RELS})];return cn(e["!id"]).forEach(function(r){t[t.length]=At("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function br(e,t,r,n,i,a){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[Jt.HLINK,Jt.XPATH,Jt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var gP="application/vnd.oasis.opendocument.spreadsheet";function mP(e,t){for(var r=Bb(e),n,i;n=Ld.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Qt(n[0],!1),i.path=="/"&&i.type!==gP)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function vP(e){var t=[Bn];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Z4(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function xP(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function yP(e){var t=[Bn];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Z4(e[r][0],e[r][1])),t.push(xP("",e[r][0]));return t.push(Z4("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function EF(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+rm.version+"</meta:generator></office:meta></office:document-meta>"}var rs=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],wP=function(){for(var e=new Array(rs.length),t=0;t<rs.length;++t){var r=rs[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function kF(e){var t={};e=Fr(e);for(var r=0;r<rs.length;++r){var n=rs[r],i=e.match(wP[r]);i!=null&&i.length>0&&(t[n[1]]=Ar(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Kr(t[n[1]]))}return t}function ax(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Br(t),n[n.length]=r?At(e,t,r):ni(e,t))}function FF(e,t){var r=t||{},n=[Bn,At("cp:coreProperties",null,{"xmlns:cp":jn.CORE_PROPS,"xmlns:dc":jn.dc,"xmlns:dcterms":jn.dcterms,"xmlns:dcmitype":jn.dcmitype,"xmlns:xsi":jn.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&ax("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:oy(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&ax("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:oy(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var a=0;a!=rs.length;++a){var s=rs[a],o=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&ax(s[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var KA=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],NF=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function TF(e,t,r,n){var i=[];if(typeof e=="string")i=K4(e,n);else for(var a=0;a<e.length;++a)i=i.concat(e[a].map(function(u){return{v:u}}));var s=typeof t=="string"?K4(t,n).map(function(u){return u.v}):t,o=0,l=0;if(s.length>0)for(var A=0;A!==i.length;A+=2){switch(l=+i[A+1].v,i[A].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=s.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=s.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=s.slice(o,o+l);break}o+=l}}function bP(e,t,r){var n={};return t||(t={}),e=Fr(e),KA.forEach(function(i){var a=(e.match(Nd(i[0]))||[])[1];switch(i[2]){case"string":a&&(t[i[1]]=Ar(a));break;case"bool":t[i[1]]=a==="true";break;case"raw":var s=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));s&&s.length>0&&(n[i[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&TF(n.HeadingPairs,n.TitlesOfParts,t,r),t}function LF(e){var t=[],r=At;return e||(e={}),e.Application="SheetJS",t[t.length]=Bn,t[t.length]=At("Properties",null,{xmlns:jn.EXT_PROPS,"xmlns:vt":jn.vt}),KA.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Br(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Br(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var BP=/<[^>]+>[^<]*/g;function _P(e,t){var r={},n="",i=e.match(BP);if(i)for(var a=0;a!=i.length;++a){var s=i[a],o=Qt(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ar(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var l=s.split(">"),A=l[0].slice(4),u=l[1];switch(A){case"lpstr":case"bstr":case"lpwstr":r[n]=Ar(u);break;case"bool":r[n]=Rr(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=Kr(u);break;case"cy":case"error":r[n]=Ar(u);break;default:if(A.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,A,l)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}function IF(e){var t=[Bn,At("Properties",null,{xmlns:jn.CUST_PROPS,"xmlns:vt":jn.vt})];if(!e)return t.join("");var r=1;return cn(e).forEach(function(i){++r,t[t.length]=At("property",ID(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Br(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var fy={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},sx;function CP(e,t,r){sx||(sx=A1(fy)),t=sx[t]||t,e[t]=r}function SP(e,t){var r=[];return cn(fy).map(function(n){for(var i=0;i<rs.length;++i)if(rs[i][1]==n)return rs[i];for(i=0;i<KA.length;++i)if(KA[i][1]==n)return KA[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(ni(fy[n[1]]||n[1],i))}}),At("DocumentProperties",r.join(""),{xmlns:ma.o})}function EP(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&cn(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var s=0;s<rs.length;++s)if(a==rs[s][1])return;for(s=0;s<KA.length;++s)if(a==KA[s][1])return;for(s=0;s<r.length;++s)if(a==r[s])return;var o=e[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(At(Q4(a),o,{"dt:dt":l}))}}),t&&cn(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var s=t[a],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),i.push(At(Q4(a),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+ma.o+'">'+i.join("")+"</"+n+">"}function Ub(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function kP(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),i+=a);var s=ze(8);return s.write_shift(4,n),s.write_shift(4,i),s}function UF(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function OF(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function jF(e,t,r){return t===31?OF(e):UF(e,t,r)}function hy(e,t,r){return jF(e,t,r===!1?0:4)}function FP(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return jF(e,t,0)}function NP(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Mi,""),e.l-i&2&&(e.l+=2)}return r}function TP(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Mi,"");return r}function LP(e){var t=e.l,r=um(e,_F);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=um(e,Ji);return[r,n]}function IP(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(LP(e));return r}function e_(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var a=e.read_shift(4),s=e.read_shift(4);n[a]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(Mi,"").replace(yh,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function DF(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function UP(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function um(e,t,r){var n=e.read_shift(2),i,a=r||{};if(e.l+=2,t!==Y4&&n!==t&&uP.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Y4?n:t){case 2:return i=e.read_shift(2,"i"),a.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return UF(e,n,4).replace(Mi,"");case 31:return OF(e);case 64:return Ub(e);case 65:return DF(e);case 71:return UP(e);case 80:return hy(e,n,!a.raw).replace(Mi,"");case 81:return FP(e,n).replace(Mi,"");case 4108:return IP(e);case 4126:case 4127:return n==4127?NP(e):TP(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function t_(e,t){var r=ze(4),n=ze(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=ze(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=kP(t);break;case 31:case 80:for(n=ze(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return qn([r,n])}function r_(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),a=[],s=0,o=0,l=-1,A={};for(s=0;s!=i;++s){var u=e.read_shift(4),f=e.read_shift(4);a[s]=[u,f+r]}a.sort(function(v,y){return v[1]-y[1]});var h={};for(s=0;s!=i;++s){if(e.l!==a[s][1]){var d=!0;if(s>0&&t)switch(t[a[s-1][0]].t){case 2:e.l+2===a[s][1]&&(e.l+=2,d=!1);break;case 80:e.l<=a[s][1]&&(e.l=a[s][1],d=!1);break;case 4108:e.l<=a[s][1]&&(e.l=a[s][1],d=!1);break}if((!t||s==0)&&e.l<=a[s][1]&&(d=!1,e.l=a[s][1]),d)throw new Error("Read Error: Expected address "+a[s][1]+" at "+e.l+" :"+s)}if(t){var m=t[a[s][0]];if(h[m.n]=um(e,m.t,{raw:!0}),m.p==="version"&&(h[m.n]=String(h[m.n]>>16)+"."+("0000"+String(h[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(h[m.n]){case 0:h[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ss(o=h[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[m.n])}}else if(a[s][0]===1){if(o=h.CodePage=um(e,Lb),Ss(o),l!==-1){var g=e.l;e.l=a[l][1],A=e_(e,o),e.l=g}}else if(a[s][0]===0){if(o===0){l=s,e.l=a[s+1][1];continue}A=e_(e,o)}else{var x=A[a[s][0]],p;switch(e[e.l]){case 65:e.l+=4,p=DF(e);break;case 30:e.l+=4,p=hy(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,p=hy(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,p=e.read_shift(4,"i");break;case 19:e.l+=4,p=e.read_shift(4);break;case 5:e.l+=4,p=e.read_shift(8,"f");break;case 11:e.l+=4,p=pn(e,4);break;case 64:e.l+=4,p=Kr(Ub(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[x]=p}}return e.l=r+n,h}var PF=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function OP(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function n_(e,t,r){var n=ze(8),i=[],a=[],s=8,o=0,l=ze(8),A=ze(8);if(l.write_shift(4,2),l.write_shift(4,1200),A.write_shift(4,1),a.push(l),i.push(A),s+=8+l.length,!t){A=ze(8),A.write_shift(4,0),i.unshift(A);var u=[ze(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(l=ze(8+2*(f.length+1)+(f.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,f.length+1),l.write_shift(0,f,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=qn(u),a.unshift(l),s+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(PF.indexOf(e[o][0])>-1||NF.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],d=0;if(t){d=+t[e[o][0]];var m=r[d];if(m.p=="version"&&typeof h=="string"){var g=h.split(".");h=(+g[0]<<16)+(+g[1]||0)}l=t_(m.t,h)}else{var x=OP(h);x==-1&&(x=31,h=String(h)),l=t_(x,h)}a.push(l),A=ze(8),A.write_shift(4,t?d:2+o),i.push(A),s+=8+l.length}var p=8*(a.length+1);for(o=0;o<a.length;++o)i[o].write_shift(4,p),p+=a[o].length;return n.write_shift(4,s),n.write_shift(4,a.length),qn([n].concat(i).concat(a))}function i_(e,t,r){var n=e.content;if(!n)return{};ri(n,0);var i,a,s,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var A=n.read_shift(4),u=n.read_shift(16);if(u!==Lt.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(a=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(s=n.read_shift(16),l=n.read_shift(4));var f=r_(n,t),h={SystemIdentifier:A};for(var d in f)h[d]=f[d];if(h.FMTID=a,i===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var m;try{m=r_(n,null)}catch{}for(d in m)h[d]=m[d];return h.FMTID=[a,s],h}function a_(e,t,r,n,i,a){var s=ze(i?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,Lt.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,i?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,i?68:48);var l=n_(e,r,n);if(o.push(l),i){var A=n_(i,null,null);s.write_shift(16,a,"hex"),s.write_shift(4,68+l.length),o.push(A)}return qn(o)}function ul(e,t){return e.read_shift(t),null}function jP(e,t){t||(t=ze(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function DP(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function pn(e,t){return e.read_shift(t)===1}function Qi(e,t){return t||(t=ze(2)),t.write_shift(2,+!!e),t}function Fn(e){return e.read_shift(2,"u")}function Wa(e,t){return t||(t=ze(2)),t.write_shift(2,e),t}function QF(e,t){return DP(e,t,Fn)}function PP(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function RF(e,t,r){return r||(r=ze(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function s0(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var s=n?e.read_shift(n,i):"";return s}function QP(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,a=1+(r&1),s=0,o,l={};i&&(s=e.read_shift(2)),n&&(o=e.read_shift(4));var A=a==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,A);return i&&(e.l+=4*s),n&&(e.l+=o),l.t=u,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function RP(e){var t=e.t||"",r=ze(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=ze(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return qn(i)}function sc(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function o0(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):sc(e,n,r)}function vc(e,t,r){if(r.biff>5)return o0(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function MF(e,t,r){return r||(r=ze(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function MP(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function HP(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Mi,"");return n&&(e.l+=24),i}function KP(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(a>>1,"utf16le").replace(Mi,"");return r+s}function GP(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return HP(e);case"0303000000000000c000000000000046":return KP(e);default:throw new Error("Unsupported Moniker "+r)}}function Np(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Mi,""):"";return r}function s_(e,t){t||(t=ze(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function VP(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var a,s,o,l,A="",u,f;i&16&&(a=Np(e,r-e.l)),i&128&&(s=Np(e,r-e.l)),(i&257)===257&&(o=Np(e,r-e.l)),(i&257)===1&&(l=GP(e,r-e.l)),i&8&&(A=Np(e,r-e.l)),i&32&&(u=e.read_shift(16)),i&64&&(f=Ub(e)),e.l=r;var h=s||o||l||"";h&&A&&(h+="#"+A),h||(h="#"+A),i&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var d={Target:h};return u&&(d.guid=u),f&&(d.time=f),a&&(d.Tooltip=a),d}function WP(e){var t=ze(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),a=i>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(a==28)n=n.slice(1),s_(n,t);else if(a&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var o=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),a&8&&s_(i>-1?n.slice(i+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function HF(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function KF(e,t){var r=HF(e);return r[3]=0,r}function oo(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function oc(e,t,r,n){return n||(n=ze(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function $P(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function qP(e,t,r){return t===0?"":vc(e,t,r)}function zP(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),a=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[i,a,s]}function GF(e){var t=e.read_shift(2),r=Tb(e);return[t,r]}function XP(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=s0(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,i}function f1(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function VF(e,t){return t||(t=ze(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function WF(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var YP=WF;function $F(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function JP(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function ZP(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function fi(e){e.l+=2,e.l+=e.read_shift(2)}var eQ={0:fi,4:fi,5:fi,6:fi,7:ZP,8:fi,9:fi,10:fi,11:fi,12:fi,13:JP,14:fi,15:fi,16:fi,17:fi,18:fi,19:fi,20:fi,21:$F};function tQ(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(eQ[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Tp(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Ob(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=ze(i);return a.write_shift(2,n),a.write_shift(2,t),i>4&&a.write_shift(2,29282),i>6&&a.write_shift(2,1997),i>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function rQ(e,t){return t===0||e.read_shift(2),1200}function nQ(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=vc(e,0,r);return e.read_shift(t+n-e.l),i}function iQ(e,t){var r=!t||t.biff==8,n=ze(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function aQ(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function sQ(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var s=s0(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:i,dt:a,name:s}}function oQ(e,t){var r=!t||t.biff>=8?2:1,n=ze(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function lQ(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),a=[],s=0;s!=i&&e.l<r;++s)a.push(QP(e));return a.Count=n,a.Unique=i,a}function AQ(e,t){var r=ze(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=RP(e[i]);var a=qn([r].concat(n));return a.parts=[r.length].concat(n.map(function(s){return s.length})),a}function cQ(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function uQ(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function fQ(e){var t=$P(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function hQ(e){return e.read_shift(2),e.read_shift(4)}function o_(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,i]}function dQ(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),A=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:a,CurTab:s,FirstTab:o,Selected:l,TabRatio:A}}function pQ(){var e=ze(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function gQ(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function mQ(e){var t=ze(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function vQ(){}function xQ(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=s0(e,0,r),n}function yQ(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,a=ze(i);return a.write_shift(2,(e.sz||12)*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function wQ(e){var t=oo(e);return t.isst=e.read_shift(4),t}function bQ(e,t,r,n){var i=ze(10);return oc(e,t,n,i),i.write_shift(4,r),i}function BQ(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=oo(e);r.biff==2&&e.l++;var a=o0(e,n-e.l,r);return i.val=a,i}function _Q(e,t,r,n,i){var a=!i||i.biff==8,s=ze(8+ +a+(1+a)*r.length);return oc(e,t,n,s),s.write_shift(2,r.length),a&&s.write_shift(1,1),s.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),s}function CQ(e,t,r){var n=e.read_shift(2),i=vc(e,0,r);return[n,i]}function SQ(e,t,r,n){var i=r&&r.biff==5;n||(n=ze(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var EQ=vc;function l_(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,a=e.read_shift(i),s=e.read_shift(i),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:s,c:l}}}function kQ(e,t){var r=t.biff==8||!t.biff?4:2,n=ze(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function FQ(e){var t=e.read_shift(2),r=e.read_shift(2),n=GF(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function NQ(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(GF(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(a.length!=s-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:s,rkrec:a}}function TQ(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(a.length!=s-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:s,ixfe:a}}function LQ(e,t,r,n){var i={},a=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return i.patternType=fP[o>>26],n.cellStyles&&(i.alc=a&7,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=s&15,i.dgRight=s>>4&15,i.dgTop=s>>8&15,i.dgBottom=s>>12&15,i.icvLeft=s>>16&127,i.icvRight=s>>23&127,i.grbitDiag=s>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function IQ(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=LQ(e,t,n.fStyle,r),n}function A_(e,t,r,n){var i=r&&r.biff==5;n||(n=ze(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&i&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function UQ(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function OQ(e){var t=ze(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function c_(e,t,r){var n=oo(e);(r.biff==2||t==9)&&++e.l;var i=PP(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function jQ(e,t,r,n,i,a){var s=ze(8);return oc(e,t,n,s),RF(r,a,s),s}function DQ(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=oo(e),i=Ci(e);return n.val=i,n}function PQ(e,t,r,n){var i=ze(14);return oc(e,t,n,i),ac(r,i),i}var u_=qP;function QQ(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var s=sc(e,a),o=[];n>e.l;)o.push(o0(e));return[a,i,s,o]}function f_(e,t,r){var n=e.read_shift(2),i,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=XP(e,t-2,r)),a.body=i||e.read_shift(t-2),typeof i=="string"&&(a.Name=i),a}var RQ=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function h_(e,t,r){var n=e.l+t,i=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var A=sc(e,s,r);i&32&&(A=RQ[A.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var f=n==e.l||o===0||!(u>0)?[]:t9(e,u,r,o);return{chKey:a,Name:A,itab:l,rgce:f}}function qF(e,t,r){if(r.biff<8)return MQ(e,t,r);for(var n=[],i=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(zP(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function MQ(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=s0(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function HQ(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),a=sc(e,n,r),s=sc(e,i,r);return[a,s]}function KQ(e,t,r){var n=WF(e);e.l++;var i=e.read_shift(1);return t-=8,[r9(e,t,r),i,n]}function d_(e,t,r){var n=YP(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,ZH(e,t,r)]}function GQ(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function VQ(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=vc(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},o,s,a]}}function WQ(e,t,r){return VQ(e,t,r)}function $Q(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(f1(e));return r}function qQ(e){var t=ze(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)VF(e[r],t);return t}function zQ(e,t,r){if(r&&r.biff<8)return YQ(e,t,r);var n=$F(e),i=tQ(e,t-22,n[1]);return{cmo:n,ft:i}}var XQ={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function YQ(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((XQ[n]||Ni)(e,t,r)),{cmo:[i,n,a],ft:s}}function JQ(e,t,r){var n=e.l,i="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:s=MP(e,6,r);var o=e.read_shift(2);e.read_shift(2),Fn(e,2);var l=e.read_shift(2);e.l+=l;for(var A=1;A<e.lens.length-1;++A){if(e.l-n!=e.lens[A])throw new Error("TxO: bad continue record");var u=e[e.l],f=sc(e,e.lens[A+1]-e.lens[A]-1);if(i+=f,i.length>=(u?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function ZQ(e,t){var r=f1(e);e.l+=16;var n=VP(e,t-24);return[r,n]}function e7(e){var t=ze(24),r=Yr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return qn([t,WP(e[1])])}function t7(e,t){e.read_shift(2);var r=f1(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Mi,""),[r,n]}function r7(e){var t=e[1].Tooltip,r=ze(10+2*(t.length+1));r.write_shift(2,2048);var n=Yr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function n7(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=J4[r]||r,r=e.read_shift(2),t[1]=J4[r]||r,t}function i7(e){return e||(e=ze(4)),e.write_shift(2,1),e.write_shift(2,1),e}function a7(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(KF(e));return r}function s7(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(KF(e));return r}function o7(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function zF(e,t,r){if(!r.cellStyles)return Ni(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),a=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var A={s:i,e:a,w:s,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(A.level=l>>8&7),A}function l7(e,t){var r=ze(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function A7(e,t){var r={};return t<32||(e.l+=16,r.header=Ci(e),r.footer=Ci(e),e.l+=2),r}function c7(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}function u7(e){for(var t=ze(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var f7=oo,h7=QF,d7=o0;function p7(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function g7(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=oo(e);++e.l;var i=vc(e,t-7,r);return n.t="str",n.val=i,n}function m7(e){var t=oo(e);++e.l;var r=Ci(e);return t.t="n",t.val=r,t}function v7(e,t,r){var n=ze(15);return u0(n,e,t),n.write_shift(8,r,"f"),n}function x7(e){var t=oo(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function y7(e,t,r){var n=ze(9);return u0(n,e,t),n.write_shift(2,r),n}function w7(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function b7(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function B7(e,t,r){var n=e.l+t,i=oo(e),a=e.read_shift(2),s=sc(e,a,r);return e.l=n,i.t="str",i.val=s,i}var _7=[2,3,48,49,131,139,140,245],dy=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=A1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var A=[],u=Jl(1);switch(l.type){case"base64":u=xa(Sa(o));break;case"binary":u=xa(o);break;case"buffer":case"array":u=o;break}ri(u,0);var f=u.read_shift(1),h=!!(f&136),d=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:d=!0,h=!0;break;case 49:d=!0,h=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var g=0,x=521;f==2&&(g=u.read_shift(2)),u.l+=3,f!=2&&(g=u.read_shift(4)),g>1048576&&(g=1e6),f!=2&&(x=u.read_shift(2));var p=u.read_shift(2),v=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(v=e[u[u.l]]),u.l+=1,u.l+=2),m&&(u.l+=36);for(var y=[],w={},B=Math.min(u.length,f==2?521:x-10-(d?264:0)),E=m?32:11;u.l<B&&u[u.l]!=13;)switch(w={},w.name=Cl.utils.decode(v,u.slice(u.l,u.l+E)).replace(/[\u0000\r\n].*$/g,""),u.l+=E,w.type=String.fromCharCode(u.read_shift(1)),f!=2&&!m&&(w.offset=u.read_shift(4)),w.len=u.read_shift(1),f==2&&(w.offset=u.read_shift(2)),w.dec=u.read_shift(1),w.name.length&&y.push(w),f!=2&&(u.l+=m?13:14),w.type){case"B":(!d||w.len!=8)&&l.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(u[u.l]!==13&&(u.l=x-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=x;var _=0,F=0;for(A[0]=[],F=0;F!=y.length;++F)A[0][F]=y[F].name;for(;g-- >0;){if(u[u.l]===42){u.l+=p;continue}for(++u.l,A[++_]=[],F=0,F=0;F!=y.length;++F){var T=u.slice(u.l,u.l+y[F].len);u.l+=y[F].len,ri(T,0);var I=Cl.utils.decode(v,T);switch(y[F].type){case"C":I.trim().length&&(A[_][F]=I.replace(/\s+$/,""));break;case"D":I.length===8?A[_][F]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):A[_][F]=I;break;case"F":A[_][F]=parseFloat(I.trim());break;case"+":case"I":A[_][F]=m?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":A[_][F]=!0;break;case"N":case"F":A[_][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));A[_][F]="##MEMO##"+(m?parseInt(I.trim(),10):T.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(A[_][F]=+I||0);break;case"@":A[_][F]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":A[_][F]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":A[_][F]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":A[_][F]=-T.read_shift(-8,"f");break;case"B":if(d&&y[F].len==8){A[_][F]=T.read_shift(8,"f");break}case"G":case"P":T.l+=y[F].len;break;case"0":if(y[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[F].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(A=A.slice(0,l.sheetRows)),l.DBF=y,A}function n(o,l){var A=l||{};A.dateNF||(A.dateNF="yyyymmdd");var u=lf(r(o,A),A);return u["!cols"]=A.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete A.DBF,u}function i(o,l){try{return uA(n(o,l),l)}catch(A){if(l&&l.WTF)throw A}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,l){var A=l||{};if(+A.codepage>=0&&Ss(+A.codepage),A.type=="string")throw new Error("Cannot write DBF to JS string");var u=sa(),f=pm(o,{header:1,raw:!0,cellDates:!0}),h=f[0],d=f.slice(1),m=o["!cols"]||[],g=0,x=0,p=0,v=1;for(g=0;g<h.length;++g){if(((m[g]||{}).DBF||{}).name){h[g]=m[g].DBF.name,++p;continue}if(h[g]!=null){if(++p,typeof h[g]=="number"&&(h[g]=h[g].toString(10)),typeof h[g]!="string")throw new Error("DBF Invalid column name "+h[g]+" |"+typeof h[g]+"|");if(h.indexOf(h[g])!==g){for(x=0;x<1024;++x)if(h.indexOf(h[g]+"_"+x)==-1){h[g]+="_"+x;break}}}}var y=cr(o["!ref"]),w=[],B=[],E=[];for(g=0;g<=y.e.c-y.s.c;++g){var _="",F="",T=0,I=[];for(x=0;x<d.length;++x)d[x][g]!=null&&I.push(d[x][g]);if(I.length==0||h[g]==null){w[g]="?";continue}for(x=0;x<I.length;++x){switch(typeof I[x]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=I[x]instanceof Date?"D":"C";break;default:F="C"}T=Math.max(T,String(I[x]).length),_=_&&_!=F?"C":F}T>250&&(T=250),F=((m[g]||{}).DBF||{}).type,F=="C"&&m[g].DBF.len>T&&(T=m[g].DBF.len),_=="B"&&F=="N"&&(_="N",E[g]=m[g].DBF.dec,T=m[g].DBF.len),B[g]=_=="C"||F=="N"?T:a[_]||0,v+=B[g],w[g]=_}var S=u.next(32);for(S.write_shift(4,318902576),S.write_shift(4,d.length),S.write_shift(2,296+32*p),S.write_shift(2,v),g=0;g<4;++g)S.write_shift(4,0);for(S.write_shift(4,0|(+t[Pk]||3)<<8),g=0,x=0;g<h.length;++g)if(h[g]!=null){var C=u.next(32),L=(h[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);C.write_shift(1,L,"sbcs"),C.write_shift(1,w[g]=="?"?"C":w[g],"sbcs"),C.write_shift(4,x),C.write_shift(1,B[g]||a[w[g]]||0),C.write_shift(1,E[g]||0),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(1,0),C.write_shift(4,0),C.write_shift(4,0),x+=B[g]||a[w[g]]||0}var R=u.next(264);for(R.write_shift(4,13),g=0;g<65;++g)R.write_shift(4,0);for(g=0;g<d.length;++g){var W=u.next(v);for(W.write_shift(1,0),x=0;x<h.length;++x)if(h[x]!=null)switch(w[x]){case"L":W.write_shift(1,d[g][x]==null?63:d[g][x]?84:70);break;case"B":W.write_shift(8,d[g][x]||0,"f");break;case"N":var G="0";for(typeof d[g][x]=="number"&&(G=d[g][x].toFixed(E[x]||0)),p=0;p<B[x]-G.length;++p)W.write_shift(1,32);W.write_shift(1,G,"sbcs");break;case"D":d[g][x]?(W.write_shift(4,("0000"+d[g][x].getFullYear()).slice(-4),"sbcs"),W.write_shift(2,("00"+(d[g][x].getMonth()+1)).slice(-2),"sbcs"),W.write_shift(2,("00"+d[g][x].getDate()).slice(-2),"sbcs")):W.write_shift(8,"00000000","sbcs");break;case"C":var V=String(d[g][x]!=null?d[g][x]:"").slice(0,B[x]);for(W.write_shift(1,V,"sbcs"),p=0;p<B[x]-V.length;++p)W.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:s}}(),XF=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+cn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,d){var m=e[d];return typeof m=="number"?C4(m):m},n=function(h,d,m){var g=d.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return g==59?h:C4(g)};e["|"]=254;function i(h,d){switch(d.type){case"base64":return a(Sa(h),d);case"binary":return a(h,d);case"buffer":return a(Yt&&Buffer.isBuffer(h)?h.toString("binary"):cA(h),d);case"array":return a(ic(h),d)}throw new Error("Unrecognized type "+d.type)}function a(h,d){var m=h.split(/[\n\r]+/),g=-1,x=-1,p=0,v=0,y=[],w=[],B=null,E={},_=[],F=[],T=[],I=0,S;for(+d.codepage>=0&&Ss(+d.codepage);p!==m.length;++p){I=0;var C=m[p].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),L=C.replace(/;;/g,"\0").split(";").map(function(D){return D.replace(/\u0000/g,";")}),R=L[0],W;if(C.length>0)switch(R){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":L[1].charAt(0)=="P"&&w.push(C.slice(3).replace(/;;/g,";"));break;case"C":var G=!1,V=!1,X=!1,Q=!1,K=-1,H=-1;for(v=1;v<L.length;++v)switch(L[v].charAt(0)){case"A":break;case"X":x=parseInt(L[v].slice(1))-1,V=!0;break;case"Y":for(g=parseInt(L[v].slice(1))-1,V||(x=0),S=y.length;S<=g;++S)y[S]=[];break;case"K":W=L[v].slice(1),W.charAt(0)==='"'?W=W.slice(1,W.length-1):W==="TRUE"?W=!0:W==="FALSE"?W=!1:isNaN(Ns(W))?isNaN(qu(W).getDate())||(W=Kr(W)):(W=Ns(W),B!==null&&sf(B)&&(W=u1(W))),G=!0;break;case"E":Q=!0;var k=Du(L[v].slice(1),{r:g,c:x});y[g][x]=[y[g][x],k];break;case"S":X=!0,y[g][x]=[y[g][x],"S5S"];break;case"G":break;case"R":K=parseInt(L[v].slice(1))-1;break;case"C":H=parseInt(L[v].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+C)}if(G&&(y[g][x]&&y[g][x].length==2?y[g][x][0]=W:y[g][x]=W,B=null),X){if(Q)throw new Error("SYLK shared formula cannot have own formula");var U=K>-1&&y[K][H];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");y[g][x][1]=dN(U[1],{r:g-K,c:x-H})}break;case"F":var P=0;for(v=1;v<L.length;++v)switch(L[v].charAt(0)){case"X":x=parseInt(L[v].slice(1))-1,++P;break;case"Y":for(g=parseInt(L[v].slice(1))-1,S=y.length;S<=g;++S)y[S]=[];break;case"M":I=parseInt(L[v].slice(1))/20;break;case"F":break;case"G":break;case"P":B=w[parseInt(L[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=L[v].slice(1).split(" "),S=parseInt(T[0],10);S<=parseInt(T[1],10);++S)I=parseInt(T[2],10),F[S-1]=I===0?{hidden:!0}:{wch:I},Zl(F[S-1]);break;case"C":x=parseInt(L[v].slice(1))-1,F[x]||(F[x]={});break;case"R":g=parseInt(L[v].slice(1))-1,_[g]||(_[g]={}),I>0?(_[g].hpt=I,_[g].hpx=Xu(I)):I===0&&(_[g].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+C)}P<1&&(B=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+C)}}return _.length>0&&(E["!rows"]=_),F.length>0&&(E["!cols"]=F),d&&d.sheetRows&&(y=y.slice(0,d.sheetRows)),[y,E]}function s(h,d){var m=i(h,d),g=m[0],x=m[1],p=lf(g,d);return cn(x).forEach(function(v){p[v]=x[v]}),p}function o(h,d){return uA(s(h,d),d)}function l(h,d,m,g){var x="C;Y"+(m+1)+";X"+(g+1)+";K";switch(h.t){case"n":x+=h.v||0,h.f&&!h.F&&(x+=";E"+Mb(h.f,{r:m,c:g}));break;case"b":x+=h.v?"TRUE":"FALSE";break;case"e":x+=h.w||h.v;break;case"d":x+='"'+(h.w||h.v)+'"';break;case"s":x+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function A(h,d){d.forEach(function(m,g){var x="F;W"+(g+1)+" "+(g+1)+" ";m.hidden?x+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=Od(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=jd(m.wpx)),typeof m.wch=="number"&&(x+=Math.round(m.wch))),x.charAt(x.length-1)!=" "&&h.push(x)})}function u(h,d){d.forEach(function(m,g){var x="F;";m.hidden?x+="M0;":m.hpt?x+="M"+20*m.hpt+";":m.hpx&&(x+="M"+20*Dd(m.hpx)+";"),x.length>2&&h.push(x+"R"+(g+1))})}function f(h,d){var m=["ID;PWXL;N;E"],g=[],x=cr(h["!ref"]),p,v=Array.isArray(h),y=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),h["!cols"]&&A(m,h["!cols"]),h["!rows"]&&u(m,h["!rows"]),m.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var w=x.s.r;w<=x.e.r;++w)for(var B=x.s.c;B<=x.e.c;++B){var E=Dt({r:w,c:B});p=v?(h[w]||[])[B]:h[E],!(!p||p.v==null&&(!p.f||p.F))&&g.push(l(p,h,w,B))}return m.join(y)+y+g.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:s,from_sheet:f}}(),YF=function(){function e(a,s){switch(s.type){case"base64":return t(Sa(a),s);case"binary":return t(a,s);case"buffer":return t(Yt&&Buffer.isBuffer(a)?a.toString("binary"):cA(a),s);case"array":return t(ic(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){for(var o=a.split(`
`),l=-1,A=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++l]=[],A=0;continue}if(!(l<0)){var h=o[u].trim().split(","),d=h[0],m=h[1];++u;for(var g=o[u]||"";(g.match(/["]/g)||[]).length&1&&u<o.length-1;)g+=`
`+o[++u];switch(g=g.trim(),+d){case-1:if(g==="BOT"){f[++l]=[],A=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?f[l][A]=!0:g==="FALSE"?f[l][A]=!1:isNaN(Ns(m))?isNaN(qu(m).getDate())?f[l][A]=m:f[l][A]=Kr(m):f[l][A]=Ns(m),++A;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),f[l][A++]=g!==""?g:null;break}if(g==="EOD")break}}return s&&s.sheetRows&&(f=f.slice(0,s.sheetRows)),f}function r(a,s){return lf(e(a,s),s)}function n(a,s){return uA(r(a,s),s)}var i=function(){var a=function(l,A,u,f,h){l.push(A),l.push(u+","+f),l.push('"'+h.replace(/"/g,'""')+'"')},s=function(l,A,u,f){l.push(A+","+u),l.push(A==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var A=[],u=cr(l["!ref"]),f,h=Array.isArray(l);a(A,"TABLE",0,1,"sheetjs"),a(A,"VECTORS",0,u.e.r-u.s.r+1,""),a(A,"TUPLES",0,u.e.c-u.s.c+1,""),a(A,"DATA",0,0,"");for(var d=u.s.r;d<=u.e.r;++d){s(A,-1,0,"BOT");for(var m=u.s.c;m<=u.e.c;++m){var g=Dt({r:d,c:m});if(f=h?(l[d]||[])[m]:l[g],!f){s(A,1,0,"");continue}switch(f.t){case"n":var x=f.w;!x&&f.v!=null&&(x=f.v),x==null?f.f&&!f.F?s(A,1,0,"="+f.f):s(A,1,0,""):s(A,0,x,"V");break;case"b":s(A,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":s(A,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=ss(f.z||Ot[14],Qn(Kr(f.v)))),s(A,0,f.w,"V");break;default:s(A,1,0,"")}}}s(A,-1,0,"EOD");var p=`\r
`,v=A.join(p);return v}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),JF=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var d=f.split(`
`),m=-1,g=-1,x=0,p=[];x!==d.length;++x){var v=d[x].trim().split(":");if(v[0]==="cell"){var y=Yr(v[1]);if(p.length<=y.r)for(m=p.length;m<=y.r;++m)p[m]||(p[m]=[]);switch(m=y.r,g=y.c,v[2]){case"t":p[m][g]=e(v[3]);break;case"v":p[m][g]=+v[3];break;case"vtf":var w=v[v.length-1];case"vtc":switch(v[3]){case"nl":p[m][g]=!!+v[4];break;default:p[m][g]=+v[4];break}v[2]=="vtf"&&(p[m][g]=[p[m][g],w])}}}return h&&h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}function n(f,h){return lf(r(f,h),h)}function i(f,h){return uA(n(f,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function A(f){if(!f||!f["!ref"])return"";for(var h=[],d=[],m,g="",x=oa(f["!ref"]),p=Array.isArray(f),v=x.s.r;v<=x.e.r;++v)for(var y=x.s.c;y<=x.e.c;++y)if(g=Dt({r:v,c:y}),m=p?(f[v]||[])[y]:f[g],!(!m||m.v==null||m.t==="z")){switch(d=["cell",g,"t"],m.t){case"s":case"str":d.push(t(m.v));break;case"n":m.f?(d[2]="vtf",d[3]="n",d[4]=m.v,d[5]=t(m.f)):(d[2]="v",d[3]=m.v);break;case"b":d[2]="vt"+(m.f?"f":"c"),d[3]="nl",d[4]=m.v?"1":"0",d[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var w=Qn(Kr(m.v));d[2]="vtc",d[3]="nd",d[4]=""+w,d[5]=m.w||ss(m.z||Ot[14],w);break;case"e":continue}h.push(d.join(":"))}return h.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[a,s,o,s,A(f),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),zu=function(){function e(u,f,h,d,m){m.raw?f[h][d]=u:u===""||(u==="TRUE"?f[h][d]=!0:u==="FALSE"?f[h][d]=!1:isNaN(Ns(u))?isNaN(qu(u).getDate())?f[h][d]=u:f[h][d]=Kr(u):f[h][d]=Ns(u))}function t(u,f){var h=f||{},d=[];if(!u||u.length===0)return d;for(var m=u.split(/[\r\n]/),g=m.length-1;g>=0&&m[g].length===0;)--g;for(var x=10,p=0,v=0;v<=g;++v)p=m[v].indexOf(" "),p==-1?p=m[v].length:p++,x=Math.max(x,p);for(v=0;v<=g;++v){d[v]=[];var y=0;for(e(m[v].slice(0,x).trim(),d,v,y,h),y=1;y<=(m[v].length-x)/10+1;++y)e(m[v].slice(x+(y-1)*10,x+y*10).trim(),d,v,y,h)}return h.sheetRows&&(d=d.slice(0,h.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var f={},h=!1,d=0,m=0;d<u.length;++d)(m=u.charCodeAt(d))==34?h=!h:!h&&m in r&&(f[m]=(f[m]||0)+1);m=[];for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&m.push([f[d],d]);if(!m.length){f=n;for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&m.push([f[d],d])}return m.sort(function(g,x){return g[0]-x[0]||n[g[1]]-n[x[1]]}),r[m.pop()[1]]||44}function a(u,f){var h=f||{},d="",m=h.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(d=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(d=u.charAt(4),u=u.slice(6)):d=i(u.slice(0,1024)):h&&h.FS?d=h.FS:d=i(u.slice(0,1024));var x=0,p=0,v=0,y=0,w=0,B=d.charCodeAt(0),E=!1,_=0,F=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var T=h.dateNF!=null?cD(h.dateNF):null;function I(){var S=u.slice(y,w),C={};if(S.charAt(0)=='"'&&S.charAt(S.length-1)=='"'&&(S=S.slice(1,-1).replace(/""/g,'"')),S.length===0)C.t="z";else if(h.raw)C.t="s",C.v=S;else if(S.trim().length===0)C.t="s",C.v=S;else if(S.charCodeAt(0)==61)S.charCodeAt(1)==34&&S.charCodeAt(S.length-1)==34?(C.t="s",C.v=S.slice(2,-1).replace(/""/g,'"')):QM(S)?(C.t="n",C.f=S.slice(1)):(C.t="s",C.v=S);else if(S=="TRUE")C.t="b",C.v=!0;else if(S=="FALSE")C.t="b",C.v=!1;else if(!isNaN(v=Ns(S)))C.t="n",h.cellText!==!1&&(C.w=S),C.v=v;else if(!isNaN(qu(S).getDate())||T&&S.match(T)){C.z=h.dateNF||Ot[14];var L=0;T&&S.match(T)&&(S=uD(S,h.dateNF,S.match(T)||[]),L=1),h.cellDates?(C.t="d",C.v=Kr(S,L)):(C.t="n",C.v=Qn(Kr(S,L))),h.cellText!==!1&&(C.w=ss(C.z,C.v instanceof Date?Qn(C.v):C.v)),h.cellNF||delete C.z}else C.t="s",C.v=S;if(C.t=="z"||(h.dense?(m[x]||(m[x]=[]),m[x][p]=C):m[Dt({c:p,r:x})]=C),y=w+1,F=u.charCodeAt(y),g.e.c<p&&(g.e.c=p),g.e.r<x&&(g.e.r=x),_==B)++p;else if(p=0,++x,h.sheetRows&&h.sheetRows<=x)return!0}e:for(;w<u.length;++w)switch(_=u.charCodeAt(w)){case 34:F===34&&(E=!E);break;case B:case 10:case 13:if(!E&&I())break e;break}return w-y>0&&I(),m["!ref"]=qt(g),m}function s(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?a(u,f):lf(t(u,f),f)}function o(u,f){var h="",d=f.type=="string"?[0,0,0,0]:zb(u,f);switch(f.type){case"base64":h=Sa(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof Cl<"u"?h=Cl.utils.decode(f.codepage,u):h=Yt&&Buffer.isBuffer(u)?u.toString("binary"):cA(u);break;case"array":h=ic(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return d[0]==239&&d[1]==187&&d[2]==191?h=Fr(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=Fr(h):f.type=="binary"&&typeof Cl<"u"&&f.codepage&&(h=Cl.utils.decode(f.codepage,Cl.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?JF.to_sheet(f.type=="string"?h:Fr(h),f):s(h,f)}function l(u,f){return uA(o(u,f),f)}function A(u){for(var f=[],h=cr(u["!ref"]),d,m=Array.isArray(u),g=h.s.r;g<=h.e.r;++g){for(var x=[],p=h.s.c;p<=h.e.c;++p){var v=Dt({r:g,c:p});if(d=m?(u[g]||[])[p]:u[v],!d||d.v==null){x.push("          ");continue}for(var y=(d.w||(Ko(d),d.w)||"").slice(0,10);y.length<10;)y+=" ";x.push(y+(p===0?" ":""))}f.push(x.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:A}}();function C7(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=XF.to_workbook(e,r);return r.WTF=n,i}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return zu.to_workbook(e,t)}}var GA=function(){function e(k,U,P){if(k){ri(k,k.l||0);for(var D=P.Enum||K;k.l<k.length;){var O=k.read_shift(2),z=D[O]||D[65535],J=k.read_shift(2),Y=k.l+J,le=z.f&&z.f(k,J,P);if(k.l=Y,U(le,z,O))return}}}function t(k,U){switch(U.type){case"base64":return r(xa(Sa(k)),U);case"binary":return r(xa(k),U);case"buffer":case"array":return r(k,U)}throw"Unsupported type "+U.type}function r(k,U){if(!k)return k;var P=U||{},D=P.dense?[]:{},O="Sheet1",z="",J=0,Y={},le=[],we=[],ne={s:{r:0,c:0},e:{r:0,c:0}},Me=P.sheetRows||0;if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)P.Enum=K,e(k,function(Be,xe,se){switch(se){case 0:P.vers=Be,Be>=4096&&(P.qpro=!0);break;case 6:ne=Be;break;case 204:Be&&(z=Be);break;case 222:z=Be;break;case 15:case 51:P.qpro||(Be[1].v=Be[1].v.slice(1));case 13:case 14:case 16:se==14&&(Be[2]&112)==112&&(Be[2]&15)>1&&(Be[2]&15)<15&&(Be[1].z=P.dateNF||Ot[14],P.cellDates&&(Be[1].t="d",Be[1].v=u1(Be[1].v))),P.qpro&&Be[3]>J&&(D["!ref"]=qt(ne),Y[O]=D,le.push(O),D=P.dense?[]:{},ne={s:{r:0,c:0},e:{r:0,c:0}},J=Be[3],O=z||"Sheet"+(J+1),z="");var be=P.dense?(D[Be[0].r]||[])[Be[0].c]:D[Dt(Be[0])];if(be){be.t=Be[1].t,be.v=Be[1].v,Be[1].z!=null&&(be.z=Be[1].z),Be[1].f!=null&&(be.f=Be[1].f);break}P.dense?(D[Be[0].r]||(D[Be[0].r]=[]),D[Be[0].r][Be[0].c]=Be[1]):D[Dt(Be[0])]=Be[1];break}},P);else if(k[2]==26||k[2]==14)P.Enum=H,k[2]==14&&(P.qpro=!0,k.l=0),e(k,function(Be,xe,se){switch(se){case 204:O=Be;break;case 22:Be[1].v=Be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Be[3]>J&&(D["!ref"]=qt(ne),Y[O]=D,le.push(O),D=P.dense?[]:{},ne={s:{r:0,c:0},e:{r:0,c:0}},J=Be[3],O="Sheet"+(J+1)),Me>0&&Be[0].r>=Me)break;P.dense?(D[Be[0].r]||(D[Be[0].r]=[]),D[Be[0].r][Be[0].c]=Be[1]):D[Dt(Be[0])]=Be[1],ne.e.c<Be[0].c&&(ne.e.c=Be[0].c),ne.e.r<Be[0].r&&(ne.e.r=Be[0].r);break;case 27:Be[14e3]&&(we[Be[14e3][0]]=Be[14e3][1]);break;case 1537:we[Be[0]]=Be[1],Be[0]==J&&(O=Be[1]);break}},P);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(D["!ref"]=qt(ne),Y[z||O]=D,le.push(z||O),!we.length)return{SheetNames:le,Sheets:Y};for(var qe={},Fe=[],he=0;he<we.length;++he)Y[le[he]]?(Fe.push(we[he]||le[he]),qe[we[he]]=Y[we[he]]||Y[le[he]]):(Fe.push(we[he]),qe[we[he]]={"!ref":"A1"});return{SheetNames:Fe,Sheets:qe}}function n(k,U){var P=U||{};if(+P.codepage>=0&&Ss(+P.codepage),P.type=="string")throw new Error("Cannot write WK1 to JS string");var D=sa(),O=cr(k["!ref"]),z=Array.isArray(k),J=[];ct(D,0,a(1030)),ct(D,6,l(O));for(var Y=Math.min(O.e.r,8191),le=O.s.r;le<=Y;++le)for(var we=bn(le),ne=O.s.c;ne<=O.e.c;++ne){le===O.s.r&&(J[ne]=Xr(ne));var Me=J[ne]+we,qe=z?(k[le]||[])[ne]:k[Me];if(!(!qe||qe.t=="z"))if(qe.t=="n")(qe.v|0)==qe.v&&qe.v>=-32768&&qe.v<=32767?ct(D,13,d(le,ne,qe.v)):ct(D,14,g(le,ne,qe.v));else{var Fe=Ko(qe);ct(D,15,f(le,ne,Fe.slice(0,239)))}}return ct(D,1),D.end()}function i(k,U){var P=U||{};if(+P.codepage>=0&&Ss(+P.codepage),P.type=="string")throw new Error("Cannot write WK3 to JS string");var D=sa();ct(D,0,s(k));for(var O=0,z=0;O<k.SheetNames.length;++O)(k.Sheets[k.SheetNames[O]]||{})["!ref"]&&ct(D,27,Q(k.SheetNames[O],z++));var J=0;for(O=0;O<k.SheetNames.length;++O){var Y=k.Sheets[k.SheetNames[O]];if(!(!Y||!Y["!ref"])){for(var le=cr(Y["!ref"]),we=Array.isArray(Y),ne=[],Me=Math.min(le.e.r,8191),qe=le.s.r;qe<=Me;++qe)for(var Fe=bn(qe),he=le.s.c;he<=le.e.c;++he){qe===le.s.r&&(ne[he]=Xr(he));var Be=ne[he]+Fe,xe=we?(Y[qe]||[])[he]:Y[Be];if(!(!xe||xe.t=="z"))if(xe.t=="n")ct(D,23,I(qe,he,J,xe.v));else{var se=Ko(xe);ct(D,22,_(qe,he,J,se.slice(0,239)))}}++J}}return ct(D,1),D.end()}function a(k){var U=ze(2);return U.write_shift(2,k),U}function s(k){var U=ze(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var P=0,D=0,O=0,z=0;z<k.SheetNames.length;++z){var J=k.SheetNames[z],Y=k.Sheets[J];if(!(!Y||!Y["!ref"])){++O;var le=oa(Y["!ref"]);P<le.e.r&&(P=le.e.r),D<le.e.c&&(D=le.e.c)}}return P>8191&&(P=8191),U.write_shift(2,P),U.write_shift(1,O),U.write_shift(1,D),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function o(k,U,P){var D={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&P.qpro?(D.s.c=k.read_shift(1),k.l++,D.s.r=k.read_shift(2),D.e.c=k.read_shift(1),k.l++,D.e.r=k.read_shift(2),D):(D.s.c=k.read_shift(2),D.s.r=k.read_shift(2),U==12&&P.qpro&&(k.l+=2),D.e.c=k.read_shift(2),D.e.r=k.read_shift(2),U==12&&P.qpro&&(k.l+=2),D.s.c==65535&&(D.s.c=D.e.c=D.s.r=D.e.r=0),D)}function l(k){var U=ze(8);return U.write_shift(2,k.s.c),U.write_shift(2,k.s.r),U.write_shift(2,k.e.c),U.write_shift(2,k.e.r),U}function A(k,U,P){var D=[{c:0,r:0},{t:"n",v:0},0,0];return P.qpro&&P.vers!=20768?(D[0].c=k.read_shift(1),D[3]=k.read_shift(1),D[0].r=k.read_shift(2),k.l+=2):(D[2]=k.read_shift(1),D[0].c=k.read_shift(2),D[0].r=k.read_shift(2)),D}function u(k,U,P){var D=k.l+U,O=A(k,U,P);if(O[1].t="s",P.vers==20768){k.l++;var z=k.read_shift(1);return O[1].v=k.read_shift(z,"utf8"),O}return P.qpro&&k.l++,O[1].v=k.read_shift(D-k.l,"cstr"),O}function f(k,U,P){var D=ze(7+P.length);D.write_shift(1,255),D.write_shift(2,U),D.write_shift(2,k),D.write_shift(1,39);for(var O=0;O<D.length;++O){var z=P.charCodeAt(O);D.write_shift(1,z>=128?95:z)}return D.write_shift(1,0),D}function h(k,U,P){var D=A(k,U,P);return D[1].v=k.read_shift(2,"i"),D}function d(k,U,P){var D=ze(7);return D.write_shift(1,255),D.write_shift(2,U),D.write_shift(2,k),D.write_shift(2,P,"i"),D}function m(k,U,P){var D=A(k,U,P);return D[1].v=k.read_shift(8,"f"),D}function g(k,U,P){var D=ze(13);return D.write_shift(1,255),D.write_shift(2,U),D.write_shift(2,k),D.write_shift(8,P,"f"),D}function x(k,U,P){var D=k.l+U,O=A(k,U,P);if(O[1].v=k.read_shift(8,"f"),P.qpro)k.l=D;else{var z=k.read_shift(2);w(k.slice(k.l,k.l+z),O),k.l+=z}return O}function p(k,U,P){var D=U&32768;return U&=-32769,U=(D?k:0)+(U>=8192?U-16384:U),(D?"":"$")+(P?Xr(U):bn(U))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(k,U){ri(k,0);for(var P=[],D=0,O="",z="",J="",Y="";k.l<k.length;){var le=k[k.l++];switch(le){case 0:P.push(k.read_shift(8,"f"));break;case 1:z=p(U[0].c,k.read_shift(2),!0),O=p(U[0].r,k.read_shift(2),!1),P.push(z+O);break;case 2:{var we=p(U[0].c,k.read_shift(2),!0),ne=p(U[0].r,k.read_shift(2),!1);z=p(U[0].c,k.read_shift(2),!0),O=p(U[0].r,k.read_shift(2),!1),P.push(we+ne+":"+z+O)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:P.push("("+P.pop()+")");break;case 5:P.push(k.read_shift(2));break;case 6:{for(var Me="";le=k[k.l++];)Me+=String.fromCharCode(le);P.push('"'+Me.replace(/"/g,'""')+'"')}break;case 8:P.push("-"+P.pop());break;case 23:P.push("+"+P.pop());break;case 22:P.push("NOT("+P.pop()+")");break;case 20:case 21:Y=P.pop(),J=P.pop(),P.push(["AND","OR"][le-20]+"("+J+","+Y+")");break;default:if(le<32&&y[le])Y=P.pop(),J=P.pop(),P.push(J+y[le]+Y);else if(v[le]){if(D=v[le][1],D==69&&(D=k[k.l++]),D>P.length){console.error("WK1 bad formula parse 0x"+le.toString(16)+":|"+P.join("|")+"|");return}var qe=P.slice(-D);P.length-=D,P.push(v[le][0]+"("+qe.join(",")+")")}else return le<=7?console.error("WK1 invalid opcode "+le.toString(16)):le<=24?console.error("WK1 unsupported op "+le.toString(16)):le<=30?console.error("WK1 invalid opcode "+le.toString(16)):le<=115?console.error("WK1 unsupported function opcode "+le.toString(16)):console.error("WK1 unrecognized opcode "+le.toString(16))}}P.length==1?U[1].f=""+P[0]:console.error("WK1 bad formula parse |"+P.join("|")+"|")}function B(k){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=k.read_shift(2),U[3]=k[k.l++],U[0].c=k[k.l++],U}function E(k,U){var P=B(k);return P[1].t="s",P[1].v=k.read_shift(U-4,"cstr"),P}function _(k,U,P,D){var O=ze(6+D.length);O.write_shift(2,k),O.write_shift(1,P),O.write_shift(1,U),O.write_shift(1,39);for(var z=0;z<D.length;++z){var J=D.charCodeAt(z);O.write_shift(1,J>=128?95:J)}return O.write_shift(1,0),O}function F(k,U){var P=B(k);P[1].v=k.read_shift(2);var D=P[1].v>>1;if(P[1].v&1)switch(D&7){case 0:D=(D>>3)*5e3;break;case 1:D=(D>>3)*500;break;case 2:D=(D>>3)/20;break;case 3:D=(D>>3)/200;break;case 4:D=(D>>3)/2e3;break;case 5:D=(D>>3)/2e4;break;case 6:D=(D>>3)/16;break;case 7:D=(D>>3)/64;break}return P[1].v=D,P}function T(k,U){var P=B(k),D=k.read_shift(4),O=k.read_shift(4),z=k.read_shift(2);if(z==65535)return D===0&&O===3221225472?(P[1].t="e",P[1].v=15):D===0&&O===3489660928?(P[1].t="e",P[1].v=42):P[1].v=0,P;var J=z&32768;return z=(z&32767)-16446,P[1].v=(1-J*2)*(O*Math.pow(2,z+32)+D*Math.pow(2,z)),P}function I(k,U,P,D){var O=ze(14);if(O.write_shift(2,k),O.write_shift(1,P),O.write_shift(1,U),D==0)return O.write_shift(4,0),O.write_shift(4,0),O.write_shift(2,65535),O;var z=0,J=0,Y=0,le=0;return D<0&&(z=1,D=-D),J=Math.log2(D)|0,D/=Math.pow(2,J-31),le=D>>>0,le&2147483648||(D/=2,++J,le=D>>>0),D-=le,le|=2147483648,le>>>=0,D*=Math.pow(2,32),Y=D>>>0,O.write_shift(4,Y),O.write_shift(4,le),J+=16383+(z?32768:0),O.write_shift(2,J),O}function S(k,U){var P=T(k);return k.l+=U-14,P}function C(k,U){var P=B(k),D=k.read_shift(4);return P[1].v=D>>6,P}function L(k,U){var P=B(k),D=k.read_shift(8,"f");return P[1].v=D,P}function R(k,U){var P=L(k);return k.l+=U-10,P}function W(k,U){return k[k.l+U-1]==0?k.read_shift(U,"cstr"):""}function G(k,U){var P=k[k.l++];P>U-1&&(P=U-1);for(var D="";D.length<P;)D+=String.fromCharCode(k[k.l++]);return D}function V(k,U,P){if(!(!P.qpro||U<21)){var D=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var O=k.read_shift(U-21,"cstr");return[D,O]}}function X(k,U){for(var P={},D=k.l+U;k.l<D;){var O=k.read_shift(2);if(O==14e3){for(P[O]=[0,""],P[O][0]=k.read_shift(2);k[k.l];)P[O][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return P}function Q(k,U){var P=ze(5+k.length);P.write_shift(2,14e3),P.write_shift(2,U);for(var D=0;D<k.length;++D){var O=k.charCodeAt(D);P[P.l++]=O>127?95:O}return P[P.l++]=0,P}var K={0:{n:"BOF",f:Fn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:W},222:{n:"SHEETNAMELP",f:G},65535:{n:""}},H={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:S},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:X},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:C},38:{n:"??"},39:{n:"NUMBER27",f:L},40:{n:"FORMULA28",f:R},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:W},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:V},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function S7(e){var t={},r=e.match(Ti),n=0,i=!1;if(r)for(;n!=r.length;++n){var a=Qt(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=fb[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+a[0])}}return t}var E7=function(){var e=Nd("t"),t=Nd("rPr");function r(a){var s=a.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:Ar(s[1])},l=a.match(t);return l&&(o.s=S7(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),k7=function(){var t=/(\r\n|\n)/g;function r(i,a,s){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),i.b&&(a.push("<b>"),s.push("</b>")),i.i&&(a.push("<i>"),s.push("</i>")),i.strike&&(a.push("<s>"),s.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),s.push("</"+l+">")),s.push("</span>"),i}function n(i){var a=[[],i.v,[]];return i.v?(i.s&&r(i.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),F7=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,N7=/<(?:\w+:)?r>/,T7=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function jb(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ar(Fr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Fr(e),r&&(n.h=bb(n.t))):e.match(N7)&&(n.r=Fr(e),n.t=Ar(Fr((e.replace(T7,"").match(F7)||[]).join("").replace(Ti,""))),r&&(n.h=k7(E7(n.r)))),n):{t:""}}var L7=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,I7=/<(?:\w+:)?(?:si|sstItem)>/g,U7=/<\/(?:\w+:)?(?:si|sstItem)>/;function O7(e,t){var r=[],n="";if(!e)return r;var i=e.match(L7);if(i){n=i[2].replace(I7,"").split(U7);for(var a=0;a!=n.length;++a){var s=jb(n[a].trim(),t);s!=null&&(r[r.length]=s)}i=Qt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var j7=/^\s|\s$|[\t\n\r]/;function ZF(e,t){if(!t.bookSST)return"";var r=[Bn];r[r.length]=At("sst",null,{xmlns:hc[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],a="<si>";i.r?a+=i.r:(a+="<t",i.t||(i.t=""),i.t.match(j7)&&(a+=' xml:space="preserve"'),a+=">"+Br(i.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function D7(e){return[e.read_shift(4),e.read_shift(4)]}function P7(e,t){var r=[],n=!1;return $o(e,function(a,s,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function Q7(e,t){return t||(t=ze(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var R7=XD;function M7(e){var t=sa();Ze(t,159,Q7(e));for(var r=0;r<e.length;++r)Ze(t,19,R7(e[r]));return Ze(t,160),t.end()}function eN(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Do(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function H7(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Do(e,4),t.U=Do(e,4),t.W=Do(e,4),t}function K7(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),a=[];i-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function G7(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(K7(e));return t}function V7(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function W7(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Do(e,4),t.U=Do(e,4),t.W=Do(e,4),t}function $7(e){var t=W7(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function tN(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function rN(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function q7(e){var t=Do(e);switch(t.Minor){case 2:return[t.Minor,z7(e)];case 3:return[t.Minor,X7()];case 4:return[t.Minor,Y7(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function z7(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=tN(e,r),i=rN(e,e.length-e.l);return{t:"Std",h:n,v:i}}function X7(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Y7(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Ti,function(a){var s=Qt(a);switch(so(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function J7(e,t){var r={},n=r.EncryptionVersionInfo=Do(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=tN(e,i),t-=i,r.EncryptionVerifier=rN(e,t),r}function Z7(e){var t={},r=t.EncryptionVersionInfo=Do(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Db(e){var t=0,r,n=eN(e),i=n.length+1,a,s,o,l,A;for(r=Jl(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)s=r[a],o=t&16384?1:0,l=t<<1&32767,A=o|l,t=A^s;return t^52811}var nN=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},i=function(s,o){return n(s^o)},a=function(s){for(var o=t[s.length-1],l=104,A=s.length-1;A>=0;--A)for(var u=s[A],f=0;f!=7;++f)u&64&&(o^=r[l]),u*=2,--l;return o};return function(s){for(var o=eN(s),l=a(o),A=o.length,u=Jl(16),f=0;f!=16;++f)u[f]=0;var h,d,m;for((A&1)===1&&(h=l>>8,u[A]=i(e[0],h),--A,h=l&255,d=o[o.length-1],u[A]=i(d,h));A>0;)--A,h=l>>8,u[A]=i(o[A],h),--A,h=l&255,u[A]=i(o[A],h);for(A=15,m=15-o.length;m>0;)h=l>>8,u[A]=i(e[m],h),--A,--m,h=l&255,u[A]=i(o[A],h),--A,--m;return u}}(),eR=function(e,t,r,n,i){i||(i=t),n||(n=nN(e));var a,s;for(a=0;a!=t.length;++a)s=t[a],s^=n[r],s=(s>>5|s<<3)&255,i[a]=s,++r;return[i,r,n]},tR=function(e){var t=0,r=nN(e);return function(n){var i=eR("",n,t,r);return t=i[1],i[0]}};function rR(e,t,r,n){var i={key:Fn(e),verificationBytes:Fn(e)};return r.password&&(i.verifier=Db(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=tR(r.password)),i}function nR(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Z7(e):n.Data=J7(e,t),n}function iR(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?nR(e,t-2,n):rR(e,r.biff>=8?t:t-2,r,n),n}var iN=function(){function e(i,a){switch(a.type){case"base64":return t(Sa(i),a);case"binary":return t(i,a);case"buffer":return t(Yt&&Buffer.isBuffer(i)?i.toString("binary"):cA(i),a);case"array":return t(ic(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){var s=a||{},o=s.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var A={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,d=0,m,g=-1;m=h.exec(u);){switch(m[0]){case"\\cell":var x=u.slice(d,h.lastIndex-m[0].length);if(x[0]==" "&&(x=x.slice(1)),++g,x.length){var p={v:x,t:"s"};Array.isArray(o)?o[f][g]=p:o[Dt({r:f,c:g})]=p}break}d=h.lastIndex}g>A.e.c&&(A.e.c=g)}),o["!ref"]=qt(A),o}function r(i,a){return uA(e(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],s=cr(i["!ref"]),o,l=Array.isArray(i),A=s.s.r;A<=s.e.r;++A){a.push("\\trowd\\trautofit1");for(var u=s.s.c;u<=s.e.c;++u)a.push("\\cellx"+(u+1));for(a.push("\\pard\\intbl"),u=s.s.c;u<=s.e.c;++u){var f=Dt({r:A,c:u});o=l?(i[A]||[])[u]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(Ko(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function aR(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Ud(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function sR(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),a=Math.min(t,r,n),s=i-a;if(s===0)return[0,0,t];var o=0,l=0,A=i+a;switch(l=s/(A>1?2-A:A),i){case t:o=((r-n)/s+6)%6;break;case r:o=(n-t)/s+2;break;case n:o=(t-r)/s+4;break}return[o/6,l,A/2]}function oR(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),a=n-i/2,s=[a,a,a],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,s[0]+=i,s[1]+=l;break;case 1:l=i*(2-o),s[0]+=l,s[1]+=i;break;case 2:l=i*(o-2),s[1]+=i,s[2]+=l;break;case 3:l=i*(4-o),s[1]+=l,s[2]+=i;break;case 4:l=i*(o-4),s[2]+=i,s[0]+=l;break;case 5:l=i*(6-o),s[2]+=l,s[0]+=i;break}for(var A=0;A!=3;++A)s[A]=Math.round(s[A]*255);return s}function fm(e,t){if(t===0)return e;var r=sR(aR(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Ud(oR(r))}var aN=6,lR=15,AR=1,Bi=aN;function Od(e){return Math.floor((e+Math.round(128/Bi)/256)*Bi)}function jd(e){return Math.floor((e-5)/Bi*100+.5)/100}function hm(e){return Math.round((e*Bi+5)/Bi*256)/256}function ox(e){return hm(jd(Od(e)))}function Pb(e){var t=Math.abs(e-ox(e)),r=Bi;if(t>.005)for(Bi=AR;Bi<lR;++Bi)Math.abs(e-ox(e))<=t&&(t=Math.abs(e-ox(e)),r=Bi);Bi=r}function Zl(e){e.width?(e.wpx=Od(e.width),e.wch=jd(e.wpx),e.MDW=Bi):e.wpx?(e.wch=jd(e.wpx),e.width=hm(e.wch),e.MDW=Bi):typeof e.wch=="number"&&(e.width=hm(e.wch),e.wpx=Od(e.width),e.MDW=Bi),e.customWidth&&delete e.customWidth}var cR=96,sN=cR;function Dd(e){return e*96/sN}function Xu(e){return e*sN/96}var uR={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function fR(e,t,r,n){t.Borders=[];var i={},a=!1;(e[0].match(Ti)||[]).forEach(function(s){var o=Qt(s);switch(so(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Rr(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Rr(o.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function hR(e,t,r,n){t.Fills=[];var i={},a=!1;(e[0].match(Ti)||[]).forEach(function(s){var o=Qt(s);switch(so(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function dR(e,t,r,n){t.Fonts=[];var i={},a=!1;(e[0].match(Ti)||[]).forEach(function(s){var o=Qt(s);switch(so(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=Fr(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Rr(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Rr(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Rr(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Rr(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Rr(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Rr(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Rr(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=fb[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Rr(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=HA[i.color.index];i.color.index==81&&(l=HA[1]),l||(l=HA[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=fm(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function pR(e,t,r){t.NumberFmt=[];for(var n=cn(Ot),i=0;i<n.length;++i)t.NumberFmt[n[i]]=Ot[n[i]];var a=e[0].match(Ti);if(a)for(i=0;i<a.length;++i){var s=Qt(a[i]);switch(so(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ar(Fr(s.formatCode)),l=parseInt(s.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}jo(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function gR(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=At("numFmt",null,{numFmtId:n,formatCode:Br(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=At("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Lp=["numFmtId","fillId","fontId","borderId","xfId"],Ip=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function mR(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(Ti)||[]).forEach(function(a){var s=Qt(a),o=0;switch(so(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<Lp.length;++o)n[Lp[o]]&&(n[Lp[o]]=parseInt(n[Lp[o]],10));for(o=0;o<Ip.length;++o)n[Ip[o]]&&(n[Ip[o]]=Rr(n[Ip[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};s.vertical&&(l.vertical=s.vertical),s.horizontal&&(l.horizontal=s.horizontal),s.textRotation!=null&&(l.textRotation=s.textRotation),s.indent&&(l.indent=s.indent),s.wrapText&&(l.wrapText=Rr(s.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function vR(e){var t=[];return t[t.length]=At("cellXfs",null),e.forEach(function(r){t[t.length]=At("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=At("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var xR=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,A){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&pR(f,u,A),(f=o.match(i))&&dR(f,u,l,A),(f=o.match(n))&&hR(f,u,l,A),(f=o.match(a))&&fR(f,u,l,A),(f=o.match(r))&&mR(f,u,A),u}}();function oN(e,t){var r=[Bn,At("styleSheet",null,{xmlns:hc[0],"xmlns:vt":jn.vt})],n;return e.SSF&&(n=gR(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=vR(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function yR(e,t){var r=e.read_shift(2),n=Ei(e);return[r,n]}function wR(e,t,r){r||(r=ze(6+4*t.length)),r.write_shift(2,e),zn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function bR(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=nP(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=rP(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ei(e),n}function BR(e,t){t||(t=ze(25+4*32)),t.write_shift(2,e.sz*20),iP(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Am(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),zn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var _R=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],lx,CR=Ni;function p_(e,t){t||(t=ze(4*3+8*7+16*1)),lx||(lx=A1(_R));var r=lx[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Am({auto:1},t),Am({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function SR(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function lN(e,t,r){r||(r=ze(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ih(e,t){return t||(t=ze(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var ER=Ni;function kR(e,t){return t||(t=ze(51)),t.write_shift(1,0),ih(null,t),ih(null,t),ih(null,t),ih(null,t),ih(null,t),t.length>t.l?t.slice(0,t.l):t}function FR(e,t){return t||(t=ze(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),lm(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function NR(e,t,r){var n=ze(2052);return n.write_shift(4,e),lm(t,n),lm(r,n),n.length>n.l?n.slice(0,n.l):n}function TR(e,t,r){var n={};n.NumberFmt=[];for(var i in Ot)n.NumberFmt[i]=Ot[i];n.CellXf=[],n.Fonts=[];var a=[],s=!1;return $o(e,function(l,A,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],jo(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=fm(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:a.push(u),s=!0;break;case 38:a.pop(),s=!1;break;default:if(A.T>0)a.push(u);else if(A.T<0)a.pop();else if(!s||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function LR(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(Ze(e,615,Ts(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Ze(e,44,wR(i,t[i]))}),Ze(e,616))}}function IR(e){var t=1;Ze(e,611,Ts(t)),Ze(e,43,BR({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Ze(e,612)}function UR(e){var t=2;Ze(e,603,Ts(t)),Ze(e,45,p_({patternType:"none"})),Ze(e,45,p_({patternType:"gray125"})),Ze(e,604)}function OR(e){var t=1;Ze(e,613,Ts(t)),Ze(e,46,kR()),Ze(e,614)}function jR(e){var t=1;Ze(e,626,Ts(t)),Ze(e,47,lN({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Ze(e,627)}function DR(e,t){Ze(e,617,Ts(t.length)),t.forEach(function(r){Ze(e,47,lN(r,0))}),Ze(e,618)}function PR(e){var t=1;Ze(e,619,Ts(t)),Ze(e,48,FR({xfId:0,builtinId:0,name:"Normal"})),Ze(e,620)}function QR(e){var t=0;Ze(e,505,Ts(t)),Ze(e,506)}function RR(e){var t=0;Ze(e,508,NR(t,"TableStyleMedium9","PivotStyleMedium4")),Ze(e,509)}function MR(e,t){var r=sa();return Ze(r,278),LR(r,e.SSF),IR(r),UR(r),OR(r),jR(r),DR(r,t.cellXfs),PR(r),QR(r),RR(r),Ze(r,279),r.end()}var HR=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function KR(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Ti)||[]).forEach(function(i){var a=Qt(i);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[HR.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function GR(){}function VR(){}var WR=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,$R=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,qR=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function zR(e,t,r){t.themeElements={};var n;[["clrScheme",WR,KR],["fontScheme",$R,GR],["fmtScheme",qR,VR]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var XR=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function AN(e,t){(!e||e.length===0)&&(e=Qb());var r,n={};if(!(r=e.match(XR)))throw new Error("themeElements not found in theme");return zR(r[0],n,t),n.raw=e,n}function Qb(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Bn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function YR(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var s;try{s=tF(a,{type:"array"})}catch{return}var o=ya(s,"theme/theme/theme1.xml",!0);if(o)return AN(o,r)}}function JR(e){return e.read_shift(4)}function ZR(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=eM(e,4);break;case 2:t.xclrValue=HF(e);break;case 3:t.xclrValue=JR(e);break;case 4:e.l+=4;break}return e.l+=8,t}function eM(e,t){return Ni(e,t)}function tM(e,t){return Ni(e,t)}function rM(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=ZR(e);break;case 6:n[1]=tM(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function nM(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),a=[];i-- >0;)a.push(rM(e,r-e.l));return{ixfe:n,ext:a}}function iM(e,t){t.forEach(function(r){switch(r[0]){}})}function aM(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ei(e)}}function sM(e){var t=ze(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),zn(e.name,t),t.slice(0,t.l)}function oM(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function lM(e){var t=ze(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function AM(e,t){var r=ze(8+2*t.length);return r.write_shift(4,e),zn(t,r),r.slice(0,r.l)}function cM(e){return e.l+=4,e.read_shift(4)!=0}function uM(e,t){var r=ze(8);return r.write_shift(4,e),r.write_shift(4,1),r}function fM(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},a=[],s=!1,o=2;return $o(e,function(l,A,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(u),s=!0;break;case 36:a.pop(),s=!1;break;default:if(!A.T){if(!s||i.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function hM(){var e=sa();return Ze(e,332),Ze(e,334,Ts(1)),Ze(e,335,sM({name:"XLDAPR",version:12e4,flags:3496657072})),Ze(e,336),Ze(e,339,AM(1,"XLDAPR")),Ze(e,52),Ze(e,35,Ts(514)),Ze(e,4096,Ts(0)),Ze(e,4097,Wa(1)),Ze(e,36),Ze(e,53),Ze(e,340),Ze(e,337,uM(1)),Ze(e,51,lM([[1,0]])),Ze(e,338),Ze(e,333),e.end()}function dM(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,a=2,s;return e.replace(Ti,function(o){var l=Qt(o);switch(so(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var A=0;A<n.Types.length;++A)n.Types[A].name==l.name&&(s=n.Types[A]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function cN(){var e=[Bn];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function pM(e){var t=[];if(!e)return t;var r=1;return(e.match(Ti)||[]).forEach(function(n){var i=Qt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function gM(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Dt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function mM(e,t,r){var n=[];return $o(e,function(a,s,o){switch(o){case 63:n.push(a);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function vM(e,t,r,n){if(!e)return e;var i=n||{},a=!1;$o(e,function(o,l,A){switch(A){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||i.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}},i)}function xM(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Eu=1024;function uN(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[At("xml",null,{"xmlns:v":ma.v,"xmlns:o":ma.o,"xmlns:x":ma.x,"xmlns:mv":ma.mv}).replace(/\/>/,">"),At("o:shapelayout",At("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),At("v:shapetype",[At("v:stroke",null,{joinstyle:"miter"}),At("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Eu<e*1e3;)Eu+=1e3;return t.forEach(function(a){var s=Yr(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?At("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,A=At("v:fill",l,o),u={on:"t",obscured:"t"};++Eu,i=i.concat(["<v:shape"+Td({id:"_x0000_s"+Eu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",A,At("v:shadow",null,u),At("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ni("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),ni("x:AutoFill","False"),ni("x:Row",String(s.r)),ni("x:Column",String(s.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function g_(e,t,r,n){var i=Array.isArray(e),a;t.forEach(function(s){var o=Yr(s.ref);if(i?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[s.ref],!a){a={t:"z"},i?e[o.r][o.c]=a:e[s.ref]=a;var l=cr(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var A=qt(l);A!==e["!ref"]&&(e["!ref"]=A)}a.c||(a.c=[]);var u={a:s.author,t:s.t,r:s.r,T:r};s.h&&(u.h=s.h);for(var f=a.c.length-1;f>=0;--f){if(!r&&a.c[f].T)return;r&&!a.c[f].T&&a.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}a.c.push(u)})}function yM(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Qt(o[0]),A={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=Yr(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&jb(f[1])||{r:"",t:"",h:""};A.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),A.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(A.h=h.h),n.push(A)}}}}),n}function fN(e){var t=[Bn,At("comments",null,{xmlns:hc[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var a=Br(i.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(Br(l.a))),a.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),a.length<=1)t.push(ni("t",Br(a[0]||"")));else{for(var s=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)s+=`Reply:
    `+a[o]+`
`;t.push(ni("t",Br(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function wM(e,t){var r=[],n=!1,i={},a=0;return e.replace(Ti,function(o,l){var A=Qt(o);switch(so(A[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:A.personId,guid:A.id,ref:A.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":i.t=e.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+A[0]+" in threaded comments")}return o}),r}function bM(e,t,r){var n=[Bn,At("ThreadedComments",null,{xmlns:jn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var a="";(i[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=l.id:l.parentId=a,s.ID=l.id,s.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(At("threadedComment",ni("text",s.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function BM(e,t){var r=[],n=!1;return e.replace(Ti,function(a){var s=Qt(a);switch(so(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return a}),r}function _M(e){var t=[Bn,At("personList",null,{xmlns:jn.TCMNT,"xmlns:x":hc[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(At("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function CM(e){var t={};t.iauthor=e.read_shift(4);var r=mc(e);return t.rfx=r.s,t.ref=Dt(r.s),e.l+=16,t}function SM(e,t){return t==null&&(t=ze(36)),t.write_shift(4,e[1].iauthor),Af(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var EM=Ei;function kM(e){return zn(e.slice(0,54))}function FM(e,t){var r=[],n=[],i={},a=!1;return $o(e,function(o,l,A){switch(A){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}}),r}function NM(e){var t=sa(),r=[];return Ze(t,628),Ze(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Ze(t,632,kM(i.a)))})}),Ze(t,631),Ze(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var a={s:Yr(n[0]),e:Yr(n[0])};Ze(t,635,SM([a,i])),i.t&&i.t.length>0&&Ze(t,637,JD(i)),Ze(t,636),delete i.iauthor})}),Ze(t,634),Ze(t,629),t.end()}var TM="application/vnd.ms-office.vbaProject";function LM(e){var t=Lt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Lt.utils.cfb_add(t,i,e.FileIndex[n].content)}}),Lt.write(t)}function IM(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Lt.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var hN=["xlsb","xlsm","xlam","biff8","xla"];function UM(){return{"!type":"dialog"}}function OM(){return{"!type":"dialog"}}function jM(){return{"!type":"macro"}}function DM(){return{"!type":"macro"}}var Du=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,a,s){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var A=a.length>0?parseInt(a,10)|0:0,u=s.length>0?parseInt(s,10)|0:0;return o?u+=t.c:--u,l?A+=t.r:--A,i+(o?"":"$")+Xr(u)+(l?"":"$")+bn(A)}return function(i,a){return t=a,i.replace(e,r)}}(),Rb=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Mb=function(){return function(t,r){return t.replace(Rb,function(n,i,a,s,o,l){var A=Eb(s)-(a?0:r.c),u=Sb(l)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",h=A==0?"":a?A+1:"["+A+"]";return i+"R"+f+"C"+h})}}();function dN(e,t){return e.replace(Rb,function(r,n,i,a,s,o){return n+(i=="$"?i+a:Xr(Eb(a)+t.c))+(s=="$"?s+o:bn(Sb(o)+t.r))})}function PM(e,t,r){var n=oa(t),i=n.s,a=Yr(r),s={r:a.r-i.r,c:a.c-i.c};return dN(e,s)}function QM(e){return e.length!=1}function m_(e){return e.replace(/_xlfn\./g,"")}function En(e){e.l+=1}function eA(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function pN(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return gN(e);r.biff==12&&(n=4)}var i=e.read_shift(n),a=e.read_shift(n),s=eA(e),o=eA(e);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function gN(e){var t=eA(e),r=eA(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function RM(e,t,r){if(r.biff<8)return gN(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),a=eA(e),s=eA(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function mN(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return MM(e);var n=e.read_shift(r&&r.biff==12?4:2),i=eA(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function MM(e){var t=eA(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function HM(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function KM(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return GM(e);var i=e.read_shift(n>=12?4:2),a=e.read_shift(2),s=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;i>524287;)i-=1048576;if(s==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:s,rRel:o}}function GM(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function VM(e,t,r){var n=(e[e.l++]&96)>>5,i=pN(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function WM(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var s=pN(e,a,r);return[n,i,s]}function $M(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function qM(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,i]}function zM(e,t,r){var n=(e[e.l++]&96)>>5,i=RM(e,t-1,r);return[n,i]}function XM(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function v_(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function YM(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function JM(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function ZM(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function eH(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function tH(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function vN(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function rH(e){return e.read_shift(2),vN(e)}function nH(e){return e.read_shift(2),vN(e)}function iH(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=mN(e,0,r);return[n,i]}function aH(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=KM(e,0,r);return[n,i]}function sH(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=mN(e,0,r);return[n,i,a]}function oH(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[c9[i],wN[i],n]}function lH(e,t,r){var n=e[e.l++],i=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:AH(e);return[i,(a[0]===0?wN:A9)[a[1]]]}function AH(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function cH(e,t,r){e.l+=r&&r.biff==2?3:4}function uH(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function fH(e){return e.l++,qo[e.read_shift(1)]}function hH(e){return e.l++,e.read_shift(2)}function dH(e){return e.l++,e.read_shift(1)!==0}function pH(e){return e.l++,Ci(e)}function gH(e,t,r){return e.l++,s0(e,t-1,r)}function mH(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=pn(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=qo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ci(e);break;case 2:r[1]=vc(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function vH(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?mc:f1)(e));return i}function xH(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,s=[];a!=n&&(s[a]=[]);++a)for(var o=0;o!=i;++o)s[a][o]=mH(e,r.biff);return s}function yH(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function wH(e,t,r){if(r.biff==5)return bH(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[n,i,a]}function bH(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function BH(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function _H(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function CH(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function SH(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,i]}var EH=Ni,kH=Ni,FH=Ni;function l0(e,t,r){return e.l+=2,[HM(e)]}function Hb(e){return e.l+=6,[]}var NH=l0,TH=Hb,LH=Hb,IH=l0;function xN(e){return e.l+=2,[Fn(e),e.read_shift(2)&1]}var UH=l0,OH=xN,jH=Hb,DH=l0,PH=l0,QH=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function RH(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),s=QH[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:i,C:a}}function MH(e){return e.l+=2,[e.read_shift(4)]}function HH(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function KH(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function GH(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function VH(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function WH(e){return e.l+=4,[0,0]}var x_={1:{n:"PtgExp",f:uH},2:{n:"PtgTbl",f:FH},3:{n:"PtgAdd",f:En},4:{n:"PtgSub",f:En},5:{n:"PtgMul",f:En},6:{n:"PtgDiv",f:En},7:{n:"PtgPower",f:En},8:{n:"PtgConcat",f:En},9:{n:"PtgLt",f:En},10:{n:"PtgLe",f:En},11:{n:"PtgEq",f:En},12:{n:"PtgGe",f:En},13:{n:"PtgGt",f:En},14:{n:"PtgNe",f:En},15:{n:"PtgIsect",f:En},16:{n:"PtgUnion",f:En},17:{n:"PtgRange",f:En},18:{n:"PtgUplus",f:En},19:{n:"PtgUminus",f:En},20:{n:"PtgPercent",f:En},21:{n:"PtgParen",f:En},22:{n:"PtgMissArg",f:En},23:{n:"PtgStr",f:gH},26:{n:"PtgSheet",f:HH},27:{n:"PtgEndSheet",f:KH},28:{n:"PtgErr",f:fH},29:{n:"PtgBool",f:dH},30:{n:"PtgInt",f:hH},31:{n:"PtgNum",f:pH},32:{n:"PtgArray",f:XM},33:{n:"PtgFunc",f:oH},34:{n:"PtgFuncVar",f:lH},35:{n:"PtgName",f:yH},36:{n:"PtgRef",f:iH},37:{n:"PtgArea",f:VM},38:{n:"PtgMemArea",f:BH},39:{n:"PtgMemErr",f:EH},40:{n:"PtgMemNoMem",f:kH},41:{n:"PtgMemFunc",f:_H},42:{n:"PtgRefErr",f:CH},43:{n:"PtgAreaErr",f:$M},44:{n:"PtgRefN",f:aH},45:{n:"PtgAreaN",f:zM},46:{n:"PtgMemAreaN",f:GH},47:{n:"PtgMemNoMemN",f:VH},57:{n:"PtgNameX",f:wH},58:{n:"PtgRef3d",f:sH},59:{n:"PtgArea3d",f:WM},60:{n:"PtgRefErr3d",f:SH},61:{n:"PtgAreaErr3d",f:qM},255:{}},$H={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},qH={1:{n:"PtgElfLel",f:xN},2:{n:"PtgElfRw",f:DH},3:{n:"PtgElfCol",f:NH},6:{n:"PtgElfRwV",f:PH},7:{n:"PtgElfColV",f:IH},10:{n:"PtgElfRadical",f:UH},11:{n:"PtgElfRadicalS",f:jH},13:{n:"PtgElfColS",f:TH},15:{n:"PtgElfColSV",f:LH},16:{n:"PtgElfRadicalLel",f:OH},25:{n:"PtgList",f:RH},29:{n:"PtgSxName",f:MH},255:{}},zH={0:{n:"PtgAttrNoop",f:WH},1:{n:"PtgAttrSemi",f:tH},2:{n:"PtgAttrIf",f:ZM},4:{n:"PtgAttrChoose",f:YM},8:{n:"PtgAttrGoto",f:JM},16:{n:"PtgAttrSum",f:cH},32:{n:"PtgAttrBaxcel",f:v_},33:{n:"PtgAttrBaxcel",f:v_},64:{n:"PtgAttrSpace",f:rH},65:{n:"PtgAttrSpaceSemi",f:nH},128:{n:"PtgAttrIfError",f:eH},255:{}};function A0(e,t,r,n){if(n.biff<8)return Ni(e,t);for(var i=e.l+t,a=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=xH(e,0,n),a.push(r[s][1]);break;case"PtgMemArea":r[s][2]=vH(e,r[s][1],n),a.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),a.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=i-e.l,t!==0&&a.push(Ni(e,t)),a}function c0(e,t,r){for(var n=e.l+t,i,a,s=[];n!=e.l;)t=n-e.l,a=e[e.l],i=x_[a]||x_[$H[a]],(a===24||a===25)&&(i=(a===24?qH:zH)[e[e.l+1]]),!i||!i.f?Ni(e,t):s.push([i.n,i.f(e,t,r)]);return s}function XH(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],a=0;a<n.length;++a){var s=n[a];if(s)switch(s[0]){case 2:i.push('"'+s[1].replace(/"/g,'""')+'"');break;default:i.push(s[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var YH={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function JH(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function yN(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function y_(e,t,r){var n=yN(e,t,r);return n=="#REF"?n:JH(n,r)}function yi(e,t,r,n,i){var a=i&&i.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,A,u,f=0,h=0,d,m="";if(!e[0]||!e[0][0])return"";for(var g=-1,x="",p=0,v=e[0].length;p<v;++p){var y=e[0][p];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),A=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:x=ln(" ",e[0][g][1][1]);break;case 1:x=ln("\r",e[0][g][1][1]);break;default:if(x="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}A=A+x,g=-1}o.push(A+YH[y[0]]+l);break;case"PtgIsect":l=o.pop(),A=o.pop(),o.push(A+" "+l);break;case"PtgUnion":l=o.pop(),A=o.pop(),o.push(A+","+l);break;case"PtgRange":l=o.pop(),A=o.pop(),o.push(A+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Gh(y[1][1],s,i),o.push(Vh(u,a));break;case"PtgRefN":u=r?Gh(y[1][1],r,i):y[1][1],o.push(Vh(u,a));break;case"PtgRef3d":f=y[1][1],u=Gh(y[1][2],s,i),m=y_(n,f,i),o.push(m+"!"+Vh(u,a));break;case"PtgFunc":case"PtgFuncVar":var w=y[1][0],B=y[1][1];w||(w=0),w&=127;var E=w==0?[]:o.slice(-w);o.length-=w,B==="User"&&(B=E.shift()),o.push(B+"("+E.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":d=z4(y[1][1],r?{s:r}:s,i),o.push(ix(d,i));break;case"PtgArea":d=z4(y[1][1],s,i),o.push(ix(d,i));break;case"PtgArea3d":f=y[1][1],d=y[1][2],m=y_(n,f,i),o.push(m+"!"+ix(d,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=y[1][2];var _=(n.names||[])[h-1]||(n[0]||[])[h],F=_?_.Name:"SH33TJSNAME"+String(h);F&&F.slice(0,6)=="_xlfn."&&!i.xlfn&&(F=F.slice(6)),o.push(F);break;case"PtgNameX":var T=y[1][1];h=y[1][2];var I;if(i.biff<=5)T<0&&(T=-T),n[T]&&(I=n[T][h]);else{var S="";if(((n[T]||[])[0]||[])[0]==14849||(((n[T]||[])[0]||[])[0]==1025?n[T][h]&&n[T][h].itab>0&&(S=n.SheetNames[n[T][h].itab-1]+"!"):S=n.SheetNames[h-1]+"!"),n[T]&&n[T][h])S+=n[T][h].Name;else if(n[0]&&n[0][h])S+=n[0][h].Name;else{var C=(yN(n,T,i)||"").split(";;");C[h-1]?S=C[h-1]:S+="SH33TJSERRX"}o.push(S);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var L="(",R=")";if(g>=0){switch(x="",e[0][g][1][0]){case 2:L=ln(" ",e[0][g][1][1])+L;break;case 3:L=ln("\r",e[0][g][1][1])+L;break;case 4:R=ln(" ",e[0][g][1][1])+R;break;case 5:R=ln("\r",e[0][g][1][1])+R;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(L+o.pop()+R);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var W={c:r.c,r:r.r};if(n.sharedf[Dt(u)]){var G=n.sharedf[Dt(u)];o.push(yi(G,s,W,n,i))}else{var V=!1;for(l=0;l!=n.arrayf.length;++l)if(A=n.arrayf[l],!(u.c<A[0].s.c||u.c>A[0].e.c)&&!(u.r<A[0].s.r||u.r>A[0].e.r)){o.push(yi(A[1],s,W,n,i)),V=!0;break}V||o.push(y[1])}break;case"PtgArray":o.push("{"+XH(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=p;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var X=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&X.indexOf(e[0][p][0])==-1){y=e[0][g];var Q=!0;switch(y[1][0]){case 4:Q=!1;case 0:x=ln(" ",y[1][1]);break;case 5:Q=!1;case 1:x=ln("\r",y[1][1]);break;default:if(x="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((Q?x:"")+o.pop()+(Q?"":x)),g=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function ZH(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,s=e.read_shift(i);if(s==65535)return[[],Ni(e,t-2)];var o=c0(e,s,r);return t!==s+i&&(a=A0(e,t-s-i,o,r)),e.l=n,[o,a]}function e9(e,t,r){var n=e.l+t,i=r.biff==2?1:2,a,s=e.read_shift(i);if(s==65535)return[[],Ni(e,t-2)];var o=c0(e,s,r);return t!==s+i&&(a=A0(e,t-s-i,o,r)),e.l=n,[o,a]}function t9(e,t,r,n){var i=e.l+t,a=c0(e,n,r),s;return i!==e.l&&(s=A0(e,i-e.l,a,r)),[a,s]}function r9(e,t,r){var n=e.l+t,i,a=e.read_shift(2),s=c0(e,a,r);return a==65535?[[],Ni(e,t-2)]:(t!==a+2&&(i=A0(e,n-a-2,s,r)),[s,i])}function n9(e){var t;if(Io(e,e.l+6)!==65535)return[Ci(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function i9(e){if(e==null){var t=ze(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ac(e);return ac(0)}function Ax(e,t,r){var n=e.l+t,i=oo(e);r.biff==2&&++e.l;var a=n9(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=e9(e,n-e.l,r);return{cell:i,val:a[0],formula:o,shared:s>>3&1,tt:a[1]}}function a9(e,t,r,n,i){var a=oc(t,r,i),s=i9(e.v),o=ze(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var A=ze(e.bf.length),u=0;u<e.bf.length;++u)A[u]=e.bf[u];var f=qn([a,s,o,A]);return f}function h1(e,t,r){var n=e.read_shift(4),i=c0(e,n,r),a=e.read_shift(4),s=a>0?A0(e,a,i,r):null;return[i,s]}var s9=h1,d1=h1,o9=h1,l9=h1,A9={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},wN={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},c9={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function w_(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function u9(e){var t="of:="+e.replace(Rb,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function cx(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function f9(e){return e.replace(/\./,"!")}var $h={},Pu={},qh=typeof Map<"u";function Kb(e,t,r){var n=0,i=e.length;if(r){if(qh?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=qh?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(qh?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function p1(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Bi=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=jd(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=hm(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function VA(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function fA(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,a=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){jo(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=a;++i)if(e[i].numFmtId===n)return i;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function bN(e,t,r,n,i,a){try{n.cellNF&&(e.z=Ot[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Kr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Ot[t]==null&&jo(AD[t]||"General",t),e.t==="e")e.w=e.w||qo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Fd(e.v);else if(e.t==="d"){var s=Qn(e.v);(s|0)===s?e.w=s.toString(10):e.w=Fd(s)}else{if(e.v===void 0)return"";e.w=nc(e.v,Pu)}else e.t==="d"?e.w=ss(t,Qn(e.v),Pu):e.w=ss(t,e.v,Pu)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=fm(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=fm(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function h9(e,t,r){if(e&&e["!ref"]){var n=cr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function d9(e,t){var r=cr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=qt(r))}var p9=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,g9=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,m9=/<(?:\w:)?hyperlink [^>]*>/mg,v9=/"(\w*:\w*)"/,x9=/<(?:\w:)?col\b[^>]*[\/]?>/g,y9=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,w9=/<(?:\w:)?pageMargins[^>]*\/>/g,BN=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,b9=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,B9=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function _9(e,t,r,n,i,a,s){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},A="",u="",f=e.match(g9);f?(A=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):A=u=e;var h=A.match(BN);h?Gb(h[0],o,i,r):(h=A.match(b9))&&S9(h[0],h[1]||"",o,i,r);var d=(A.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var m=A.slice(d,d+50).match(v9);m&&d9(o,m[1])}var g=A.match(B9);g&&g[1]&&Q9(g[1],i);var x=[];if(t.cellStyles){var p=A.match(x9);p&&U9(x,p)}f&&H9(f[1],o,t,l,a,s);var v=u.match(y9);v&&(o["!autofilter"]=j9(v[0]));var y=[],w=u.match(p9);if(w)for(d=0;d!=w.length;++d)y[d]=cr(w[d].slice(w[d].indexOf('"')+1));var B=u.match(m9);B&&T9(o,B,n);var E=u.match(w9);if(E&&(o["!margins"]=L9(Qt(E[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=qt(l)),t.sheetRows>0&&o["!ref"]){var _=cr(o["!ref"]);t.sheetRows<=+_.e.r&&(_.e.r=t.sheetRows-1,_.e.r>l.e.r&&(_.e.r=l.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>l.e.c&&(_.e.c=l.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),o["!fullref"]=o["!ref"],o["!ref"]=qt(_))}return x.length>0&&(o["!cols"]=x),y.length>0&&(o["!merges"]=y),o}function C9(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+qt(e[r])+'"/>';return t+"</mergeCells>"}function Gb(e,t,r,n){var i=Qt(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Ar(Fr(i.codeName)))}function S9(e,t,r,n,i){Gb(e.slice(0,e.indexOf(">")),r,n,i)}function E9(e,t,r,n,i){var a=!1,s={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}a=!0,s.codeName=Zs(Br(l))}if(e&&e["!outline"]){var A={summaryBelow:1,summaryRight:1};e["!outline"].above&&(A.summaryBelow=0),e["!outline"].left&&(A.summaryRight=0),o=(o||"")+At("outlinePr",null,A)}!a&&!o||(i[i.length]=At("sheetPr",o,s))}var k9=["objects","scenarios","selectLockedCells","selectUnlockedCells"],F9=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function N9(e){var t={sheet:1};return k9.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),F9.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Db(e.password).toString(16).toUpperCase()),At("sheetProtection",null,t)}function T9(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var a=Qt(Fr(t[i]),!0);if(!a.ref)return;var s=((r||{})["!id"]||[])[a.id];s?(a.Target=s.Target,a.location&&(a.Target+="#"+Ar(a.location))):(a.Target="#"+Ar(a.location),s={Target:a.Target,TargetMode:"Internal"}),a.Rel=s,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=cr(a.ref),l=o.s.r;l<=o.e.r;++l)for(var A=o.s.c;A<=o.e.c;++A){var u=Dt({c:A,r:l});n?(e[l]||(e[l]=[]),e[l][A]||(e[l][A]={t:"z",v:void 0}),e[l][A].l=a):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=a)}}}function L9(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function I9(e){return VA(e),At("pageMargins",null,e)}function U9(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Qt(t[n],!0);i.hidden&&(i.hidden=Rr(i.hidden));var a=parseInt(i.min,10)-1,s=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Pb(i.width)),Zl(i);a<=s;)e[a++]=Gr(i)}}function O9(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=At("col",null,p1(i,n)));return r[r.length]="</cols>",r.join("")}function j9(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function D9(e,t,r,n){var i=typeof e.ref=="string"?e.ref:qt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,s=oa(i);s.s.r==s.e.r&&(s.e.r=oa(t["!ref"]).e.r,i=qt(s));for(var o=0;o<a.length;++o){var l=a[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),At("autoFilter",null,{ref:i})}var P9=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Q9(e,t){t.Views||(t.Views=[{}]),(e.match(P9)||[]).forEach(function(r,n){var i=Qt(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),Rr(i.rightToLeft)&&(t.Views[n].RTL=!0)})}function R9(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),At("sheetViews",At("sheetView",null,i),{})}function M9(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",a=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=qo[e.v];break;case"d":n&&n.cellDates?i=Kr(e.v,-1).toISOString():(e=Gr(e),e.t="n",i=""+(e.v=Qn(Kr(e.v)))),typeof e.z>"u"&&(e.z=Ot[14]);break;default:i=e.v;break}var o=ni("v",Br(i)),l={r:t},A=fA(n.cellXfs,e,n);switch(A!==0&&(l.s=A),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=ni("v",""+Kb(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=a&&(e.t=a,e.v=s),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=At("f",Br(e.f),u)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),At("c",o,l)}var H9=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,a=Nd("v"),s=Nd("f");return function(l,A,u,f,h,d){for(var m=0,g="",x=[],p=[],v=0,y=0,w=0,B="",E,_,F=0,T=0,I,S,C=0,L=0,R=Array.isArray(d.CellXf),W,G=[],V=[],X=Array.isArray(A),Q=[],K={},H=!1,k=!!u.sheetStubs,U=l.split(t),P=0,D=U.length;P!=D;++P){g=U[P].trim();var O=g.length;if(O!==0){var z=0;e:for(m=0;m<O;++m)switch(g[m]){case">":if(g[m-1]!="/"){++m;break e}if(u&&u.cellStyles){if(_=Qt(g.slice(z,m),!0),F=_.r!=null?parseInt(_.r,10):F+1,T=-1,u.sheetRows&&u.sheetRows<F)continue;K={},H=!1,_.ht&&(H=!0,K.hpt=parseFloat(_.ht),K.hpx=Xu(K.hpt)),_.hidden=="1"&&(H=!0,K.hidden=!0),_.outlineLevel!=null&&(H=!0,K.level=+_.outlineLevel),H&&(Q[F-1]=K)}break;case"<":z=m;break}if(z>=m)break;if(_=Qt(g.slice(z,m),!0),F=_.r!=null?parseInt(_.r,10):F+1,T=-1,!(u.sheetRows&&u.sheetRows<F)){f.s.r>F-1&&(f.s.r=F-1),f.e.r<F-1&&(f.e.r=F-1),u&&u.cellStyles&&(K={},H=!1,_.ht&&(H=!0,K.hpt=parseFloat(_.ht),K.hpx=Xu(K.hpt)),_.hidden=="1"&&(H=!0,K.hidden=!0),_.outlineLevel!=null&&(H=!0,K.level=+_.outlineLevel),H&&(Q[F-1]=K)),x=g.slice(m).split(e);for(var J=0;J!=x.length&&x[J].trim().charAt(0)=="<";++J);for(x=x.slice(J),m=0;m!=x.length;++m)if(g=x[m].trim(),g.length!==0){if(p=g.match(r),v=m,y=0,w=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,p!=null&&p.length===2){for(v=0,B=p[1],y=0;y!=B.length&&!((w=B.charCodeAt(y)-64)<1||w>26);++y)v=26*v+w;--v,T=v}else++T;for(y=0;y!=g.length&&g.charCodeAt(y)!==62;++y);if(++y,_=Qt(g.slice(0,y),!0),_.r||(_.r=Dt({r:F-1,c:T})),B=g.slice(y),E={t:""},(p=B.match(a))!=null&&p[1]!==""&&(E.v=Ar(p[1])),u.cellFormula){if((p=B.match(s))!=null&&p[1]!==""){if(E.f=Ar(Fr(p[1])).replace(/\r\n/g,`
`),u.xlfn||(E.f=m_(E.f)),p[0].indexOf('t="array"')>-1)E.F=(B.match(i)||[])[1],E.F.indexOf(":")>-1&&G.push([cr(E.F),E.F]);else if(p[0].indexOf('t="shared"')>-1){S=Qt(p[0]);var Y=Ar(Fr(p[1]));u.xlfn||(Y=m_(Y)),V[parseInt(S.si,10)]=[S,Y,_.r]}}else(p=B.match(/<f[^>]*\/>/))&&(S=Qt(p[0]),V[S.si]&&(E.f=PM(V[S.si][1],V[S.si][2],_.r)));var le=Yr(_.r);for(y=0;y<G.length;++y)le.r>=G[y][0].s.r&&le.r<=G[y][0].e.r&&le.c>=G[y][0].s.c&&le.c<=G[y][0].e.c&&(E.F=G[y][1])}if(_.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(k)E.t="z";else continue;else E.t=_.t||"n";switch(f.s.c>T&&(f.s.c=T),f.e.c<T&&(f.e.c=T),E.t){case"n":if(E.v==""||E.v==null){if(!k)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!k)continue;E.t="z"}else I=$h[parseInt(E.v,10)],E.v=I.t,E.r=I.r,u.cellHTML&&(E.h=I.h);break;case"str":E.t="s",E.v=E.v!=null?Fr(E.v):"",u.cellHTML&&(E.h=bb(E.v));break;case"inlineStr":p=B.match(n),E.t="s",p!=null&&(I=jb(p[1]))?(E.v=I.t,u.cellHTML&&(E.h=I.h)):E.v="";break;case"b":E.v=Rr(E.v);break;case"d":u.cellDates?E.v=Kr(E.v,1):(E.v=Qn(Kr(E.v,1)),E.t="n");break;case"e":(!u||u.cellText!==!1)&&(E.w=E.v),E.v=CF[E.v];break}if(C=L=0,W=null,R&&_.s!==void 0&&(W=d.CellXf[_.s],W!=null&&(W.numFmtId!=null&&(C=W.numFmtId),u.cellStyles&&W.fillId!=null&&(L=W.fillId))),bN(E,C,L,u,h,d),u.cellDates&&R&&E.t=="n"&&sf(Ot[C])&&(E.t="d",E.v=u1(E.v)),_.cm&&u.xlmeta){var we=(u.xlmeta.Cell||[])[+_.cm-1];we&&we.type=="XLDAPR"&&(E.D=!0)}if(X){var ne=Yr(_.r);A[ne.r]||(A[ne.r]=[]),A[ne.r][ne.c]=E}else A[_.r]=E}}}}Q.length>0&&(A["!rows"]=Q)}}();function K9(e,t,r,n){var i=[],a=[],s=cr(e["!ref"]),o="",l,A="",u=[],f=0,h=0,d=e["!rows"],m=Array.isArray(e),g={r:A},x,p=-1;for(h=s.s.c;h<=s.e.c;++h)u[h]=Xr(h);for(f=s.s.r;f<=s.e.r;++f){for(a=[],A=bn(f),h=s.s.c;h<=s.e.c;++h){l=u[h]+A;var v=m?(e[f]||[])[h]:e[l];v!==void 0&&(o=M9(v,l,e,t))!=null&&a.push(o)}(a.length>0||d&&d[f])&&(g={r:A},d&&d[f]&&(x=d[f],x.hidden&&(g.hidden=1),p=-1,x.hpx?p=Dd(x.hpx):x.hpt&&(p=x.hpt),p>-1&&(g.ht=p,g.customHeight=1),x.level&&(g.outlineLevel=x.level)),i[i.length]=At("row",a.join(""),g))}if(d)for(;f<d.length;++f)d&&d[f]&&(g={r:f+1},x=d[f],x.hidden&&(g.hidden=1),p=-1,x.hpx?p=Dd(x.hpx):x.hpt&&(p=x.hpt),p>-1&&(g.ht=p,g.customHeight=1),x.level&&(g.outlineLevel=x.level),i[i.length]=At("row","",g));return i.join("")}function _N(e,t,r,n){var i=[Bn,At("worksheet",null,{xmlns:hc[0],"xmlns:r":jn.r})],a=r.SheetNames[e],s=0,o="",l=r.Sheets[a];l==null&&(l={});var A=l["!ref"]||"A1",u=cr(A);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+A+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),A=qt(u)}n||(n={}),l["!comments"]=[];var f=[];E9(l,r,e,t,i),i[i.length]=At("dimension",null,{ref:A}),i[i.length]=R9(l,t,e,r),t.sheetFormat&&(i[i.length]=At("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=O9(l,l["!cols"])),i[s=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=K9(l,t),o.length>0&&(i[i.length]=o)),i.length>s+1&&(i[i.length]="</sheetData>",i[s]=i[s].replace("/>",">")),l["!protect"]&&(i[i.length]=N9(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=D9(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=C9(l["!merges"]));var h=-1,d,m=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(g){g[1].Target&&(d={ref:g[0]},g[1].Target.charAt(0)!="#"&&(m=br(n,-1,Br(g[1].Target).replace(/#.*$/,""),Jt.HLINK),d["r:id"]="rId"+m),(h=g[1].Target.indexOf("#"))>-1&&(d.location=Br(g[1].Target.slice(h+1))),g[1].Tooltip&&(d.tooltip=Br(g[1].Tooltip)),i[i.length]=At("hyperlink",null,d))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=I9(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=ni("ignoredErrors",At("ignoredError",null,{numberStoredAsText:1,sqref:A}))),f.length>0&&(m=br(n,-1,"../drawings/drawing"+(e+1)+".xml",Jt.DRAW),i[i.length]=At("drawing",null,{"r:id":"rId"+m}),l["!drawing"]=f),l["!comments"].length>0&&(m=br(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Jt.VML),i[i.length]=At("legacyDrawing",null,{"r:id":"rId"+m}),l["!legacy"]=m),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function G9(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}function V9(e,t,r){var n=ze(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;i.hpx?a=Dd(i.hpx)*20:i.hpt&&(a=i.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var s=0;i.level&&(s|=i.level),i.hidden&&(s|=16),(i.hpx||i.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var A={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var f=-1,h=-1,d=u<<10;d<u+1<<10;++d){A.c=d;var m=Array.isArray(r)?(r[A.r]||[])[A.c]:r[Dt(A)];m&&(f<0&&(f=d),h=d)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,h))}var g=n.l;return n.l=l,n.write_shift(4,o),n.l=g,n.length>n.l?n.slice(0,n.l):n}function W9(e,t,r,n){var i=V9(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&Ze(e,0,i)}var $9=mc,q9=Af;function z9(){}function X9(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=ZD(e),r}function Y9(e,t,r){r==null&&(r=ze(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Am({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),yF(e,r),r.slice(0,r.l)}function J9(e){var t=os(e);return[t]}function Z9(e,t,r){return r==null&&(r=ze(8)),dc(t,r)}function eK(e){var t=pc(e);return[t]}function tK(e,t,r){return r==null&&(r=ze(4)),gc(t,r)}function rK(e){var t=os(e),r=e.read_shift(1);return[t,r,"b"]}function nK(e,t,r){return r==null&&(r=ze(9)),dc(t,r),r.write_shift(1,e.v?1:0),r}function iK(e){var t=pc(e),r=e.read_shift(1);return[t,r,"b"]}function aK(e,t,r){return r==null&&(r=ze(5)),gc(t,r),r.write_shift(1,e.v?1:0),r}function sK(e){var t=os(e),r=e.read_shift(1);return[t,r,"e"]}function oK(e,t,r){return r==null&&(r=ze(9)),dc(t,r),r.write_shift(1,e.v),r}function lK(e){var t=pc(e),r=e.read_shift(1);return[t,r,"e"]}function AK(e,t,r){return r==null&&(r=ze(8)),gc(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function cK(e){var t=os(e),r=e.read_shift(4);return[t,r,"s"]}function uK(e,t,r){return r==null&&(r=ze(12)),dc(t,r),r.write_shift(4,t.v),r}function fK(e){var t=pc(e),r=e.read_shift(4);return[t,r,"s"]}function hK(e,t,r){return r==null&&(r=ze(8)),gc(t,r),r.write_shift(4,t.v),r}function dK(e){var t=os(e),r=Ci(e);return[t,r,"n"]}function pK(e,t,r){return r==null&&(r=ze(16)),dc(t,r),ac(e.v,r),r}function CN(e){var t=pc(e),r=Ci(e);return[t,r,"n"]}function gK(e,t,r){return r==null&&(r=ze(12)),gc(t,r),ac(e.v,r),r}function mK(e){var t=os(e),r=Tb(e);return[t,r,"n"]}function vK(e,t,r){return r==null&&(r=ze(12)),dc(t,r),wF(e.v,r),r}function xK(e){var t=pc(e),r=Tb(e);return[t,r,"n"]}function yK(e,t,r){return r==null&&(r=ze(8)),gc(t,r),wF(e.v,r),r}function wK(e){var t=os(e),r=kb(e);return[t,r,"is"]}function bK(e){var t=os(e),r=Ei(e);return[t,r,"str"]}function BK(e,t,r){return r==null&&(r=ze(12+4*e.v.length)),dc(t,r),zn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function _K(e){var t=pc(e),r=Ei(e);return[t,r,"str"]}function CK(e,t,r){return r==null&&(r=ze(8+4*e.v.length)),gc(t,r),zn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function SK(e,t,r){var n=e.l+t,i=os(e);i.r=r["!row"];var a=e.read_shift(1),s=[i,a,"b"];if(r.cellFormula){e.l+=2;var o=d1(e,n-e.l,r);s[3]=yi(o,null,i,r.supbooks,r)}else e.l=n;return s}function EK(e,t,r){var n=e.l+t,i=os(e);i.r=r["!row"];var a=e.read_shift(1),s=[i,a,"e"];if(r.cellFormula){e.l+=2;var o=d1(e,n-e.l,r);s[3]=yi(o,null,i,r.supbooks,r)}else e.l=n;return s}function kK(e,t,r){var n=e.l+t,i=os(e);i.r=r["!row"];var a=Ci(e),s=[i,a,"n"];if(r.cellFormula){e.l+=2;var o=d1(e,n-e.l,r);s[3]=yi(o,null,i,r.supbooks,r)}else e.l=n;return s}function FK(e,t,r){var n=e.l+t,i=os(e);i.r=r["!row"];var a=Ei(e),s=[i,a,"str"];if(r.cellFormula){e.l+=2;var o=d1(e,n-e.l,r);s[3]=yi(o,null,i,r.supbooks,r)}else e.l=n;return s}var NK=mc,TK=Af;function LK(e,t){return t==null&&(t=ze(4)),t.write_shift(4,e),t}function IK(e,t){var r=e.l+t,n=mc(e),i=Fb(e),a=Ei(e),s=Ei(e),o=Ei(e);e.l=r;var l={rfx:n,relId:i,loc:a,display:o};return s&&(l.Tooltip=s),l}function UK(e,t){var r=ze(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Af({s:Yr(e[0]),e:Yr(e[0])},r),Nb("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return zn(i||"",r),zn(e[1].Tooltip||"",r),zn("",r),r.slice(0,r.l)}function OK(){}function jK(e,t,r){var n=e.l+t,i=bF(e),a=e.read_shift(1),s=[i];if(s[2]=a,r.cellFormula){var o=s9(e,n-e.l,r);s[1]=o}else e.l=n;return s}function DK(e,t,r){var n=e.l+t,i=mc(e),a=[i];if(r.cellFormula){var s=l9(e,n-e.l,r);a[1]=s,e.l=n}else e.l=n;return a}function PK(e,t,r){r==null&&(r=ze(18));var n=p1(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var SN=["left","right","top","bottom","header","footer"];function QK(e){var t={};return SN.forEach(function(r){t[r]=Ci(e)}),t}function RK(e,t){return t==null&&(t=ze(6*8)),VA(e),SN.forEach(function(r){ac(e[r],t)}),t}function MK(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function HK(e,t,r){r==null&&(r=ze(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function KK(e){var t=ze(24);return t.write_shift(4,4),t.write_shift(4,1),Af(e,t),t}function GK(e,t){return t==null&&(t=ze(16*4+2)),t.write_shift(2,e.password?Db(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function VK(){}function WK(){}function $K(e,t,r,n,i,a,s){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},A,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,d,m,g,x,p,v,y,w,B,E=[];o.biff=12,o["!row"]=0;var _=0,F=!1,T=[],I={},S=o.supbooks||i.supbooks||[[]];if(S.sharedf=I,S.arrayf=T,S.SheetNames=i.SheetNames||i.Sheets.map(function(X){return X.name}),!o.supbooks&&(o.supbooks=S,i.Names))for(var C=0;C<i.Names.length;++C)S[0][C+1]=i.Names[C];var L=[],R=[],W=!1;Pd[16]={n:"BrtShortReal",f:CN};var G;if($o(e,function(Q,K,H){if(!h)switch(H){case 148:A=Q;break;case 0:d=Q,o.sheetRows&&o.sheetRows<=d.r&&(h=!0),w=bn(x=d.r),o["!row"]=d.r,(Q.hidden||Q.hpt||Q.level!=null)&&(Q.hpt&&(Q.hpx=Xu(Q.hpt)),R[Q.r]=Q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:Q[2]},Q[2]){case"n":m.v=Q[1];break;case"s":y=$h[Q[1]],m.v=y.t,m.r=y.r;break;case"b":m.v=!!Q[1];break;case"e":m.v=Q[1],o.cellText!==!1&&(m.w=qo[m.v]);break;case"str":m.t="s",m.v=Q[1];break;case"is":m.t="s",m.v=Q[1].t;break}if((g=s.CellXf[Q[0].iStyleRef])&&bN(m,g.numFmtId,null,o,a,s),p=Q[0].c==-1?p+1:Q[0].c,o.dense?(l[x]||(l[x]=[]),l[x][p]=m):l[Xr(p)+w]=m,o.cellFormula){for(F=!1,_=0;_<T.length;++_){var k=T[_];d.r>=k[0].s.r&&d.r<=k[0].e.r&&p>=k[0].s.c&&p<=k[0].e.c&&(m.F=qt(k[0]),F=!0)}!F&&Q.length>3&&(m.f=Q[3])}if(u.s.r>d.r&&(u.s.r=d.r),u.s.c>p&&(u.s.c=p),u.e.r<d.r&&(u.e.r=d.r),u.e.c<p&&(u.e.c=p),o.cellDates&&g&&m.t=="n"&&sf(Ot[g.numFmtId])){var U=jA(m.v);U&&(m.t="d",m.v=new Date(U.y,U.m-1,U.d,U.H,U.M,U.S,U.u))}G&&(G.type=="XLDAPR"&&(m.D=!0),G=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;m={t:"z",v:void 0},p=Q[0].c==-1?p+1:Q[0].c,o.dense?(l[x]||(l[x]=[]),l[x][p]=m):l[Xr(p)+w]=m,u.s.r>d.r&&(u.s.r=d.r),u.s.c>p&&(u.s.c=p),u.e.r<d.r&&(u.e.r=d.r),u.e.c<p&&(u.e.c=p),G&&(G.type=="XLDAPR"&&(m.D=!0),G=void 0);break;case 176:E.push(Q);break;case 49:G=((o.xlmeta||{}).Cell||[])[Q-1];break;case 494:var P=n["!id"][Q.relId];for(P?(Q.Target=P.Target,Q.loc&&(Q.Target+="#"+Q.loc),Q.Rel=P):Q.relId==""&&(Q.Target="#"+Q.loc),x=Q.rfx.s.r;x<=Q.rfx.e.r;++x)for(p=Q.rfx.s.c;p<=Q.rfx.e.c;++p)o.dense?(l[x]||(l[x]=[]),l[x][p]||(l[x][p]={t:"z",v:void 0}),l[x][p].l=Q):(v=Dt({c:p,r:x}),l[v]||(l[v]={t:"z",v:void 0}),l[v].l=Q);break;case 426:if(!o.cellFormula)break;T.push(Q),B=o.dense?l[x][p]:l[Xr(p)+w],B.f=yi(Q[1],u,{r:d.r,c:p},S,o),B.F=qt(Q[0]);break;case 427:if(!o.cellFormula)break;I[Dt(Q[0].s)]=Q[1],B=o.dense?l[x][p]:l[Xr(p)+w],B.f=yi(Q[1],u,{r:d.r,c:p},S,o);break;case 60:if(!o.cellStyles)break;for(;Q.e>=Q.s;)L[Q.e--]={width:Q.w/256,hidden:!!(Q.flags&1),level:Q.level},W||(W=!0,Pb(Q.w/256)),Zl(L[Q.e+1]);break;case 161:l["!autofilter"]={ref:qt(Q)};break;case 476:l["!margins"]=Q;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),Q.name&&(i.Sheets[r].CodeName=Q.name),(Q.above||Q.left)&&(l["!outline"]={above:Q.above,left:Q.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),Q.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!K.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+H.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||A&&(A.e.r>0||A.e.c>0||A.s.r>0||A.s.c>0))&&(l["!ref"]=qt(A||u)),o.sheetRows&&l["!ref"]){var V=cr(l["!ref"]);o.sheetRows<=+V.e.r&&(V.e.r=o.sheetRows-1,V.e.r>u.e.r&&(V.e.r=u.e.r),V.e.r<V.s.r&&(V.s.r=V.e.r),V.e.c>u.e.c&&(V.e.c=u.e.c),V.e.c<V.s.c&&(V.s.c=V.e.c),l["!fullref"]=l["!ref"],l["!ref"]=qt(V))}return E.length>0&&(l["!merges"]=E),L.length>0&&(l["!cols"]=L),R.length>0&&(l["!rows"]=R),l}function qK(e,t,r,n,i,a,s){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Gr(t),t.z=t.z||Ot[14],t.v=Qn(Kr(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=fA(i.cellXfs,t,i),t.l&&a["!links"].push([Dt(l),t.l]),t.c&&a["!comments"].push([Dt(l),t.c]),t.t){case"s":case"str":return i.bookSST?(o=Kb(i.Strings,t.v,i.revStrings),l.t="s",l.v=o,s?Ze(e,18,hK(t,l)):Ze(e,7,uK(t,l))):(l.t="str",s?Ze(e,17,CK(t,l)):Ze(e,6,BK(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?Ze(e,13,yK(t,l)):Ze(e,2,vK(t,l)):s?Ze(e,16,gK(t,l)):Ze(e,5,pK(t,l)),!0;case"b":return l.t="b",s?Ze(e,15,aK(t,l)):Ze(e,4,nK(t,l)),!0;case"e":return l.t="e",s?Ze(e,14,AK(t,l)):Ze(e,3,oK(t,l)),!0}return s?Ze(e,12,tK(t,l)):Ze(e,1,Z9(t,l)),!0}function zK(e,t,r,n){var i=cr(t["!ref"]||"A1"),a,s="",o=[];Ze(e,145);var l=Array.isArray(t),A=i.e.r;t["!rows"]&&(A=Math.max(i.e.r,t["!rows"].length-1));for(var u=i.s.r;u<=A;++u){s=bn(u),W9(e,t,i,u);var f=!1;if(u<=i.e.r)for(var h=i.s.c;h<=i.e.c;++h){u===i.s.r&&(o[h]=Xr(h)),a=o[h]+s;var d=l?(t[u]||[])[h]:t[a];if(!d){f=!1;continue}f=qK(e,d,u,h,n,t,f)}}Ze(e,146)}function XK(e,t){!t||!t["!merges"]||(Ze(e,177,LK(t["!merges"].length)),t["!merges"].forEach(function(r){Ze(e,176,TK(r))}),Ze(e,178))}function YK(e,t){!t||!t["!cols"]||(Ze(e,390),t["!cols"].forEach(function(r,n){r&&Ze(e,60,PK(n,r))}),Ze(e,391))}function JK(e,t){!t||!t["!ref"]||(Ze(e,648),Ze(e,649,KK(cr(t["!ref"]))),Ze(e,650))}function ZK(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=br(r,-1,n[1].Target.replace(/#.*$/,""),Jt.HLINK);Ze(e,494,UK(n,i))}}),delete t["!links"]}function eG(e,t,r,n){if(t["!comments"].length>0){var i=br(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Jt.VML);Ze(e,551,Nb("rId"+i)),t["!legacy"]=i}}function tG(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],a=typeof i.ref=="string"?i.ref:qt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=oa(a);o.s.r==o.e.r&&(o.e.r=oa(t["!ref"]).e.r,a=qt(o));for(var l=0;l<s.length;++l){var A=s[l];if(A.Name=="_xlnm._FilterDatabase"&&A.Sheet==n){A.Ref="'"+r.SheetNames[n]+"'!"+a;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ze(e,161,Af(cr(a))),Ze(e,162)}}function rG(e,t,r){Ze(e,133),Ze(e,137,HK(t,r)),Ze(e,138),Ze(e,134)}function nG(e,t){t["!protect"]&&Ze(e,535,GK(t["!protect"]))}function iG(e,t,r,n){var i=sa(),a=r.SheetNames[e],s=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=cr(s["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],Ze(i,129),(r.vbaraw||s["!outline"])&&Ze(i,147,Y9(o,s["!outline"])),Ze(i,148,q9(l)),rG(i,s,r.Workbook),YK(i,s),zK(i,s,e,t),nG(i,s),tG(i,s,r,e),XK(i,s),ZK(i,s,n),s["!margins"]&&Ze(i,476,RK(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&JK(i,s),eG(i,s,e,n),Ze(i,130),i.end()}function aG(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var s=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var i=Ar((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,i,n]}function sG(e,t,r,n,i,a){var s=a||{"!type":"chart"};if(!e)return a;var o=0,l=0,A="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=aG(f);u.s.r=u.s.c=0,u.e.c=o,A=Xr(o),h[0].forEach(function(d,m){s[A+bn(m)]={t:"n",v:d,z:h[1]},l=m}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(s["!ref"]=qt(u)),s}function oG(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(BN);return o&&Gb(o[0],a,i,r),(s=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=s[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function lG(e,t){e.l+=10;var r=Ei(e);return{name:r}}function AG(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s=!1;return $o(e,function(l,A,u){switch(u){case 550:a["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(A.T>0)){if(!(A.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var Vb=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],cG=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],uG=[],fG=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function b_(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var a=t[i];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Rr(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function B_(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Rr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function EN(e){B_(e.WBProps,Vb),B_(e.CalcPr,fG),b_(e.WBView,cG),b_(e.Sheets,uG),Pu.date1904=Rr(e.WBProps.date1904)}function hG(e){return!e.Workbook||!e.Workbook.WBProps?"false":Rr(e.Workbook.WBProps.date1904)?"true":"false"}var dG="][*?/\\".split("");function kN(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return dG.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function pG(e,t,r){e.forEach(function(n,i){kN(n);for(var a=0;a<i;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[i]&&t[i].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function gG(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];pG(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)h9(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var mG=/<\w+:workbook/;function vG(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",a={},s=0;if(e.replace(Ti,function(l,A){var u=Qt(l);switch(so(u[0])){case"<?xml":break;case"<workbook":l.match(mG)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Vb.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Rr(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=Fr(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Ar(Fr(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Fr(u.name),u.comment&&(a.Comment=u.comment),u.localSheetId&&(a.Sheet=+u.localSheetId),Rr(u.hidden||"0")&&(a.Hidden=!0),s=A+l.length;break;case"</definedName>":a.Ref=Ar(Fr(e.slice(s,A))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),hc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return EN(r),r}function FN(e){var t=[Bn];t[t.length]=At("workbook",null,{xmlns:hc[0],"xmlns:r":jn.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Vb.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=At("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],a=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!i[a]||!i[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var s={name:Br(e.SheetNames[a].slice(0,31))};if(s.sheetId=""+(a+1),s["r:id"]="rId"+(a+1),i[a])switch(i[a].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=At("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=At("definedName",Br(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function xG(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=ly(e),r.name=Ei(e),r}function yG(e,t){return t||(t=ze(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Nb(e.strRelID,t),zn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function wG(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Ei(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function bG(e,t){t||(t=ze(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),yF(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function BG(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function _G(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),a=eP(e),s=o9(e,0,r),o=Fb(e);e.l=n;var l={Name:a,Ptg:s};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function CG(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var a=[],s=[[]];return s.SheetNames=[],s.XTI=[],Pd[16]={n:"BrtFRTArchID$",f:BG},$o(e,function(l,A,u){switch(u){case 156:s.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=yi(l.Ptg,null,null,s,t),delete t.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([u,l]):s[0]=[u,l],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(l),s.XTI=s.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(u),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!A.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),EN(r),r.Names=a,r.supbooks=s,r}function SG(e,t){Ze(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Ze(e,156,yG(i))}Ze(e,144)}function EG(e,t){t||(t=ze(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return zn("SheetJS",t),zn(rm.version,t),zn(rm.version,t),zn("7262",t),t.length>t.l?t.slice(0,t.l):t}function kG(e,t){t||(t=ze(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function FG(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&a==-1&&(a=n);a>i||(Ze(e,135),Ze(e,158,kG(i)),Ze(e,136))}}function NG(e,t){var r=sa();return Ze(r,131),Ze(r,128,EG()),Ze(r,153,bG(e.Workbook&&e.Workbook.WBProps||null)),FG(r,e),SG(r,e),Ze(r,132),r.end()}function TG(e,t,r){return t.slice(-4)===".bin"?CG(e,r):vG(e,r)}function LG(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?$K(e,n,r,i,a,s,o):_9(e,n,r,i,a,s,o)}function IG(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?AG(e,n,r,i,a):oG(e,n,r,i,a)}function UG(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?jM():DM()}function OG(e,t,r,n,i,a,s,o){return t.slice(-4)===".bin"?UM():OM()}function jG(e,t,r,n){return t.slice(-4)===".bin"?TR(e,r,n):xR(e,r,n)}function DG(e,t,r){return AN(e,r)}function PG(e,t,r){return t.slice(-4)===".bin"?P7(e,r):O7(e,r)}function QG(e,t,r){return t.slice(-4)===".bin"?FM(e,r):yM(e,r)}function RG(e,t,r){return t.slice(-4)===".bin"?mM(e):pM(e)}function MG(e,t,r,n){return r.slice(-4)===".bin"?vM(e,t,r,n):void 0}function HG(e,t,r){return t.slice(-4)===".bin"?fM(e,t,r):dM(e,t,r)}function KG(e,t,r){return(t.slice(-4)===".bin"?NG:FN)(e)}function GG(e,t,r,n,i){return(t.slice(-4)===".bin"?iG:_N)(e,r,n,i)}function VG(e,t,r){return(t.slice(-4)===".bin"?MR:oN)(e,r)}function WG(e,t,r){return(t.slice(-4)===".bin"?M7:ZF)(e,r)}function $G(e,t,r){return(t.slice(-4)===".bin"?NM:fN)(e)}function qG(e){return(e.slice(-4)===".bin"?hM:cN)()}var NN=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,TN=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function gs(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(NN),a,s,o,l;if(i)for(l=0;l!=i.length;++l)a=i[l].match(TN),(s=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),n[o]=a[2].slice(1,a[2].length-1));return n}function zG(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(NN),i,a,s,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(TN),(a=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?s="xmlns"+i[1].slice(6):s=i[1].slice(a+1),r[s]=i[2].slice(1,i[2].length-1));return r}var zh;function XG(e,t){var r=zh[e]||Ar(e);return r==="General"?nc(t):ss(r,t)}function YG(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Rr(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Kr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ar(t)]=i}function JG(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||qo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Fd(e.v):e.w=nc(e.v):e.w=XG(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=zh[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&sf(n)){var i=jA(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(a){if(r.WTF)throw a}}}function ZG(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=uR[n.Pattern]||n.Pattern)}e[t.ID]=t}function eV(e,t,r,n,i,a,s,o,l,A){var u="General",f=n.StyleID,h={};A=A||{};var d=[],m=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&s&&(f=s.StyleID);a[f]!==void 0&&(a[f].nf&&(u=a[f].nf),a[f].Interior&&d.push(a[f].Interior),!!a[f].Parent);)f=a[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Rr(e);break;case"String":n.t="s",n.r=R4(Ar(e)),n.v=e.indexOf("<")>-1?Ar(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Kr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ar(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=CF[e],A.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=R4(t||e));break}if(JG(n,u,A),A.cellFormula!==!1)if(n.Formula){var g=Ar(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=Du(g,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Du("RC:RC",i):n.ArrayRange&&(n.F=Du(n.ArrayRange,i),l.push([cr(n.F),n.F]))}else for(m=0;m<l.length;++m)i.r>=l[m][0].s.r&&i.r<=l[m][0].e.r&&i.c>=l[m][0].s.c&&i.c<=l[m][0].e.c&&(n.F=l[m][1]);A.cellStyles&&(d.forEach(function(x){!h.patternType&&x.patternType&&(h.patternType=x.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function tV(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function ux(e,t){var r=t||{};of();var n=xh(Bb(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Fr(n));var i=n.slice(0,1024).toLowerCase(),a=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var s=Gr(r);return s.type="string",zu.to_workbook(n,s)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(xe){i.indexOf("<"+xe)>=0&&(a=!0)}),a)return RV(n,r);zh={"General Number":"General","General Date":Ot[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ot[15],"Short Date":Ot[14],"Long Time":Ot[19],"Medium Time":Ot[18],"Short Time":Ot[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ot[2],Standard:Ot[4],Percent:Ot[10],Scientific:Ot[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],A,u={},f=[],h=r.dense?[]:{},d="",m={},g={},x=gs('<Data ss:Type="String">'),p=0,v=0,y=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},B={},E={},_="",F=0,T=[],I={},S={},C=0,L=[],R=[],W={},G=[],V,X=!1,Q=[],K=[],H={},k=0,U=0,P={Sheets:[],WBProps:{date1904:!1}},D={};Ld.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var O="";o=Ld.exec(n);)switch(o[3]=(O=o[3]).toLowerCase()){case"data":if(O=="data"){if(o[1]==="/"){if((A=l.pop())[0]!==o[3])throw new Error("Bad state: "+A.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?eV(n.slice(p,o.index),_,x,l[l.length-1][0]=="comment"?W:m,{c:v,r:y},B,G[v],g,Q,r):(_="",x=gs(o[0]),p=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(R.length>0&&(m.c=R),(!r.sheetRows||r.sheetRows>y)&&m.v!==void 0&&(r.dense?(h[y]||(h[y]=[]),h[y][v]=m):h[Xr(v)+bn(y)]=m),m.HRef&&(m.l={Target:Ar(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(k=v+(parseInt(m.MergeAcross,10)|0),U=y+(parseInt(m.MergeDown,10)|0),T.push({s:{c:v,r:y},e:{c:k,r:U}})),!r.sheetStubs)m.MergeAcross?v=k+1:++v;else if(m.MergeAcross||m.MergeDown){for(var z=v;z<=k;++z)for(var J=y;J<=U;++J)(z>v||J>y)&&(r.dense?(h[J]||(h[J]=[]),h[J][z]={t:"z"}):h[Xr(z)+bn(J)]={t:"z"});v=k+1}else++v;else m=zG(o[0]),m.Index&&(v=+m.Index-1),v<w.s.c&&(w.s.c=v),v>w.e.c&&(w.e.c=v),o[0].slice(-2)==="/>"&&++v,R=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<w.s.r&&(w.s.r=y),y>w.e.r&&(w.e.r=y),o[0].slice(-2)==="/>"&&(g=gs(o[0]),g.Index&&(y=+g.Index-1)),v=0,++y):(g=gs(o[0]),g.Index&&(y=+g.Index-1),H={},(g.AutoFitHeight=="0"||g.Height)&&(H.hpx=parseInt(g.Height,10),H.hpt=Dd(H.hpx),K[y]=H),g.Hidden=="1"&&(H.hidden=!0,K[y]=H));break;case"worksheet":if(o[1]==="/"){if((A=l.pop())[0]!==o[3])throw new Error("Bad state: "+A.join("|"));f.push(d),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(h["!ref"]=qt(w),r.sheetRows&&r.sheetRows<=w.e.r&&(h["!fullref"]=h["!ref"],w.e.r=r.sheetRows-1,h["!ref"]=qt(w))),T.length&&(h["!merges"]=T),G.length>0&&(h["!cols"]=G),K.length>0&&(h["!rows"]=K),u[d]=h}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=v=0,l.push([o[3],!1]),A=gs(o[0]),d=Ar(A.Name),h=r.dense?[]:{},T=[],Q=[],K=[],D={name:d,Hidden:0},P.Sheets.push(D);break;case"table":if(o[1]==="/"){if((A=l.pop())[0]!==o[3])throw new Error("Bad state: "+A.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),G=[],X=!1}break;case"style":o[1]==="/"?ZG(B,E,r):E=gs(o[0]);break;case"numberformat":E.nf=Ar(gs(o[0]).Format||"General"),zh[E.nf]&&(E.nf=zh[E.nf]);for(var Y=0;Y!=392&&Ot[Y]!=E.nf;++Y);if(Y==392){for(Y=57;Y!=392;++Y)if(Ot[Y]==null){jo(E.nf,Y);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(V=gs(o[0]),V.Hidden&&(V.hidden=!0,delete V.Hidden),V.Width&&(V.wpx=parseInt(V.Width,10)),!X&&V.wpx>10){X=!0,Bi=aN;for(var le=0;le<G.length;++le)G[le]&&Zl(G[le])}X&&Zl(V),G[V.Index-1||G.length]=V;for(var we=0;we<+V.Span;++we)G[G.length]=Gr(V);break;case"namedrange":if(o[1]==="/")break;P.Names||(P.Names=[]);var ne=Qt(o[0]),Me={Name:ne.Name,Ref:Du(ne.RefersTo.slice(1),{r:0,c:0})};P.Sheets.length>0&&(Me.Sheet=P.Sheets.length-1),P.Names.push(Me);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?_+=n.slice(F,o.index):F=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=gs(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?CP(I,O,n.slice(C,o.index)):C=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((A=l.pop())[0]!==o[3])throw new Error("Bad state: "+A.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((A=l.pop())[0]!==o[3])throw new Error("Bad state: "+A.join("|"));tV(W),R.push(W)}else l.push([o[3],!1]),A=gs(o[0]),W={a:A.Author};break;case"autofilter":if(o[1]==="/"){if((A=l.pop())[0]!==o[3])throw new Error("Bad state: "+A.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var qe=gs(o[0]);h["!autofilter"]={ref:Du(qe.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((A=l.pop())[0]!==o[3])throw new Error("Bad state: "+A.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((A=l.pop())[0]!==o[3])throw new Error("Bad state: "+A.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return k_(n,r);var Fe=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Fe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Fe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":P.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Fe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Fe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(C,o.index)){case"SheetHidden":D.Hidden=1;break;case"SheetVeryHidden":D.Hidden=2;break}else C=o.index+o[0].length;break;case"header":h["!margins"]||VA(h["!margins"]={},"xlml"),isNaN(+Qt(o[0]).Margin)||(h["!margins"].header=+Qt(o[0]).Margin);break;case"footer":h["!margins"]||VA(h["!margins"]={},"xlml"),isNaN(+Qt(o[0]).Margin)||(h["!margins"].footer=+Qt(o[0]).Margin);break;case"pagemargins":var he=Qt(o[0]);h["!margins"]||VA(h["!margins"]={},"xlml"),isNaN(+he.Top)||(h["!margins"].top=+he.Top),isNaN(+he.Left)||(h["!margins"].left=+he.Left),isNaN(+he.Right)||(h["!margins"].right=+he.Right),isNaN(+he.Bottom)||(h["!margins"].bottom=+he.Bottom);break;case"displayrighttoleft":P.Views||(P.Views=[]),P.Views[0]||(P.Views[0]={}),P.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Fe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Fe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Fe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Fe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Fe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Fe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Fe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Fe=!1}break;case"smarttags":break;default:Fe=!1;break}if(Fe||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?YG(S,O,L,n.slice(C,o.index)):(L=o,C=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Be={};return!r.bookSheets&&!r.bookProps&&(Be.Sheets=u),Be.SheetNames=f,Be.Workbook=P,Be.SSF=Gr(Ot),Be.Props=I,Be.Custprops=S,Be}function py(e,t){switch($b(t=t||{}),t.type||"base64"){case"base64":return ux(Sa(e),t);case"binary":case"buffer":case"file":return ux(e,t);case"array":return ux(cA(e),t)}}function rV(e,t){var r=[];return e.Props&&r.push(SP(e.Props,t)),e.Custprops&&r.push(EP(e.Props,e.Custprops)),r.join("")}function nV(){return""}function iV(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var a=[];a.push(At("NumberFormat",null,{"ss:Format":Br(Ot[n.numFmtId])}));var s={"ss:ID":"s"+(21+i)};r.push(At("Style",a.join(""),s))}),At("Styles",r.join(""))}function LN(e){return At("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Mb(e.Ref,{r:0,c:0})})}function aV(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(LN(i)))}return At("Names",r.join(""))}function sV(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,a=[],s=0;s<i.length;++s){var o=i[s];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(LN(o)))}return a.join("")}function oV(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(At("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(At("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(At("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(At("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(ni("ProtectContents","True")),e["!protect"].objects&&i.push(ni("ProtectObjects","True")),e["!protect"].scenarios&&i.push(ni("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(ni("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(ni("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&i.push("<"+s[1]+"/>")})),i.length==0?"":At("WorksheetOptions",i.join(""),{xmlns:ma.x})}function lV(e){return e.map(function(t){var r=FD(t.t||""),n=At("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return At("Comment",n,{"ss:Author":t.a})}).join("")}function AV(e,t,r,n,i,a,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Br(Mb(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var l=Yr(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Br(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Br(e.l.Tooltip))),r["!merges"])for(var A=r["!merges"],u=0;u!=A.length;++u)A[u].s.c!=s.c||A[u].s.r!=s.r||(A[u].e.c>A[u].s.c&&(o["ss:MergeAcross"]=A[u].e.c-A[u].s.c),A[u].e.r>A[u].s.r&&(o["ss:MergeDown"]=A[u].e.r-A[u].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=qo[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ot[14]);break;case"s":f="String",h=kD(e.v||"");break}var d=fA(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+d),o["ss:Index"]=s.c+1;var m=e.v!=null?h:"",g=e.t=="z"?"":'<Data ss:Type="'+f+'">'+m+"</Data>";return(e.c||[]).length>0&&(g+=lV(e.c)),At("Cell",g,o)}function cV(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Xu(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function uV(e,t,r,n){if(!e["!ref"])return"";var i=cr(e["!ref"]),a=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(x,p){Zl(x);var v=!!x.width,y=p1(p,x),w={"ss:Index":p+1};v&&(w["ss:Width"]=Od(y.width)),x.hidden&&(w["ss:Hidden"]="1"),o.push(At("Column",null,w))});for(var l=Array.isArray(e),A=i.s.r;A<=i.e.r;++A){for(var u=[cV(A,(e["!rows"]||[])[A])],f=i.s.c;f<=i.e.c;++f){var h=!1;for(s=0;s!=a.length;++s)if(!(a[s].s.c>f)&&!(a[s].s.r>A)&&!(a[s].e.c<f)&&!(a[s].e.r<A)){(a[s].s.c!=f||a[s].s.r!=A)&&(h=!0);break}if(!h){var d={r:A,c:f},m=Dt(d),g=l?(e[A]||[])[f]:e[m];u.push(AV(g,m,e,t,r,n,d))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function fV(e,t,r){var n=[],i=r.SheetNames[e],a=r.Sheets[i],s=a?sV(a,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=a?uV(a,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(oV(a,t,e,r)),n.join("")}function hV(e,t){t||(t={}),e.SSF||(e.SSF=Gr(Ot)),e.SSF&&(of(),l1(e.SSF),t.revssf=c1(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],fA(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(rV(e,t)),r.push(nV()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(At("Worksheet",fV(n,t,e),{"ss:Name":Br(e.SheetNames[n])}));return r[2]=iV(e,t),r[3]=aV(e),Bn+At("Workbook",r.join(""),{xmlns:ma.ss,"xmlns:o":ma.o,"xmlns:x":ma.x,"xmlns:ss":ma.ss,"xmlns:dt":ma.dt,"xmlns:html":ma.html})}function dV(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=aP(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=sP(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var pV=[60,1084,2066,2165,2175];function gV(e,t,r,n,i){var a=n,s=[],o=r.slice(r.l,r.l+a);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}s.push(o),r.l+=a;for(var l=Io(r,r.l),A=gy[l],u=0;A!=null&&pV.indexOf(l)>-1;)a=Io(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+a),s.push(o),r.l+=4+a,A=gy[l=Io(r,r.l)];var f=qn(s);ri(f,0);var h=0;f.lens=[];for(var d=0;d<s.length;++d)f.lens.push(h),h+=s[d].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,i)}function Vs(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ot[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||qo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Fd(e.v):e.w=nc(e.v):e.w=ss(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&sf(Ot[n]||String(n))){var i=jA(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Up(e,t,r){return{v:e,ixfe:t,t:r}}function mV(e,t){var r={opts:{}},n={},i=t.dense?[]:{},a={},s={},o=null,l=[],A="",u={},f,h="",d,m,g,x,p={},v=[],y,w,B=[],E=[],_={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},T=function(at){return at<8?HA[at]:at<64&&E[at-8]||HA[at]},I=function(at,et,ur){var Ft=et.XF.data;if(!(!Ft||!Ft.patternType||!ur||!ur.cellStyles)){et.s={},et.s.patternType=Ft.patternType;var tn;(tn=Ud(T(Ft.icvFore)))&&(et.s.fgColor={rgb:tn}),(tn=Ud(T(Ft.icvBack)))&&(et.s.bgColor={rgb:tn})}},S=function(at,et,ur){if(!(H>1)&&!(ur.sheetRows&&at.r>=ur.sheetRows)){if(ur.cellStyles&&et.XF&&et.XF.data&&I(at,et,ur),delete et.ixfe,delete et.XF,f=at,h=Dt(at),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),at.r<s.s.r&&(s.s.r=at.r),at.c<s.s.c&&(s.s.c=at.c),at.r+1>s.e.r&&(s.e.r=at.r+1),at.c+1>s.e.c&&(s.e.c=at.c+1),ur.cellFormula&&et.f){for(var Ft=0;Ft<v.length;++Ft)if(!(v[Ft][0].s.c>at.c||v[Ft][0].s.r>at.r)&&!(v[Ft][0].e.c<at.c||v[Ft][0].e.r<at.r)){et.F=qt(v[Ft][0]),(v[Ft][0].s.c!=at.c||v[Ft][0].s.r!=at.r)&&delete et.f,et.f&&(et.f=""+yi(v[Ft][1],s,at,Q,C));break}}ur.dense?(i[at.r]||(i[at.r]=[]),i[at.r][at.c]=et):i[h]=et}},C={enc:!1,sbcch:0,snames:[],sharedf:p,arrayf:v,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(C.password=t.password);var L,R=[],W=[],G=[],V=[],X=!1,Q=[];Q.SheetNames=C.snames,Q.sharedf=C.sharedf,Q.arrayf=C.arrayf,Q.names=[],Q.XTI=[];var K=0,H=0,k=0,U=[],P=[],D;C.codepage=1200,Ss(1200);for(var O=!1;e.l<e.length-1;){var z=e.l,J=e.read_shift(2);if(J===0&&K===10)break;var Y=e.l===e.length?0:e.read_shift(2),le=gy[J];if(le&&le.f){if(t.bookSheets&&K===133&&J!==133)break;if(K=J,le.r===2||le.r==12){var we=e.read_shift(2);if(Y-=2,!C.enc&&we!==J&&((we&255)<<8|we>>8)!==J)throw new Error("rt mismatch: "+we+"!="+J);le.r==12&&(e.l+=10,Y-=10)}var ne={};if(J===10?ne=le.f(e,Y,C):ne=gV(J,le,e,Y,C),H==0&&[9,521,1033,2057].indexOf(K)===-1)continue;switch(J){case 34:r.opts.Date1904=_.WBProps.date1904=ne;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(C.enc||(e.l=0),C.enc=ne,!t.password)throw new Error("File is password-protected");if(ne.valid==null)throw new Error("Encryption scheme unsupported");if(!ne.valid)throw new Error("Password is incorrect");break;case 92:C.lastuser=ne;break;case 66:var Me=Number(ne);switch(Me){case 21010:Me=1200;break;case 32768:Me=1e4;break;case 32769:Me=1252;break}Ss(C.codepage=Me),O=!0;break;case 317:C.rrtabid=ne;break;case 25:C.winlocked=ne;break;case 439:r.opts.RefreshAll=ne;break;case 12:r.opts.CalcCount=ne;break;case 16:r.opts.CalcDelta=ne;break;case 17:r.opts.CalcIter=ne;break;case 13:r.opts.CalcMode=ne;break;case 14:r.opts.CalcPrecision=ne;break;case 95:r.opts.CalcSaveRecalc=ne;break;case 15:C.CalcRefMode=ne;break;case 2211:r.opts.FullCalc=ne;break;case 129:ne.fDialog&&(i["!type"]="dialog"),ne.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),ne.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:B.push(ne);break;case 430:Q.push([ne]),Q[Q.length-1].XTI=[];break;case 35:case 547:Q[Q.length-1].push(ne);break;case 24:case 536:D={Name:ne.Name,Ref:yi(ne.rgce,s,null,Q,C)},ne.itab>0&&(D.Sheet=ne.itab-1),Q.names.push(D),Q[0]||(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].push(ne),ne.Name=="_xlnm._FilterDatabase"&&ne.itab>0&&ne.rgce&&ne.rgce[0]&&ne.rgce[0][0]&&ne.rgce[0][0][0]=="PtgArea3d"&&(P[ne.itab-1]={ref:qt(ne.rgce[0][0][1][2])});break;case 22:C.ExternCount=ne;break;case 23:Q.length==0&&(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].XTI=Q[Q.length-1].XTI.concat(ne),Q.XTI=Q.XTI.concat(ne);break;case 2196:if(C.biff<8)break;D!=null&&(D.Comment=ne[1]);break;case 18:i["!protect"]=ne;break;case 19:ne!==0&&C.WTF&&console.error("Password verifier: "+ne);break;case 133:a[ne.pos]=ne,C.snames.push(ne.name);break;case 10:{if(--H)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,i["!ref"]=qt(s),t.sheetRows&&t.sheetRows<=s.e.r){var qe=s.e.r;s.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=qt(s),s.e.r=qe}s.e.r++,s.e.c++}R.length>0&&(i["!merges"]=R),W.length>0&&(i["!objects"]=W),G.length>0&&(i["!cols"]=G),V.length>0&&(i["!rows"]=V),_.Sheets.push(F)}A===""?u=i:n[A]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(C.biff===8&&(C.biff={9:2,521:3,1033:4}[J]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ne.BIFFVer]||8),C.biffguess=ne.BIFFVer==0,ne.BIFFVer==0&&ne.dt==4096&&(C.biff=5,O=!0,Ss(C.codepage=28591)),C.biff==8&&ne.BIFFVer==0&&ne.dt==16&&(C.biff=2),H++)break;if(i=t.dense?[]:{},C.biff<8&&!O&&(O=!0,Ss(C.codepage=t.codepage||1252)),C.biff<5||ne.BIFFVer==0&&ne.dt==4096){A===""&&(A="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Fe={pos:e.l-Y,name:A};a[Fe.pos]=Fe,C.snames.push(A)}else A=(a[z]||{name:""}).name;ne.dt==32&&(i["!type"]="chart"),ne.dt==64&&(i["!type"]="macro"),R=[],W=[],C.arrayf=v=[],G=[],V=[],X=!1,F={Hidden:(a[z]||{hs:0}).hs,name:A}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[ne.r]||[])[ne.c]:i[Dt({c:ne.c,r:ne.r})])&&++ne.c,y={ixfe:ne.ixfe,XF:B[ne.ixfe]||{},v:ne.val,t:"n"},k>0&&(y.z=U[y.ixfe>>8&63]),Vs(y,t,r.opts.Date1904),S({c:ne.c,r:ne.r},y,t);break;case 5:case 517:y={ixfe:ne.ixfe,XF:B[ne.ixfe],v:ne.val,t:ne.t},k>0&&(y.z=U[y.ixfe>>8&63]),Vs(y,t,r.opts.Date1904),S({c:ne.c,r:ne.r},y,t);break;case 638:y={ixfe:ne.ixfe,XF:B[ne.ixfe],v:ne.rknum,t:"n"},k>0&&(y.z=U[y.ixfe>>8&63]),Vs(y,t,r.opts.Date1904),S({c:ne.c,r:ne.r},y,t);break;case 189:for(var he=ne.c;he<=ne.C;++he){var Be=ne.rkrec[he-ne.c][0];y={ixfe:Be,XF:B[Be],v:ne.rkrec[he-ne.c][1],t:"n"},k>0&&(y.z=U[y.ixfe>>8&63]),Vs(y,t,r.opts.Date1904),S({c:he,r:ne.r},y,t)}break;case 6:case 518:case 1030:{if(ne.val=="String"){o=ne;break}if(y=Up(ne.val,ne.cell.ixfe,ne.tt),y.XF=B[y.ixfe],t.cellFormula){var xe=ne.formula;if(xe&&xe[0]&&xe[0][0]&&xe[0][0][0]=="PtgExp"){var se=xe[0][0][1][0],be=xe[0][0][1][1],Te=Dt({r:se,c:be});p[Te]?y.f=""+yi(ne.formula,s,ne.cell,Q,C):y.F=((t.dense?(i[se]||[])[be]:i[Te])||{}).F}else y.f=""+yi(ne.formula,s,ne.cell,Q,C)}k>0&&(y.z=U[y.ixfe>>8&63]),Vs(y,t,r.opts.Date1904),S(ne.cell,y,t),o=ne}break;case 7:case 519:if(o)o.val=ne,y=Up(ne,o.cell.ixfe,"s"),y.XF=B[y.ixfe],t.cellFormula&&(y.f=""+yi(o.formula,s,o.cell,Q,C)),k>0&&(y.z=U[y.ixfe>>8&63]),Vs(y,t,r.opts.Date1904),S(o.cell,y,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{v.push(ne);var pe=Dt(ne[0].s);if(d=t.dense?(i[ne[0].s.r]||[])[ne[0].s.c]:i[pe],t.cellFormula&&d){if(!o||!pe||!d)break;d.f=""+yi(ne[1],s,ne[0],Q,C),d.F=qt(ne[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;p[Dt(o.cell)]=ne[0],d=t.dense?(i[o.cell.r]||[])[o.cell.c]:i[Dt(o.cell)],(d||{}).f=""+yi(ne[0],s,f,Q,C)}}break;case 253:y=Up(l[ne.isst].t,ne.ixfe,"s"),l[ne.isst].h&&(y.h=l[ne.isst].h),y.XF=B[y.ixfe],k>0&&(y.z=U[y.ixfe>>8&63]),Vs(y,t,r.opts.Date1904),S({c:ne.c,r:ne.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:ne.ixfe,XF:B[ne.ixfe],t:"z"},k>0&&(y.z=U[y.ixfe>>8&63]),Vs(y,t,r.opts.Date1904),S({c:ne.c,r:ne.r},y,t));break;case 190:if(t.sheetStubs)for(var je=ne.c;je<=ne.C;++je){var Ve=ne.ixfe[je-ne.c];y={ixfe:Ve,XF:B[Ve],t:"z"},k>0&&(y.z=U[y.ixfe>>8&63]),Vs(y,t,r.opts.Date1904),S({c:je,r:ne.r},y,t)}break;case 214:case 516:case 4:y=Up(ne.val,ne.ixfe,"s"),y.XF=B[y.ixfe],k>0&&(y.z=U[y.ixfe>>8&63]),Vs(y,t,r.opts.Date1904),S({c:ne.c,r:ne.r},y,t);break;case 0:case 512:H===1&&(s=ne);break;case 252:l=ne;break;case 1054:if(C.biff==4){U[k++]=ne[1];for(var We=0;We<k+163&&Ot[We]!=ne[1];++We);We>=163&&jo(ne[1],k+163)}else jo(ne[1],ne[0]);break;case 30:{U[k++]=ne;for(var ft=0;ft<k+163&&Ot[ft]!=ne;++ft);ft>=163&&jo(ne,k+163)}break;case 229:R=R.concat(ne);break;case 93:W[ne.cmo[0]]=C.lastobj=ne;break;case 438:C.lastobj.TxO=ne;break;case 127:C.lastobj.ImData=ne;break;case 440:for(x=ne[0].s.r;x<=ne[0].e.r;++x)for(g=ne[0].s.c;g<=ne[0].e.c;++g)d=t.dense?(i[x]||[])[g]:i[Dt({c:g,r:x})],d&&(d.l=ne[1]);break;case 2048:for(x=ne[0].s.r;x<=ne[0].e.r;++x)for(g=ne[0].s.c;g<=ne[0].e.c;++g)d=t.dense?(i[x]||[])[g]:i[Dt({c:g,r:x})],d&&d.l&&(d.l.Tooltip=ne[1]);break;case 28:{if(C.biff<=5&&C.biff>=2)break;d=t.dense?(i[ne[0].r]||[])[ne[0].c]:i[Dt(ne[0])];var Et=W[ne[2]];d||(t.dense?(i[ne[0].r]||(i[ne[0].r]=[]),d=i[ne[0].r][ne[0].c]={t:"z"}):d=i[Dt(ne[0])]={t:"z"},s.e.r=Math.max(s.e.r,ne[0].r),s.s.r=Math.min(s.s.r,ne[0].r),s.e.c=Math.max(s.e.c,ne[0].c),s.s.c=Math.min(s.s.c,ne[0].c)),d.c||(d.c=[]),m={a:ne[1],t:Et.TxO.t},d.c.push(m)}break;case 2173:iM(B[ne.ixfe],ne.ext);break;case 125:{if(!C.cellStyles)break;for(;ne.e>=ne.s;)G[ne.e--]={width:ne.w/256,level:ne.level||0,hidden:!!(ne.flags&1)},X||(X=!0,Pb(ne.w/256)),Zl(G[ne.e+1])}break;case 520:{var ut={};ne.level!=null&&(V[ne.r]=ut,ut.level=ne.level),ne.hidden&&(V[ne.r]=ut,ut.hidden=!0),ne.hpt&&(V[ne.r]=ut,ut.hpt=ne.hpt,ut.hpx=Xu(ne.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||VA(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[J]]=ne;break;case 161:i["!margins"]||VA(i["!margins"]={}),i["!margins"].header=ne.header,i["!margins"].footer=ne.footer;break;case 574:ne.RTL&&(_.Views[0].RTL=!0);break;case 146:E=ne;break;case 2198:L=ne;break;case 140:w=ne;break;case 442:A?F.CodeName=ne||F.name:_.WBProps.CodeName=ne||"ThisWorkbook";break}}else le||console.error("Missing Info for XLS Record 0x"+J.toString(16)),e.l+=Y}return r.SheetNames=cn(a).sort(function(wt,at){return Number(wt)-Number(at)}).map(function(wt){return a[wt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&P.forEach(function(wt,at){r.Sheets[r.SheetNames[at]]["!autofilter"]=wt}),r.Strings=l,r.SSF=Gr(Ot),C.enc&&(r.Encryption=C.enc),L&&(r.Themes=L),r.Metadata={},w!==void 0&&(r.Metadata.Country=w),Q.names.length>0&&(_.Names=Q.names),r.Workbook=_,r}var Xh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function vV(e,t,r){var n=Lt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=i_(n,Ay,Xh.DSI);for(var a in i)t[a]=i[a]}catch(A){if(r.WTF)throw A}var s=Lt.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=i_(s,cy,Xh.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(A){if(r.WTF)throw A}t.HeadingPairs&&t.TitlesOfParts&&(TF(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function xV(e,t){var r=[],n=[],i=[],a=0,s,o=U4(Ay,"n"),l=U4(cy,"n");if(e.Props)for(s=cn(e.Props),a=0;a<s.length;++a)(Object.prototype.hasOwnProperty.call(o,s[a])?r:Object.prototype.hasOwnProperty.call(l,s[a])?n:i).push([s[a],e.Props[s[a]]]);if(e.Custprops)for(s=cn(e.Custprops),a=0;a<s.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},s[a])||(Object.prototype.hasOwnProperty.call(o,s[a])?r:Object.prototype.hasOwnProperty.call(l,s[a])?n:i).push([s[a],e.Custprops[s[a]]]);var A=[];for(a=0;a<i.length;++a)PF.indexOf(i[a][0])>-1||NF.indexOf(i[a][0])>-1||i[a][1]!=null&&A.push(i[a]);n.length&&Lt.utils.cfb_add(t,"/SummaryInformation",a_(n,Xh.SI,l,cy)),(r.length||A.length)&&Lt.utils.cfb_add(t,"/DocumentSummaryInformation",a_(r,Xh.DSI,o,Ay,A.length?A:null,Xh.UDI))}function IN(e,t){t||(t={}),$b(t),db(),t.codepage&&hb(t.codepage);var r,n;if(e.FullPaths){if(Lt.find(e,"/encryption"))throw new Error("File is password-protected");r=Lt.find(e,"!CompObj"),n=Lt.find(e,"/Workbook")||Lt.find(e,"/Book")}else{switch(t.type){case"base64":e=xa(Sa(e));break;case"binary":e=xa(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ri(e,0),n={content:e}}var i,a;if(r&&dV(r),t.bookProps&&!t.bookSheets)i={};else{var s=Yt?"buffer":"array";if(n&&n.content)i=mV(n.content,t);else if((a=Lt.find(e,"PerfectOffice_MAIN"))&&a.content)i=GA.to_workbook(a.content,(t.type=s,t));else if((a=Lt.find(e,"NativeContent_MAIN"))&&a.content)i=GA.to_workbook(a.content,(t.type=s,t));else throw(a=Lt.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Lt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=LM(e))}var o={};return e.FullPaths&&vV(e,o,t),i.Props=i.Custprops=o,t.bookFiles&&(i.cfb=e),i}function yV(e,t){var r=t||{},n=Lt.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Lt.utils.cfb_add(n,i,UN(e,r)),r.biff==8&&(e.Props||e.Custprops)&&xV(e,n),r.biff==8&&e.vbaraw&&IM(n,Lt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Pd={0:{f:G9},1:{f:J9},2:{f:mK},3:{f:sK},4:{f:rK},5:{f:dK},6:{f:bK},7:{f:cK},8:{f:FK},9:{f:kK},10:{f:SK},11:{f:EK},12:{f:eK},13:{f:xK},14:{f:lK},15:{f:iK},16:{f:CN},17:{f:_K},18:{f:fK},19:{f:kb},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:_G},40:{},42:{},43:{f:bR},44:{f:yR},45:{f:CR},46:{f:ER},47:{f:SR},48:{},49:{f:$D},50:{},51:{f:oM},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:zF},62:{f:wK},63:{f:gM},64:{f:VK},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ni,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:MK},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:X9},148:{f:$9,p:16},151:{f:OK},152:{},153:{f:wG},154:{},155:{},156:{f:xG},157:{},158:{},159:{T:1,f:D7},160:{T:-1},161:{T:1,f:mc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:NK},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:aM},336:{T:-1},337:{f:cM,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ly},357:{},358:{},359:{},360:{T:1},361:{},362:{f:qF},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:jK},427:{f:DK},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:QK},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:z9},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:IK},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ly},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:EM},633:{T:1},634:{T:-1},635:{T:1,f:CM},636:{T:-1},637:{f:YD},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:lG},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:WK},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},gy={6:{f:Ax},10:{f:ul},12:{f:Fn},13:{f:Fn},14:{f:pn},15:{f:pn},16:{f:Ci},17:{f:pn},18:{f:pn},19:{f:Fn},20:{f:u_},21:{f:u_},23:{f:qF},24:{f:h_},25:{f:pn},26:{},27:{},28:{f:WQ},29:{},34:{f:pn},35:{f:f_},38:{f:Ci},39:{f:Ci},40:{f:Ci},41:{f:Ci},42:{f:pn},43:{f:pn},47:{f:iR},49:{f:xQ},51:{f:Fn},60:{},61:{f:dQ},64:{f:pn},65:{f:vQ},66:{f:Fn},77:{},80:{},81:{},82:{},85:{f:Fn},89:{},90:{},91:{},92:{f:nQ},93:{f:zQ},94:{},95:{f:pn},96:{},97:{},99:{f:pn},125:{f:zF},128:{f:UQ},129:{f:aQ},130:{f:Fn},131:{f:pn},132:{f:pn},133:{f:sQ},134:{},140:{f:n7},141:{f:Fn},144:{},146:{f:s7},151:{},152:{},153:{},154:{},155:{},156:{f:Fn},157:{},158:{},160:{f:h7},161:{f:A7},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:NQ},190:{f:TQ},193:{f:ul},197:{},198:{},199:{},200:{},201:{},202:{f:pn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Fn},220:{},221:{f:pn},222:{},224:{f:IQ},225:{f:rQ},226:{f:ul},227:{},229:{f:$Q},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:lQ},253:{f:wQ},255:{f:cQ},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:QF},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:pn},353:{f:ul},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:QQ},431:{f:pn},432:{},433:{},434:{},437:{},438:{f:JQ},439:{f:pn},440:{f:ZQ},441:{},442:{f:o0},443:{},444:{f:Fn},445:{},446:{},448:{f:ul},449:{f:hQ,r:2},450:{f:ul},512:{f:l_},513:{f:f7},515:{f:DQ},516:{f:BQ},517:{f:c_},519:{f:d7},520:{f:uQ},523:{},545:{f:d_},549:{f:o_},566:{},574:{f:gQ},638:{f:FQ},659:{},1048:{},1054:{f:CQ},1084:{},1212:{f:KQ},2048:{f:t7},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Tp},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ul},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:o7,r:12},2173:{f:nM,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:pn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:HQ,r:12},2197:{},2198:{f:YR,r:12},2199:{},2200:{},2201:{},2202:{f:GQ,r:12},2203:{f:ul},2204:{},2205:{},2206:{},2207:{},2211:{f:fQ},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Fn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:c7},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:a7},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:l_},1:{},2:{f:x7},3:{f:m7},4:{f:g7},5:{f:c_},7:{f:w7},8:{},9:{f:Tp},11:{},22:{f:Fn},30:{f:EQ},31:{},32:{},33:{f:d_},36:{},37:{f:o_},50:{f:b7},62:{},52:{},67:{},68:{f:Fn},69:{},86:{},126:{},127:{f:p7},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:B7},223:{},234:{},354:{},421:{},518:{f:Ax},521:{f:Tp},536:{f:h_},547:{f:f_},561:{},579:{},1030:{f:Ax},1033:{f:Tp},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ct(e,t,r,n){var i=t;if(!isNaN(i)){var a=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,i),s.write_shift(2,a),a>0&&Cb(r)&&e.push(r)}}function wV(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return ct(e,t,r,i);var a=t;if(!isNaN(a)){for(var s=r.parts||[],o=0,l=0,A=0;A+(s[o]||8224)<=8224;)A+=s[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,a),u.write_shift(2,A),e.push(r.slice(l,l+A)),l+=A;l<i;){for(u=e.next(4),u.write_shift(2,60),A=0;A+(s[o]||8224)<=8224;)A+=s[o]||8224,o++;u.write_shift(2,A),e.push(r.slice(l,l+A)),l+=A}}}function u0(e,t,r){return e||(e=ze(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function bV(e,t,r,n){var i=ze(9);return u0(i,e,t),RF(r,n||"b",i),i}function BV(e,t,r){var n=ze(8+2*r.length);return u0(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function _V(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Qn(Kr(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?ct(e,2,y7(r,n,i)):ct(e,3,v7(r,n,i));return;case"b":case"e":ct(e,5,bV(r,n,t.v,t.t));return;case"s":case"str":ct(e,4,BV(r,n,(t.v||"").slice(0,255)));return}ct(e,1,u0(null,r,n))}function CV(e,t,r,n){var i=Array.isArray(t),a=cr(t["!ref"]||"A1"),s,o="",l=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),s=qt(a)}for(var A=a.s.r;A<=a.e.r;++A){o=bn(A);for(var u=a.s.c;u<=a.e.c;++u){A===a.s.r&&(l[u]=Xr(u)),s=l[u]+o;var f=i?(t[A]||[])[u]:t[s];f&&_V(e,f,A,u)}}}function SV(e,t){for(var r=t||{},n=sa(),i=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(i=a);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ct(n,r.biff==4?1033:r.biff==3?521:9,Ob(e,16,r)),CV(n,e.Sheets[e.SheetNames[i]],i,r),ct(n,10),n.end()}function EV(e,t,r){ct(e,49,yQ({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function kV(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&ct(e,1054,SQ(i,t[i],r))})}function FV(e,t){var r=ze(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ct(e,2151,r),r=ze(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),VF(cr(t["!ref"]||"A1"),r),r.write_shift(4,4),ct(e,2152,r)}function NV(e,t){for(var r=0;r<16;++r)ct(e,224,A_({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ct(e,224,A_(n,0,t))})}function TV(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ct(e,440,e7(n)),n[1].Tooltip&&ct(e,2048,r7(n))}delete t["!links"]}function LV(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&ct(e,125,l7(p1(i,n),i))})}}function IV(e,t,r,n,i){var a=16+fA(i.cellXfs,t,i);if(t.v==null&&!t.bf){ct(e,513,oc(r,n,a));return}if(t.bf)ct(e,6,a9(t,r,n,i,a));else switch(t.t){case"d":case"n":var s=t.t=="d"?Qn(Kr(t.v)):t.v;ct(e,515,PQ(r,n,s,a));break;case"b":case"e":ct(e,517,jQ(r,n,t.v,a,i,t.t));break;case"s":case"str":if(i.bookSST){var o=Kb(i.Strings,t.v,i.revStrings);ct(e,253,bQ(r,n,o,a))}else ct(e,516,_Q(r,n,(t.v||"").slice(0,255),a,i));break;default:ct(e,513,oc(r,n,a))}}function UV(e,t,r){var n=sa(),i=r.SheetNames[e],a=r.Sheets[i]||{},s=(r||{}).Workbook||{},o=(s.Sheets||[])[e]||{},l=Array.isArray(a),A=t.biff==8,u,f="",h=[],d=cr(a["!ref"]||"A1"),m=A?65536:16384;if(d.e.c>255||d.e.r>=m){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,m-1)}ct(n,2057,Ob(r,16,t)),ct(n,13,Wa(1)),ct(n,12,Wa(100)),ct(n,15,Qi(!0)),ct(n,17,Qi(!1)),ct(n,16,ac(.001)),ct(n,95,Qi(!0)),ct(n,42,Qi(!1)),ct(n,43,Qi(!1)),ct(n,130,Wa(1)),ct(n,128,OQ()),ct(n,131,Qi(!1)),ct(n,132,Qi(!1)),A&&LV(n,a["!cols"]),ct(n,512,kQ(d,t)),A&&(a["!links"]=[]);for(var g=d.s.r;g<=d.e.r;++g){f=bn(g);for(var x=d.s.c;x<=d.e.c;++x){g===d.s.r&&(h[x]=Xr(x)),u=h[x]+f;var p=l?(a[g]||[])[x]:a[u];p&&(IV(n,p,g,x,t),A&&p.l&&a["!links"].push([u,p.l]))}}var v=o.CodeName||o.name||i;return A&&ct(n,574,mQ((s.Views||[])[0])),A&&(a["!merges"]||[]).length&&ct(n,229,qQ(a["!merges"])),A&&TV(n,a),ct(n,442,MF(v)),A&&FV(n,a),ct(n,10),n.end()}function OV(e,t,r){var n=sa(),i=(e||{}).Workbook||{},a=i.Sheets||[],s=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(ct(n,2057,Ob(e,5,r)),r.bookType=="xla"&&ct(n,135),ct(n,225,o?Wa(1200):null),ct(n,193,jP(2)),l&&ct(n,191),l&&ct(n,192),ct(n,226),ct(n,92,iQ("SheetJS",r)),ct(n,66,Wa(o?1200:1252)),o&&ct(n,353,Wa(0)),o&&ct(n,448),ct(n,317,u7(e.SheetNames.length)),o&&e.vbaraw&&ct(n,211),o&&e.vbaraw){var A=s.CodeName||"ThisWorkbook";ct(n,442,MF(A))}ct(n,156,Wa(17)),ct(n,25,Qi(!1)),ct(n,18,Qi(!1)),ct(n,19,Wa(0)),o&&ct(n,431,Qi(!1)),o&&ct(n,444,Wa(0)),ct(n,61,pQ()),ct(n,64,Qi(!1)),ct(n,141,Wa(0)),ct(n,34,Qi(hG(e)=="true")),ct(n,14,Qi(!0)),o&&ct(n,439,Qi(!1)),ct(n,218,Wa(0)),EV(n,e,r),kV(n,e.SSF,r),NV(n,r),o&&ct(n,352,Qi(!1));var u=n.end(),f=sa();o&&ct(f,140,i7()),o&&r.Strings&&wV(f,252,AQ(r.Strings)),ct(f,10);var h=f.end(),d=sa(),m=0,g=0;for(g=0;g<e.SheetNames.length;++g)m+=(o?12:11)+(o?2:1)*e.SheetNames[g].length;var x=u.length+m+h.length;for(g=0;g<e.SheetNames.length;++g){var p=a[g]||{};ct(d,133,oQ({pos:x,hs:p.Hidden||0,dt:0,name:e.SheetNames[g]},r)),x+=t[g].length}var v=d.end();if(m!=v.length)throw new Error("BS8 "+m+" != "+v.length);var y=[];return u.length&&y.push(u),v.length&&y.push(v),h.length&&y.push(h),qn(y)}function jV(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Gr(Ot)),e&&e.SSF&&(of(),l1(e.SSF),r.revssf=c1(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,qb(r),r.cellXfs=[],fA(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=UV(i,r,e);return n.unshift(OV(e,n,r)),qn(n)}function UN(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=oa(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return jV(e,t);case 4:case 3:case 2:return SV(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function __(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),s=i.index,o=a&&a.index||e.length,l=yD(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),A=-1,u=0,f=0,h=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(s=0;s<l.length;++s){var g=l[s].trim(),x=g.slice(0,3).toLowerCase();if(x=="<tr"){if(++A,r.sheetRows&&r.sheetRows<=A){--A;break}u=0;continue}if(!(x!="<td"&&x!="<th")){var p=g.split(/<\/t[dh]>/i);for(o=0;o<p.length;++o){var v=p[o].trim();if(v.match(/<t[dh]/i)){for(var y=v,w=0;y.charAt(0)=="<"&&(w=y.indexOf(">"))>-1;)y=y.slice(w+1);for(var B=0;B<m.length;++B){var E=m[B];E.s.c==u&&E.s.r<A&&A<=E.e.r&&(u=E.e.c+1,B=-1)}var _=Qt(v.slice(0,v.indexOf(">")));h=_.colspan?+_.colspan:1,((f=+_.rowspan)>1||h>1)&&m.push({s:{r:A,c:u},e:{r:A+(f||1)-1,c:u+h-1}});var F=_.t||_["data-t"]||"";if(!y.length){u+=h;continue}if(y=iF(y),d.s.r>A&&(d.s.r=A),d.e.r<A&&(d.e.r=A),d.s.c>u&&(d.s.c=u),d.e.c<u&&(d.e.c=u),!y.length){u+=h;continue}var T={t:"s",v:y};r.raw||!y.trim().length||F=="s"||(y==="TRUE"?T={t:"b",v:!0}:y==="FALSE"?T={t:"b",v:!1}:isNaN(Ns(y))?isNaN(qu(y).getDate())||(T={t:"d",v:Kr(y)},r.cellDates||(T={t:"n",v:Qn(T.v)}),T.z=r.dateNF||Ot[14]):T={t:"n",v:Ns(y)}),r.dense?(n[A]||(n[A]=[]),n[A][u]=T):n[Dt({r:A,c:u})]=T,u+=h}}}}return n["!ref"]=qt(d),m.length&&(n["!merges"]=m),n}function DV(e,t,r,n){for(var i=e["!merges"]||[],a=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,A=0;A<i.length;++A)if(!(i[A].s.r>r||i[A].s.c>s)&&!(i[A].e.r<r||i[A].e.c<s)){if(i[A].s.r<r||i[A].s.c<s){o=-1;break}o=i[A].e.r-i[A].s.r+1,l=i[A].e.c-i[A].s.c+1;break}if(!(o<0)){var u=Dt({r,c:s}),f=n.dense?(e[r]||[])[s]:e[u],h=f&&f.v!=null&&(f.h||bb(f.w||(Ko(f),f.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(d["data-t"]=f&&f.t||"z",f.v!=null&&(d["data-v"]=f.v),f.z!=null&&(d["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),d.id=(n.id||"sjs")+"-"+u,a.push(At("td",h,d))}}var m="<tr>";return m+a.join("")+"</tr>"}var PV='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',QV="</body></html>";function RV(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return uA(__(r[0],t),t);var n=Yb();return r.forEach(function(i,a){Jb(n,__(i,t),"Sheet"+(a+1))}),n}function MV(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function ON(e,t){var r=t||{},n=r.header!=null?r.header:PV,i=r.footer!=null?r.footer:QV,a=[n],s=oa(e["!ref"]);r.dense=Array.isArray(e),a.push(MV(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)a.push(DV(e,s,o,r));return a.push("</table>"+i),a.join("")}function jN(e,t,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var s=typeof n.origin=="string"?Yr(n.origin):n.origin;i=s.r,a=s.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),A={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var u=oa(e["!ref"]);A.s.r=Math.min(A.s.r,u.s.r),A.s.c=Math.min(A.s.c,u.s.c),A.e.r=Math.max(A.e.r,u.e.r),A.e.c=Math.max(A.e.c,u.e.c),i==-1&&(A.e.r=i=u.e.r+1)}var f=[],h=0,d=e["!rows"]||(e["!rows"]=[]),m=0,g=0,x=0,p=0,v=0,y=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&g<l;++m){var w=o[m];if(C_(w)){if(n.display)continue;d[g]={hidden:!0}}var B=w.children;for(x=p=0;x<B.length;++x){var E=B[x];if(!(n.display&&C_(E))){var _=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):iF(E.innerHTML),F=E.getAttribute("data-z")||E.getAttribute("z");for(h=0;h<f.length;++h){var T=f[h];T.s.c==p+a&&T.s.r<g+i&&g+i<=T.e.r&&(p=T.e.c+1-a,h=-1)}y=+E.getAttribute("colspan")||1,((v=+E.getAttribute("rowspan")||1)>1||y>1)&&f.push({s:{r:g+i,c:p+a},e:{r:g+i+(v||1)-1,c:p+a+(y||1)-1}});var I={t:"s",v:_},S=E.getAttribute("data-t")||E.getAttribute("t")||"";_!=null&&(_.length==0?I.t=S||"z":n.raw||_.trim().length==0||S=="s"||(_==="TRUE"?I={t:"b",v:!0}:_==="FALSE"?I={t:"b",v:!1}:isNaN(Ns(_))?isNaN(qu(_).getDate())||(I={t:"d",v:Kr(_)},n.cellDates||(I={t:"n",v:Qn(I.v)}),I.z=n.dateNF||Ot[14]):I={t:"n",v:Ns(_)})),I.z===void 0&&F!=null&&(I.z=F);var C="",L=E.getElementsByTagName("A");if(L&&L.length)for(var R=0;R<L.length&&!(L[R].hasAttribute("href")&&(C=L[R].getAttribute("href"),C.charAt(0)!="#"));++R);C&&C.charAt(0)!="#"&&(I.l={Target:C}),n.dense?(e[g+i]||(e[g+i]=[]),e[g+i][p+a]=I):e[Dt({c:p+a,r:g+i})]=I,A.e.c<p+a&&(A.e.c=p+a),p+=y}}++g}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),A.e.r=Math.max(A.e.r,g-1+i),e["!ref"]=qt(A),g>=l&&(e["!fullref"]=qt((A.e.r=o.length-m+g-1+i,A))),e}function DN(e,t){var r=t||{},n=r.dense?[]:{};return jN(n,e,t)}function HV(e,t){return uA(DN(e,t),t)}function C_(e){var t="",r=KV(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function KV(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function GV(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ar(t.replace(/<[^>]*>/g,""));return[r]}var S_={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function PN(e,t){var r=t||{},n=Bb(e),i=[],a,s,o={name:""},l="",A=0,u,f,h={},d=[],m=r.dense?[]:{},g,x,p={value:""},v="",y=0,w=[],B=-1,E=-1,_={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,T={},I=[],S={},C=0,L=0,R=[],W=1,G=1,V=[],X={Names:[]},Q={},K=["",""],H=[],k={},U="",P=0,D=!1,O=!1,z=0;for(Ld.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=Ld.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"工作表":g[1]==="/"?(_.e.c>=_.s.c&&_.e.r>=_.s.r?m["!ref"]=qt(_):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=_.e.r&&(m["!fullref"]=m["!ref"],_.e.r=r.sheetRows-1,m["!ref"]=qt(_)),I.length&&(m["!merges"]=I),R.length&&(m["!rows"]=R),u.name=u.名称||u.name,typeof JSON<"u"&&JSON.stringify(u),d.push(u.name),h[u.name]=m,O=!1):g[0].charAt(g[0].length-2)!=="/"&&(u=Qt(g[0],!1),B=E=-1,_.s.r=_.s.c=1e7,_.e.r=_.e.c=0,m=r.dense?[]:{},I=[],R=[],O=!0);break;case"table-row-group":g[1]==="/"?--F:++F;break;case"table-row":case"行":if(g[1]==="/"){B+=W,W=1;break}if(f=Qt(g[0],!1),f.行号?B=f.行号-1:B==-1&&(B=0),W=+f["number-rows-repeated"]||1,W<10)for(z=0;z<W;++z)F>0&&(R[B+z]={level:F});E=-1;break;case"covered-table-cell":g[1]!=="/"&&++E,r.sheetStubs&&(r.dense?(m[B]||(m[B]=[]),m[B][E]={t:"z"}):m[Dt({r:B,c:E})]={t:"z"}),v="",w=[];break;case"table-cell":case"数据":if(g[0].charAt(g[0].length-2)==="/")++E,p=Qt(g[0],!1),G=parseInt(p["number-columns-repeated"]||"1",10),x={t:"z",v:null},p.formula&&r.cellFormula!=!1&&(x.f=w_(Ar(p.formula))),(p.数据类型||p["value-type"])=="string"&&(x.t="s",x.v=Ar(p["string-value"]||""),r.dense?(m[B]||(m[B]=[]),m[B][E]=x):m[Dt({r:B,c:E})]=x),E+=G-1;else if(g[1]!=="/"){++E,v="",y=0,w=[],G=1;var J=W?B+W-1:B;if(E>_.e.c&&(_.e.c=E),E<_.s.c&&(_.s.c=E),B<_.s.r&&(_.s.r=B),J>_.e.r&&(_.e.r=J),p=Qt(g[0],!1),H=[],k={},x={t:p.数据类型||p["value-type"],v:null},r.cellFormula)if(p.formula&&(p.formula=Ar(p.formula)),p["number-matrix-columns-spanned"]&&p["number-matrix-rows-spanned"]&&(C=parseInt(p["number-matrix-rows-spanned"],10)||0,L=parseInt(p["number-matrix-columns-spanned"],10)||0,S={s:{r:B,c:E},e:{r:B+C-1,c:E+L-1}},x.F=qt(S),V.push([S,x.F])),p.formula)x.f=w_(p.formula);else for(z=0;z<V.length;++z)B>=V[z][0].s.r&&B<=V[z][0].e.r&&E>=V[z][0].s.c&&E<=V[z][0].e.c&&(x.F=V[z][1]);switch((p["number-columns-spanned"]||p["number-rows-spanned"])&&(C=parseInt(p["number-rows-spanned"],10)||0,L=parseInt(p["number-columns-spanned"],10)||0,S={s:{r:B,c:E},e:{r:B+C-1,c:E+L-1}},I.push(S)),p["number-columns-repeated"]&&(G=parseInt(p["number-columns-repeated"],10)),x.t){case"boolean":x.t="b",x.v=Rr(p["boolean-value"]);break;case"float":x.t="n",x.v=parseFloat(p.value);break;case"percentage":x.t="n",x.v=parseFloat(p.value);break;case"currency":x.t="n",x.v=parseFloat(p.value);break;case"date":x.t="d",x.v=Kr(p["date-value"]),r.cellDates||(x.t="n",x.v=Qn(x.v)),x.z="m/d/yy";break;case"time":x.t="n",x.v=mD(p["time-value"])/86400,r.cellDates&&(x.t="d",x.v=u1(x.v)),x.z="HH:MM:SS";break;case"number":x.t="n",x.v=parseFloat(p.数据数值);break;default:if(x.t==="string"||x.t==="text"||!x.t)x.t="s",p["string-value"]!=null&&(v=Ar(p["string-value"]),w=[]);else throw new Error("Unsupported value type "+x.t)}}else{if(D=!1,x.t==="s"&&(x.v=v||"",w.length&&(x.R=w),D=y==0),Q.Target&&(x.l=Q),H.length>0&&(x.c=H,H=[]),v&&r.cellText!==!1&&(x.w=v),D&&(x.t="z",delete x.v),(!D||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=B))for(var Y=0;Y<W;++Y){if(G=parseInt(p["number-columns-repeated"]||"1",10),r.dense)for(m[B+Y]||(m[B+Y]=[]),m[B+Y][E]=Y==0?x:Gr(x);--G>0;)m[B+Y][E+G]=Gr(x);else for(m[Dt({r:B+Y,c:E})]=x;--G>0;)m[Dt({r:B+Y,c:E+G})]=Gr(x);_.e.c<=E&&(_.e.c=E)}G=parseInt(p["number-columns-repeated"]||"1",10),E+=G-1,G=0,x={},v="",w=[]}Q={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((a=i.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((a=i.pop())[0]!==g[3])throw"Bad state: "+a;k.t=v,w.length&&(k.R=w),k.a=U,H.push(k)}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);U="",P=0,v="",y=0,w=[];break;case"creator":g[1]==="/"?U=n.slice(P,g.index):P=g.index+g[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((a=i.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);v="",y=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(T[o.name]=l,(a=i.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&(l="",o=Qt(g[0],!1),i.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":s=Qt(g[0],!1),l+=S_[g[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":s=Qt(g[0],!1),l+=S_[g[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(A,g.index);break}else A=g.index+g[0].length;break;case"named-range":s=Qt(g[0],!1),K=cx(s["cell-range-address"]);var le={Name:s.name,Ref:K[0]+"!"+K[1]};O&&(le.Sheet=d.length),X.Names.push(le);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(g[1]==="/"&&(!p||!p["string-value"])){var we=GV(n.slice(y,g.index));v=(v.length>0?v+`
`:"")+we[0]}else Qt(g[0],!1),y=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{K=cx(Qt(g[0])["target-range-address"]),h[K[0]]["!autofilter"]={ref:K[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(Q=Qt(g[0],!1),!Q.href)break;Q.Target=Ar(Q.href),delete Q.href,Q.Target.charAt(0)=="#"&&Q.Target.indexOf(".")>-1?(K=cx(Q.Target.slice(1)),Q.Target="#"+K[0]+"!"+K[1]):Q.Target.match(/^\.\.[\\\/]/)&&(Q.Target=Q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(g)}}var ne={Sheets:h,SheetNames:d,Workbook:X};return r.bookSheets&&delete ne.Sheets,ne}function E_(e,t){t=t||{},Ga(e,"META-INF/manifest.xml")&&mP(kn(e,"META-INF/manifest.xml"),t);var r=ya(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=PN(Fr(r),t);return Ga(e,"meta.xml")&&(n.Props=kF(kn(e,"meta.xml"))),n}function k_(e,t){return PN(e,t)}var VV=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Td({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Bn+t}}(),F_=function(){var e=function(a){return Br(a).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,s,o){var l=[];l.push('      <table:table table:name="'+Br(s.SheetNames[o])+`" table:style-name="ta1">
`);var A=0,u=0,f=oa(a["!ref"]||"A1"),h=a["!merges"]||[],d=0,m=Array.isArray(a);if(a["!cols"])for(u=0;u<=f.e.c;++u)l.push("        <table:table-column"+(a["!cols"][u]?' table:style-name="co'+a["!cols"][u].ods+'"':"")+`></table:table-column>
`);var g="",x=a["!rows"]||[];for(A=0;A<f.s.r;++A)g=x[A]?' table:style-name="ro'+x[A].ods+'"':"",l.push("        <table:table-row"+g+`></table:table-row>
`);for(;A<=f.e.r;++A){for(g=x[A]?' table:style-name="ro'+x[A].ods+'"':"",l.push("        <table:table-row"+g+`>
`),u=0;u<f.s.c;++u)l.push(t);for(;u<=f.e.c;++u){var p=!1,v={},y="";for(d=0;d!=h.length;++d)if(!(h[d].s.c>u)&&!(h[d].s.r>A)&&!(h[d].e.c<u)&&!(h[d].e.r<A)){(h[d].s.c!=u||h[d].s.r!=A)&&(p=!0),v["table:number-columns-spanned"]=h[d].e.c-h[d].s.c+1,v["table:number-rows-spanned"]=h[d].e.r-h[d].s.r+1;break}if(p){l.push(r);continue}var w=Dt({r:A,c:u}),B=m?(a[A]||[])[u]:a[w];if(B&&B.f&&(v["table:formula"]=Br(u9(B.f)),B.F&&B.F.slice(0,w.length)==w)){var E=oa(B.F);v["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,v["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!B){l.push(t);continue}switch(B.t){case"b":y=B.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=B.v?"true":"false";break;case"n":y=B.w||String(B.v||0),v["office:value-type"]="float",v["office:value"]=B.v||0;break;case"s":case"str":y=B.v==null?"":B.v,v["office:value-type"]="string";break;case"d":y=B.w||Kr(B.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=Kr(B.v).toISOString(),v["table:style-name"]="ce1";break;default:l.push(t);continue}var _=e(y);if(B.l&&B.l.Target){var F=B.l.Target;F=F.charAt(0)=="#"?"#"+f9(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),_=At("text:a",_,{"xlink:href":F.replace(/&/g,"&amp;")})}l.push("          "+At("table:table-cell",At("text:p",_,{}),v)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(a,s){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(A){return s.Sheets[A]}).forEach(function(A){if(A&&A["!cols"]){for(var u=0;u<A["!cols"].length;++u)if(A["!cols"][u]){var f=A["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Zl(f),f.ods=o;var h=A["!cols"][u].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),a.push(`  </style:style>
`),++o}}});var l=0;s.SheetNames.map(function(A){return s.Sheets[A]}).forEach(function(A){if(A&&A["!rows"]){for(var u=0;u<A["!rows"].length;++u)if(A["!rows"][u]){A["!rows"][u].ods=l;var f=A["!rows"][u].hpx+"px";a.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),a.push(`  </style:style>
`),++l}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(s,o){var l=[Bn],A=Td({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Td({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+A+u+`>
`),l.push(EF().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+A+`>
`),i(l,s),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var f=0;f!=s.SheetNames.length;++f)l.push(n(s.Sheets[s.SheetNames[f]],s,f));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function QN(e,t){if(t.bookType=="fods")return F_(e,t);var r=xb(),n="",i=[],a=[];return n="mimetype",zt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",zt(r,n,F_(e,t)),i.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",zt(r,n,VV(e,t)),i.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",zt(r,n,Bn+EF()),i.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",zt(r,n,yP(a)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",zt(r,n,vP(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function lc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function my(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Fr(cA(e))}function WV(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):xa(Zs(e))}function $V(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function tA(e){var t=e.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function N_(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function qV(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function zV(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;i>=1;++a,i/=256)e[t+a]=i&255;e[t+15]|=r>=0?0:128}function Qd(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function wr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function An(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function hr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=Qd(e,r),a=i&7;i=Math.floor(i/8);var s=0,o;if(i==0)break;switch(a){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=Qd(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var A={data:o,type:a};t[i]==null?t[i]=[A]:t[i].push(A)}return t}function Zn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(wr(n*8+i.type)),i.type==2&&t.push(wr(i.data.length)),t.push(i.data))})}),tA(t)}function Wb(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Ha(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=Qd(e,n),a=hr(e.slice(n[0],n[0]+i));n[0]+=i;var s={id:An(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=hr(o.data),A=An(l[3][0].data);s.messages.push({meta:l,data:e.slice(n[0],n[0]+A)}),n[0]+=A}),(t=a[3])!=null&&t[0]&&(s.merge=An(a[3][0].data)>>>0>0),r.push(s)}return r}function qc(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:wr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:wr(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(s){i.push(s.data),s.meta[3]=[{type:0,data:wr(s.data.length)}],n[2].push({data:Zn(s.meta),type:2})});var a=Zn(n);t.push(wr(a.length)),t.push(a),i.forEach(function(s){return t.push(s)})}),tA(t)}function XV(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Qd(t,r),i=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}i.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var l=0,A=0;if(a==1?(A=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(A=(t[r[0]++]>>2)+1,a==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[tA(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(A>=l)for(i.push(i[0].slice(-l)),A-=l;A>=i[i.length-1].length;)i.push(i[i.length-1]),A-=i[i.length-1].length;i.push(i[0].slice(-l,-l+A))}}var u=tA(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Ka(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(XV(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return tA(t)}function zc(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var a=wr(n),s=a.length;t.push(a),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,i[0]=0,i[1]=s&255,i[2]=s>>8&255,i[3]=s>>16&255,r+=n}return tA(t)}function YV(e,t,r,n){var i=lc(e),a=i.getUint32(4,!0),s=(n>1?12:8)+N_(a&(n>1?3470:398))*4,o=-1,l=-1,A=NaN,u=new Date(2001,0,1);a&512&&(o=i.getUint32(s,!0),s+=4),s+=N_(a&(n>1?12288:4096))*4,a&16&&(l=i.getUint32(s,!0),s+=4),a&32&&(A=i.getFloat64(s,!0),s+=8),a&64&&(u.setTime(u.getTime()+i.getFloat64(s,!0)*1e3),s+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:A};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:A>0};break;case 7:f={t:"n",v:A/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(l>-1)f={t:"s",v:t[l]};else if(!isNaN(A))f={t:"n",v:A};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function JV(e,t,r){var n=lc(e),i=n.getUint32(8,!0),a=12,s=-1,o=-1,l=NaN,A=NaN,u=new Date(2001,0,1);i&1&&(l=qV(e,a),a+=16),i&2&&(A=n.getFloat64(a,!0),a+=8),i&4&&(u.setTime(u.getTime()+n.getFloat64(a,!0)*1e3),a+=8),i&8&&(o=n.getUint32(a,!0),a+=4),i&16&&(s=n.getUint32(a,!0),a+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:A>0};break;case 7:f={t:"n",v:A/86400};break;case 8:f={t:"e",v:0};break;case 9:if(s>-1)f={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return f}function fx(e,t){var r=new Uint8Array(32),n=lc(r),i=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,zV(r,i,e.v),a|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),a|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),a|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,i)}function hx(e,t){var r=new Uint8Array(32),n=lc(r),i=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),a|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),a|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),a|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,i)}function ZV(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return YV(e,t,r,e[0]);case 5:return JV(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function xi(e){var t=hr(e);return Qd(t[1][0].data)}function T_(e,t){var r=hr(t.data),n=An(r[1][0].data),i=r[3],a=[];return(i||[]).forEach(function(s){var o=hr(s.data),l=An(o[1][0].data)>>>0;switch(n){case 1:a[l]=my(o[3][0].data);break;case 8:{var A=e[xi(o[9][0].data)][0],u=hr(A.data),f=e[xi(u[1][0].data)][0],h=An(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var d=hr(f.data);a[l]=d[3].map(function(m){return my(m.data)}).join("")}break}}),a}function eW(e,t){var r,n,i,a,s,o,l,A,u,f,h,d,m,g,x=hr(e),p=An(x[1][0].data)>>>0,v=An(x[2][0].data)>>>0,y=((n=(r=x[8])==null?void 0:r[0])==null?void 0:n.data)&&An(x[8][0].data)>0||!1,w,B;if((a=(i=x[7])==null?void 0:i[0])!=null&&a.data&&t!=0)w=(o=(s=x[7])==null?void 0:s[0])==null?void 0:o.data,B=(A=(l=x[6])==null?void 0:l[0])==null?void 0:A.data;else if((f=(u=x[4])==null?void 0:u[0])!=null&&f.data&&t!=1)w=(d=(h=x[4])==null?void 0:h[0])==null?void 0:d.data,B=(g=(m=x[3])==null?void 0:m[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var E=y?4:1,_=lc(w),F=[],T=0;T<w.length/2;++T){var I=_.getUint16(T*2,!0);I<65535&&F.push([T,I])}if(F.length!=v)throw"Expected ".concat(v," cells, found ").concat(F.length);var S=[];for(T=0;T<F.length-1;++T)S[F[T][0]]=B.subarray(F[T][1]*E,F[T+1][1]*E);return F.length>=1&&(S[F[F.length-1][0]]=B.subarray(F[F.length-1][1]*E)),{R:p,cells:S}}function tW(e,t){var r,n=hr(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?An(n[7][0].data)>>>0>0?1:0:-1,a=Wb(n[5],function(s){return eW(s,i)});return{nrows:An(n[4][0].data)>>>0,data:a.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(l,A){if(s[o.R][A])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(A));s[o.R][A]=l}),s},[])}}function rW(e,t,r){var n,i=hr(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(An(i[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(a.e.c=(An(i[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=qt(a);var s=hr(i[4][0].data),o=T_(e,e[xi(s[4][0].data)][0]),l=(n=s[17])!=null&&n[0]?T_(e,e[xi(s[17][0].data)][0]):[],A=hr(s[3][0].data),u=0;A[1].forEach(function(f){var h=hr(f.data),d=e[xi(h[2][0].data)][0],m=An(d.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var g=tW(e,d);g.data.forEach(function(x,p){x.forEach(function(v,y){var w=Dt({r:u+p,c:y}),B=ZV(v,o,l);B&&(r[w]=B)})}),u+=g.nrows})}function nW(e,t){var r=hr(t.data),n={"!ref":"A1"},i=e[xi(r[2][0].data)],a=An(i[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return rW(e,i[0],n),n}function iW(e,t){var r,n=hr(t.data),i={name:(r=n[1])!=null&&r[0]?my(n[1][0].data):"",sheets:[]},a=Wb(n[2],xi);return a.forEach(function(s){e[s].forEach(function(o){var l=An(o.meta[1][0].data);l==6e3&&i.sheets.push(nW(e,o))})}),i}function aW(e,t){var r=Yb(),n=hr(t.data),i=Wb(n[1],xi);if(i.forEach(function(a){e[a].forEach(function(s){var o=An(s.meta[1][0].data);if(o==2){var l=iW(e,s);l.sheets.forEach(function(A,u){Jb(r,A,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function dx(e){var t,r,n,i,a={},s=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var A;try{A=Ka(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var u;try{u=Ha(A)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){a[f.id]=f.messages,s.push(f.id)})}}),!s.length)throw new Error("File has no messages");var o=((i=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&An(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||s.forEach(function(l){a[l].forEach(function(A){var u=An(A.meta[1][0].data)>>>0;if(u==1)if(!o)o=A;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return aW(a,o)}function sW(e,t,r){var n,i,a,s;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(a=e[8])==null?void 0:a[0])==null?void 0:s.data)&&An(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,A=lc(e[7][0].data),u=0,f=[],h=lc(e[4][0].data),d=0,m=[],g=0;g<t.length;++g){if(t[g]==null){A.setUint16(g*2,65535,!0),h.setUint16(g*2,65535);continue}A.setUint16(g*2,u,!0),h.setUint16(g*2,d,!0);var x,p;switch(typeof t[g]){case"string":x=fx({t:"s",v:t[g]},r),p=hx({t:"s",v:t[g]},r);break;case"number":x=fx({t:"n",v:t[g]},r),p=hx({t:"n",v:t[g]},r);break;case"boolean":x=fx({t:"b",v:t[g]},r),p=hx({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}f.push(x),u+=x.length,m.push(p),d+=p.length,++l}for(e[2][0].data=wr(l);g<e[7][0].data.length/2;++g)A.setUint16(g*2,65535,!0),h.setUint16(g*2,65535,!0);return e[6][0].data=tA(f),e[3][0].data=tA(m),l}function oW(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=oa(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(qt(n)));var a=pm(r,{range:n,header:1}),s=["~Sh33tJ5~"];a.forEach(function(U){return U.forEach(function(P){typeof P=="string"&&s.push(P)})});var o={},l=[],A=Lt.read(t.numbers,{type:"base64"});A.FileIndex.map(function(U,P){return[U,A.FullPaths[P]]}).forEach(function(U){var P=U[0],D=U[1];if(P.type==2&&P.name.match(/\.iwa/)){var O=P.content,z=Ka(O),J=Ha(z);J.forEach(function(Y){l.push(Y.id),o[Y.id]={deps:[],location:D,type:An(Y.messages[0].meta[1][0].data)}})}}),l.sort(function(U,P){return U-P});var u=l.filter(function(U){return U>1}).map(function(U){return[U,wr(U)]});A.FileIndex.map(function(U,P){return[U,A.FullPaths[P]]}).forEach(function(U){var P=U[0];if(U[1],!!P.name.match(/\.iwa/)){var D=Ha(Ka(P.content));D.forEach(function(O){O.messages.forEach(function(z){u.forEach(function(J){O.messages.some(function(Y){return An(Y.meta[1][0].data)!=11006&&$V(Y.data,J[1])})&&o[J[0]].deps.push(O.id)})})})}});for(var f=Lt.find(A,o[1].location),h=Ha(Ka(f.content)),d,m=0;m<h.length;++m){var g=h[m];g.id==1&&(d=g)}var x=xi(hr(d.messages[0].data)[1][0].data);for(f=Lt.find(A,o[x].location),h=Ha(Ka(f.content)),m=0;m<h.length;++m)g=h[m],g.id==x&&(d=g);for(x=xi(hr(d.messages[0].data)[2][0].data),f=Lt.find(A,o[x].location),h=Ha(Ka(f.content)),m=0;m<h.length;++m)g=h[m],g.id==x&&(d=g);for(x=xi(hr(d.messages[0].data)[2][0].data),f=Lt.find(A,o[x].location),h=Ha(Ka(f.content)),m=0;m<h.length;++m)g=h[m],g.id==x&&(d=g);var p=hr(d.messages[0].data);{p[6][0].data=wr(n.e.r+1),p[7][0].data=wr(n.e.c+1);var v=xi(p[46][0].data),y=Lt.find(A,o[v].location),w=Ha(Ka(y.content));{for(var B=0;B<w.length&&w[B].id!=v;++B);if(w[B].id!=v)throw"Bad ColumnRowUIDMapArchive";var E=hr(w[B].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var _=0;_<=n.e.c;++_){var F=[];F[1]=F[2]=[{type:0,data:wr(_+420690)}],E[1].push({type:2,data:Zn(F)}),E[2].push({type:0,data:wr(_)}),E[3].push({type:0,data:wr(_)})}E[4]=[],E[5]=[],E[6]=[];for(var T=0;T<=n.e.r;++T)F=[],F[1]=F[2]=[{type:0,data:wr(T+726270)}],E[4].push({type:2,data:Zn(F)}),E[5].push({type:0,data:wr(T)}),E[6].push({type:0,data:wr(T)});w[B].messages[0].data=Zn(E)}y.content=zc(qc(w)),y.size=y.content.length,delete p[46];var I=hr(p[4][0].data);{I[7][0].data=wr(n.e.r+1);var S=hr(I[1][0].data),C=xi(S[2][0].data);y=Lt.find(A,o[C].location),w=Ha(Ka(y.content));{if(w[0].id!=C)throw"Bad HeaderStorageBucket";var L=hr(w[0].messages[0].data);for(T=0;T<a.length;++T){var R=hr(L[2][0].data);R[1][0].data=wr(T),R[4][0].data=wr(a[T].length),L[2][T]={type:L[2][0].type,data:Zn(R)}}w[0].messages[0].data=Zn(L)}y.content=zc(qc(w)),y.size=y.content.length;var W=xi(I[2][0].data);y=Lt.find(A,o[W].location),w=Ha(Ka(y.content));{if(w[0].id!=W)throw"Bad HeaderStorageBucket";for(L=hr(w[0].messages[0].data),_=0;_<=n.e.c;++_)R=hr(L[2][0].data),R[1][0].data=wr(_),R[4][0].data=wr(n.e.r+1),L[2][_]={type:L[2][0].type,data:Zn(R)};w[0].messages[0].data=Zn(L)}y.content=zc(qc(w)),y.size=y.content.length;var G=xi(I[4][0].data);(function(){for(var U=Lt.find(A,o[G].location),P=Ha(Ka(U.content)),D,O=0;O<P.length;++O){var z=P[O];z.id==G&&(D=z)}var J=hr(D.messages[0].data);{J[3]=[];var Y=[];s.forEach(function(ne,Me){Y[1]=[{type:0,data:wr(Me)}],Y[2]=[{type:0,data:wr(1)}],Y[3]=[{type:2,data:WV(ne)}],J[3].push({type:2,data:Zn(Y)})})}D.messages[0].data=Zn(J);var le=qc(P),we=zc(le);U.content=we,U.size=U.content.length})();var V=hr(I[3][0].data);{var X=V[1][0];delete V[2];var Q=hr(X.data);{var K=xi(Q[2][0].data);(function(){for(var U=Lt.find(A,o[K].location),P=Ha(Ka(U.content)),D,O=0;O<P.length;++O){var z=P[O];z.id==K&&(D=z)}var J=hr(D.messages[0].data);{delete J[6],delete V[7];var Y=new Uint8Array(J[5][0].data);J[5]=[];for(var le=0,we=0;we<=n.e.r;++we){var ne=hr(Y);le+=sW(ne,a[we],s),ne[1][0].data=wr(we),J[5].push({data:Zn(ne),type:2})}J[1]=[{type:0,data:wr(n.e.c+1)}],J[2]=[{type:0,data:wr(n.e.r+1)}],J[3]=[{type:0,data:wr(le)}],J[4]=[{type:0,data:wr(n.e.r+1)}]}D.messages[0].data=Zn(J);var Me=qc(P),qe=zc(Me);U.content=qe,U.size=U.content.length})()}X.data=Zn(Q)}I[3][0].data=Zn(V)}p[4][0].data=Zn(I)}d.messages[0].data=Zn(p);var H=qc(h),k=zc(H);return f.content=k,f.size=f.content.length,A}function RN(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function $b(e){RN([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function qb(e){RN([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function lW(e){return Jt.WS.indexOf(e)>-1?"sheet":e==Jt.CS?"chart":e==Jt.DS?"dialog":e==Jt.MS?"macro":e&&e.length?e:"sheet"}function AW(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,lW(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function cW(e,t,r,n,i,a,s,o,l,A,u,f){try{a[n]=Wh(ya(e,r,!0),t);var h=kn(e,t),d;switch(o){case"sheet":d=LG(h,t,i,l,a[n],A,u,f);break;case"chart":if(d=IG(h,t,i,l,a[n],A,u,f),!d||!d["!drawel"])break;var m=wh(d["!drawel"].Target,t),g=Id(m),x=xM(ya(e,m,!0),Wh(ya(e,g,!0),m)),p=wh(x,m),v=Id(p);d=sG(ya(e,p,!0),p,l,Wh(ya(e,v,!0),p),A,d);break;case"macro":d=UG(h,t,i,l,a[n],A,u,f);break;case"dialog":d=OG(h,t,i,l,a[n],A,u,f);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=d;var y=[];a&&a[n]&&cn(a[n]).forEach(function(w){var B="";if(a[n][w].Type==Jt.CMNT){B=wh(a[n][w].Target,t);var E=QG(kn(e,B,!0),B,l);if(!E||!E.length)return;g_(d,E,!1)}a[n][w].Type==Jt.TCMNT&&(B=wh(a[n][w].Target,t),y=y.concat(wM(kn(e,B,!0),l)))}),y&&y.length&&g_(d,y,!0,l.people||[])}catch(w){if(l.WTF)throw w}}function Qa(e){return e.charAt(0)=="/"?e.slice(1):e}function uW(e,t){if(of(),t=t||{},$b(t),Ga(e,"META-INF/manifest.xml")||Ga(e,"objectdata.xml"))return E_(e,t);if(Ga(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof dx<"u"){if(e.FileIndex)return dx(e);var r=Lt.utils.cfb_new();return D4(e).forEach(function(R){zt(r,R,bD(e,R))}),dx(r)}throw new Error("Unsupported NUMBERS file")}if(!Ga(e,"[Content_Types].xml"))throw Ga(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ga(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=D4(e),i=pP(ya(e,"[Content_Types].xml")),a=!1,s,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",kn(e,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!kn(e,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),a=!0}i.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},A={};if(!t.bookSheets&&!t.bookProps){if($h=[],i.sst)try{$h=PG(kn(e,Qa(i.sst)),i.sst,t)}catch(R){if(t.WTF)throw R}t.cellStyles&&i.themes.length&&(l=DG(ya(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(A=jG(kn(e,Qa(i.style)),i.style,l,t))}i.links.map(function(R){try{var W=Wh(ya(e,Id(Qa(R))),R);return MG(kn(e,Qa(R)),W,R,t)}catch{}});var u=TG(kn(e,Qa(i.workbooks[0])),i.workbooks[0],t),f={},h="";i.coreprops.length&&(h=kn(e,Qa(i.coreprops[0]),!0),h&&(f=kF(h)),i.extprops.length!==0&&(h=kn(e,Qa(i.extprops[0]),!0),h&&bP(h,f,t)));var d={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(h=ya(e,Qa(i.custprops[0]),!0),h&&(d=_P(h,t)));var m={};if((t.bookSheets||t.bookProps)&&(u.Sheets?s=u.Sheets.map(function(W){return W.name}):f.Worksheets&&f.SheetNames.length>0&&(s=f.SheetNames),t.bookProps&&(m.Props=f,m.Custprops=d),t.bookSheets&&typeof s<"u"&&(m.SheetNames=s),t.bookSheets?m.SheetNames:t.bookProps))return m;s={};var g={};t.bookDeps&&i.calcchain&&(g=RG(kn(e,Qa(i.calcchain)),i.calcchain));var x=0,p={},v,y;{var w=u.Sheets;f.Worksheets=w.length,f.SheetNames=[];for(var B=0;B!=w.length;++B)f.SheetNames[B]=w[B].name}var E=a?"bin":"xml",_=i.workbooks[0].lastIndexOf("/"),F=(i.workbooks[0].slice(0,_+1)+"_rels/"+i.workbooks[0].slice(_+1)+".rels").replace(/^\//,"");Ga(e,F)||(F="xl/_rels/workbook."+E+".rels");var T=Wh(ya(e,F,!0),F.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=HG(kn(e,Qa(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=BM(kn(e,Qa(i.people[0])),t)),T&&(T=AW(T,u.Sheets));var I=kn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(x=0;x!=f.Worksheets;++x){var S="sheet";if(T&&T[x]?(v="xl/"+T[x][1].replace(/[\/]?xl\//,""),Ga(e,v)||(v=T[x][1]),Ga(e,v)||(v=F.replace(/_rels\/.*$/,"")+T[x][1]),S=T[x][2]):(v="xl/worksheets/sheet"+(x+1-I)+"."+E,v=v.replace(/sheet0\./,"sheet.")),y=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(x!=t.sheets)continue e;break;case"string":if(f.SheetNames[x].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var C=!1,L=0;L!=t.sheets.length;++L)typeof t.sheets[L]=="number"&&t.sheets[L]==x&&(C=1),typeof t.sheets[L]=="string"&&t.sheets[L].toLowerCase()==f.SheetNames[x].toLowerCase()&&(C=1);if(!C)continue e}}cW(e,v,y,f.SheetNames[x],x,p,s,S,t,u,l,A)}return m={Directory:i,Workbook:u,Props:f,Custprops:d,Deps:g,Sheets:s,SheetNames:f.SheetNames,Strings:$h,Styles:A,Themes:l,SSF:Gr(Ot)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(R,W){R=R.replace(/^Root Entry[\/]/,""),m.keys.push(R),m.files[R]=e.FileIndex[W]}))),t&&t.bookVBA&&(i.vba.length>0?m.vbaraw=kn(e,Qa(i.vba[0]),!0):i.defaults&&i.defaults.bin===TM&&(m.vbaraw=kn(e,"xl/vbaProject.bin",!0))),m}function fW(e,t){var r=t||{},n="Workbook",i=Lt.find(e,n);try{if(n="/!DataSpaces/Version",i=Lt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(H7(i.content),n="/!DataSpaces/DataSpaceMap",i=Lt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=G7(i.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Lt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=V7(i.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Lt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);$7(i.content)}catch{}if(n="/EncryptionInfo",i=Lt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=q7(i.content);if(n="/EncryptedPackage",i=Lt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function hW(e,t){return t.bookType=="ods"?QN(e,t):t.bookType=="numbers"?oW(e,t):t.bookType=="xlsb"?dW(e,t):pW(e,t)}function dW(e,t){Eu=1024,e&&!e.SSF&&(e.SSF=Gr(Ot)),e&&e.SSF&&(of(),l1(e.SSF),t.revssf=c1(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,qh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=hN.indexOf(t.bookType)>-1,i=Ib();qb(t=t||{});var a=xb(),s="",o=0;if(t.cellXfs=[],fA(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",zt(a,s,FF(e.Props,t)),i.coreprops.push(s),br(t.rels,2,s,Jt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],A=0;A<e.SheetNames.length;++A)(e.Workbook.Sheets[A]||{}).Hidden!=2&&l.push(e.SheetNames[A]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,zt(a,s,LF(e.Props)),i.extprops.push(s),br(t.rels,3,s,Jt.EXT_PROPS),e.Custprops!==e.Props&&cn(e.Custprops||{}).length>0&&(s="docProps/custom.xml",zt(a,s,IF(e.Custprops)),i.custprops.push(s),br(t.rels,4,s,Jt.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,zt(a,s,GG(o-1,s,t,e,u)),i.sheets.push(s),br(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Jt.WS[0])}if(f){var d=f["!comments"],m=!1,g="";d&&d.length>0&&(g="xl/comments"+o+"."+r,zt(a,g,$G(d,g)),i.comments.push(g),br(u,-1,"../comments"+o+"."+r,Jt.CMNT),m=!0),f["!legacy"]&&m&&zt(a,"xl/drawings/vmlDrawing"+o+".vml",uN(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&zt(a,Id(s),ju(u))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,zt(a,s,WG(t.Strings,s,t)),i.strs.push(s),br(t.wbrels,-1,"sharedStrings."+r,Jt.SST)),s="xl/workbook."+r,zt(a,s,KG(e,s)),i.workbooks.push(s),br(t.rels,1,s,Jt.WB),s="xl/theme/theme1.xml",zt(a,s,Qb(e.Themes,t)),i.themes.push(s),br(t.wbrels,-1,"theme/theme1.xml",Jt.THEME),s="xl/styles."+r,zt(a,s,VG(e,s,t)),i.styles.push(s),br(t.wbrels,-1,"styles."+r,Jt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",zt(a,s,e.vbaraw),i.vba.push(s),br(t.wbrels,-1,"vbaProject.bin",Jt.VBA)),s="xl/metadata."+r,zt(a,s,qG(s)),i.metadata.push(s),br(t.wbrels,-1,"metadata."+r,Jt.XLMETA),zt(a,"[Content_Types].xml",SF(i,t)),zt(a,"_rels/.rels",ju(t.rels)),zt(a,"xl/_rels/workbook."+r+".rels",ju(t.wbrels)),delete t.revssf,delete t.ssf,a}function pW(e,t){Eu=1024,e&&!e.SSF&&(e.SSF=Gr(Ot)),e&&e.SSF&&(of(),l1(e.SSF),t.revssf=c1(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,qh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=hN.indexOf(t.bookType)>-1,i=Ib();qb(t=t||{});var a=xb(),s="",o=0;if(t.cellXfs=[],fA(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",zt(a,s,FF(e.Props,t)),i.coreprops.push(s),br(t.rels,2,s,Jt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],A=0;A<e.SheetNames.length;++A)(e.Workbook.Sheets[A]||{}).Hidden!=2&&l.push(e.SheetNames[A]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,zt(a,s,LF(e.Props)),i.extprops.push(s),br(t.rels,3,s,Jt.EXT_PROPS),e.Custprops!==e.Props&&cn(e.Custprops||{}).length>0&&(s="docProps/custom.xml",zt(a,s,IF(e.Custprops)),i.custprops.push(s),br(t.rels,4,s,Jt.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,zt(a,s,_N(o-1,t,e,f)),i.sheets.push(s),br(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Jt.WS[0])}if(h){var m=h["!comments"],g=!1,x="";if(m&&m.length>0){var p=!1;m.forEach(function(v){v[1].forEach(function(y){y.T==!0&&(p=!0)})}),p&&(x="xl/threadedComments/threadedComment"+o+"."+r,zt(a,x,bM(m,u,t)),i.threadedcomments.push(x),br(f,-1,"../threadedComments/threadedComment"+o+"."+r,Jt.TCMNT)),x="xl/comments"+o+"."+r,zt(a,x,fN(m)),i.comments.push(x),br(f,-1,"../comments"+o+"."+r,Jt.CMNT),g=!0}h["!legacy"]&&g&&zt(a,"xl/drawings/vmlDrawing"+o+".vml",uN(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&zt(a,Id(s),ju(f))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,zt(a,s,ZF(t.Strings,t)),i.strs.push(s),br(t.wbrels,-1,"sharedStrings."+r,Jt.SST)),s="xl/workbook."+r,zt(a,s,FN(e)),i.workbooks.push(s),br(t.rels,1,s,Jt.WB),s="xl/theme/theme1.xml",zt(a,s,Qb(e.Themes,t)),i.themes.push(s),br(t.wbrels,-1,"theme/theme1.xml",Jt.THEME),s="xl/styles."+r,zt(a,s,oN(e,t)),i.styles.push(s),br(t.wbrels,-1,"styles."+r,Jt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",zt(a,s,e.vbaraw),i.vba.push(s),br(t.wbrels,-1,"vbaProject.bin",Jt.VBA)),s="xl/metadata."+r,zt(a,s,cN()),i.metadata.push(s),br(t.wbrels,-1,"metadata."+r,Jt.XLMETA),u.length>1&&(s="xl/persons/person.xml",zt(a,s,_M(u)),i.people.push(s),br(t.wbrels,-1,"persons/person.xml",Jt.PEOPLE)),zt(a,"[Content_Types].xml",SF(i,t)),zt(a,"_rels/.rels",ju(t.rels)),zt(a,"xl/_rels/workbook."+r+".rels",ju(t.wbrels)),delete t.revssf,delete t.ssf,a}function zb(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Sa(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function gW(e,t){return Lt.find(e,"EncryptedPackage")?fW(e,t):IN(e,t)}function mW(e,t){var r,n=e,i=t||{};return i.type||(i.type=Yt&&Buffer.isBuffer(e)?"buffer":"base64"),r=tF(n,i),uW(r,i)}function MN(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return py(e.slice(r),t);default:break e}return zu.to_workbook(e,t)}function vW(e,t){var r="",n=zb(e,t);switch(t.type){case"base64":r=Sa(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ic(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Fr(r)),t.type="binary",MN(r,t)}function xW(e,t){var r=e;return t.type=="base64"&&(r=Sa(r)),r=Cl.utils.decode(1200,r.slice(2),"str"),t.type="binary",MN(r,t)}function yW(e){return e.match(/[^\x00-\x7F]/)?Zs(e):e}function px(e,t,r,n){return n?(r.type="string",zu.to_workbook(e,r)):zu.to_workbook(t,r)}function dm(e,t){db();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return dm(new Uint8Array(e),(r=Gr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Pu={},r.dateNF&&(Pu.dateNF=r.dateNF),r.type||(r.type=Yt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Yt?"buffer":"binary",n=dD(e),typeof Uint8Array<"u"&&!Yt&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=yW(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return r=Gr(r),r.type="array",dm(pb(n),r)}switch((i=zb(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return gW(Lt.read(n,r),r);break;case 9:if(i[1]<=8)return IN(n,r);break;case 60:return py(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return C7(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return YF.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?mW(n,r):px(e,n,r,a);case 239:return i[3]===60?py(n,r):px(e,n,r,a);case 255:if(i[1]===254)return xW(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return GA.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return GA.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return dy.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return iN.to_workbook(n,r);break;case 10:case 13:case 32:return vW(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return _7.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?dy.to_workbook(n,r):px(e,n,r,a)}function HN(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return i0(t.file,Lt.write(e,{type:Yt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Lt.write(e,t)}function wW(e,t){var r=Gr(t||{}),n=hW(e,r);return bW(n,r)}function bW(e,t){var r={},n=Yt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Lt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(o1(i))}return t.password&&typeof encrypt_agile<"u"?HN(encrypt_agile(i,t.password),t):t.type==="file"?i0(t.file,i):t.type=="string"?Fr(i):i}function BW(e,t){var r=t||{},n=yV(e,r);return HN(n,r)}function zs(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return kd(Zs(n));case"binary":return Zs(n);case"string":return e;case"file":return i0(t.file,n,"utf8");case"buffer":return Yt?Wo(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):zs(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function _W(e,t){switch(t.type){case"base64":return kd(e);case"binary":return e;case"string":return e;case"file":return i0(t.file,e,"binary");case"buffer":return Yt?Wo(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Op(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?kd(r):t.type=="string"?Fr(r):r;case"file":return i0(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function KN(e,t){db(),gG(e);var r=Gr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=KN(e,r);return r.type="array",o1(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return zs(hV(e,r),r);case"slk":case"sylk":return zs(XF.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return zs(ON(e.Sheets[e.SheetNames[i]],r),r);case"txt":return _W(GN(e.Sheets[e.SheetNames[i]],r),r);case"csv":return zs(Xb(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return zs(YF.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return Op(dy.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return zs(zu.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return zs(iN.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return zs(JF.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return zs(QN(e,r),r);case"wk1":return Op(GA.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return Op(GA.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Op(UN(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),BW(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return wW(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function CW(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function L_(e,t,r){var n={};return n.type="file",n.file=t,CW(n),KN(e,n)}function SW(e,t,r,n,i,a,s,o){var l=bn(r),A=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!s||e[r])for(var d=t.s.c;d<=t.e.c;++d){var m=s?e[r][d]:e[n[d]+l];if(m===void 0||m.t===void 0){if(A===void 0)continue;a[d]!=null&&(h[a[d]]=A);continue}var g=m.v;switch(m.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(a[d]!=null){if(g==null)if(m.t=="e"&&g===null)h[a[d]]=null;else if(A!==void 0)h[a[d]]=A;else if(u&&g===null)h[a[d]]=null;else continue;else h[a[d]]=u&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?g:Ko(m,g,o);g!=null&&(f=!1)}}return{row:h,isempty:f}}function pm(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},A=t||{},u=A.range!=null?A.range:e["!ref"];switch(A.header===1?n=1:A.header==="A"?n=2:Array.isArray(A.header)?n=3:A.header==null&&(n=0),typeof u){case"string":l=cr(u);break;case"number":l=cr(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var f=bn(l.s.r),h=[],d=[],m=0,g=0,x=Array.isArray(e),p=l.s.r,v=0,y={};x&&!e[p]&&(e[p]=[]);var w=A.skipHidden&&e["!cols"]||[],B=A.skipHidden&&e["!rows"]||[];for(v=l.s.c;v<=l.e.c;++v)if(!(w[v]||{}).hidden)switch(h[v]=Xr(v),r=x?e[p][v]:e[h[v]+f],n){case 1:a[v]=v-l.s.c;break;case 2:a[v]=h[v];break;case 3:a[v]=A.header[v-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=Ko(r,null,A),g=y[s]||0,!g)y[s]=1;else{do o=s+"_"+g++;while(y[o]);y[s]=g,y[o]=1}a[v]=o}for(p=l.s.r+i;p<=l.e.r;++p)if(!(B[p]||{}).hidden){var E=SW(e,l,p,h,n,a,x,A);(E.isempty===!1||(n===1?A.blankrows!==!1:A.blankrows))&&(d[m++]=E.row)}return d.length=m,d}var I_=/"/g;function EW(e,t,r,n,i,a,s,o){for(var l=!0,A=[],u="",f=bn(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var d=o.dense?(e[r]||[])[h]:e[n[h]+f];if(d==null)u="";else if(d.v!=null){l=!1,u=""+(o.rawNumbers&&d.t=="n"?d.v:Ko(d,null,o));for(var m=0,g=0;m!==u.length;++m)if((g=u.charCodeAt(m))===i||g===a||g===34||o.forceQuotes){u='"'+u.replace(I_,'""')+'"';break}u=="ID"&&(u='"ID"')}else d.f!=null&&!d.F?(l=!1,u="="+d.f,u.indexOf(",")>=0&&(u='"'+u.replace(I_,'""')+'"')):u="";A.push(u)}return o.blankrows===!1&&l?null:A.join(s)}function Xb(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=cr(e["!ref"]),a=n.FS!==void 0?n.FS:",",s=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),A=new RegExp((a=="|"?"\\|":a)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],m=i.s.c;m<=i.e.c;++m)(h[m]||{}).hidden||(f[m]=Xr(m));for(var g=0,x=i.s.r;x<=i.e.r;++x)(d[x]||{}).hidden||(u=EW(e,i,x,f,s,l,a,n),u!=null&&(n.strip&&(u=u.replace(A,"")),(u||n.blankrows!==!1)&&r.push((g++?o:"")+u)));return delete n.dense,r.join("")}function GN(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Xb(e,t);return r}function kW(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=cr(e["!ref"]),a="",s=[],o,l=[],A=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)s[o]=Xr(o);for(var u=i.s.r;u<=i.e.r;++u)for(a=bn(u),o=i.s.c;o<=i.e.c;++o)if(t=s[o]+a,r=A?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function VN(e,t,r){var n=r||{},i=+!n.skipHeader,a=e||{},s=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?Yr(n.origin):n.origin;s=l.r,o=l.c}var A,u={s:{c:0,r:0},e:{c:o,r:s+t.length-1+i}};if(a["!ref"]){var f=cr(a["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),s==-1&&(s=f.e.r+1,u.e.r=s+t.length-1+i)}else s==-1&&(s=0,u.e.r=t.length-1+i);var h=n.header||[],d=0;t.forEach(function(g,x){cn(g).forEach(function(p){(d=h.indexOf(p))==-1&&(h[d=h.length]=p);var v=g[p],y="z",w="",B=Dt({c:o+d,r:s+x+i});A=Rd(a,B),v&&typeof v=="object"&&!(v instanceof Date)?a[B]=v:(typeof v=="number"?y="n":typeof v=="boolean"?y="b":typeof v=="string"?y="s":v instanceof Date?(y="d",n.cellDates||(y="n",v=Qn(v)),w=n.dateNF||Ot[14]):v===null&&n.nullError&&(y="e",v=0),A?(A.t=y,A.v=v,delete A.w,delete A.R,w&&(A.z=w)):a[B]=A={t:y,v},w&&(A.z=w))})}),u.e.c=Math.max(u.e.c,o+h.length-1);var m=bn(s);if(i)for(d=0;d<h.length;++d)a[Xr(d+o)+m]={t:"s",v:h[d]};return a["!ref"]=qt(u),a}function FW(e,t){return VN(null,e,t)}function Rd(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Yr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Rd(e,Dt(t)):Rd(e,Dt({r:t,c:r||0}))}function NW(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Yb(){return{SheetNames:[],Sheets:{}}}function Jb(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var s=a&&a[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=s+i)!=-1;++i);}if(kN(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function TW(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=NW(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function LW(e,t){return e.z=t,e}function WN(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function IW(e,t,r){return WN(e,"#"+t,r)}function UW(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function OW(e,t,r,n){for(var i=typeof t!="string"?t:cr(t),a=typeof t=="string"?t:qt(t),s=i.s.r;s<=i.e.r;++s)for(var o=i.s.c;o<=i.e.c;++o){var l=Rd(e,s,o);l.t="n",l.F=a,delete l.v,s==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var pl={encode_col:Xr,encode_row:bn,encode_cell:Dt,encode_range:qt,decode_col:Eb,decode_row:Sb,split_cell:WD,decode_cell:Yr,decode_range:oa,format_cell:Ko,sheet_add_aoa:xF,sheet_add_json:VN,sheet_add_dom:jN,aoa_to_sheet:lf,json_to_sheet:FW,table_to_sheet:DN,table_to_book:HV,sheet_to_csv:Xb,sheet_to_txt:GN,sheet_to_json:pm,sheet_to_html:ON,sheet_to_formulae:kW,sheet_to_row_object_array:pm,sheet_get_cell:Rd,book_new:Yb,book_append_sheet:Jb,book_set_sheet_visibility:TW,cell_set_number_format:LW,cell_set_hyperlink:WN,cell_set_internal_link:IW,cell_add_comment:UW,sheet_set_array_formula:OW,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const $N=ve.createContext(void 0);function oi(){const e=ve.useContext($N);if(e===void 0)throw new Error("useData must be used within a DataProvider");return e}const U_=["Welcome","Kodaly Songs","Kodaly Action Songs","Action/Games Songs","Rhythm Sticks","Scarf Songs","General Game","Core Songs","Parachute Games","Percussion Games","Goodbye","Teaching Units","Kodaly Rhythms","Kodaly Games","IWB Games"],Xc=["Communication and Language: 🎧 Listens carefully to rhymes and songs","Communication and Language: 🎧 Enjoys singing and making sounds","Communication and Language: 🎧 Joins in with familiar songs and rhymes","Communication and Language: 🎧 Understands and responds to simple questions or instructions","Communication and Language: 🗣️ Uses talk to express ideas and feelings","Listening, Attention and Understanding: 🎧 Listens with increased attention to sounds","Listening, Attention and Understanding: 🎧 Responds to what they hear with relevant actions","Listening, Attention and Understanding: 🎧 Follows directions with two or more steps","Listening, Attention and Understanding: 🎧 Understands simple concepts such as in, on, under","Speaking: 🗣️ Begins to use longer sentences","Speaking: 🗣️ Retells events or experiences in sequence","Speaking: 🗣️ Uses new vocabulary in different contexts","Speaking: 🗣️ Talks about what they are doing or making","Personal, Social and Emotional Development: 🧠 Shows confidence to try new activities","Personal, Social and Emotional Development: 🧠 Takes turns and shares with others","Personal, Social and Emotional Development: 🧠 Expresses own feelings and considers others'","Personal, Social and Emotional Development: 🧠 Shows resilience and perseverance","Physical Development: 🕺 Moves energetically, e.g., running, jumping, dancing","Physical Development: 🕺 Uses large and small motor skills for coordinated movement","Physical Development: 🕺 Moves with control and coordination","Physical Development: 🕺 Shows strength, balance and coordination","Expressive Arts and Design: 🎨 Creates collaboratively, sharing ideas and resources","Expressive Arts and Design: 🎨 Explores the sounds of instruments","Expressive Arts and Design: 🎨 Sings a range of well-known nursery rhymes and songs","Expressive Arts and Design: 🎨 Performs songs, rhymes, poems and stories with others","Expressive Arts and Design: 🎨 Responds imaginatively to music and dance","Expressive Arts and Design: 🎨 Develops storylines in pretend play"],jW=e=>{const t=e.categoryOrder;if(t.length===0)return"Untitled Lesson";if(t.includes("Welcome")&&t.includes("Goodbye")){const r=t.filter(n=>n!=="Welcome"&&n!=="Goodbye");return r.length>0?`${r[0]} Lesson`:"Standard Lesson"}return t.includes("Kodaly Songs")?"Kodaly Lesson":t.includes("Rhythm Sticks")?"Rhythm Sticks Lesson":t.includes("Percussion Games")?"Percussion Lesson":t.includes("Scarf Songs")?"Movement with Scarves":t.includes("Parachute Games")?"Parachute Activities":t.includes("Action/Games Songs")?"Action Games Lesson":`${t[0]} Lesson`},Yc=[{id:"A1",name:"Autumn 1",months:"Sep-Oct",lessons:[],isComplete:!1},{id:"A2",name:"Autumn 2",months:"Nov-Dec",lessons:[],isComplete:!1},{id:"SP1",name:"Spring 1",months:"Jan-Feb",lessons:[],isComplete:!1},{id:"SP2",name:"Spring 2",months:"Mar-Apr",lessons:[],isComplete:!1},{id:"SM1",name:"Summer 1",months:"Apr-May",lessons:[],isComplete:!1},{id:"SM2",name:"Summer 2",months:"Jun-Jul",lessons:[],isComplete:!1}];function DW({children:e}){const[t,r]=ve.useState({sheet:"LKG",display:"Lower Kindergarten",eyfs:"LKG Statements"}),[n,i]=ve.useState([]),[a,s]=ve.useState([]),[o,l]=ve.useState({}),[A,u]=ve.useState({}),[f,h]=ve.useState(Xc),[d,m]=ve.useState(!0),[g,x]=ve.useState([]),[p,v]=ve.useState(!1),[y,w]=ve.useState([]),[B,E]=ve.useState([]),[_,F]=ve.useState(Yc),[T,I]=ve.useState([]),[S,C]=ve.useState([]),[L,R]=ve.useState(null),[W,G]=ve.useState(!1),[V,X]=ve.useState(!1);ve.useEffect(()=>{if(new URLSearchParams(window.location.search).get("cleared")==="true"){v(!0);const De=window.location.pathname+window.location.hash;window.history.replaceState({},document.title,De)}ur(),et(),je(),se(),Me(),he(),K()},[t]);const Q=async()=>{console.log("🔧 DEBUGGING SUBJECT SETUP...");const _e=Wr();console.log("📊 Supabase configured:",_e);try{console.log("🔗 Testing Supabase connection with existing tables...");const{data:Ce,error:De}=await or.from("lessons").select("count(*)",{count:"exact",head:!0});if(De)return console.error("❌ Basic connection test failed:",De),!1;console.log("✅ Basic Supabase connection works!"),console.log("🔗 Testing subjects table...");const{data:ye,error:rt}=await or.from("subjects").select("count(*)",{count:"exact",head:!0});if(rt)return console.error("❌ Subjects table test failed:",rt),(rt.message.includes('relation "subjects" does not exist')||rt.code==="PGRST116")&&(console.error("💥 SUBJECTS TABLE DOES NOT EXIST!"),console.log("📝 You need to create the subjects tables in Supabase."),console.log("🚀 Go to your Supabase Dashboard → SQL Editor and run this:"),console.log(`
-- Create subjects table
CREATE TABLE subjects (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  name TEXT UNIQUE NOT NULL,
  description TEXT,
  color TEXT DEFAULT '#6b7280',
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  created_by UUID REFERENCES auth.users(id)
);

-- Create subject_categories table
CREATE TABLE subject_categories (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  subject_id UUID REFERENCES subjects(id) ON DELETE CASCADE,
  name TEXT NOT NULL,
  description TEXT,
  color TEXT DEFAULT '#6b7280',
  sort_order INTEGER DEFAULT 0,
  is_locked BOOLEAN DEFAULT false,
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  created_by UUID REFERENCES auth.users(id)
);

-- Insert sample subjects
INSERT INTO subjects (name, description, color) VALUES 
  ('Music', 'Music education activities and lessons', '#3b82f6'),
  ('Drama', 'Drama and performance activities', '#ef4444'),
  ('EYFS', 'Early Years Foundation Stage activities', '#10b981');

-- Insert sample categories for Music
INSERT INTO subject_categories (subject_id, name, description, color, sort_order) 
SELECT id, 'Welcome Songs', 'Opening circle time songs', '#3b82f6', 0 FROM subjects WHERE name = 'Music'
UNION ALL
SELECT id, 'Action Songs', 'Movement and action-based songs', '#3b82f6', 1 FROM subjects WHERE name = 'Music'
UNION ALL
SELECT id, 'Rhythm Activities', 'Rhythm and beat exercises', '#3b82f6', 2 FROM subjects WHERE name = 'Music'
UNION ALL
SELECT id, 'Goodbye Songs', 'Closing circle time songs', '#3b82f6', 3 FROM subjects WHERE name = 'Music';
          `)),!1;console.log("✅ Subjects table exists and is accessible!");const{data:Ct,error:St}=await or.from("subjects").select("*");return St?(console.error("❌ Error fetching subjects:",St),!1):(console.log("📊 Found subjects:",(Ct==null?void 0:Ct.length)||0),console.log("📋 Subjects data:",Ct),!0)}catch(Ce){return console.error("💥 Debug failed:",Ce),!1}},K=async()=>{if(W){console.log("⏸️ Subjects already loading, skipping...");return}try{console.log("🔄 Loading subjects..."),G(!0),Wr(),console.log("📡 Querying subjects from Supabase...");const{data:_e,error:Ce}=await or.from("subjects").select("*").eq("is_active",!0).order("name");if(Ce){if(console.error("❌ Failed to load subjects from Supabase:",Ce),Ce.message.includes('relation "subjects" does not exist')||Ce.code==="PGRST116"){console.error("💥 SUBJECTS TABLE MISSING!"),I([{id:"no-table-1",name:"Music",description:"Create database tables to enable full functionality",color:"#3b82f6",is_active:!0},{id:"no-table-2",name:"Drama",description:"Create database tables to enable full functionality",color:"#ef4444",is_active:!0},{id:"no-table-3",name:"EYFS",description:"Create database tables to enable full functionality",color:"#10b981",is_active:!0}]);return}I([{id:"fallback-1",name:"Music",description:"Music education activities and lessons",color:"#3b82f6",is_active:!0},{id:"fallback-2",name:"Drama",description:"Drama and performance activities",color:"#ef4444",is_active:!0},{id:"fallback-3",name:"EYFS",description:"Early Years Foundation Stage activities",color:"#10b981",is_active:!0}]);return}console.log("✅ Successfully loaded subjects:",(_e==null?void 0:_e.length)||0,"subjects"),I(_e||[]),G(!1),console.log("🏁 Set subjectsLoading to FALSE")}catch(_e){console.error("💥 Exception while loading subjects:",_e),I([{id:"error-fallback-1",name:"Music",description:"Music education activities (offline mode)",color:"#3b82f6",is_active:!0},{id:"error-fallback-2",name:"Drama",description:"Drama and performance activities (offline mode)",color:"#ef4444",is_active:!0},{id:"error-fallback-3",name:"EYFS",description:"Early Years Foundation Stage activities (offline mode)",color:"#10b981",is_active:!0}])}finally{G(!1),X(!0)}},H=async _e=>{try{if(Wr()){const{data:Ce,error:De}=await or.from("subject_categories").select("*").eq("subject_id",_e).order("sort_order");if(De){console.error("Failed to load subject categories from Supabase:",De);return}C(Ce||[])}}catch(Ce){console.error("Failed to load subject categories:",Ce)}},k=async _e=>{try{Wr();const{data:Ce,error:De}=await or.from("subjects").insert([_e]).select().single();if(De)throw console.error("Failed to create subject:",De),De;const ye=Ce;return I(rt=>[...rt,ye]),ye}catch(Ce){throw console.error("Failed to create subject:",Ce),Ce}},U=async(_e,Ce)=>{try{Wr();const{data:De,error:ye}=await or.from("subjects").update(Ce).eq("id",_e).select().single();if(ye)throw console.error("Failed to update subject:",ye),ye;const rt=De;return I(Ct=>Ct.map(St=>St.id===_e?rt:St)),rt}catch(De){throw console.error("Failed to update subject:",De),De}},P=async _e=>{try{Wr();const{error:Ce}=await or.from("subjects").update({is_active:!1}).eq("id",_e);if(Ce)throw console.error("Failed to delete subject:",Ce),Ce;I(De=>De.filter(ye=>ye.id!==_e)),(L==null?void 0:L.id)===_e&&(R(null),C([]))}catch(Ce){throw console.error("Failed to delete subject:",Ce),Ce}},D=async _e=>{try{Wr();const{data:Ce,error:De}=await or.from("subject_categories").insert([_e]).select().single();if(De)throw console.error("Failed to create subject category:",De),De;const ye=Ce;return C(rt=>[...rt,ye].sort((Ct,St)=>Ct.sort_order-St.sort_order)),ye}catch(Ce){throw console.error("Failed to create subject category:",Ce),Ce}},O=async(_e,Ce)=>{try{Wr();const{data:De,error:ye}=await or.from("subject_categories").update(Ce).eq("id",_e).select().single();if(ye)throw console.error("Failed to update subject category:",ye),ye;const rt=De;return C(Ct=>Ct.map(St=>St.id===_e?rt:St).sort((St,kt)=>St.sort_order-kt.sort_order)),rt}catch(De){throw console.error("Failed to update subject category:",De),De}},z=async _e=>{try{Wr();const{error:Ce}=await or.from("subject_categories").delete().eq("id",_e);if(Ce)throw console.error("Failed to delete subject category:",Ce),Ce;C(De=>De.filter(ye=>ye.id!==_e))}catch(Ce){throw console.error("Failed to delete subject category:",Ce),Ce}},J=async(_e,Ce)=>{try{Wr();const De=Ce.map((ye,rt)=>({id:ye,sort_order:rt}));for(const ye of De){const{error:rt}=await or.from("subject_categories").update({sort_order:ye.sort_order}).eq("id",ye.id);if(rt)throw console.error("Failed to reorder subject category:",rt),rt}await H(_e)}catch(De){throw console.error("Failed to reorder subject categories:",De),De}},Y=async _e=>{try{const Ce=S.find(De=>De.id===_e);if(!Ce)return;await O(_e,{is_locked:!Ce.is_locked})}catch(Ce){throw console.error("Failed to toggle category lock:",Ce),Ce}},le=async _e=>{try{const Ce=S.find(De=>De.id===_e);if(!Ce)return;await O(_e,{is_active:!Ce.is_active})}catch(Ce){throw console.error("Failed to toggle category visibility:",Ce),Ce}},we=async()=>{console.log("🔄 Retrying subjects load..."),X(!1),G(!1),await K()},ne=_e=>{R(_e),_e?H(_e.id):C([])},Me=()=>{try{if(p){E([]);return}const _e=localStorage.getItem(`units-${t.sheet}`);if(_e)try{const Ce=JSON.parse(_e).map(De=>({...De,createdAt:new Date(De.createdAt),updatedAt:new Date(De.updatedAt)}));E(Ce)}catch(Ce){console.error("Error parsing saved units:",Ce),E([])}else E([]),localStorage.setItem(`units-${t.sheet}`,JSON.stringify([]))}catch(_e){console.error("Failed to load units:",_e),E([])}},qe=_e=>{E(Ce=>{const De=Ce.findIndex(ye=>ye.id===_e.id);if(De!==-1){const ye=[...Ce];return ye[De]={..._e,updatedAt:new Date},localStorage.setItem(`units-${t.sheet}`,JSON.stringify(ye)),ye}else{const ye=[...Ce,{..._e,createdAt:new Date,updatedAt:new Date}];return localStorage.setItem(`units-${t.sheet}`,JSON.stringify(ye)),ye}})},Fe=_e=>{E(Ce=>{const De=Ce.filter(ye=>ye.id!==_e);return localStorage.setItem(`units-${t.sheet}`,JSON.stringify(De)),De})},he=()=>{try{if(p){F(Yc);return}const _e=localStorage.getItem(`half-terms-${t.sheet}`);if(_e)try{const Ce=JSON.parse(_e);F(Ce)}catch(Ce){console.error("Error parsing saved half-terms:",Ce),F(Yc)}else F(Yc),localStorage.setItem(`half-terms-${t.sheet}`,JSON.stringify(Yc))}catch(_e){console.error("Failed to load half-terms:",_e),F(Yc)}},Be=(_e,Ce,De)=>{F(ye=>{const rt=ye.map(Ct=>Ct.id===_e?{...Ct,lessons:Ce,isComplete:De}:Ct);return localStorage.setItem(`half-terms-${t.sheet}`,JSON.stringify(rt)),rt})},xe=_e=>{const Ce=_.find(De=>De.id===_e);return Ce?Ce.lessons:[]},se=async()=>{try{if(m(!0),p){w([]);return}if(Wr())try{const ye=await Au.getAll();if(ye&&ye.length>0){w(ye);return}}catch(ye){console.warn("Failed to load activities from Supabase:",ye)}const _e=localStorage.getItem("library-activities");if(_e){w(JSON.parse(_e));return}const Ce=[];Object.values(o).forEach(ye=>{Object.values(ye.grouped).forEach(rt=>{Ce.push(...rt)})});const De=Ce.filter((ye,rt,Ct)=>rt===Ct.findIndex(St=>St.activity===ye.activity&&St.category===ye.category));w(De),localStorage.setItem("library-activities",JSON.stringify(De)),Wr()&&De.forEach(async ye=>{try{await Au.create(ye)}catch(rt){console.warn("Failed to add activity to Supabase:",rt)}})}catch(_e){console.error("Failed to load activities:",_e),w([])}finally{m(!1)}},be=async _e=>{try{let Ce=_e;if(Wr())try{Ce=await Au.create(_e)}catch(ye){console.warn("Failed to add activity to Supabase:",ye),Ce={..._e,_id:`local-${Date.now()}`}}w(ye=>[...ye,Ce]);const De=localStorage.getItem("library-activities");if(De){const ye=JSON.parse(De);ye.push(Ce),localStorage.setItem("library-activities",JSON.stringify(ye))}else localStorage.setItem("library-activities",JSON.stringify([Ce]));return Ce}catch(Ce){throw console.error("Failed to add activity:",Ce),Ce}},Te=async _e=>{try{let Ce=_e;if(Wr()&&_e._id)try{Ce=await Au.update(_e._id,_e)}catch(ye){console.warn("Failed to update activity in Supabase:",ye)}w(ye=>ye.map(rt=>rt._id===_e._id?Ce:rt));const De=localStorage.getItem("library-activities");if(De){const rt=JSON.parse(De).map(Ct=>Ct._id===_e._id?Ce:Ct);localStorage.setItem("library-activities",JSON.stringify(rt))}return Ce}catch(Ce){throw console.error("Failed to update activity:",Ce),Ce}},pe=async _e=>{try{if(Wr())try{await Au.delete(_e)}catch(De){console.warn("Failed to delete activity from Supabase:",De)}w(De=>De.filter(ye=>ye._id!==_e&&ye.id!==_e));const Ce=localStorage.getItem("library-activities");if(Ce){const ye=JSON.parse(Ce).filter(rt=>rt._id!==_e&&rt.id!==_e);localStorage.setItem("library-activities",JSON.stringify(ye))}}catch(Ce){throw console.error("Failed to delete activity:",Ce),Ce}},je=()=>{try{if(p){x([]);return}Wr()&&or.from(mn.LESSON_PLANS).select("*").then(({data:_e,error:Ce})=>{if(Ce)console.warn("Failed to load lesson plans from Supabase:",Ce),Ve();else if(_e){const De=_e.map(ye=>({id:ye.id,date:new Date(ye.date),week:ye.week,className:ye.class_name,activities:ye.activities||[],duration:ye.duration||0,notes:ye.notes||"",status:ye.status||"planned",unitId:ye.unit_id,unitName:ye.unit_name,lessonNumber:ye.lesson_number,title:ye.title,term:ye.term,time:ye.time,createdAt:new Date(ye.created_at),updatedAt:new Date(ye.updated_at)}));x(De)}})}catch(_e){console.error("Failed to load user-created lesson plans:",_e),Ve()}},Ve=()=>{try{if(p){x([]);return}const _e=localStorage.getItem("user-created-lesson-plans");if(_e){const Ce=JSON.parse(_e).map(De=>({...De,date:new Date(De.date),createdAt:new Date(De.createdAt),updatedAt:new Date(De.updatedAt)}));x(Ce)}}catch(_e){console.error("Failed to load user-created lesson plans from localStorage:",_e),x([])}},We=async _e=>{try{if(localStorage.setItem("user-created-lesson-plans",JSON.stringify(_e)),Wr()){const Ce=_e.map(ye=>({id:ye.id,date:ye.date.toISOString(),week:ye.week,class_name:ye.className,activities:ye.activities,duration:ye.duration,notes:ye.notes,status:ye.status,unit_id:ye.unitId,unit_name:ye.unitName,lesson_number:ye.lessonNumber,title:ye.title,term:ye.term,time:ye.time})),{error:De}=await or.from(mn.LESSON_PLANS).upsert(Ce,{onConflict:"id"});De&&console.warn("Failed to save lesson plans to Supabase:",De)}}catch(Ce){console.error("Failed to save user-created lesson plans:",Ce)}},ft=async _e=>{x(Ce=>{const De=Ce.findIndex(rt=>rt.id===_e.id);let ye;return De>=0?(ye=[...Ce],ye[De]={..._e,updatedAt:new Date}):ye=[...Ce,{..._e,createdAt:new Date,updatedAt:new Date}],We(ye),_e.lessonNumber&&at(_e),ye})},Et=(_e,Ce)=>{l(De=>({...De,[_e]:Ce}))},ut=async _e=>{try{const Ce=g.find(ye=>ye.id===_e);if(!Ce||!Ce.lessonNumber){x(ye=>{const rt=ye.filter(Ct=>Ct.id!==_e);return localStorage.setItem("user-created-lesson-plans",JSON.stringify(rt)),rt});return}const De=parseInt(Ce.lessonNumber);if(x(ye=>{let rt=ye.filter(te=>te.id!==_e);const Ct=rt.filter(te=>te.className===Ce.className&&te.lessonNumber).sort((te,ue)=>parseInt(te.lessonNumber)-parseInt(ue.lessonNumber)),St={};Ct.forEach((te,ue)=>{const ae=parseInt(te.lessonNumber),Ae=(ue+1).toString();St[te.lessonNumber]=Ae,te.lessonNumber=Ae,te.updatedAt=new Date}),l(te=>{const ue={...te};return delete ue[De.toString()],Object.keys(St).forEach(ae=>{const Ae=St[ae];ue[ae]&&ae!==Ae&&(ue[Ae]=ue[ae],delete ue[ae],ue[Ae].grouped&&Object.values(ue[Ae].grouped).forEach(fe=>{fe.forEach(ge=>{ge.lessonNumber=Ae})}))}),ue}),i(te=>te.filter(ae=>ae!==De.toString()).map(ae=>St[ae]||ae).sort((ae,Ae)=>parseInt(ae)-parseInt(Ae))),u(te=>{const ue={...te};return delete ue[De.toString()],Object.keys(St).forEach(ae=>{const Ae=St[ae];ue[ae]&&ae!==Ae&&(ue[Ae]=ue[ae],delete ue[ae])}),ue}),F(te=>{const ue=te.map(ae=>{const Ae=ae.lessons.filter(fe=>fe!==De.toString()).map(fe=>St[fe]||fe);return{...ae,lessons:Ae}});return localStorage.setItem(`half-terms-${Ce.className}`,JSON.stringify(ue)),ue});const kt=localStorage.getItem(`units-${Ce.className}`);if(kt)try{const ue=JSON.parse(kt).map(ae=>{const Ae=ae.lessonNumbers.filter(fe=>fe!==De.toString()).map(fe=>St[fe]||fe);return{...ae,lessonNumbers:Ae,updatedAt:new Date}});localStorage.setItem(`units-${Ce.className}`,JSON.stringify(ue)),E(ue)}catch(te){console.error("Failed to update units after lesson deletion:",te)}localStorage.setItem("user-created-lesson-plans",JSON.stringify(rt));const Xt={allLessonsData:o,lessonNumbers:n,teachingUnits:a,eyfsStatements:A};return localStorage.setItem(`lesson-data-${Ce.className}`,JSON.stringify(Xt)),rt}),Wr()){const{error:ye}=await or.from(mn.LESSON_PLANS).delete().eq("id",_e);ye&&console.warn("Failed to delete lesson plan from Supabase:",ye)}}catch(Ce){console.error("Failed to delete and reindex lesson plan:",Ce)}},wt=_e=>{l(De=>{const ye={...De};return delete ye[_e],ye}),i(De=>De.filter(ye=>ye!==_e)),u(De=>{const ye={...De};return delete ye[_e],ye});const Ce={allLessonsData:{...o},lessonNumbers:n.filter(De=>De!==_e),teachingUnits:a,eyfsStatements:{...A}};delete Ce.allLessonsData[_e],delete Ce.eyfsStatements[_e],localStorage.setItem(`lesson-data-${t.sheet}`,JSON.stringify(Ce)),nh.updateSheet(t.sheet,Ce).catch(De=>console.warn(`Failed to update Supabase after deleting lesson ${_e}:`,De)),x(De=>{const ye=De.filter(rt=>rt.lessonNumber!==_e);return We(ye),ye});try{const De=localStorage.getItem(`units-${t.sheet}`);if(De){const ye=JSON.parse(De);let rt=!1;const Ct=ye.map(St=>St.lessonNumbers.includes(_e)?(rt=!0,{...St,lessonNumbers:St.lessonNumbers.filter(kt=>kt!==_e),updatedAt:new Date}):St);rt&&(localStorage.setItem(`units-${t.sheet}`,JSON.stringify(Ct)),E(Ct))}}catch(De){console.error("Failed to update units after deleting lesson:",De)}try{const De=localStorage.getItem(`half-terms-${t.sheet}`);if(De){const ye=JSON.parse(De);let rt=!1;const Ct=ye.map(St=>St.lessons.includes(_e)?(rt=!0,{...St,lessons:St.lessons.filter(kt=>kt!==_e)}):St);rt&&(localStorage.setItem(`half-terms-${t.sheet}`,JSON.stringify(Ct)),F(Ct))}}catch(De){console.error("Failed to update half-terms after deleting lesson:",De)}},at=_e=>{if(!_e.lessonNumber)return;const Ce={},De=new Set;let ye=0;_e.activities.forEach(kt=>{Ce[kt.category]||(Ce[kt.category]=[]),Ce[kt.category].push({...kt,lessonNumber:_e.lessonNumber||""}),De.add(kt.category),ye+=kt.time||0});const rt=tn(Array.from(De)),Ct={grouped:Ce,categoryOrder:rt,totalTime:ye,title:_e.title,eyfsStatements:[]};l(kt=>{const Xt={...kt};return Xt[_e.lessonNumber]=Ct,Xt}),i(kt=>kt.includes(_e.lessonNumber)?kt:[...kt,_e.lessonNumber].sort((te,ue)=>parseInt(te)-parseInt(ue)));const St={allLessonsData:{...o,[_e.lessonNumber]:Ct},lessonNumbers:n.includes(_e.lessonNumber)?n:[...n,_e.lessonNumber].sort((kt,Xt)=>parseInt(kt)-parseInt(Xt)),teachingUnits:a,eyfsStatements:A};localStorage.setItem(`lesson-data-${t.sheet}`,JSON.stringify(St)),nh.updateSheet(t.sheet,St).catch(kt=>console.warn(`Failed to update Supabase with user plan for lesson ${_e.lessonNumber}:`,kt))},et=async()=>{try{if(p){h(Xc);return}if(Wr())try{const Ce=await w4.getBySheet(t.sheet);if(Ce&&Ce.allStatements){h(Ce.allStatements);return}}catch(Ce){console.warn("Failed to load EYFS statements from Supabase:",Ce)}const _e=localStorage.getItem(`eyfs-standards-${t.sheet}`);if(_e)try{const Ce=JSON.parse(_e),De=[];Object.entries(Ce).forEach(([ye,rt])=>{rt.forEach(Ct=>{De.push(`${ye}: ${Ct}`)})}),h(De.length>0?De:Xc)}catch(Ce){console.error("Error parsing saved EYFS standards:",Ce),h(Xc)}else h(Xc)}catch(_e){console.error("Error loading EYFS statements:",_e),h(Xc)}},ur=async()=>{try{if(m(!0),p){console.log(`Data was cleared, setting empty state for ${t.sheet}`),l({}),i([]),s([]),u({}),m(!1);return}if(Wr())try{const Ce=await nh.getBySheet(t.sheet);if(Ce&&Object.keys(Ce).length>0){l(Ce.allLessonsData||{}),i(Ce.lessonNumbers||[]),s(Ce.teachingUnits||[]),u(Ce.eyfsStatements||{}),console.log(`Loaded ${t.sheet} data from Supabase`),m(!1);return}}catch(Ce){console.warn(`Supabase data fetch failed for ${t.sheet}, trying localStorage:`,Ce)}const _e=localStorage.getItem(`lesson-data-${t.sheet}`);if(_e){const Ce=JSON.parse(_e);l(Ce.allLessonsData||{}),i(Ce.lessonNumbers||[]),s(Ce.teachingUnits||[]),u(Ce.eyfsStatements||{}),console.log(`Loaded ${t.sheet} data from localStorage`),Wr()&&nh.updateSheet(t.sheet,Ce).then(()=>console.log(`Migrated ${t.sheet} data to Supabase`)).catch(De=>console.warn(`Failed to migrate ${t.sheet} data to Supabase:`,De))}else p?(console.log(`Data was cleared, setting empty state for ${t.sheet}`),l({}),i([]),s([]),u({}),v(!1)):await Ft()}catch(_e){console.error("Failed to load data:",_e),p?(console.log(`Data was cleared, setting empty state for ${t.sheet}`),l({}),i([]),s([]),u({}),v(!1)):await Ft()}finally{m(!1)}},Ft=async()=>{try{console.log(`Loading sample data for ${t.sheet}`),i([]),s([]),l({}),u({}),console.log(`Set empty data for ${t.sheet}`)}catch(_e){console.error(`Sample data loading failed for ${t.sheet}:`,_e),i([]),s([]),l({}),u({})}},tn=_e=>_e.sort((Ce,De)=>{const ye=U_.indexOf(Ce),rt=U_.indexOf(De);return ye!==-1&&rt!==-1?ye-rt:ye!==-1?-1:rt!==-1?1:Ce.localeCompare(De)}),fr=async _e=>{var Ce;try{if(!_e||_e.length===0){console.warn(`No sheet data provided for ${t.sheet}`);return}console.log(`Processing ${t.sheet} sheet data, rows:`,_e.length);const De=_e[0];console.log("Headers:",De);const ye=[],rt=new Set,Ct=new Set;let St="";for(let ue=1;ue<_e.length;ue++){const ae=_e[ue];if(!ae||ae.length<3)continue;const Ae=(ae[0]||"").toString().trim(),fe=(ae[1]||"").toString().trim(),ge=(ae[2]||"").toString().trim(),Oe=(ae[3]||"").toString().trim(),Ke=(ae[4]||"").toString().trim(),Ie=(ae[5]||"0").toString().trim(),Re=(ae[6]||"").toString().trim(),He=(ae[7]||"").toString().trim(),nt=(ae[8]||"").toString().trim(),lt=(ae[9]||"").toString().trim(),pt=(ae[10]||"").toString().trim();if(!fe||!ge)continue;Ae&&(St=Ae,rt.add(Ae)),Ct.add(fe);let st=0;try{const Nt=parseInt(Ie);!isNaN(Nt)&&Nt>=0&&(st=Nt)}catch{console.warn("Invalid time value:",Ie)}const dt={id:`${t.sheet}-${ge}-${fe}-${Date.now()}`,activity:ge,description:Oe.replace(/"/g,""),time:st,videoLink:Re,musicLink:He,backingLink:nt,resourceLink:lt,link:"",vocalsLink:"",imageLink:"",teachingUnit:fe,category:fe,level:Ke,unitName:pt,lessonNumber:St||"1",eyfsStandards:[]};if(ye.push(dt),Wr())try{const{id:Nt,uniqueId:pr,...Rt}=dt,rn={activity:Rt.activity,description:Rt.description,activity_text:Rt.activityText,time:Rt.time,video_link:Rt.videoLink,music_link:Rt.musicLink,backing_link:Rt.backingLink,resource_link:Rt.resourceLink,link:Rt.link,vocals_link:Rt.vocalsLink,image_link:Rt.imageLink,teaching_unit:Rt.teachingUnit,category:Rt.category,level:Rt.level,unit_name:Rt.unitName,lesson_number:Rt.lessonNumber,eyfs_standards:Rt.eyfsStandards};or.from(mn.ACTIVITIES).upsert([rn],{onConflict:"activity,category,lesson_number",ignoreDuplicates:!1}).then(({error:Vi})=>{Vi&&console.warn("Failed to add activity to Supabase:",Vi)})}catch(Nt){console.warn("Failed to add activity to Supabase:",Nt)}}console.log(`Processed ${t.sheet} activities:`,ye.length),console.log(`${t.sheet} lesson numbers found:`,Array.from(rt)),console.log(`${t.sheet} categories found:`,Array.from(Ct));const kt=Array.from(rt).filter(ue=>ue&&!isNaN(parseInt(ue))).sort((ue,ae)=>parseInt(ue)-parseInt(ae));i(kt),s(Array.from(Ct).sort());const Xt={};kt.forEach(ue=>{const ae=ye.filter(Ie=>Ie.lessonNumber===ue),Ae={},fe=new Set;let ge=0;ae.forEach(Ie=>{Ae[Ie.category]||(Ae[Ie.category]=[]),Ae[Ie.category].push(Ie),fe.add(Ie.category),ge+=Ie.time});const Oe=tn(Array.from(fe)),Ke=jW({grouped:Ae,categoryOrder:Oe,totalTime:ge,eyfsStatements:[]});Xt[ue]={grouped:Ae,categoryOrder:Oe,totalTime:ge,eyfsStatements:[],title:Ke}}),console.log(`${t.sheet} lessons data structure:`,Object.keys(Xt)),console.log(`Sample ${t.sheet} lesson category order:`,(Ce=Xt[kt[0]])==null?void 0:Ce.categoryOrder),l(Xt);const te={};if(kt.forEach(ue=>{te[ue]=[]}),u(te),Rn(Xt,kt,Array.from(Ct),te),Wr())try{await dr(Xt,kt,Array.from(Ct),te)}catch(ue){console.warn(`Failed to save ${t.sheet} data to Supabase, but data is saved locally:`,ue)}w(ue=>{const ae=new Map(ue.map(fe=>[`${fe.activity}-${fe.category}-${fe.lessonNumber}`,fe]));ye.forEach(fe=>{const ge=`${fe.activity}-${fe.category}-${fe.lessonNumber}`;ae.set(ge,fe)});const Ae=Array.from(ae.values());return localStorage.setItem("library-activities",JSON.stringify(Ae)),Ae})}catch(De){console.error(`Error processing ${t.sheet} sheet data:`,De),i([]),s([]),l({}),u({}),Rn({},[],[],{})}},dr=async(_e,Ce,De,ye)=>{const rt={allLessonsData:_e,lessonNumbers:Ce,teachingUnits:De,eyfsStatements:ye};try{return await nh.updateSheet(t.sheet,rt),console.log(`Saved ${t.sheet} data to Supabase`),!0}catch(Ct){return console.warn(`Failed to save ${t.sheet} data to Supabase:`,Ct),!1}},Rn=(_e,Ce,De,ye)=>{const rt={allLessonsData:_e,lessonNumbers:Ce,teachingUnits:De,eyfsStatements:ye};return localStorage.setItem(`lesson-data-${t.sheet}`,JSON.stringify(rt)),console.log(`Saved ${t.sheet} data to localStorage (backup)`),!0},nr=async _e=>{try{m(!0);const Ce=await Ta(_e);if(!Ce||Ce.length===0)throw new Error("No data found in the file.");return console.log("Excel data loaded:",Ce.slice(0,5)),await fr(Ce),!0}catch(Ce){throw console.error("Excel upload failed:",Ce),Ce}finally{m(!1)}},Ta=_e=>new Promise((Ce,De)=>{const ye=new FileReader;ye.onload=rt=>{var Ct;try{const St=(Ct=rt.target)==null?void 0:Ct.result;if(!St){De(new Error("Failed to read file."));return}const kt=dm(St,{type:"binary"}),Xt=kt.SheetNames[0],te=kt.Sheets[Xt],ue=pl.sheet_to_json(te,{header:1});Ce(ue)}catch(St){De(St)}},ye.onerror=()=>{De(new Error("Error reading file."))},ye.readAsBinaryString(_e)}),Nr=async()=>{await ur(),await et(),je(),se(),Me(),he(),X(!1),G(!1),await K()},Li=async(_e,Ce)=>{u(De=>{const ye={...De};return ye[_e]||(ye[_e]=[]),ye[_e].includes(Ce)||(ye[_e]=[...ye[_e],Ce]),Rn(o,n,a,ye),dr(o,n,a,ye).catch(rt=>console.warn("Failed to save EYFS statements to Supabase:",rt)),ye}),l(De=>{const ye={...De};if(ye[_e]){const rt=ye[_e].eyfsStatements||[];rt.includes(Ce)||(ye[_e]={...ye[_e],eyfsStatements:[...rt,Ce]})}return ye})},Aa=async(_e,Ce)=>{u(De=>{const ye={...De};return ye[_e]&&(ye[_e]=ye[_e].filter(rt=>rt!==Ce)),Rn(o,n,a,ye),dr(o,n,a,ye).catch(rt=>console.warn("Failed to save EYFS statements to Supabase:",rt)),ye}),l(De=>{const ye={...De};return ye[_e]&&ye[_e].eyfsStatements&&(ye[_e]={...ye[_e],eyfsStatements:ye[_e].eyfsStatements.filter(rt=>rt!==Ce)}),ye})},vr=async _e=>{h(_e),localStorage.setItem(`eyfs-statements-flat-${t.sheet}`,JSON.stringify(_e)),localStorage.setItem(`eyfs-standards-${t.sheet}`,JSON.stringify(ir(_e)));try{await w4.updateSheet(t.sheet,{allStatements:_e,structuredStatements:ir(_e)})}catch(Ce){console.error("Failed to save EYFS statements to Supabase:",Ce)}},Pt=(_e,Ce)=>{l(De=>{const ye={...De};return ye[_e]&&(ye[_e]={...ye[_e],title:Ce},Rn(ye,n,a,A),dr(ye,n,a,A).catch(rt=>console.warn("Failed to save lesson title to Supabase:",rt))),ye})},ir=_e=>{const Ce={};return _e.forEach(De=>{const ye=De.split(":"),rt=ye[0].trim(),Ct=ye.length>1?ye[1].trim():De;Ce[rt]||(Ce[rt]=[]),Ce[rt].push(Ct)}),Ce},ls={currentSheetInfo:t,setCurrentSheetInfo:r,lessonNumbers:n,teachingUnits:a,allLessonsData:o,eyfsStatements:A,allEyfsStatements:f,loading:d,refreshData:Nr,uploadExcelFile:nr,addEyfsToLesson:Li,removeEyfsFromLesson:Aa,updateAllEyfsStatements:vr,updateLessonTitle:Pt,userCreatedLessonPlans:g,addOrUpdateUserLessonPlan:ft,updateLessonData:Et,deleteUserLessonPlan:ut,deleteLesson:wt,allActivities:y,addActivity:be,updateActivity:Te,deleteActivity:pe,units:B,updateUnit:qe,deleteUnit:Fe,halfTerms:_,updateHalfTerm:Be,getLessonsForHalfTerm:xe,subjects:T,subjectCategories:S,currentSubject:L,subjectsLoading:W,setCurrentSubject:ne,loadSubjects:K,loadSubjectCategories:H,retryLoadSubjects:we,createSubject:k,updateSubject:U,deleteSubject:P,createSubjectCategory:D,updateSubjectCategory:O,deleteSubjectCategory:z,reorderSubjectCategories:J,toggleCategoryLock:Y,toggleCategoryVisibility:le,debugSubjectSetup:Q};return c.jsx($N.Provider,{value:ls,children:e})}const qN=ve.createContext(void 0);function Gi(){const e=ve.useContext(qN);if(e===void 0)throw new Error("useSettings must be used within a SettingsProvider");return e}const O_={LKG:{primary:"#10B981",secondary:"#059669",accent:"#34D399",gradient:"from-emerald-500 to-green-600"},UKG:{primary:"#3B82F6",secondary:"#2563EB",accent:"#60A5FA",gradient:"from-blue-500 to-indigo-600"},Reception:{primary:"#8B5CF6",secondary:"#7C3AED",accent:"#A78BFA",gradient:"from-purple-500 to-violet-600"}},gx={schoolName:"Curriculum Designer",schoolLogo:"/RLOGO.png",primaryColor:"#3B82F6",secondaryColor:"#2563EB",accentColor:"#60A5FA",customTheme:!1},j_=[{name:"Welcome",color:"#F59E0B",position:0},{name:"Kodaly Songs",color:"#8B5CF6",position:1},{name:"Kodaly Action Songs",color:"#F97316",position:2},{name:"Action/Games Songs",color:"#F97316",position:3},{name:"Rhythm Sticks",color:"#D97706",position:4},{name:"Scarf Songs",color:"#10B981",position:5},{name:"General Game",color:"#3B82F6",position:6},{name:"Core Songs",color:"#84CC16",position:7},{name:"Parachute Games",color:"#EF4444",position:8},{name:"Percussion Games",color:"#06B6D4",position:9},{name:"Teaching Units",color:"#6366F1",position:10},{name:"Goodbye",color:"#14B8A6",position:11},{name:"Kodaly Rhythms",color:"#9333EA",position:12},{name:"Kodaly Games",color:"#F59E0B",position:13},{name:"IWB Games",color:"#FBBF24",position:14}],D_=[{id:"LKG",name:"Lower Kindergarten",color:"#10B981"},{id:"UKG",name:"Upper Kindergarten",color:"#3B82F6"},{id:"Reception",name:"Reception",color:"#8B5CF6"}];function PW({children:e}){const[t,r]=ve.useState(gx),[n,i]=ve.useState(j_),[a,s]=ve.useState(D_);ve.useEffect(()=>{try{const p=localStorage.getItem("lesson-viewer-settings");if(p){const w=JSON.parse(p);r({...gx,...w})}const v=localStorage.getItem("lesson-viewer-categories");if(v){const w=JSON.parse(v);i(w)}const y=localStorage.getItem("custom-year-groups");if(y){const w=JSON.parse(y);s(w)}}catch(p){console.error("Failed to load settings:",p)}},[]),ve.useEffect(()=>{try{localStorage.setItem("lesson-viewer-settings",JSON.stringify(t))}catch(p){console.error("Failed to save settings:",p)}},[t]),ve.useEffect(()=>{try{localStorage.setItem("lesson-viewer-categories",JSON.stringify(n))}catch(p){console.error("Failed to save categories:",p)}},[n]),ve.useEffect(()=>{try{localStorage.setItem("custom-year-groups",JSON.stringify(a))}catch(p){console.error("Failed to save year groups:",p)}},[a]);const o=p=>{r(v=>({...v,...p}))},l=p=>{i(p)},A=p=>{s(p)},u=()=>{r(gx),localStorage.removeItem("lesson-viewer-settings")},f=()=>{i(j_),localStorage.removeItem("lesson-viewer-categories")},h=()=>{s(D_),localStorage.removeItem("custom-year-groups")},d=p=>{if(t.customTheme)return{primary:t.primaryColor,secondary:t.secondaryColor,accent:t.accentColor,gradient:`from-[${t.primaryColor}] to-[${t.secondaryColor}]`};const v=a.find(y=>y.id===p);return v&&v.color?{primary:v.color,secondary:g(v.color,-20),accent:g(v.color,20),gradient:`from-[${v.color}] to-[${g(v.color,-20)}]`}:O_[p]||O_.LKG},m=p=>{const v=n.find(y=>y.name===p);return(v==null?void 0:v.color)||"#6B7280"},g=(p,v)=>{let y=parseInt(p.substring(1,3),16),w=parseInt(p.substring(3,5),16),B=parseInt(p.substring(5,7),16);return y=Math.max(0,Math.min(255,y+v)),w=Math.max(0,Math.min(255,w+v)),B=Math.max(0,Math.min(255,B+v)),`#${y.toString(16).padStart(2,"0")}${w.toString(16).padStart(2,"0")}${B.toString(16).padStart(2,"0")}`},x={settings:t,categories:n,customYearGroups:a,updateSettings:o,updateCategories:l,updateYearGroups:A,resetToDefaults:u,resetCategoriesToDefaults:f,resetYearGroupsToDefaults:h,getThemeForClass:d,getCategoryColor:m};return c.jsx(qN.Provider,{value:x,children:e})}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var QW={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RW=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),_t=(e,t)=>{const r=ve.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:a=2,absoluteStrokeWidth:s,className:o="",children:l,...A},u)=>ve.createElement("svg",{ref:u,...QW,width:i,height:i,stroke:n,strokeWidth:s?Number(a)*24/Number(i):a,className:["lucide",`lucide-${RW(e)}`,o].join(" "),...A},[...t.map(([f,h])=>ve.createElement(f,h)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DA=_t("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yh=_t("ArrowDownUp",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"m21 8-4-4-4 4",key:"1c9v7m"}],["path",{d:"M17 4v16",key:"7dpous"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MW=_t("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HW=_t("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jh=_t("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=_t("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KW=_t("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=_t("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const No=_t("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=_t("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f0=_t("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gm=_t("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zb=_t("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h0=_t("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _a=_t("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GW=_t("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gl=_t("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ko=_t("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zN=_t("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yu=_t("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VW=_t("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=_t("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WW=_t("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mm=_t("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $W=_t("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XN=_t("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bh=_t("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qW=_t("Hand",[["path",{d:"M18 11V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v0",key:"aigmz7"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v2",key:"1n6bmn"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v8",key:"a9iiix"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vm=_t("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Md=_t("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vy=_t("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hd=_t("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zW=_t("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YN=_t("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xy=_t("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P_=_t("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XW=_t("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YW=_t("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JW=_t("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZW=_t("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JN=_t("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kd=_t("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q_=_t("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ki=_t("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ka=_t("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yy=_t("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tl=_t("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mx=_t("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=_t("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e$=_t("School",[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 4 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-8l4-2",key:"1vwozw"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 8-4 8 4",key:"1q0ilc"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rA=_t("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t$=_t("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xm=_t("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r$=_t("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pn=_t("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _i=_t("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n$=_t("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vl=_t("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R_=_t("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ym=_t("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gd=_t("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eo=_t("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=_t("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i$=_t("Youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]);function cf(){const e=ve.useContext(Dk);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}function a$({embedded:e=!1}){const{user:t}=cf(),{refreshData:r,uploadExcelFile:n,loading:i}=oi(),[a,s]=ve.useState(!1),[o,l]=ve.useState("idle"),[A,u]=ve.useState("checking"),[f,h]=ve.useState(""),d=(t==null?void 0:t.email)==="rob.reichstorer@gmail.com"||(t==null?void 0:t.role)==="administrator",m=async()=>{try{if(u("checking"),Wr())try{await b4.exportAll(),u("online")}catch(v){console.warn("Supabase connection failed:",v),u("offline")}}catch(v){console.error("Server status check failed:",v),u("offline")}},g=async v=>{var w;const y=(w=v.target.files)==null?void 0:w[0];if(y)try{l("uploading"),await n(y),l("success"),setTimeout(()=>l("idle"),3e3)}catch{l("error"),setTimeout(()=>l("idle"),3e3)}},x=async()=>{try{l("uploading");const v={activities:[],lessons:{},lessonPlans:[],eyfs:{}},y=localStorage.getItem("library-activities");y&&(v.activities=JSON.parse(y)),["LKG","UKG","Reception"].forEach(B=>{const E=localStorage.getItem(`lesson-data-${B}`);E&&(v.lessons[B]=JSON.parse(E))});const w=localStorage.getItem("lesson-plans");w&&(v.lessonPlans=JSON.parse(w)),["LKG","UKG","Reception"].forEach(B=>{const E=localStorage.getItem(`eyfs-standards-${B}`);E&&(v.eyfs[B]=JSON.parse(E))}),await b4.importAll(v),l("success"),h("Data successfully migrated to Supabase."),setTimeout(()=>l("idle"),3e3)}catch(v){console.error("Migration failed:",v),l("error"),h("Failed to migrate data to Supabase."),setTimeout(()=>l("idle"),3e3)}},p=()=>{confirm("Are you sure you want to clear ALL local data? This will remove all lessons, activities, units, and settings. This action cannot be undone.")&&(localStorage.removeItem("lesson-data-LKG"),localStorage.removeItem("lesson-data-UKG"),localStorage.removeItem("lesson-data-Reception"),localStorage.removeItem("lesson-plans"),localStorage.removeItem("library-activities"),localStorage.removeItem("units"),localStorage.removeItem("eyfs-standards-LKG"),localStorage.removeItem("eyfs-standards-UKG"),localStorage.removeItem("eyfs-standards-Reception"),localStorage.removeItem("eyfs-statements-flat-LKG"),localStorage.removeItem("eyfs-statements-flat-UKG"),localStorage.removeItem("eyfs-statements-flat-Reception"),localStorage.removeItem("lesson-viewer-settings"),localStorage.removeItem("lesson-viewer-categories"),localStorage.removeItem("user-created-lesson-plans"),localStorage.removeItem("admin-editable-content"),localStorage.removeItem("admin-google-sheets-config"),localStorage.removeItem("has-visited-before"),l("success"),h("All local data has been cleared. The page will reload."),setTimeout(()=>{window.location.href=window.location.pathname+"?cleared=true"+window.location.hash},1500))};return ve.useEffect(()=>{a&&m()},[a]),d?e&&!a?c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[c.jsx(No,{className:"h-6 w-6 text-blue-600"}),c.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Welcome, ",t==null?void 0:t.name,"!"]})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"You have full administrative access to manage the EYFS Lesson Builder system. Use the options below to configure data sources and manage content."}),c.jsx("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-gray-600 font-medium",children:"Admin Email:"}),c.jsx("span",{className:"font-semibold text-blue-600",children:t==null?void 0:t.email})]}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-gray-600 font-medium",children:"Access Level:"}),c.jsx("span",{className:"font-semibold text-green-600",children:"Full Administrator"})]})]})})]}),c.jsxs("div",{className:"border border-gray-200 rounded-lg p-6",children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[c.jsx(Vl,{className:"h-6 w-6 text-blue-600"}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Excel File Upload"})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Upload an Excel file (.xlsx, .xls, .csv) to update your lesson data."}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:g,disabled:o==="uploading",className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 transition-colors duration-200"}),o==="uploading"&&c.jsxs("div",{className:"flex items-center space-x-2 text-blue-600 p-3 bg-blue-50 rounded-lg",children:[c.jsx(Tl,{className:"h-5 w-5 animate-spin"}),c.jsx("span",{className:"text-sm font-medium",children:f||"Uploading and processing..."})]}),o==="success"&&c.jsxs("div",{className:"flex items-center space-x-2 text-green-600 p-3 bg-green-50 rounded-lg",children:[c.jsx(No,{className:"h-5 w-5"}),c.jsx("span",{className:"text-sm font-medium",children:f||"Data updated successfully!"})]}),o==="error"&&c.jsxs("div",{className:"flex items-center space-x-2 text-red-600 p-3 bg-red-50 rounded-lg",children:[c.jsx(DA,{className:"h-5 w-5"}),c.jsx("span",{className:"text-sm font-medium",children:f||"Update failed. Please try again."})]})]})]}),c.jsxs("div",{className:"border border-red-200 bg-red-50 rounded-lg p-6",children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[c.jsx(_i,{className:"h-6 w-6 text-red-600"}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Clear All Local Data"})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Clear all locally stored data including lessons, activities, units, and settings. This action cannot be undone."}),c.jsxs("button",{onClick:p,className:"w-full bg-red-600 hover:bg-red-700 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center space-x-2",children:[c.jsx(_i,{className:"h-5 w-5"}),c.jsx("span",{children:"Clear All Local Data"})]}),c.jsx("p",{className:"text-xs text-red-600 mt-2 text-center",children:"Warning: This will remove all your lessons, activities, units, and settings."})]})]}):!a&&!e?null:e?c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"border border-gray-200 rounded-lg p-6",children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[c.jsx(Vl,{className:"h-6 w-6 text-blue-600"}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Excel File Upload"})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Upload an Excel file (.xlsx, .xls, .csv) to update your lesson data."}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:g,disabled:o==="uploading",className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 transition-colors duration-200"}),o==="uploading"&&c.jsxs("div",{className:"flex items-center space-x-2 text-blue-600 p-3 bg-blue-50 rounded-lg",children:[c.jsx(Tl,{className:"h-5 w-5 animate-spin"}),c.jsx("span",{className:"text-sm font-medium",children:f||"Uploading and processing..."})]}),o==="success"&&c.jsxs("div",{className:"flex items-center space-x-2 text-green-600 p-3 bg-green-50 rounded-lg",children:[c.jsx(No,{className:"h-5 w-5"}),c.jsx("span",{className:"text-sm font-medium",children:f||"Data updated successfully!"})]}),o==="error"&&c.jsxs("div",{className:"flex items-center space-x-2 text-red-600 p-3 bg-red-50 rounded-lg",children:[c.jsx(DA,{className:"h-5 w-5"}),c.jsx("span",{className:"text-sm font-medium",children:f||"Update failed. Please try again."})]})]})]}),c.jsxs("div",{className:"border border-red-200 bg-red-50 rounded-lg p-6",children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[c.jsx(_i,{className:"h-6 w-6 text-red-600"}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Clear All Local Data"})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Clear all locally stored data including lessons, activities, units, and settings. This action cannot be undone."}),c.jsxs("button",{onClick:p,className:"w-full bg-red-600 hover:bg-red-700 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center space-x-2",children:[c.jsx(_i,{className:"h-5 w-5"}),c.jsx("span",{children:"Clear All Local Data"})]}),c.jsx("p",{className:"text-xs text-red-600 mt-2 text-center",children:"Warning: This will remove all your lessons, activities, units, and settings."})]})]}):c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 bg-gradient-to-r from-blue-600 to-indigo-600 text-white flex-shrink-0",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(xm,{className:"h-6 w-6"}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold",children:"Admin Settings"}),c.jsxs("p",{className:"text-blue-100 text-sm",children:["Data Source Management - ",t==null?void 0:t.name]})]})]}),c.jsx("button",{onClick:()=>s(!1),className:"p-2 text-blue-100 hover:text-white hover:bg-blue-700 rounded-lg transition-colors duration-200",children:c.jsx(Zr,{className:"h-6 w-6"})})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[c.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[c.jsx(No,{className:"h-6 w-6 text-blue-600"}),c.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Welcome, ",t==null?void 0:t.name,"!"]})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"You have full administrative access to manage the EYFS Lesson Builder system. Use the options below to configure data sources and manage content."}),c.jsx("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-gray-600 font-medium",children:"Admin Email:"}),c.jsx("span",{className:"font-semibold text-blue-600",children:t==null?void 0:t.email})]}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-gray-600 font-medium",children:"Access Level:"}),c.jsx("span",{className:"font-semibold text-green-600",children:"Full Administrator"})]})]})})]}),c.jsxs("div",{className:"border border-gray-200 rounded-lg p-6",children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[c.jsx(t$,{className:"h-6 w-6 text-blue-600"}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Supabase Status"})]}),c.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200 mb-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-gray-700 font-medium",children:"Supabase Connection:"}),A==="checking"?c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Tl,{className:"h-4 w-4 text-blue-600 animate-spin"}),c.jsx("span",{className:"text-blue-600 font-medium",children:"Checking..."})]}):A==="online"?c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),c.jsx("span",{className:"text-green-600 font-medium",children:"Connected"})]}):c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),c.jsx("span",{className:"text-red-600 font-medium",children:"Disconnected"})]})]})}),A==="offline"&&c.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200 mb-4",children:c.jsxs("div",{className:"flex items-start space-x-2",children:[c.jsx(DA,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-yellow-700 font-medium mb-1",children:"Supabase is disconnected"}),c.jsx("p",{className:"text-sm text-yellow-600",children:"The application is currently using local storage for data. Connect to Supabase to enable cloud storage and synchronization."})]})]})}),A==="online"&&c.jsxs("button",{onClick:x,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center space-x-2",children:[c.jsx(GW,{className:"h-5 w-5"}),c.jsx("span",{children:"Migrate Local Data to Supabase"})]})]}),c.jsxs("div",{className:"border border-gray-200 rounded-lg p-6",children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[c.jsx(Vl,{className:"h-6 w-6 text-blue-600"}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Excel File Upload"})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Upload an Excel file (.xlsx, .xls, .csv) to update your lesson data."}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:g,disabled:o==="uploading",className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 transition-colors duration-200"}),o==="uploading"&&c.jsxs("div",{className:"flex items-center space-x-2 text-blue-600 p-3 bg-blue-50 rounded-lg",children:[c.jsx(Tl,{className:"h-5 w-5 animate-spin"}),c.jsx("span",{className:"text-sm font-medium",children:f||"Uploading and processing..."})]}),o==="success"&&c.jsxs("div",{className:"flex items-center space-x-2 text-green-600 p-3 bg-green-50 rounded-lg",children:[c.jsx(No,{className:"h-5 w-5"}),c.jsx("span",{className:"text-sm font-medium",children:f||"Data updated successfully!"})]}),o==="error"&&c.jsxs("div",{className:"flex items-center space-x-2 text-red-600 p-3 bg-red-50 rounded-lg",children:[c.jsx(DA,{className:"h-5 w-5"}),c.jsx("span",{className:"text-sm font-medium",children:f||"Update failed. Please try again."})]})]})]}),c.jsxs("div",{className:"border border-red-200 bg-red-50 rounded-lg p-6",children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[c.jsx(_i,{className:"h-6 w-6 text-red-600"}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Clear All Local Data"})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Clear all locally stored data including lessons, activities, units, and settings. This action cannot be undone."}),c.jsxs("button",{onClick:p,className:"w-full bg-red-600 hover:bg-red-700 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center space-x-2",children:[c.jsx(_i,{className:"h-5 w-5"}),c.jsx("span",{children:"Clear All Local Data"})]}),c.jsx("p",{className:"text-xs text-red-600 mt-2 text-center",children:"Warning: This will remove all your lessons, activities, units, and settings."})]}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Current Configuration"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[c.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg border border-gray-200",children:[c.jsx("span",{className:"text-gray-600 font-medium",children:"Primary Data Source:"}),c.jsx("span",{className:"font-semibold text-green-600",children:A==="online"?"Supabase":"Local Storage (Fallback)"})]}),c.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg border border-gray-200",children:[c.jsx("span",{className:"text-gray-600 font-medium",children:"Authentication:"}),c.jsx("span",{className:"font-semibold text-blue-600",children:"EYFS Admin"})]}),c.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg border border-gray-200 md:col-span-2",children:[c.jsx("span",{className:"text-gray-600 font-medium",children:"Last Updated:"}),c.jsxs("span",{className:"font-semibold text-gray-900",children:[new Date().toLocaleDateString()," ",new Date().toLocaleTimeString()]})]})]})]})]}),c.jsx("div",{className:"flex justify-end p-6 border-t border-gray-200 bg-gray-50 flex-shrink-0",children:c.jsx("button",{onClick:()=>s(!1),className:"px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg transition-colors duration-200",children:"Close"})})]})}):null}const M_=[{name:"Purple",value:"#8b5cf6"},{name:"Orange",value:"#f97316"},{name:"Green",value:"#10b981"},{name:"Blue",value:"#06b6d4"},{name:"Lime",value:"#84cc16"},{name:"Yellow",value:"#f59e0b"},{name:"Red",value:"#ef4444"},{name:"Pink",value:"#ec4899"},{name:"Indigo",value:"#6366f1"},{name:"Gray",value:"#6b7280"}];function s$(){const e=oi(),{subjects:t=[],subjectCategories:r=[],currentSubject:n,setCurrentSubject:i,loadSubjects:a,loadSubjectCategories:s,createSubject:o,updateSubject:l,deleteSubject:A,createSubjectCategory:u,updateSubjectCategory:f,deleteSubjectCategory:h,reorderSubjectCategories:d,toggleCategoryLock:m,toggleCategoryVisibility:g,subjectsLoading:x}=e||{},p=t||[],v=r||[],[y,w]=ve.useState(!1),[B,E]=ve.useState(!1),[_,F]=ve.useState(!1),[T,I]=ve.useState(null),[S,C]=ve.useState(null),[L,R]=ve.useState({name:"",description:"",color:"#8b5cf6"}),[W,G]=ve.useState({name:"",description:"",color:"#8b5cf6",is_locked:!1});ve.useEffect(()=>{a&&a()},[]);const V=async()=>{if(L.name.trim()){w(!0);try{T?await l(T.id,{name:L.name,description:L.description,color:L.color}):await o({name:L.name,description:L.description,color:L.color,is_active:!0}),await a(),E(!1),k()}catch(O){console.error("Error saving subject:",O),alert("Error saving subject: "+O.message)}finally{w(!1)}}},X=async O=>{if(confirm(`Are you sure you want to delete "${O.name}"? This will also delete all associated categories.`))try{await A(O.id),await a()}catch(z){console.error("Error deleting subject:",z),alert("Error deleting subject: "+z.message)}},Q=async()=>{if(!(!W.name.trim()||!n)){w(!0);try{if(S)await f(S.id,{name:W.name,description:W.description,color:W.color,is_locked:W.is_locked});else{const O=v.length>0?Math.max(...v.map(z=>z.sort_order),0):0;await u({subject_id:n.id,name:W.name,description:W.description,color:W.color,is_locked:W.is_locked,is_active:!0,sort_order:O+1})}await s(n.id),F(!1),U()}catch(O){console.error("Error saving category:",O),alert("Error saving category: "+O.message)}finally{w(!1)}}},K=async O=>{if(confirm(`Are you sure you want to delete "${O.name}"?`))try{await h(O.id),n&&await s(n.id)}catch(z){console.error("Error deleting category:",z),alert("Error deleting category: "+z.message)}},H=async(O,z)=>{if(!n)return;const J=[...v],[Y]=J.splice(O,1);J.splice(z,0,Y);const le=J.map(we=>we.id);try{await d(n.id,le)}catch(we){console.error("Error reordering categories:",we)}},k=()=>{R({name:"",description:"",color:"#8b5cf6"}),I(null)},U=()=>{G({name:"",description:"",color:"#8b5cf6",is_locked:!1}),C(null)},P=O=>{I(O),R({name:O.name,description:O.description||"",color:O.color}),E(!0)},D=O=>{C(O),G({name:O.name,description:O.description||"",color:O.color,is_locked:O.is_locked}),F(!0)};return x||!e?c.jsxs("div",{className:"flex items-center justify-center py-8",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),c.jsx("span",{className:"ml-3 text-gray-600",children:"Loading subjects..."})]}):c.jsx("div",{className:"w-full max-w-full",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:[c.jsx("div",{className:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-blue-600 to-indigo-600 text-white",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(Ls,{className:"h-6 w-6"}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold",children:"Subjects & Categories"}),c.jsx("p",{className:"text-blue-100 text-sm",children:"Manage subjects and their categories"})]})]}),c.jsxs("button",{onClick:()=>{k(),E(!0)},className:"px-4 py-2 bg-white bg-opacity-20 hover:bg-opacity-30 text-white font-medium rounded-lg flex items-center space-x-2 transition-colors",children:[c.jsx(ka,{className:"h-4 w-4"}),c.jsx("span",{children:"New Subject"})]})]})}),c.jsxs("div",{className:"flex min-h-[500px] max-h-[70vh]",children:[c.jsxs("div",{className:"w-1/3 border-r border-gray-200 bg-gray-50",children:[c.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:c.jsxs("h3",{className:"font-semibold text-gray-900",children:["Subjects (",p.length,")"]})}),c.jsx("div",{className:"overflow-y-auto",style:{height:"calc(70vh - 120px)"},children:p.length===0?c.jsxs("div",{className:"p-4 text-center text-gray-500",children:[c.jsx(Ls,{className:"h-8 w-8 text-gray-300 mx-auto mb-2"}),c.jsx("p",{className:"text-sm",children:"No subjects yet"}),c.jsx("p",{className:"text-xs text-gray-400",children:"Create your first subject"})]}):p.map(O=>c.jsx("div",{className:`p-4 border-b border-gray-200 cursor-pointer hover:bg-gray-100 transition-colors ${(n==null?void 0:n.id)===O.id?"bg-blue-50 border-l-4 border-l-blue-600":""}`,onClick:()=>i(O),children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:O.color}}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-900",children:O.name}),O.description&&c.jsx("p",{className:"text-sm text-gray-600",children:O.description})]})]}),c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx("button",{onClick:z=>{z.stopPropagation(),P(O)},className:"p-1 text-gray-400 hover:text-blue-600 rounded",children:c.jsx(ki,{className:"h-4 w-4"})}),c.jsx("button",{onClick:z=>{z.stopPropagation(),X(O)},className:"p-1 text-gray-400 hover:text-red-600 rounded",children:c.jsx(_i,{className:"h-4 w-4"})})]})]})},O.id))})]}),c.jsx("div",{className:"flex-1",children:n?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"px-4 py-3 border-b border-gray-200 bg-white",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-6 h-6 rounded-full",style:{backgroundColor:n.color}}),c.jsxs("div",{children:[c.jsxs("h3",{className:"font-semibold text-gray-900",children:[n.name," Categories"]}),c.jsxs("p",{className:"text-sm text-gray-600",children:[v.length," categories"]})]})]}),c.jsxs("button",{onClick:()=>{U(),F(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg flex items-center space-x-2 transition-colors",children:[c.jsx(ka,{className:"h-4 w-4"}),c.jsx("span",{children:"Add Category"})]})]})}),c.jsx("div",{className:"p-4 overflow-y-auto",style:{height:"calc(70vh - 180px)"},children:c.jsxs("div",{className:"space-y-3",children:[v.map((O,z)=>c.jsx("div",{className:`p-4 rounded-lg border transition-all ${O.is_active?"bg-white border-gray-200":"bg-gray-50 border-gray-300 opacity-60"}`,children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:O.color}}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("h4",{className:"font-medium text-gray-900",children:O.name}),O.is_locked&&c.jsx(xy,{className:"h-4 w-4 text-amber-600",title:"Locked category"})]}),O.description&&c.jsx("p",{className:"text-sm text-gray-600",children:O.description})]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[z>0&&c.jsx("button",{onClick:()=>H(z,z-1),className:"p-1 text-gray-400 hover:text-blue-600 rounded",title:"Move up",children:c.jsx(h0,{className:"h-4 w-4"})}),z<v.length-1&&c.jsx("button",{onClick:()=>H(z,z+1),className:"p-1 text-gray-400 hover:text-blue-600 rounded",title:"Move down",children:c.jsx(f0,{className:"h-4 w-4"})}),c.jsx("button",{onClick:()=>g(O.id),className:`p-1 rounded ${O.is_active?"text-gray-400 hover:text-orange-600":"text-orange-600 hover:text-gray-400"}`,title:O.is_active?"Hide category":"Show category",children:O.is_active?c.jsx(Yu,{className:"h-4 w-4"}):c.jsx(zN,{className:"h-4 w-4"})}),c.jsx("button",{onClick:()=>m(O.id),className:`p-1 rounded ${O.is_locked?"text-amber-600 hover:text-gray-400":"text-gray-400 hover:text-amber-600"}`,title:O.is_locked?"Unlock category":"Lock category",children:O.is_locked?c.jsx(xy,{className:"h-4 w-4"}):c.jsx(n$,{className:"h-4 w-4"})}),c.jsx("button",{onClick:()=>D(O),className:"p-1 text-gray-400 hover:text-blue-600 rounded",title:"Edit category",children:c.jsx(ki,{className:"h-4 w-4"})}),c.jsx("button",{onClick:()=>K(O),className:"p-1 text-gray-400 hover:text-red-600 rounded",title:"Delete category",children:c.jsx(_i,{className:"h-4 w-4"})})]})]})},O.id)),v.length===0&&c.jsxs("div",{className:"text-center py-12 text-gray-500",children:[c.jsx(Pn,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),c.jsx("p",{className:"text-lg",children:"No categories yet"}),c.jsxs("p",{className:"text-sm",children:["Add categories to organize activities for ",n.name]})]})]})})]}):c.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:c.jsxs("div",{className:"text-center",children:[c.jsx(Ls,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),c.jsx("p",{className:"text-lg",children:"Select a subject to manage categories"}),c.jsx("p",{className:"text-sm",children:"Create your first subject to get started"})]})})})]}),B&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[c.jsx("div",{className:"p-6 border-b border-gray-200",children:c.jsx("h3",{className:"text-lg font-semibold",children:T?"Edit Subject":"Create New Subject"})}),c.jsxs("div",{className:"p-6 space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject Name *"}),c.jsx("input",{type:"text",value:L.name,onChange:O=>R({...L,name:O.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Music, Drama, EYFS"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),c.jsx("textarea",{value:L.description,onChange:O=>R({...L,description:O.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"Brief description of this subject..."})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color Theme"}),c.jsx("div",{className:"flex flex-wrap gap-2",children:M_.map(O=>c.jsx("button",{onClick:()=>R({...L,color:O.value}),className:`w-8 h-8 rounded-full border-2 transition-all ${L.color===O.value?"border-gray-800 scale-110":"border-gray-300 hover:border-gray-400"}`,style:{backgroundColor:O.value},title:O.name},O.value))})]})]}),c.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:[c.jsx("button",{onClick:()=>{E(!1),k()},className:"px-4 py-2 text-gray-600 hover:text-gray-800 font-medium",children:"Cancel"}),c.jsxs("button",{onClick:V,disabled:!L.name.trim()||y,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 text-white font-medium rounded-lg flex items-center space-x-2",children:[y&&c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),c.jsx(ao,{className:"h-4 w-4"}),c.jsx("span",{children:T?"Update":"Create"})]})]})]})}),_&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[c.jsxs("div",{className:"p-6 border-b border-gray-200",children:[c.jsx("h3",{className:"text-lg font-semibold",children:S?"Edit Category":"Create New Category"}),n&&c.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["for ",n.name]})]}),c.jsxs("div",{className:"p-6 space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category Name *"}),c.jsx("input",{type:"text",value:W.name,onChange:O=>G({...W,name:O.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Warm Up, Games, Cool Down"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),c.jsx("textarea",{value:W.description,onChange:O=>G({...W,description:O.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"What types of activities go in this category..."})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color"}),c.jsx("div",{className:"flex flex-wrap gap-2",children:M_.map(O=>c.jsx("button",{onClick:()=>G({...W,color:O.value}),className:`w-8 h-8 rounded-full border-2 transition-all ${W.color===O.value?"border-gray-800 scale-110":"border-gray-300 hover:border-gray-400"}`,style:{backgroundColor:O.value},title:O.name},O.value))})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("input",{type:"checkbox",id:"locked",checked:W.is_locked,onChange:O=>G({...W,is_locked:O.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),c.jsx("label",{htmlFor:"locked",className:"text-sm font-medium text-gray-700",children:"Lock this category (prevent users from modifying)"})]})]}),c.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:[c.jsx("button",{onClick:()=>{F(!1),U()},className:"px-4 py-2 text-gray-600 hover:text-gray-800 font-medium",children:"Cancel"}),c.jsxs("button",{onClick:Q,disabled:!W.name.trim()||y,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 text-white font-medium rounded-lg flex items-center space-x-2",children:[y&&c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),c.jsx(ao,{className:"h-4 w-4"}),c.jsx("span",{children:S?"Update":"Create"})]})]})]})})]})})}function o$({isOpen:e,onClose:t}){const{user:r}=cf(),{settings:n,updateSettings:i,resetToDefaults:a,categories:s,updateCategories:o,resetCategoriesToDefaults:l,customYearGroups:A,updateYearGroups:u,resetYearGroupsToDefaults:f}=Gi(),[h,d]=ve.useState(n),[m,g]=ve.useState(s),[x,p]=ve.useState(A),[v,y]=ve.useState("idle"),[w,B]=ve.useState("appearance"),[E,_]=ve.useState(null),[F,T]=ve.useState(""),[I,S]=ve.useState("#6B7280"),[C,L]=ve.useState(null),[R,W]=ve.useState(""),[G,V]=ve.useState(""),[X,Q]=ve.useState("#3B82F6"),[K,H]=ve.useState(null),[k,U]=ve.useState(null);ve.useState(!1);const P=(r==null?void 0:r.email)==="rob.reichstorer@gmail.com"||(r==null?void 0:r.role)==="administrator";es.useEffect(()=>{d(n)},[n]),es.useEffect(()=>{g(s)},[s]),es.useEffect(()=>{p(A)},[A]);const D=()=>{i(h),o(m),u(x),t()},O=()=>{d(n),g(s),p(A),t()},z=async pe=>{var Ve;const je=(Ve=pe.target.files)==null?void 0:Ve[0];if(je){if(!je.type.startsWith("image/")){y("error"),setTimeout(()=>y("idle"),3e3);return}try{y("uploading");const We=new FileReader;We.onload=ft=>{var ut;const Et=(ut=ft.target)==null?void 0:ut.result;d(wt=>({...wt,schoolLogo:Et})),y("success"),setTimeout(()=>y("idle"),3e3)},We.readAsDataURL(je)}catch(We){console.error("Logo upload failed:",We),y("error"),setTimeout(()=>y("idle"),3e3)}}},J=()=>{confirm("Are you sure you want to reset all settings to defaults? This cannot be undone.")&&(a(),d(n))},Y=()=>{if(F.trim()){if(m.some(pe=>pe.name.toLowerCase()===F.toLowerCase())){alert("A category with this name already exists.");return}g([...m,{name:F,color:I,position:m.length}]),T(""),S("#6B7280")}},le=pe=>{if(confirm("Are you sure you want to delete this category? This may affect existing activities.")){const je=m.filter((Ve,We)=>We!==pe);je.forEach((Ve,We)=>{Ve.position=We}),g(je)}},we=pe=>{L(pe)},ne=(pe,je)=>{if(pe.preventDefault(),!C||C===je)return;const Ve=m.findIndex(ut=>ut.name===C),We=m.findIndex(ut=>ut.name===je);if(Ve===-1||We===-1)return;const ft=[...m],[Et]=ft.splice(Ve,1);ft.splice(We,0,Et),ft.forEach((ut,wt)=>{ut.position=wt}),g(ft)},Me=()=>{L(null)},qe=()=>{confirm("Are you sure you want to reset categories to defaults? This cannot be undone.")&&(l(),g(s))},Fe=()=>{if(!(!R.trim()||!G.trim())){if(x.some(pe=>pe.id.toLowerCase()===R.toLowerCase())){alert("A year group with this ID already exists.");return}p([...x,{id:R,name:G,color:X}]),W(""),V(""),Q("#3B82F6")}},he=pe=>{if(confirm("Are you sure you want to delete this year group? This may affect existing lessons.")){const je=x.filter((Ve,We)=>We!==pe);p(je)}},Be=pe=>{U(pe)},xe=(pe,je)=>{if(pe.preventDefault(),!k||k===je)return;const Ve=x.findIndex(ut=>ut.id===k),We=x.findIndex(ut=>ut.id===je);if(Ve===-1||We===-1)return;const ft=[...x],[Et]=ft.splice(Ve,1);ft.splice(We,0,Et),p(ft)},se=()=>{U(null)},be=()=>{confirm("Are you sure you want to reset year groups to defaults? This cannot be undone.")&&(f(),p(A))},Te=["https://images.pexels.com/photos/1181686/pexels-photo-1181686.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&dpr=2","https://images.pexels.com/photos/164821/pexels-photo-164821.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&dpr=2","https://images.pexels.com/photos/1407322/pexels-photo-1407322.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&dpr=2","https://images.pexels.com/photos/1751731/pexels-photo-1751731.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&dpr=2"];return e?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 bg-white",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(xm,{className:"h-6 w-6 text-blue-600"}),c.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"User Settings"})]}),c.jsx("button",{onClick:O,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:c.jsx(Zr,{className:"h-6 w-6"})})]}),c.jsxs("div",{className:"flex border-b border-gray-200",children:[c.jsx("button",{onClick:()=>B("appearance"),className:`px-6 py-3 font-medium text-sm transition-colors duration-200 ${w==="appearance"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Appearance"}),c.jsx("button",{onClick:()=>B("yeargroups"),className:`px-6 py-3 font-medium text-sm transition-colors duration-200 ${w==="yeargroups"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Year Groups"}),c.jsx("button",{onClick:()=>B("categories"),className:`px-6 py-3 font-medium text-sm transition-colors duration-200 ${w==="categories"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Activity Categories"}),P&&c.jsx("button",{onClick:()=>B("data"),className:`px-6 py-3 font-medium text-sm transition-colors duration-200 ${w==="data"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Data Management"})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[w==="appearance"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[c.jsx(e$,{className:"h-6 w-6 text-blue-600"}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"School Information"})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"School Name"}),c.jsx("input",{type:"text",value:h.schoolName,onChange:pe=>d(je=>({...je,schoolName:pe.target.value})),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",placeholder:"Enter your school name",dir:"ltr"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"School Logo"}),c.jsxs("div",{className:"flex items-center space-x-6 mb-4",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("img",{src:h.schoolLogo,alt:"School Logo",className:"w-20 h-20 rounded-xl object-cover border border-gray-200 shadow-sm"})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Upload a custom logo or choose from presets below"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"file",accept:"image/*",onChange:z,disabled:v==="uploading",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),c.jsxs("button",{disabled:v==="uploading",className:"inline-flex items-center space-x-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium rounded-lg transition-colors duration-200",children:[c.jsx(Vl,{className:"h-4 w-4"}),c.jsx("span",{children:v==="uploading"?"Uploading...":"Upload Logo"})]})]}),v==="success"&&c.jsxs("div",{className:"flex items-center space-x-2 text-green-600 mt-2",children:[c.jsx(Ea,{className:"h-4 w-4"}),c.jsx("span",{className:"text-sm",children:"Logo uploaded successfully!"})]}),v==="error"&&c.jsxs("div",{className:"flex items-center space-x-2 text-red-600 mt-2",children:[c.jsx(Zr,{className:"h-4 w-4"}),c.jsx("span",{className:"text-sm",children:"Upload failed. Please try again."})]})]})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Or choose a preset:"}),c.jsx("div",{className:"grid grid-cols-4 gap-3",children:Te.map((pe,je)=>c.jsxs("button",{onClick:()=>d(Ve=>({...Ve,schoolLogo:pe})),className:`relative group rounded-xl overflow-hidden border transition-all duration-200 ${h.schoolLogo===pe?"border-blue-500 shadow-md":"border-gray-200 hover:border-blue-300 hover:shadow-sm"}`,children:[c.jsx("img",{src:pe,alt:`Preset ${je+1}`,className:"w-full h-16 object-cover"}),h.schoolLogo===pe&&c.jsx("div",{className:"absolute inset-0 bg-blue-500 bg-opacity-20 flex items-center justify-center",children:c.jsx("div",{className:"bg-blue-500 rounded-full p-1",children:c.jsx(Ea,{className:"h-3 w-3 text-white"})})})]},je))})]})]})]})]}),c.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-6",children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[c.jsx(Q_,{className:"h-6 w-6 text-purple-600"}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Theme Customization"})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between p-4 bg-white rounded-lg border border-purple-200",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-900",children:"Custom Theme"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Enable to use custom colors instead of automatic class-based themes"})]}),c.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:h.customTheme,onChange:pe=>d(je=>({...je,customTheme:pe.target.checked})),className:"sr-only peer"}),c.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-600"})]})]}),h.customTheme&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Primary Color"}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("input",{type:"color",value:h.primaryColor,onChange:pe=>d(je=>({...je,primaryColor:pe.target.value})),className:"w-12 h-12 rounded-lg border border-gray-300 cursor-pointer"}),c.jsx("input",{type:"text",value:h.primaryColor,onChange:pe=>d(je=>({...je,primaryColor:pe.target.value})),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-sm",placeholder:"#3B82F6",dir:"ltr"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Secondary Color"}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("input",{type:"color",value:h.secondaryColor,onChange:pe=>d(je=>({...je,secondaryColor:pe.target.value})),className:"w-12 h-12 rounded-lg border border-gray-300 cursor-pointer"}),c.jsx("input",{type:"text",value:h.secondaryColor,onChange:pe=>d(je=>({...je,secondaryColor:pe.target.value})),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-sm",placeholder:"#2563EB",dir:"ltr"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Accent Color"}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("input",{type:"color",value:h.accentColor,onChange:pe=>d(je=>({...je,accentColor:pe.target.value})),className:"w-12 h-12 rounded-lg border border-gray-300 cursor-pointer"}),c.jsx("input",{type:"text",value:h.accentColor,onChange:pe=>d(je=>({...je,accentColor:pe.target.value})),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-sm",placeholder:"#60A5FA",dir:"ltr"})]})]})]}),c.jsxs("div",{className:"p-4 bg-white rounded-lg border border-gray-200",children:[c.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Preview:"}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsx("div",{className:"w-16 h-16 rounded-lg shadow-sm border border-gray-200",style:{backgroundColor:h.primaryColor},title:"Primary Color"}),c.jsx("div",{className:"w-16 h-16 rounded-lg shadow-sm border border-gray-200",style:{backgroundColor:h.secondaryColor},title:"Secondary Color"}),c.jsx("div",{className:"w-16 h-16 rounded-lg shadow-sm border border-gray-200",style:{backgroundColor:h.accentColor},title:"Accent Color"})]})]})]}),!h.customTheme&&c.jsxs("div",{className:"p-4 bg-white rounded-lg border border-gray-200",children:[c.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Automatic Year Group Themes:"}),c.jsx("div",{className:"space-y-3",children:x.map(pe=>c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-sm text-gray-600",children:pe.name}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsx("div",{className:"w-6 h-6 rounded",style:{backgroundColor:pe.color||"#6B7280"},title:"Primary"}),c.jsx("div",{className:"w-6 h-6 rounded",style:{backgroundColor:l$(pe.color||"#6B7280",-20)},title:"Secondary"})]})]},pe.id))})]})]})]}),c.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Reset Settings"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Reset all settings to their default values. This action cannot be undone."})]}),c.jsxs("button",{onClick:J,className:"inline-flex items-center space-x-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-medium rounded-lg transition-colors duration-200",children:[c.jsx(mx,{className:"h-4 w-4"}),c.jsx("span",{children:"Reset All"})]})]})})]}),w==="yeargroups"&&c.jsxs(c.Fragment,{children:[c.jsx(s$,{}),c.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(ym,{className:"h-6 w-6 text-blue-600"}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Year Group Management"})]}),c.jsxs("button",{onClick:be,className:"px-3 py-1.5 bg-blue-100 hover:bg-blue-200 text-blue-700 text-sm font-medium rounded-lg transition-colors duration-200 flex items-center space-x-1",children:[c.jsx(mx,{className:"h-3.5 w-3.5"}),c.jsx("span",{children:"Reset to Default"})]})]}),c.jsxs("div",{className:"bg-white rounded-lg border border-blue-200 p-4 mb-6",children:[c.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Add New Year Group"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"ID (used in system)"}),c.jsx("input",{type:"text",value:R,onChange:pe=>W(pe.target.value),placeholder:"e.g., Year1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",dir:"ltr"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Display Name"}),c.jsx("input",{type:"text",value:G,onChange:pe=>V(pe.target.value),placeholder:"e.g., Year 1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",dir:"ltr"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Color"}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsx("input",{type:"color",value:X,onChange:pe=>Q(pe.target.value),className:"h-9 w-9 rounded border border-gray-300 cursor-pointer"}),c.jsxs("button",{onClick:Fe,disabled:!R.trim()||!G.trim(),className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium rounded-lg transition-colors duration-200 flex items-center justify-center space-x-1",children:[c.jsx(ka,{className:"h-4 w-4"}),c.jsx("span",{children:"Add"})]})]})]})]}),c.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[c.jsx("strong",{children:"Note:"})," The ID is used internally and should be unique. Changing IDs of existing year groups may affect data."]})]}),c.jsxs("div",{className:"bg-white rounded-lg border border-blue-200 p-4",children:[c.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Manage Year Groups"}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Drag and drop to reorder year groups. Changes will affect how year groups are displayed throughout the application."}),c.jsx("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:x.map((pe,je)=>c.jsx("div",{draggable:!0,onDragStart:()=>Be(pe.id),onDragOver:Ve=>xe(Ve,pe.id),onDragEnd:se,className:`p-3 bg-white border rounded-lg transition-all duration-200 ${k===pe.id?"opacity-50 border-blue-400 bg-blue-50":"border-gray-200 hover:border-blue-300"}`,children:K===pe.id?c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"flex-shrink-0 cursor-move",children:c.jsx(bh,{className:"h-5 w-5 text-gray-400"})}),c.jsxs("div",{className:"flex-1 grid grid-cols-3 gap-2",children:[c.jsx("input",{type:"text",value:pe.id,onChange:Ve=>{const We=[...x];We[je].id=Ve.target.value,p(We)},className:"px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",dir:"ltr"}),c.jsx("input",{type:"text",value:pe.name,onChange:Ve=>{const We=[...x];We[je].name=Ve.target.value,p(We)},className:"px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",dir:"ltr"}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsx("input",{type:"color",value:pe.color,onChange:Ve=>{const We=[...x];We[je].color=Ve.target.value,p(We)},className:"h-9 w-9 rounded border border-gray-300 cursor-pointer"}),c.jsx("button",{onClick:()=>H(null),className:"p-1.5 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-lg transition-colors duration-200",children:c.jsx(ao,{className:"h-5 w-5"})})]})]})]}):c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"flex-shrink-0 cursor-move",children:c.jsx(bh,{className:"h-5 w-5 text-gray-400"})}),c.jsx("div",{className:"w-4 h-4 rounded-full flex-shrink-0",style:{backgroundColor:pe.color||"#6B7280"}}),c.jsxs("div",{className:"flex-1 grid grid-cols-2 gap-2",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-xs text-gray-500",children:"ID:"}),c.jsx("span",{className:"ml-1 font-medium text-gray-900",dir:"ltr",children:pe.id})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-xs text-gray-500",children:"Name:"}),c.jsx("span",{className:"ml-1 font-medium text-gray-900",dir:"ltr",children:pe.name})]})]}),c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx("button",{onClick:()=>H(pe.id),className:"p-1.5 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:c.jsx(ki,{className:"h-4 w-4"})}),c.jsx("button",{onClick:()=>he(je),className:"p-1.5 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors duration-200",children:c.jsx(_i,{className:"h-4 w-4"})})]})]})},pe.id))})]})]}),c.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx("div",{className:"text-yellow-600 flex-shrink-0 mt-0.5",children:"⚠️"}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Important Note About Year Group IDs"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Changing the ID of an existing year group may affect lessons, activities, and other data associated with that year group. It's recommended to only change the display name and color of existing year groups, not their IDs."})]})]})})]}),w==="categories"&&c.jsx(c.Fragment,{children:c.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-xl p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(Q_,{className:"h-6 w-6 text-indigo-600"}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Activity Categories"})]}),c.jsxs("button",{onClick:qe,className:"px-3 py-1.5 bg-indigo-100 hover:bg-indigo-200 text-indigo-700 text-sm font-medium rounded-lg transition-colors duration-200 flex items-center space-x-1",children:[c.jsx(mx,{className:"h-3.5 w-3.5"}),c.jsx("span",{children:"Reset to Default"})]})]}),c.jsxs("div",{className:"bg-white rounded-lg border border-indigo-200 p-4 mb-6",children:[c.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Add New Category"}),c.jsxs("div",{className:"flex flex-wrap gap-3",children:[c.jsx("div",{className:"flex-1 min-w-[200px]",children:c.jsx("input",{type:"text",value:F,onChange:pe=>T(pe.target.value),placeholder:"Category name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr"})}),c.jsx("div",{className:"w-24",children:c.jsx("input",{type:"color",value:I,onChange:pe=>S(pe.target.value),className:"w-full h-10 rounded-lg border border-gray-300 cursor-pointer"})}),c.jsxs("button",{onClick:Y,disabled:!F.trim(),className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-400 text-white font-medium rounded-lg transition-colors duration-200 flex items-center space-x-2",children:[c.jsx(ka,{className:"h-4 w-4"}),c.jsx("span",{children:"Add"})]})]})]}),c.jsxs("div",{className:"bg-white rounded-lg border border-indigo-200 p-4",children:[c.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Manage Categories"}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Drag and drop to reorder categories. Changes will affect how categories are displayed throughout the application."}),c.jsx("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:m.map((pe,je)=>c.jsx("div",{draggable:!0,onDragStart:()=>we(pe.name),onDragOver:Ve=>ne(Ve,pe.name),onDragEnd:Me,className:`p-3 bg-white border rounded-lg transition-all duration-200 ${C===pe.name?"opacity-50 border-indigo-400 bg-indigo-50":"border-gray-200 hover:border-indigo-300"}`,children:E===pe.name?c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"flex-shrink-0 cursor-move",children:c.jsx(bh,{className:"h-5 w-5 text-gray-400"})}),c.jsxs("div",{className:"flex-1 flex items-center space-x-2",children:[c.jsx("input",{type:"text",value:pe.name,onChange:Ve=>{const We=[...m];We[je].name=Ve.target.value,g(We)},className:"flex-1 px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm",dir:"ltr"}),c.jsx("input",{type:"color",value:pe.color,onChange:Ve=>{const We=[...m];We[je].color=Ve.target.value,g(We)},className:"w-10 h-10 rounded-lg border border-gray-300 cursor-pointer"}),c.jsx("button",{onClick:()=>_(null),className:"p-1.5 text-indigo-600 hover:text-indigo-800 hover:bg-indigo-50 rounded-lg transition-colors duration-200",children:c.jsx(ao,{className:"h-5 w-5"})})]})]}):c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"flex-shrink-0 cursor-move",children:c.jsx(bh,{className:"h-5 w-5 text-gray-400"})}),c.jsx("div",{className:"w-4 h-4 rounded-full flex-shrink-0",style:{backgroundColor:pe.color}}),c.jsx("div",{className:"flex-1 font-medium text-gray-900",dir:"ltr",children:pe.name}),c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx("button",{onClick:()=>_(pe.name),className:"p-1.5 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:c.jsx(ki,{className:"h-4 w-4"})}),c.jsx("button",{onClick:()=>le(je),className:"p-1.5 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors duration-200",children:c.jsx(_i,{className:"h-4 w-4"})})]})]})},pe.name))})]})]})}),w==="data"&&P&&c.jsx(a$,{embedded:!0})]}),c.jsxs("div",{className:"flex justify-between p-6 border-t border-gray-200 bg-gray-50",children:[c.jsx("button",{onClick:O,className:"px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg transition-colors duration-200",children:"Cancel"}),c.jsx("button",{onClick:D,className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200",children:"Save Settings"})]})]})}):null}const l$=(e,t)=>{let r=parseInt(e.substring(1,3),16),n=parseInt(e.substring(3,5),16),i=parseInt(e.substring(5,7),16);return r=Math.max(0,Math.min(255,r+t)),n=Math.max(0,Math.min(255,n+t)),i=Math.max(0,Math.min(255,i+t)),`#${r.toString(16).padStart(2,"0")}${n.toString(16).padStart(2,"0")}${i.toString(16).padStart(2,"0")}`};function A$({isOpen:e,onClose:t}){const[r,n]=ve.useState(0),[i,a]=ve.useState(null),[s,o]=ve.useState({top:0,left:0}),[l,A]=ve.useState("top"),u=[{title:"Welcome to Curriculum Designer",description:"This guide will walk you through the key features of the application. Let's get started!",target:"body",position:"top",icon:c.jsx(vy,{className:"h-8 w-8 text-blue-500"})},{title:"Activity Library",description:"Browse through all available activities. Use the search and filters to find specific activities by name, category, or level.",target:'[data-tab="activity-library"]',position:"bottom",icon:c.jsx(Pn,{className:"h-8 w-8 text-pink-500"})},{title:"Category Filters",description:"Filter activities by category to quickly find what you need. Each category is color-coded for easy identification.",target:".bg-white.bg-opacity-20.border.border-white.border-opacity-30.rounded-lg:first-of-type",position:"bottom",icon:c.jsx(WW,{className:"h-8 w-8 text-indigo-500"})},{title:"Search Activities",description:"Search for specific activities by name, description, or content. This helps you quickly find what you need.",target:".pl-10.pr-4.py-2.bg-white.bg-opacity-20",position:"bottom",icon:c.jsx(rA,{className:"h-8 w-8 text-blue-500"})},{title:"Lesson Builder",description:"Create and edit lesson plans by adding activities. Drag activities from the library into your lesson plan.",target:'[data-tab="lesson-builder"]',position:"bottom",icon:c.jsx(ki,{className:"h-8 w-8 text-green-500"})},{title:"Unit Builder",description:"Group lessons into units for better organization. Drag lessons to create comprehensive teaching units.",target:'[data-tab="unit-builder"]',position:"bottom",icon:c.jsx(mm,{className:"h-8 w-8 text-indigo-500"})},{title:"Calendar View",description:"Plan your lessons across the academic year. Add units or individual lessons to specific dates.",target:'[data-tab="calendar"]',position:"bottom",icon:c.jsx(ns,{className:"h-8 w-8 text-purple-500"})},{title:"Export Options",description:"Export your lesson plans as PDF or Excel documents to share with colleagues or for offline use.",target:".bg-gradient-to-br.from-green-500.to-teal-600",position:"bottom",icon:c.jsx(Gl,{className:"h-8 w-8 text-green-500"})},{title:"Create New Content",description:"Add new activities, lessons, or units using the create buttons throughout the application.",target:".bg-purple-600.hover\\:bg-purple-700",position:"left",icon:c.jsx(ka,{className:"h-8 w-8 text-purple-500"})},{title:"Save Your Work",description:"Remember to save your work regularly. Look for save buttons like this throughout the application.",target:".bg-green-600.hover\\:bg-green-700",position:"left",icon:c.jsx(ao,{className:"h-8 w-8 text-green-500"})},{title:"Help Button",description:"Click this button anytime to restart this walkthrough guide.",target:"[data-help-button]",position:"left",icon:c.jsx(vm,{className:"h-8 w-8 text-blue-500"})}];if(ve.useEffect(()=>{if(!e)return;const m=()=>{const g=u[r].target;if(g==="body"){const B=window.innerWidth,E=window.innerHeight;o({left:B/2-200,top:E/2-150}),A("none"),a(document.body);return}const x=document.querySelector(g);if(!x){console.warn(`Target element not found: ${g}`);return}a(x);const p=x.getBoundingClientRect(),v=u[r].position;let y=0,w=0;switch(v){case"top":y=p.top-220,w=p.left+p.width/2-200,A("bottom");break;case"bottom":y=p.bottom+20,w=p.left+p.width/2-200,A("top");break;case"left":y=p.top+p.height/2-110,w=p.left-420,A("right");break;case"right":y=p.top+p.height/2-110,w=p.right+20,A("left");break}y<10&&(y=10),w<10&&(w=10),w+400>window.innerWidth&&(w=window.innerWidth-410),o({top:y,left:w})};return m(),window.addEventListener("resize",m),()=>{window.removeEventListener("resize",m)}},[e,r,u]),!e)return null;const f=()=>{r<u.length-1?n(r+1):d()},h=()=>{r>0&&n(r-1)},d=()=>{t()};return c.jsx("div",{className:"fixed inset-0 z-50 pointer-events-none",children:c.jsxs("div",{className:"absolute bg-white rounded-xl shadow-xl w-[400px] p-6 pointer-events-auto transition-all duration-300 animate-bounce-in",style:{top:s.top,left:s.left},children:[c.jsxs("div",{className:"absolute top-3 right-3 bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-1 rounded-full",children:["Step ",r+1," of ",u.length]}),c.jsx("button",{onClick:d,className:"absolute top-3 left-3 text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-100",children:c.jsx(Zr,{className:"h-5 w-5"})}),c.jsxs("div",{className:"mt-6 mb-6 flex items-start space-x-4",children:[c.jsx("div",{className:"flex-shrink-0 bg-blue-100 p-3 rounded-full",children:u[r].icon}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-bold text-gray-900 text-xl mb-2",children:u[r].title}),c.jsx("p",{className:"text-gray-600",children:u[r].description})]})]}),c.jsxs("div",{className:"flex justify-between items-center mt-4 pt-4 border-t border-gray-200",children:[r>0?c.jsxs("button",{onClick:h,className:"px-4 py-2 text-sm font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors flex items-center space-x-1",children:[c.jsx(gm,{className:"h-5 w-5"}),c.jsx("span",{children:"Previous"})]}):c.jsx("div",{}),c.jsxs("button",{onClick:f,className:"px-4 py-2 text-sm font-medium bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors flex items-center space-x-1",children:[c.jsx("span",{children:r<u.length-1?"Next":"Finish"}),c.jsx(Zb,{className:"h-5 w-5"})]})]}),l!=="none"&&c.jsx("div",{className:`absolute w-6 h-6 bg-white transform rotate-45 ${l==="top"?"top-[-12px]":l==="bottom"?"bottom-[-12px]":l==="left"?"left-[-12px]":"right-[-12px]"}`,style:{left:l==="top"||l==="bottom"?"calc(50% - 12px)":void 0,top:l==="left"||l==="right"?"calc(50% - 12px)":void 0}})]})})}function ZN({isOpen:e,onClose:t,initialSection:r}){const[n,i]=ve.useState(r||"activity"),[a,s]=ve.useState(0),[o,l]=ve.useState(null);ve.useState({top:0,left:0}),ve.useState("top");const[A,u]=ve.useState(!1);ve.useEffect(()=>{if(e){u(!0);const w=setTimeout(()=>{u(!1)},600);return()=>clearTimeout(w)}},[e]);const f=[{title:"Creating a New Activity",content:c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{children:["Start by navigating to the ",c.jsx("strong",{children:"Activity Library"})," tab in the main navigation."]}),c.jsxs("p",{children:["Click the ",c.jsx("strong",{children:"Create Activity"})," button at the top of the page."]})]}),highlightSelector:'[data-tab="activity-library"]'},{title:"Fill in Activity Details",content:c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{children:["Enter a descriptive ",c.jsx("strong",{children:"Activity Name"}),"."]}),c.jsxs("p",{children:["Select the appropriate ",c.jsx("strong",{children:"Category"})," from the dropdown menu."]}),c.jsxs("p",{children:["Choose the ",c.jsx("strong",{children:"Level"})," (year group or All)."]}),c.jsxs("p",{children:["Set the ",c.jsx("strong",{children:"Duration"})," in minutes."]})]})},{title:"Add Activity Content",content:c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{children:["Use the rich text editor to add detailed ",c.jsx("strong",{children:"Activity"})," instructions."]}),c.jsx("p",{children:"Format text using the toolbar (bold, italic, lists, etc.)."}),c.jsxs("p",{children:["Add a more detailed ",c.jsx("strong",{children:"Description"})," if needed."]})]})},{title:"Add Resources",content:c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{children:"Add links to external resources:"}),c.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[c.jsx("li",{children:"Video links"}),c.jsx("li",{children:"Music files"}),c.jsx("li",{children:"Backing tracks"}),c.jsx("li",{children:"Teaching resources"}),c.jsx("li",{children:"Images"})]}),c.jsx("p",{children:"These will be available when viewing the activity."})]})},{title:"Save Your Activity",content:c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{children:"Review all information for accuracy."}),c.jsxs("p",{children:["Click the ",c.jsx("strong",{children:"Create Activity"})," button at the bottom of the form."]}),c.jsx("p",{children:"Your new activity will now appear in the Activity Library and can be used in lesson plans."})]})}],h=[{title:"Creating a New Lesson",content:c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{children:["Navigate to the ",c.jsx("strong",{children:"Lesson Builder"})," tab in the main navigation."]}),c.jsx("p",{children:"You'll see a blank lesson template ready to be filled."})]}),highlightSelector:'[data-tab="lesson-builder"]'},{title:"Set Lesson Details",content:c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{children:["Enter a descriptive ",c.jsx("strong",{children:"Lesson Title"})," at the top."]}),c.jsxs("p",{children:["Set the ",c.jsx("strong",{children:"Week Number"})," for curriculum planning."]}),c.jsxs("p",{children:["Select the appropriate ",c.jsx("strong",{children:"Term"})," (Autumn, Spring, Summer)."]})]})},{title:"Add Activities to Your Lesson",content:c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{children:["Browse the ",c.jsx("strong",{children:"Activity Library"})," panel on the right."]}),c.jsx("p",{children:"You can:"}),c.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[c.jsx("li",{children:"Drag activities directly into your lesson plan"}),c.jsx("li",{children:'Select multiple activities and click "Add Selected"'}),c.jsx("li",{children:"Filter activities by category or search for specific ones"})]})]})},{title:"Organize Your Lesson",content:c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{children:"Activities are automatically grouped by category."}),c.jsx("p",{children:"Drag activities to reorder them within your lesson."}),c.jsx("p",{children:"Remove activities by clicking the trash icon that appears on hover."}),c.jsx("p",{children:"The total lesson duration updates automatically based on activities."})]})},{title:"Add Lesson Notes",content:c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{children:["Use the ",c.jsx("strong",{children:"Lesson Notes"})," section at the bottom to add:"]}),c.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[c.jsx("li",{children:"Teaching tips"}),c.jsx("li",{children:"Required materials"}),c.jsx("li",{children:"Learning objectives"}),c.jsx("li",{children:"Assessment notes"})]}),c.jsx("p",{children:"You can use the rich text editor for formatting."})]})},{title:"Save Your Lesson",content:c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{children:["Click the ",c.jsx("strong",{children:"Save Plan"})," button to store your lesson."]}),c.jsxs("p",{children:["Or use ",c.jsx("strong",{children:"Save & New"})," to create another lesson immediately."]}),c.jsx("p",{children:"Your lesson is now ready to be used or added to a unit."})]})}],d=[{title:"Creating a New Unit",content:c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{children:["Navigate to the ",c.jsx("strong",{children:"Unit Builder"})," tab in the main navigation."]}),c.jsxs("p",{children:["Click the ",c.jsx("strong",{children:"Create New"})," button to start a fresh unit."]})]}),highlightSelector:'[data-tab="unit-builder"]'},{title:"Set Unit Details",content:c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{children:["Enter a descriptive ",c.jsx("strong",{children:"Unit Name"})," at the top."]}),c.jsxs("p",{children:["Select the appropriate ",c.jsx("strong",{children:"Term"})," (Autumn 1/2, Spring 1/2, Summer 1/2)."]}),c.jsxs("p",{children:["Add a detailed ",c.jsx("strong",{children:"Unit Description"})," in the text area below."]})]})},{title:"Select Lessons for Your Unit",content:c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{children:["Browse the ",c.jsx("strong",{children:"Available Lessons"})," panel in the middle."]}),c.jsx("p",{children:"You can:"}),c.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[c.jsx("li",{children:"Click individual lessons to select them"}),c.jsx("li",{children:"Use the search box to find specific lessons"}),c.jsx("li",{children:"Filter by term to narrow down options"}),c.jsx("li",{children:'Click "Select All" to choose all filtered lessons'})]}),c.jsxs("p",{children:["Click ",c.jsx("strong",{children:"Add Selected Lessons"})," to include them in your unit."]})]})},{title:"Organize Your Unit",content:c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{children:["In the ",c.jsx("strong",{children:"Unit Contents"})," panel, you can:"]}),c.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[c.jsx("li",{children:"Reorder lessons using the up/down arrows"}),c.jsx("li",{children:"Remove lessons by clicking the trash icon"}),c.jsx("li",{children:"See a summary of each lesson's content"})]}),c.jsx("p",{children:"The order of lessons determines how they'll be scheduled."})]})},{title:"Save Your Unit",content:c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{children:["Click the ",c.jsx("strong",{children:"Save Unit"})," button to store your unit."]}),c.jsxs("p",{children:["Your unit will appear in the ",c.jsx("strong",{children:"Your Units"})," panel on the right."]}),c.jsx("p",{children:"You can now assign this unit to specific dates in the calendar."})]})}],m=[{title:"Assigning Units to Half-Terms",content:c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{children:["Navigate to the ",c.jsx("strong",{children:"Calendar"})," tab in the main navigation."]}),c.jsx("p",{children:"This view shows your academic year divided into weeks."})]}),highlightSelector:'[data-tab="calendar"]'},{title:"Select a Unit to Assign",content:c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{children:["In the ",c.jsx("strong",{children:"Your Units"})," panel, find the unit you want to schedule."]}),c.jsxs("p",{children:["Click the ",c.jsx("strong",{children:"Calendar"})," icon next to the unit."]}),c.jsx("p",{children:'This will open the "Add Unit to Calendar" dialog.'})]})},{title:"Choose a Start Date",content:c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{children:["In the dialog, select a ",c.jsx("strong",{children:"Start Date"})," for your unit."]}),c.jsx("p",{children:"This is the date when the first lesson in the unit will be scheduled."}),c.jsx("p",{children:"Subsequent lessons will be scheduled on following days."})]})},{title:"Confirm Half-Term Assignment",content:c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{children:"The system will automatically identify which half-term your dates fall into:"}),c.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[c.jsxs("li",{children:[c.jsx("strong",{children:"A1"}),": Autumn 1 (Sep-Oct)"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"A2"}),": Autumn 2 (Nov-Dec)"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"SP1"}),": Spring 1 (Jan-Feb)"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"SP2"}),": Spring 2 (Mar-Apr)"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"SM1"}),": Summer 1 (Apr-May)"]}),c.jsxs("li",{children:[c.jsx("strong",{children:"SM2"}),": Summer 2 (Jun-Jul)"]})]})]})},{title:"Add to Calendar",content:c.jsxs("div",{className:"space-y-2",children:[c.jsxs("p",{children:["Click the ",c.jsx("strong",{children:"Add to Calendar"})," button to confirm."]}),c.jsx("p",{children:"The system will create lesson plans for each lesson in your unit, starting from the selected date."}),c.jsx("p",{children:"These will appear on your calendar view, color-coded by unit."})]})},{title:"Managing Scheduled Units",content:c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{children:"Once scheduled, you can:"}),c.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[c.jsx("li",{children:"Click on any date to view or edit scheduled lessons"}),c.jsx("li",{children:"Filter the calendar by unit using the dropdown at the top"}),c.jsx("li",{children:"Edit individual lesson details by clicking on them"}),c.jsx("li",{children:"Reschedule lessons by editing their date"})]})]})}],g=()=>{switch(n){case"activity":return f;case"lesson":return h;case"unit":return d;case"assign":return m;default:return f}},x=g();if(ve.useEffect(()=>{if(!e)return;const B=g()[a];if(o&&(o.classList.remove("highlight-pulse"),o.classList.remove("ring-4"),o.classList.remove("ring-blue-500"),o.classList.remove("ring-opacity-70"),o.classList.remove("z-40")),B.highlightSelector){const E=document.querySelector(B.highlightSelector);E&&(E.classList.add("highlight-pulse"),E.classList.add("ring-4"),E.classList.add("ring-blue-500"),E.classList.add("ring-opacity-70"),E.classList.add("z-40"),l(E),E.scrollIntoView({behavior:"smooth",block:"center"}))}return()=>{o&&(o.classList.remove("highlight-pulse"),o.classList.remove("ring-4"),o.classList.remove("ring-blue-500"),o.classList.remove("ring-opacity-70"),o.classList.remove("z-40"))}},[e,n,a]),!e)return null;const p=()=>{a<x.length-1?s(a+1):n==="activity"?(i("lesson"),s(0)):n==="lesson"?(i("unit"),s(0)):n==="unit"?(i("assign"),s(0)):t()},v=()=>{a>0?s(a-1):n==="lesson"?(i("activity"),s(f.length-1)):n==="unit"?(i("lesson"),s(h.length-1)):n==="assign"&&(i("unit"),s(d.length-1))},y=w=>{switch(w){case"activity":return c.jsx(Pn,{className:"h-5 w-5"});case"lesson":return c.jsx(ki,{className:"h-5 w-5"});case"unit":return c.jsx(mm,{className:"h-5 w-5"});case"assign":return c.jsx(ns,{className:"h-5 w-5"})}};return c.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:[c.jsx("style",{jsx:!0,children:`
        .modal-bounce {
          animation: modalBounce 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        @keyframes modalBounce {
          0% {
            transform: scale(0.3);
            opacity: 0;
          }
          50% {
            transform: scale(1.05);
          }
          70% {
            transform: scale(0.95);
          }
          100% {
            transform: scale(1);
            opacity: 1;
          }
        }
      `}),c.jsxs("div",{className:`bg-white rounded-2xl shadow-xl w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden ${A?"modal-bounce":""}`,children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 bg-gradient-to-r from-blue-600 to-indigo-600 text-white",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(vm,{className:"h-6 w-6"}),c.jsx("h2",{className:"text-xl font-bold",children:"Curriculum Designer Guide"})]}),c.jsx("button",{onClick:t,className:"p-2 text-blue-100 hover:text-white hover:bg-blue-700 rounded-lg transition-colors duration-200",children:c.jsx(Zr,{className:"h-6 w-6"})})]}),c.jsxs("div",{className:"flex border-b border-gray-200 bg-gray-50",children:[c.jsxs("button",{onClick:()=>{i("activity"),s(0)},className:`flex items-center space-x-2 px-4 py-3 font-medium text-sm transition-colors duration-200 ${n==="activity"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[c.jsx(Pn,{className:"h-4 w-4"}),c.jsx("span",{children:"1. Create Activity"})]}),c.jsxs("button",{onClick:()=>{i("lesson"),s(0)},className:`flex items-center space-x-2 px-4 py-3 font-medium text-sm transition-colors duration-200 ${n==="lesson"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[c.jsx(ki,{className:"h-4 w-4"}),c.jsx("span",{children:"2. Create Lesson"})]}),c.jsxs("button",{onClick:()=>{i("unit"),s(0)},className:`flex items-center space-x-2 px-4 py-3 font-medium text-sm transition-colors duration-200 ${n==="unit"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[c.jsx(mm,{className:"h-4 w-4"}),c.jsx("span",{children:"3. Create Unit"})]}),c.jsxs("button",{onClick:()=>{i("assign"),s(0)},className:`flex items-center space-x-2 px-4 py-3 font-medium text-sm transition-colors duration-200 ${n==="assign"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[c.jsx(ns,{className:"h-4 w-4"}),c.jsx("span",{children:"4. Assign to Half-Term"})]})]}),c.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:c.jsxs("div",{className:"max-w-3xl mx-auto",children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[c.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:y(n)}),c.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:[n==="activity"&&"Creating Activities",n==="lesson"&&"Building Lessons",n==="unit"&&"Managing Units",n==="assign"&&"Assigning to Half-Terms"]})]}),c.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 p-6 mb-6",children:[c.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:x[a].title}),c.jsx("div",{className:"prose max-w-none",children:x[a].content}),x[a].image&&c.jsx("div",{className:"mt-4 border border-gray-200 rounded-lg overflow-hidden",children:c.jsx("img",{src:x[a].image,alt:x[a].title,className:"w-full object-cover"})})]}),c.jsx("div",{className:"flex items-center justify-center space-x-2 mb-6",children:x.map((w,B)=>c.jsx("div",{className:`w-2.5 h-2.5 rounded-full transition-colors duration-200 ${B===a?"bg-blue-600":"bg-gray-300"}`},B))})]})}),c.jsxs("div",{className:"flex justify-between p-6 border-t border-gray-200 bg-gray-50",children:[c.jsxs("button",{onClick:v,className:`px-4 py-2 font-medium rounded-lg transition-colors duration-200 flex items-center space-x-2 ${a>0||n!=="activity"?"text-gray-600 hover:text-gray-900 hover:bg-gray-200":"text-gray-400 cursor-not-allowed"}`,disabled:a===0&&n==="activity",children:[c.jsx(gm,{className:"h-5 w-5"}),c.jsx("span",{children:"Previous"})]}),c.jsxs("div",{className:"text-sm text-gray-500",children:["Step ",a+1," of ",x.length]}),c.jsxs("button",{onClick:p,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200 flex items-center space-x-2",children:[c.jsx("span",{children:a<x.length-1||n!=="assign"?"Next":"Finish"}),c.jsx(Zb,{className:"h-5 w-5"})]})]})]})]})}function c$(){const{user:e,logout:t}=cf(),{currentSheetInfo:r,setCurrentSheetInfo:n,refreshData:i,loading:a}=oi(),{settings:s,getThemeForClass:o,customYearGroups:l}=Gi(),[A,u]=ve.useState(!1),[f,h]=ve.useState(!1),[d,m]=ve.useState(!1),[g,x]=ve.useState(!1),[p,v]=ve.useState(void 0),y=o(r.sheet);return c.jsxs(c.Fragment,{children:[c.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200 fixed top-0 left-0 right-0 z-50",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsxs("div",{className:"flex justify-between items-center h-16",children:[c.jsxs("div",{className:"flex items-center space-x-4 flex-shrink-0",children:[c.jsxs("div",{className:"flex-shrink-0",children:[c.jsx("img",{src:"/RLOGO copy copy.png",alt:"Curriculum Designer",className:"h-10 w-10 object-cover rounded-lg border border-blue-200 shadow-sm",onError:B=>{var _;const E=B.target;E.style.display="none",(_=E.nextElementSibling)==null||_.classList.remove("hidden")}}),c.jsx("div",{className:"h-10 w-10 p-2 rounded-lg shadow-md border border-blue-200 hidden bg-gradient-to-br from-blue-500 to-blue-600",children:c.jsx(Ls,{className:"h-6 w-6 text-white"})})]}),c.jsx("div",{className:"min-w-0",children:c.jsx("h1",{className:"text-xl font-bold text-black leading-tight",children:"Creative Curriculum Designer"})})]}),c.jsxs("div",{className:"hidden md:flex items-center space-x-3 flex-shrink-0",children:[c.jsx("div",{className:"relative min-w-0",children:c.jsx("select",{value:r.sheet,onChange:B=>{const E=l.find(_=>_.id===B.target.value);E&&n({sheet:E.id,display:E.name,eyfs:`${E.id} Statements`})},className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-2 focus:border-2 block w-full p-2.5 pr-8 appearance-none cursor-pointer transition-colors duration-200 hover:bg-gray-100 min-w-[180px]",style:{focusRingColor:y.primary,focusBorderColor:y.primary},children:l.map(B=>c.jsx("option",{value:B.id,children:B.name},B.id))})}),c.jsx("button",{onClick:()=>x(!0),className:"p-2.5 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors duration-200 flex-shrink-0",title:"Help Guide","data-help-button":!0,children:c.jsx(vm,{className:"h-5 w-5"})}),c.jsx("button",{onClick:()=>h(!0),className:"p-2.5 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors duration-200 flex-shrink-0",title:"User Settings",children:c.jsx(xm,{className:"h-5 w-5"})}),c.jsx("button",{onClick:w,disabled:a,className:"p-2.5 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors duration-200 disabled:opacity-50 flex-shrink-0",title:"Refresh Data",children:c.jsx(Tl,{className:`h-5 w-5 ${a?"animate-spin":""}`})}),c.jsxs("div",{className:"flex items-center space-x-3 flex-shrink-0 min-w-0",children:[c.jsxs("div",{className:"flex items-center space-x-2 min-w-0",children:[e!=null&&e.avatar?c.jsx("img",{src:e.avatar,alt:e.name,className:"h-8 w-8 rounded-full object-cover flex-shrink-0"}):c.jsx("div",{className:"h-8 w-8 bg-gray-300 rounded-full flex items-center justify-center flex-shrink-0",children:c.jsx(R_,{className:"h-5 w-5 text-gray-600"})}),c.jsx("span",{className:"text-sm font-medium text-gray-700 truncate max-w-[120px]",children:e==null?void 0:e.name})]}),c.jsx("button",{onClick:t,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors duration-200 flex-shrink-0",title:"Logout",children:c.jsx(P_,{className:"h-5 w-5"})})]})]}),c.jsx("button",{onClick:()=>u(!A),className:"md:hidden p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors duration-200 flex-shrink-0",children:A?c.jsx(Zr,{className:"h-6 w-6"}):c.jsx(JW,{className:"h-6 w-6"})})]}),A&&c.jsx("div",{className:"md:hidden py-4 border-t border-gray-200",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Year Group"}),c.jsx("select",{value:r.sheet,onChange:B=>{const E=l.find(_=>_.id===B.target.value);E&&n({sheet:E.id,display:E.name,eyfs:`${E.id} Statements`})},className:"w-full bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-2 focus:border-2 block p-2.5",style:{focusRingColor:y.primary,focusBorderColor:y.primary},children:l.map(B=>c.jsx("option",{value:B.id,children:B.name},B.id))})]}),c.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[c.jsxs("div",{className:"flex items-center space-x-3 min-w-0 flex-1",children:[e!=null&&e.avatar?c.jsx("img",{src:e.avatar,alt:e.name,className:"h-8 w-8 rounded-full object-cover flex-shrink-0"}):c.jsx("div",{className:"h-8 w-8 bg-gray-300 rounded-full flex items-center justify-center flex-shrink-0",children:c.jsx(R_,{className:"h-5 w-5 text-gray-600"})}),c.jsx("span",{className:"text-sm font-medium text-gray-700 truncate",children:e==null?void 0:e.name})]}),c.jsxs("div",{className:"flex space-x-2 flex-shrink-0",children:[c.jsx("button",{onClick:()=>x(!0),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:c.jsx(vm,{className:"h-5 w-5"})}),c.jsx("button",{onClick:()=>{h(!0),u(!1)},className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:c.jsx(xm,{className:"h-5 w-5"})}),c.jsx("button",{onClick:w,disabled:a,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors duration-200 disabled:opacity-50",children:c.jsx(Tl,{className:`h-5 w-5 ${a?"animate-spin":""}`})}),c.jsx("button",{onClick:t,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:c.jsx(P_,{className:"h-5 w-5"})})]})]})]})})]})}),c.jsx(o$,{isOpen:f,onClose:()=>h(!1)}),c.jsx(A$,{isOpen:d,onClose:()=>m(!1)}),c.jsx(ZN,{isOpen:g,onClose:()=>x(!1),initialSection:p})]});function w(){i()}}const eT=ve.createContext({dragDropManager:void 0});function _r(e){"@babel/helpers - typeof";return _r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_r(e)}function Ra(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var H_=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),vx=function(){return Math.random().toString(36).substring(7).split("").join(".")},K_={INIT:"@@redux/INIT"+vx(),REPLACE:"@@redux/REPLACE"+vx(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+vx()}};function u$(e){if(typeof e!="object"||e===null)return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function tT(e,t,r){var n;if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Ra(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Ra(1));return r(tT)(e,t)}if(typeof e!="function")throw new Error(Ra(2));var i=e,a=t,s=[],o=s,l=!1;function A(){o===s&&(o=s.slice())}function u(){if(l)throw new Error(Ra(3));return a}function f(g){if(typeof g!="function")throw new Error(Ra(4));if(l)throw new Error(Ra(5));var x=!0;return A(),o.push(g),function(){if(x){if(l)throw new Error(Ra(6));x=!1,A();var v=o.indexOf(g);o.splice(v,1),s=null}}}function h(g){if(!u$(g))throw new Error(Ra(7));if(typeof g.type>"u")throw new Error(Ra(8));if(l)throw new Error(Ra(9));try{l=!0,a=i(a,g)}finally{l=!1}for(var x=s=o,p=0;p<x.length;p++){var v=x[p];v()}return g}function d(g){if(typeof g!="function")throw new Error(Ra(10));i=g,h({type:K_.REPLACE})}function m(){var g,x=f;return g={subscribe:function(v){if(typeof v!="object"||v===null)throw new Error(Ra(11));function y(){v.next&&v.next(u())}y();var w=x(y);return{unsubscribe:w}}},g[H_]=function(){return this},g}return h({type:K_.INIT}),n={dispatch:h,subscribe:f,getState:u,replaceReducer:d},n[H_]=m,n}function $t(e,t,...r){if(f$()&&t===void 0)throw new Error("invariant requires an error message argument");if(!e){let n;if(t===void 0)n=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let i=0;n=new Error(t.replace(/%s/g,function(){return r[i++]})),n.name="Invariant Violation"}throw n.framesToPop=1,n}}function f$(){return typeof process<"u"&&!0}function h$(e,t,r){return t.split(".").reduce((n,i)=>n&&n[i]?n[i]:r||null,e)}function d$(e,t){return e.filter(r=>r!==t)}function rT(e){return typeof e=="object"}function p$(e,t){const r=new Map,n=a=>{r.set(a,r.has(a)?r.get(a)+1:1)};e.forEach(n),t.forEach(n);const i=[];return r.forEach((a,s)=>{a===1&&i.push(s)}),i}function g$(e,t){return e.filter(r=>t.indexOf(r)>-1)}const e5="dnd-core/INIT_COORDS",g1="dnd-core/BEGIN_DRAG",t5="dnd-core/PUBLISH_DRAG_SOURCE",m1="dnd-core/HOVER",v1="dnd-core/DROP",x1="dnd-core/END_DRAG";function G_(e,t){return{type:e5,payload:{sourceClientOffset:t||null,clientOffset:e||null}}}const m$={type:e5,payload:{clientOffset:null,sourceClientOffset:null}};function v$(e){return function(r=[],n={publishSource:!0}){const{publishSource:i=!0,clientOffset:a,getSourceClientOffset:s}=n,o=e.getMonitor(),l=e.getRegistry();e.dispatch(G_(a)),x$(r,o,l);const A=b$(r,o);if(A==null){e.dispatch(m$);return}let u=null;if(a){if(!s)throw new Error("getSourceClientOffset must be defined");y$(s),u=s(A)}e.dispatch(G_(a,u));const h=l.getSource(A).beginDrag(o,A);if(h==null)return;w$(h),l.pinSource(A);const d=l.getSourceType(A);return{type:g1,payload:{itemType:d,item:h,sourceId:A,clientOffset:a||null,sourceClientOffset:u||null,isSourcePublic:!!i}}}}function x$(e,t,r){$t(!t.isDragging(),"Cannot call beginDrag while dragging."),e.forEach(function(n){$t(r.getSource(n),"Expected sourceIds to be registered.")})}function y$(e){$t(typeof e=="function","When clientOffset is provided, getSourceClientOffset must be a function.")}function w$(e){$t(rT(e),"Item must be an object.")}function b$(e,t){let r=null;for(let n=e.length-1;n>=0;n--)if(t.canDragSource(e[n])){r=e[n];break}return r}function B$(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{},n=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable}))),n.forEach(function(i){B$(e,i,r[i])})}return e}function C$(e){return function(r={}){const n=e.getMonitor(),i=e.getRegistry();S$(n),F$(n).forEach((s,o)=>{const l=E$(s,o,i,n),A={type:v1,payload:{dropResult:_$({},r,l)}};e.dispatch(A)})}}function S$(e){$t(e.isDragging(),"Cannot call drop while not dragging."),$t(!e.didDrop(),"Cannot call drop twice during one drag operation.")}function E$(e,t,r,n){const i=r.getTarget(e);let a=i?i.drop(n,e):void 0;return k$(a),typeof a>"u"&&(a=t===0?{}:n.getDropResult()),a}function k$(e){$t(typeof e>"u"||rT(e),"Drop result must either be an object or undefined.")}function F$(e){const t=e.getTargetIds().filter(e.canDropOnTarget,e);return t.reverse(),t}function N$(e){return function(){const r=e.getMonitor(),n=e.getRegistry();T$(r);const i=r.getSourceId();return i!=null&&(n.getSource(i,!0).endDrag(r,i),n.unpinSource()),{type:x1}}}function T$(e){$t(e.isDragging(),"Cannot call endDrag while not dragging.")}function wy(e,t){return t===null?e===null:Array.isArray(e)?e.some(r=>r===t):e===t}function L$(e){return function(r,{clientOffset:n}={}){I$(r);const i=r.slice(0),a=e.getMonitor(),s=e.getRegistry(),o=a.getItemType();return O$(i,s,o),U$(i,a,s),j$(i,a,s),{type:m1,payload:{targetIds:i,clientOffset:n||null}}}}function I$(e){$t(Array.isArray(e),"Expected targetIds to be an array.")}function U$(e,t,r){$t(t.isDragging(),"Cannot call hover while not dragging."),$t(!t.didDrop(),"Cannot call hover after drop.");for(let n=0;n<e.length;n++){const i=e[n];$t(e.lastIndexOf(i)===n,"Expected targetIds to be unique in the passed array.");const a=r.getTarget(i);$t(a,"Expected targetIds to be registered.")}}function O$(e,t,r){for(let n=e.length-1;n>=0;n--){const i=e[n],a=t.getTargetType(i);wy(a,r)||e.splice(n,1)}}function j$(e,t,r){e.forEach(function(n){r.getTarget(n).hover(t,n)})}function D$(e){return function(){if(e.getMonitor().isDragging())return{type:t5}}}function P$(e){return{beginDrag:v$(e),publishDragSource:D$(e),hover:L$(e),drop:C$(e),endDrag:N$(e)}}class Q${receiveBackend(t){this.backend=t}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){const t=this,{dispatch:r}=this.store;function n(a){return(...s)=>{const o=a.apply(t,s);typeof o<"u"&&r(o)}}const i=P$(this);return Object.keys(i).reduce((a,s)=>{const o=i[s];return a[s]=n(o),a},{})}dispatch(t){this.store.dispatch(t)}constructor(t,r){this.isSetUp=!1,this.handleRefCountChange=()=>{const n=this.store.getState().refCount>0;this.backend&&(n&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!n&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=t,this.monitor=r,t.subscribe(this.handleRefCountChange)}}function R$(e,t){return{x:e.x+t.x,y:e.y+t.y}}function nT(e,t){return{x:e.x-t.x,y:e.y-t.y}}function M$(e){const{clientOffset:t,initialClientOffset:r,initialSourceClientOffset:n}=e;return!t||!r||!n?null:nT(R$(t,n),r)}function H$(e){const{clientOffset:t,initialClientOffset:r}=e;return!t||!r?null:nT(t,r)}const Zh=[],r5=[];Zh.__IS_NONE__=!0;r5.__IS_ALL__=!0;function K$(e,t){return e===Zh?!1:e===r5||typeof t>"u"?!0:g$(t,e).length>0}class G${subscribeToStateChange(t,r={}){const{handlerIds:n}=r;$t(typeof t=="function","listener must be a function."),$t(typeof n>"u"||Array.isArray(n),"handlerIds, when specified, must be an array of strings.");let i=this.store.getState().stateId;const a=()=>{const s=this.store.getState(),o=s.stateId;try{o===i||o===i+1&&!K$(s.dirtyHandlerIds,n)||t()}finally{i=o}};return this.store.subscribe(a)}subscribeToOffsetChange(t){$t(typeof t=="function","listener must be a function.");let r=this.store.getState().dragOffset;const n=()=>{const i=this.store.getState().dragOffset;i!==r&&(r=i,t())};return this.store.subscribe(n)}canDragSource(t){if(!t)return!1;const r=this.registry.getSource(t);return $t(r,`Expected to find a valid source. sourceId=${t}`),this.isDragging()?!1:r.canDrag(this,t)}canDropOnTarget(t){if(!t)return!1;const r=this.registry.getTarget(t);if($t(r,`Expected to find a valid target. targetId=${t}`),!this.isDragging()||this.didDrop())return!1;const n=this.registry.getTargetType(t),i=this.getItemType();return wy(n,i)&&r.canDrop(this,t)}isDragging(){return!!this.getItemType()}isDraggingSource(t){if(!t)return!1;const r=this.registry.getSource(t,!0);if($t(r,`Expected to find a valid source. sourceId=${t}`),!this.isDragging()||!this.isSourcePublic())return!1;const n=this.registry.getSourceType(t),i=this.getItemType();return n!==i?!1:r.isDragging(this,t)}isOverTarget(t,r={shallow:!1}){if(!t)return!1;const{shallow:n}=r;if(!this.isDragging())return!1;const i=this.registry.getTargetType(t),a=this.getItemType();if(a&&!wy(i,a))return!1;const s=this.getTargetIds();if(!s.length)return!1;const o=s.indexOf(t);return n?o===s.length-1:o>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return!!this.store.getState().dragOperation.isSourcePublic}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return M$(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return H$(this.store.getState().dragOffset)}constructor(t,r){this.store=t,this.registry=r}}const V_=typeof global<"u"?global:self,iT=V_.MutationObserver||V_.WebKitMutationObserver;function aT(e){return function(){const r=setTimeout(i,0),n=setInterval(i,50);function i(){clearTimeout(r),clearInterval(n),e()}}}function V$(e){let t=1;const r=new iT(e),n=document.createTextNode("");return r.observe(n,{characterData:!0}),function(){t=-t,n.data=t}}const W$=typeof iT=="function"?V$:aT;class $${enqueueTask(t){const{queue:r,requestFlush:n}=this;r.length||(n(),this.flushing=!0),r[r.length]=t}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:t}=this;for(;this.index<t.length;){const r=this.index;if(this.index++,t[r].call(),this.index>this.capacity){for(let n=0,i=t.length-this.index;n<i;n++)t[n]=t[n+this.index];t.length-=this.index,this.index=0}}t.length=0,this.index=0,this.flushing=!1},this.registerPendingError=t=>{this.pendingErrors.push(t),this.requestErrorThrow()},this.requestFlush=W$(this.flush),this.requestErrorThrow=aT(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}}class q${call(){try{this.task&&this.task()}catch(t){this.onError(t)}finally{this.task=null,this.release(this)}}constructor(t,r){this.onError=t,this.release=r,this.task=null}}class z${create(t){const r=this.freeTasks,n=r.length?r.pop():new q$(this.onError,i=>r[r.length]=i);return n.task=t,n}constructor(t){this.onError=t,this.freeTasks=[]}}const sT=new $$,X$=new z$(sT.registerPendingError);function Y$(e){sT.enqueueTask(X$.create(e))}const n5="dnd-core/ADD_SOURCE",i5="dnd-core/ADD_TARGET",a5="dnd-core/REMOVE_SOURCE",y1="dnd-core/REMOVE_TARGET";function J$(e){return{type:n5,payload:{sourceId:e}}}function Z$(e){return{type:i5,payload:{targetId:e}}}function eq(e){return{type:a5,payload:{sourceId:e}}}function tq(e){return{type:y1,payload:{targetId:e}}}function rq(e){$t(typeof e.canDrag=="function","Expected canDrag to be a function."),$t(typeof e.beginDrag=="function","Expected beginDrag to be a function."),$t(typeof e.endDrag=="function","Expected endDrag to be a function.")}function nq(e){$t(typeof e.canDrop=="function","Expected canDrop to be a function."),$t(typeof e.hover=="function","Expected hover to be a function."),$t(typeof e.drop=="function","Expected beginDrag to be a function.")}function by(e,t){if(t&&Array.isArray(e)){e.forEach(r=>by(r,!1));return}$t(typeof e=="string"||typeof e=="symbol",t?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}var za;(function(e){e.SOURCE="SOURCE",e.TARGET="TARGET"})(za||(za={}));let iq=0;function aq(){return iq++}function sq(e){const t=aq().toString();switch(e){case za.SOURCE:return`S${t}`;case za.TARGET:return`T${t}`;default:throw new Error(`Unknown Handler Role: ${e}`)}}function W_(e){switch(e[0]){case"S":return za.SOURCE;case"T":return za.TARGET;default:throw new Error(`Cannot parse handler ID: ${e}`)}}function $_(e,t){const r=e.entries();let n=!1;do{const{done:i,value:[,a]}=r.next();if(a===t)return!0;n=!!i}while(!n);return!1}class oq{addSource(t,r){by(t),rq(r);const n=this.addHandler(za.SOURCE,t,r);return this.store.dispatch(J$(n)),n}addTarget(t,r){by(t,!0),nq(r);const n=this.addHandler(za.TARGET,t,r);return this.store.dispatch(Z$(n)),n}containsHandler(t){return $_(this.dragSources,t)||$_(this.dropTargets,t)}getSource(t,r=!1){return $t(this.isSourceId(t),"Expected a valid source ID."),r&&t===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(t)}getTarget(t){return $t(this.isTargetId(t),"Expected a valid target ID."),this.dropTargets.get(t)}getSourceType(t){return $t(this.isSourceId(t),"Expected a valid source ID."),this.types.get(t)}getTargetType(t){return $t(this.isTargetId(t),"Expected a valid target ID."),this.types.get(t)}isSourceId(t){return W_(t)===za.SOURCE}isTargetId(t){return W_(t)===za.TARGET}removeSource(t){$t(this.getSource(t),"Expected an existing source."),this.store.dispatch(eq(t)),Y$(()=>{this.dragSources.delete(t),this.types.delete(t)})}removeTarget(t){$t(this.getTarget(t),"Expected an existing target."),this.store.dispatch(tq(t)),this.dropTargets.delete(t),this.types.delete(t)}pinSource(t){const r=this.getSource(t);$t(r,"Expected an existing source."),this.pinnedSourceId=t,this.pinnedSource=r}unpinSource(){$t(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(t,r,n){const i=sq(t);return this.types.set(i,r),t===za.SOURCE?this.dragSources.set(i,n):t===za.TARGET&&this.dropTargets.set(i,n),i}constructor(t){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=t}}const lq=(e,t)=>e===t;function Aq(e,t){return!e&&!t?!0:!e||!t?!1:e.x===t.x&&e.y===t.y}function cq(e,t,r=lq){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!r(e[n],t[n]))return!1;return!0}function uq(e=Zh,t){switch(t.type){case m1:break;case n5:case i5:case y1:case a5:return Zh;case g1:case t5:case x1:case v1:default:return r5}const{targetIds:r=[],prevTargetIds:n=[]}=t.payload,i=p$(r,n);if(!(i.length>0||!cq(r,n)))return Zh;const s=n[n.length-1],o=r[r.length-1];return s!==o&&(s&&i.push(s),o&&i.push(o)),i}function fq(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{},n=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable}))),n.forEach(function(i){fq(e,i,r[i])})}return e}const q_={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function dq(e=q_,t){const{payload:r}=t;switch(t.type){case e5:case g1:return{initialSourceClientOffset:r.sourceClientOffset,initialClientOffset:r.clientOffset,clientOffset:r.clientOffset};case m1:return Aq(e.clientOffset,r.clientOffset)?e:hq({},e,{clientOffset:r.clientOffset});case x1:case v1:return q_;default:return e}}function pq(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{},n=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable}))),n.forEach(function(i){pq(e,i,r[i])})}return e}const gq={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function mq(e=gq,t){const{payload:r}=t;switch(t.type){case g1:return Jc({},e,{itemType:r.itemType,item:r.item,sourceId:r.sourceId,isSourcePublic:r.isSourcePublic,dropResult:null,didDrop:!1});case t5:return Jc({},e,{isSourcePublic:!0});case m1:return Jc({},e,{targetIds:r.targetIds});case y1:return e.targetIds.indexOf(r.targetId)===-1?e:Jc({},e,{targetIds:d$(e.targetIds,r.targetId)});case v1:return Jc({},e,{dropResult:r.dropResult,didDrop:!0,targetIds:[]});case x1:return Jc({},e,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return e}}function vq(e=0,t){switch(t.type){case n5:case i5:return e+1;case a5:case y1:return e-1;default:return e}}function xq(e=0){return e+1}function yq(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{},n=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable}))),n.forEach(function(i){yq(e,i,r[i])})}return e}function bq(e={},t){return{dirtyHandlerIds:uq(e.dirtyHandlerIds,{type:t.type,payload:wq({},t.payload,{prevTargetIds:h$(e,"dragOperation.targetIds",[])})}),dragOffset:dq(e.dragOffset,t),refCount:vq(e.refCount,t),dragOperation:mq(e.dragOperation,t),stateId:xq(e.stateId)}}function Bq(e,t=void 0,r={},n=!1){const i=_q(n),a=new G$(i,new oq(i)),s=new Q$(i,a),o=e(s,t,r);return s.receiveBackend(o),s}function _q(e){const t=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__;return tT(bq,e&&t&&t({name:"dnd-core",instanceId:"dnd-core"}))}function Cq(e,t){if(e==null)return{};var r=Sq(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Sq(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}let z_=0;const Cg=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");var s5=ve.memo(function(t){var{children:r}=t,n=Cq(t,["children"]);const[i,a]=Eq(n);return ve.useEffect(()=>{if(a){const s=oT();return++z_,()=>{--z_===0&&(s[Cg]=null)}}},[]),c.jsx(eT.Provider,{value:i,children:r})});function Eq(e){if("manager"in e)return[{dragDropManager:e.manager},!1];const t=kq(e.backend,e.context,e.options,e.debugMode),r=!e.context;return[t,r]}function kq(e,t=oT(),r,n){const i=t;return i[Cg]||(i[Cg]={dragDropManager:Bq(e,t,r,n)}),i[Cg]}function oT(){return typeof global<"u"?global:window}var Fq=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var n,i,a;if(Array.isArray(t)){if(n=t.length,n!=r.length)return!1;for(i=n;i--!==0;)if(!e(t[i],r[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(a=Object.keys(t),n=a.length,n!==Object.keys(r).length)return!1;for(i=n;i--!==0;)if(!Object.prototype.hasOwnProperty.call(r,a[i]))return!1;for(i=n;i--!==0;){var s=a[i];if(!e(t[s],r[s]))return!1}return!0}return t!==t&&r!==r};const Nq=fw(Fq),Ac=typeof window<"u"?ve.useLayoutEffect:ve.useEffect;function Tq(e,t,r){const[n,i]=ve.useState(()=>t(e)),a=ve.useCallback(()=>{const s=t(e);Nq(n,s)||(i(s),r&&r())},[n,e,r]);return Ac(a),[n,a]}function Lq(e,t,r){const[n,i]=Tq(e,t,r);return Ac(function(){const s=e.getHandlerId();if(s!=null)return e.subscribeToStateChange(i,{handlerIds:[s]})},[e,i]),n}function lT(e,t,r){return Lq(t,e||(()=>({})),()=>r.reconnect())}function AT(e,t){const r=[...t||[]];return t==null&&typeof e!="function"&&r.push(e),ve.useMemo(()=>typeof e=="function"?e():e,r)}function Iq(e){return ve.useMemo(()=>e.hooks.dragSource(),[e])}function Uq(e){return ve.useMemo(()=>e.hooks.dragPreview(),[e])}let xx=!1,yx=!1;class Oq{receiveHandlerId(t){this.sourceId=t}getHandlerId(){return this.sourceId}canDrag(){$t(!xx,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return xx=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{xx=!1}}isDragging(){if(!this.sourceId)return!1;$t(!yx,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return yx=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{yx=!1}}subscribeToStateChange(t,r){return this.internalMonitor.subscribeToStateChange(t,r)}isDraggingSource(t){return this.internalMonitor.isDraggingSource(t)}isOverTarget(t,r){return this.internalMonitor.isOverTarget(t,r)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(t){return this.internalMonitor.subscribeToOffsetChange(t)}canDragSource(t){return this.internalMonitor.canDragSource(t)}canDropOnTarget(t){return this.internalMonitor.canDropOnTarget(t)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(t){this.sourceId=null,this.internalMonitor=t.getMonitor()}}let wx=!1;class jq{receiveHandlerId(t){this.targetId=t}getHandlerId(){return this.targetId}subscribeToStateChange(t,r){return this.internalMonitor.subscribeToStateChange(t,r)}canDrop(){if(!this.targetId)return!1;$t(!wx,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return wx=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{wx=!1}}isOver(t){return this.targetId?this.internalMonitor.isOverTarget(this.targetId,t):!1}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(t){this.targetId=null,this.internalMonitor=t.getMonitor()}}function Dq(e,t,r){const n=r.getRegistry(),i=n.addTarget(e,t);return[i,()=>n.removeTarget(i)]}function Pq(e,t,r){const n=r.getRegistry(),i=n.addSource(e,t);return[i,()=>n.removeSource(i)]}function By(e,t,r,n){let i;if(i!==void 0)return!!i;if(e===t)return!0;if(typeof e!="object"||!e||typeof t!="object"||!t)return!1;const a=Object.keys(e),s=Object.keys(t);if(a.length!==s.length)return!1;const o=Object.prototype.hasOwnProperty.bind(t);for(let l=0;l<a.length;l++){const A=a[l];if(!o(A))return!1;const u=e[A],f=t[A];if(i=void 0,i===!1||i===void 0&&u!==f)return!1}return!0}function _y(e){return e!==null&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Qq(e){if(typeof e.type=="string")return;const t=e.type.displayName||e.type.name||"the component";throw new Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${t} into a <div>, or turn it into a drag source or a drop target itself.`)}function Rq(e){return(t=null,r=null)=>{if(!ve.isValidElement(t)){const a=t;return e(a,r),a}const n=t;return Qq(n),Mq(n,r?a=>e(a,r):e)}}function cT(e){const t={};return Object.keys(e).forEach(r=>{const n=e[r];if(r.endsWith("Ref"))t[r]=e[r];else{const i=Rq(n);t[r]=()=>i}}),t}function X_(e,t){typeof e=="function"?e(t):e.current=t}function Mq(e,t){const r=e.ref;return $t(typeof r!="string","Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),r?ve.cloneElement(e,{ref:n=>{X_(r,n),X_(t,n)}}):ve.cloneElement(e,{ref:t})}class Hq{receiveHandlerId(t){this.handlerId!==t&&(this.handlerId=t,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(t){this.dragSourceOptionsInternal=t}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(t){this.dragPreviewOptionsInternal=t}reconnect(){const t=this.reconnectDragSource();this.reconnectDragPreview(t)}reconnectDragSource(){const t=this.dragSource,r=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return r&&this.disconnectDragSource(),this.handlerId?t?(r&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=t,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,t,this.dragSourceOptions)),r):(this.lastConnectedDragSource=t,r):r}reconnectDragPreview(t=!1){const r=this.dragPreview,n=t||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(n&&this.disconnectDragPreview(),!!this.handlerId){if(!r){this.lastConnectedDragPreview=r;return}n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=r,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,r,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!By(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!By(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(t){this.hooks=cT({dragSource:(r,n)=>{this.clearDragSource(),this.dragSourceOptions=n||null,_y(r)?this.dragSourceRef=r:this.dragSourceNode=r,this.reconnectDragSource()},dragPreview:(r,n)=>{this.clearDragPreview(),this.dragPreviewOptions=n||null,_y(r)?this.dragPreviewRef=r:this.dragPreviewNode=r,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=t}}class Kq{get connectTarget(){return this.dropTarget}reconnect(){const t=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();t&&this.disconnectDropTarget();const r=this.dropTarget;if(this.handlerId){if(!r){this.lastConnectedDropTarget=r;return}t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=r,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,r,this.dropTargetOptions))}}receiveHandlerId(t){t!==this.handlerId&&(this.handlerId=t,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(t){this.dropTargetOptionsInternal=t}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!By(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(t){this.hooks=cT({dropTarget:(r,n)=>{this.clearDropTarget(),this.dropTargetOptions=n,_y(r)?this.dropTargetRef=r:this.dropTargetNode=r,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=t}}function uf(){const{dragDropManager:e}=ve.useContext(eT);return $t(e!=null,"Expected drag drop context"),e}function Gq(e,t){const r=uf(),n=ve.useMemo(()=>new Hq(r.getBackend()),[r]);return Ac(()=>(n.dragSourceOptions=e||null,n.reconnect(),()=>n.disconnectDragSource()),[n,e]),Ac(()=>(n.dragPreviewOptions=t||null,n.reconnect(),()=>n.disconnectDragPreview()),[n,t]),n}function Vq(){const e=uf();return ve.useMemo(()=>new Oq(e),[e])}class Wq{beginDrag(){const t=this.spec,r=this.monitor;let n=null;return typeof t.item=="object"?n=t.item:typeof t.item=="function"?n=t.item(r):n={},n??null}canDrag(){const t=this.spec,r=this.monitor;return typeof t.canDrag=="boolean"?t.canDrag:typeof t.canDrag=="function"?t.canDrag(r):!0}isDragging(t,r){const n=this.spec,i=this.monitor,{isDragging:a}=n;return a?a(i):r===t.getSourceId()}endDrag(){const t=this.spec,r=this.monitor,n=this.connector,{end:i}=t;i&&i(r.getItem(),r),n.reconnect()}constructor(t,r,n){this.spec=t,this.monitor=r,this.connector=n}}function $q(e,t,r){const n=ve.useMemo(()=>new Wq(e,t,r),[t,r]);return ve.useEffect(()=>{n.spec=e},[e]),n}function qq(e){return ve.useMemo(()=>{const t=e.type;return $t(t!=null,"spec.type must be defined"),t},[e])}function zq(e,t,r){const n=uf(),i=$q(e,t,r),a=qq(e);Ac(function(){if(a!=null){const[o,l]=Pq(a,i,n);return t.receiveHandlerId(o),r.receiveHandlerId(o),l}},[n,t,r,i,a])}function uT(e,t){const r=AT(e,t);$t(!r.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const n=Vq(),i=Gq(r.options,r.previewOptions);return zq(r,n,i),[lT(r.collect,n,i),Iq(i),Uq(i)]}function Xq(e){return ve.useMemo(()=>e.hooks.dropTarget(),[e])}function Yq(e){const t=uf(),r=ve.useMemo(()=>new Kq(t.getBackend()),[t]);return Ac(()=>(r.dropTargetOptions=e||null,r.reconnect(),()=>r.disconnectDropTarget()),[e]),r}function Jq(){const e=uf();return ve.useMemo(()=>new jq(e),[e])}function Zq(e){const{accept:t}=e;return ve.useMemo(()=>($t(e.accept!=null,"accept must be defined"),Array.isArray(t)?t:[t]),[t])}class ez{canDrop(){const t=this.spec,r=this.monitor;return t.canDrop?t.canDrop(r.getItem(),r):!0}hover(){const t=this.spec,r=this.monitor;t.hover&&t.hover(r.getItem(),r)}drop(){const t=this.spec,r=this.monitor;if(t.drop)return t.drop(r.getItem(),r)}constructor(t,r){this.spec=t,this.monitor=r}}function tz(e,t){const r=ve.useMemo(()=>new ez(e,t),[t]);return ve.useEffect(()=>{r.spec=e},[e]),r}function rz(e,t,r){const n=uf(),i=tz(e,t),a=Zq(e);Ac(function(){const[o,l]=Dq(a,i,n);return t.receiveHandlerId(o),r.receiveHandlerId(o),l},[n,t,i,r,a.map(s=>s.toString()).join("|")])}function fT(e,t){const r=AT(e,t),n=Jq(),i=Yq(r.options);return rz(r,n,i),[lT(r.collect,n,i),Xq(i)]}function hT(e){let t=null;return()=>(t==null&&(t=e()),t)}function nz(e,t){return e.filter(r=>r!==t)}function iz(e,t){const r=new Set,n=a=>r.add(a);e.forEach(n),t.forEach(n);const i=[];return r.forEach(a=>i.push(a)),i}class az{enter(t){const r=this.entered.length,n=i=>this.isNodeInDocument(i)&&(!i.contains||i.contains(t));return this.entered=iz(this.entered.filter(n),[t]),r===0&&this.entered.length>0}leave(t){const r=this.entered.length;return this.entered=nz(this.entered.filter(this.isNodeInDocument),t),r>0&&this.entered.length===0}reset(){this.entered=[]}constructor(t){this.entered=[],this.isNodeInDocument=t}}class sz{initializeExposedProperties(){Object.keys(this.config.exposeProperties).forEach(t=>{Object.defineProperty(this.item,t,{configurable:!0,enumerable:!0,get(){return console.warn(`Browser doesn't allow reading "${t}" until the drop event.`),null}})})}loadDataTransfer(t){if(t){const r={};Object.keys(this.config.exposeProperties).forEach(n=>{const i=this.config.exposeProperties[n];i!=null&&(r[n]={value:i(t,this.config.matchesTypes),configurable:!0,enumerable:!0})}),Object.defineProperties(this.item,r)}}canDrag(){return!0}beginDrag(){return this.item}isDragging(t,r){return r===t.getSourceId()}endDrag(){}constructor(t){this.config=t,this.item={},this.initializeExposedProperties()}}const dT="__NATIVE_FILE__",pT="__NATIVE_URL__",gT="__NATIVE_TEXT__",mT="__NATIVE_HTML__",Y_=Object.freeze(Object.defineProperty({__proto__:null,FILE:dT,HTML:mT,TEXT:gT,URL:pT},Symbol.toStringTag,{value:"Module"}));function bx(e,t,r){const n=t.reduce((i,a)=>i||e.getData(a),"");return n??r}const Cy={[dT]:{exposeProperties:{files:e=>Array.prototype.slice.call(e.files),items:e=>e.items,dataTransfer:e=>e},matchesTypes:["Files"]},[mT]:{exposeProperties:{html:(e,t)=>bx(e,t,""),dataTransfer:e=>e},matchesTypes:["Html","text/html"]},[pT]:{exposeProperties:{urls:(e,t)=>bx(e,t,"").split(`
`),dataTransfer:e=>e},matchesTypes:["Url","text/uri-list"]},[gT]:{exposeProperties:{text:(e,t)=>bx(e,t,""),dataTransfer:e=>e},matchesTypes:["Text","text/plain"]}};function oz(e,t){const r=Cy[e];if(!r)throw new Error(`native type ${e} has no configuration`);const n=new sz(r);return n.loadDataTransfer(t),n}function Bx(e){if(!e)return null;const t=Array.prototype.slice.call(e.types||[]);return Object.keys(Cy).filter(r=>{const n=Cy[r];return n!=null&&n.matchesTypes?n.matchesTypes.some(i=>t.indexOf(i)>-1):!1})[0]||null}const lz=hT(()=>/firefox/i.test(navigator.userAgent)),vT=hT(()=>!!window.safari);class J_{interpolate(t){const{xs:r,ys:n,c1s:i,c2s:a,c3s:s}=this;let o=r.length-1;if(t===r[o])return n[o];let l=0,A=s.length-1,u;for(;l<=A;){u=Math.floor(.5*(l+A));const d=r[u];if(d<t)l=u+1;else if(d>t)A=u-1;else return n[u]}o=Math.max(0,A);const f=t-r[o],h=f*f;return n[o]+i[o]*f+a[o]*h+s[o]*f*h}constructor(t,r){const{length:n}=t,i=[];for(let d=0;d<n;d++)i.push(d);i.sort((d,m)=>t[d]<t[m]?-1:1);const a=[],s=[];let o,l;for(let d=0;d<n-1;d++)o=t[d+1]-t[d],l=r[d+1]-r[d],a.push(o),s.push(l/o);const A=[s[0]];for(let d=0;d<a.length-1;d++){const m=s[d],g=s[d+1];if(m*g<=0)A.push(0);else{o=a[d];const x=a[d+1],p=o+x;A.push(3*p/((p+x)/m+(p+o)/g))}}A.push(s[s.length-1]);const u=[],f=[];let h;for(let d=0;d<A.length-1;d++){h=s[d];const m=A[d],g=1/a[d],x=m+A[d+1]-h-h;u.push((h-m-x)*g),f.push(x*g*g)}this.xs=t,this.ys=r,this.c1s=A,this.c2s=u,this.c3s=f}}const Az=1;function xT(e){const t=e.nodeType===Az?e:e.parentElement;if(!t)return null;const{top:r,left:n}=t.getBoundingClientRect();return{x:n,y:r}}function jp(e){return{x:e.clientX,y:e.clientY}}function cz(e){var t;return e.nodeName==="IMG"&&(lz()||!(!((t=document.documentElement)===null||t===void 0)&&t.contains(e)))}function uz(e,t,r,n){let i=e?t.width:r,a=e?t.height:n;return vT()&&e&&(a/=window.devicePixelRatio,i/=window.devicePixelRatio),{dragPreviewWidth:i,dragPreviewHeight:a}}function fz(e,t,r,n,i){const a=cz(t),o=xT(a?e:t),l={x:r.x-o.x,y:r.y-o.y},{offsetWidth:A,offsetHeight:u}=e,{anchorX:f,anchorY:h}=n,{dragPreviewWidth:d,dragPreviewHeight:m}=uz(a,t,A,u),g=()=>{let E=new J_([0,.5,1],[l.y,l.y/u*m,l.y+m-u]).interpolate(h);return vT()&&a&&(E+=(window.devicePixelRatio-1)*m),E},x=()=>new J_([0,.5,1],[l.x,l.x/A*d,l.x+d-A]).interpolate(f),{offsetX:p,offsetY:v}=i,y=p===0||p,w=v===0||v;return{x:y?p:x(),y:w?v:g()}}class hz{get window(){if(this.globalContext)return this.globalContext;if(typeof window<"u")return window}get document(){var t;return!((t=this.globalContext)===null||t===void 0)&&t.document?this.globalContext.document:this.window?this.window.document:void 0}get rootElement(){var t;return((t=this.optionsArgs)===null||t===void 0?void 0:t.rootElement)||this.window}constructor(t,r){this.ownerDocument=null,this.globalContext=t,this.optionsArgs=r}}function dz(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{},n=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable}))),n.forEach(function(i){dz(e,i,r[i])})}return e}class pz{profile(){var t,r;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:((t=this.dragStartSourceIds)===null||t===void 0?void 0:t.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:((r=this.dragOverTargetIds)===null||r===void 0?void 0:r.length)||0}}get window(){return this.options.window}get document(){return this.options.document}get rootElement(){return this.options.rootElement}setup(){const t=this.rootElement;if(t!==void 0){if(t.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");t.__isReactDndBackendSetUp=!0,this.addEventListeners(t)}}teardown(){const t=this.rootElement;if(t!==void 0&&(t.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId)){var r;(r=this.window)===null||r===void 0||r.cancelAnimationFrame(this.asyncEndDragFrameId)}}connectDragPreview(t,r,n){return this.sourcePreviewNodeOptions.set(t,n),this.sourcePreviewNodes.set(t,r),()=>{this.sourcePreviewNodes.delete(t),this.sourcePreviewNodeOptions.delete(t)}}connectDragSource(t,r,n){this.sourceNodes.set(t,r),this.sourceNodeOptions.set(t,n);const i=s=>this.handleDragStart(s,t),a=s=>this.handleSelectStart(s);return r.setAttribute("draggable","true"),r.addEventListener("dragstart",i),r.addEventListener("selectstart",a),()=>{this.sourceNodes.delete(t),this.sourceNodeOptions.delete(t),r.removeEventListener("dragstart",i),r.removeEventListener("selectstart",a),r.setAttribute("draggable","false")}}connectDropTarget(t,r){const n=s=>this.handleDragEnter(s,t),i=s=>this.handleDragOver(s,t),a=s=>this.handleDrop(s,t);return r.addEventListener("dragenter",n),r.addEventListener("dragover",i),r.addEventListener("drop",a),()=>{r.removeEventListener("dragenter",n),r.removeEventListener("dragover",i),r.removeEventListener("drop",a)}}addEventListeners(t){t.addEventListener&&(t.addEventListener("dragstart",this.handleTopDragStart),t.addEventListener("dragstart",this.handleTopDragStartCapture,!0),t.addEventListener("dragend",this.handleTopDragEndCapture,!0),t.addEventListener("dragenter",this.handleTopDragEnter),t.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),t.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),t.addEventListener("dragover",this.handleTopDragOver),t.addEventListener("dragover",this.handleTopDragOverCapture,!0),t.addEventListener("drop",this.handleTopDrop),t.addEventListener("drop",this.handleTopDropCapture,!0))}removeEventListeners(t){t.removeEventListener&&(t.removeEventListener("dragstart",this.handleTopDragStart),t.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),t.removeEventListener("dragend",this.handleTopDragEndCapture,!0),t.removeEventListener("dragenter",this.handleTopDragEnter),t.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),t.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),t.removeEventListener("dragover",this.handleTopDragOver),t.removeEventListener("dragover",this.handleTopDragOverCapture,!0),t.removeEventListener("drop",this.handleTopDrop),t.removeEventListener("drop",this.handleTopDropCapture,!0))}getCurrentSourceNodeOptions(){const t=this.monitor.getSourceId(),r=this.sourceNodeOptions.get(t);return Z_({dropEffect:this.altKeyPressed?"copy":"move"},r||{})}getCurrentDropEffect(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}getCurrentSourcePreviewNodeOptions(){const t=this.monitor.getSourceId(),r=this.sourcePreviewNodeOptions.get(t);return Z_({anchorX:.5,anchorY:.5,captureDraggingState:!1},r||{})}isDraggingNativeItem(){const t=this.monitor.getItemType();return Object.keys(Y_).some(r=>Y_[r]===t)}beginDragNativeItem(t,r){this.clearCurrentDragSourceNode(),this.currentNativeSource=oz(t,r),this.currentNativeHandle=this.registry.addSource(t,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}setCurrentDragSourceNode(t){this.clearCurrentDragSourceNode(),this.currentDragSourceNode=t;const r=1e3;this.mouseMoveTimeoutTimer=setTimeout(()=>{var n;return(n=this.rootElement)===null||n===void 0?void 0:n.addEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)},r)}clearCurrentDragSourceNode(){if(this.currentDragSourceNode){if(this.currentDragSourceNode=null,this.rootElement){var t;(t=this.window)===null||t===void 0||t.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)}return this.mouseMoveTimeoutTimer=null,!0}return!1}handleDragStart(t,r){t.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(r))}handleDragEnter(t,r){this.dragEnterTargetIds.unshift(r)}handleDragOver(t,r){this.dragOverTargetIds===null&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(r)}handleDrop(t,r){this.dropTargetIds.unshift(r)}constructor(t,r,n){this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.lastClientOffset=null,this.hoverRafId=null,this.getSourceClientOffset=i=>{const a=this.sourceNodes.get(i);return a&&xT(a)||null},this.endDragNativeItem=()=>{this.isDraggingNativeItem()&&(this.actions.endDrag(),this.currentNativeHandle&&this.registry.removeSource(this.currentNativeHandle),this.currentNativeHandle=null,this.currentNativeSource=null)},this.isNodeInDocument=i=>!!(i&&this.document&&this.document.body&&this.document.body.contains(i)),this.endDragIfSourceWasRemovedFromDOM=()=>{const i=this.currentDragSourceNode;i==null||this.isNodeInDocument(i)||(this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover())},this.scheduleHover=i=>{this.hoverRafId===null&&typeof requestAnimationFrame<"u"&&(this.hoverRafId=requestAnimationFrame(()=>{this.monitor.isDragging()&&this.actions.hover(i||[],{clientOffset:this.lastClientOffset}),this.hoverRafId=null}))},this.cancelHover=()=>{this.hoverRafId!==null&&typeof cancelAnimationFrame<"u"&&(cancelAnimationFrame(this.hoverRafId),this.hoverRafId=null)},this.handleTopDragStartCapture=()=>{this.clearCurrentDragSourceNode(),this.dragStartSourceIds=[]},this.handleTopDragStart=i=>{if(i.defaultPrevented)return;const{dragStartSourceIds:a}=this;this.dragStartSourceIds=null;const s=jp(i);this.monitor.isDragging()&&(this.actions.endDrag(),this.cancelHover()),this.actions.beginDrag(a||[],{publishSource:!1,getSourceClientOffset:this.getSourceClientOffset,clientOffset:s});const{dataTransfer:o}=i,l=Bx(o);if(this.monitor.isDragging()){if(o&&typeof o.setDragImage=="function"){const u=this.monitor.getSourceId(),f=this.sourceNodes.get(u),h=this.sourcePreviewNodes.get(u)||f;if(h){const{anchorX:d,anchorY:m,offsetX:g,offsetY:x}=this.getCurrentSourcePreviewNodeOptions(),y=fz(f,h,s,{anchorX:d,anchorY:m},{offsetX:g,offsetY:x});o.setDragImage(h,y.x,y.y)}}try{o==null||o.setData("application/json",{})}catch{}this.setCurrentDragSourceNode(i.target);const{captureDraggingState:A}=this.getCurrentSourcePreviewNodeOptions();A?this.actions.publishDragSource():setTimeout(()=>this.actions.publishDragSource(),0)}else if(l)this.beginDragNativeItem(l);else{if(o&&!o.types&&(i.target&&!i.target.hasAttribute||!i.target.hasAttribute("draggable")))return;i.preventDefault()}},this.handleTopDragEndCapture=()=>{this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleTopDragEnterCapture=i=>{if(this.dragEnterTargetIds=[],this.isDraggingNativeItem()){var a;(a=this.currentNativeSource)===null||a===void 0||a.loadDataTransfer(i.dataTransfer)}if(!this.enterLeaveCounter.enter(i.target)||this.monitor.isDragging())return;const{dataTransfer:o}=i,l=Bx(o);l&&this.beginDragNativeItem(l,o)},this.handleTopDragEnter=i=>{const{dragEnterTargetIds:a}=this;if(this.dragEnterTargetIds=[],!this.monitor.isDragging())return;this.altKeyPressed=i.altKey,a.length>0&&this.actions.hover(a,{clientOffset:jp(i)}),a.some(o=>this.monitor.canDropOnTarget(o))&&(i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect=this.getCurrentDropEffect()))},this.handleTopDragOverCapture=i=>{if(this.dragOverTargetIds=[],this.isDraggingNativeItem()){var a;(a=this.currentNativeSource)===null||a===void 0||a.loadDataTransfer(i.dataTransfer)}},this.handleTopDragOver=i=>{const{dragOverTargetIds:a}=this;if(this.dragOverTargetIds=[],!this.monitor.isDragging()){i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect="none");return}this.altKeyPressed=i.altKey,this.lastClientOffset=jp(i),this.scheduleHover(a),(a||[]).some(o=>this.monitor.canDropOnTarget(o))?(i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect=this.getCurrentDropEffect())):this.isDraggingNativeItem()?i.preventDefault():(i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=i=>{this.isDraggingNativeItem()&&i.preventDefault(),this.enterLeaveCounter.leave(i.target)&&(this.isDraggingNativeItem()&&setTimeout(()=>this.endDragNativeItem(),0),this.cancelHover())},this.handleTopDropCapture=i=>{if(this.dropTargetIds=[],this.isDraggingNativeItem()){var a;i.preventDefault(),(a=this.currentNativeSource)===null||a===void 0||a.loadDataTransfer(i.dataTransfer)}else Bx(i.dataTransfer)&&i.preventDefault();this.enterLeaveCounter.reset()},this.handleTopDrop=i=>{const{dropTargetIds:a}=this;this.dropTargetIds=[],this.actions.hover(a,{clientOffset:jp(i)}),this.actions.drop({dropEffect:this.getCurrentDropEffect()}),this.isDraggingNativeItem()?this.endDragNativeItem():this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleSelectStart=i=>{const a=i.target;typeof a.dragDrop=="function"&&(a.tagName==="INPUT"||a.tagName==="SELECT"||a.tagName==="TEXTAREA"||a.isContentEditable||(i.preventDefault(),a.dragDrop()))},this.options=new hz(r,n),this.actions=t.getActions(),this.monitor=t.getMonitor(),this.registry=t.getRegistry(),this.enterLeaveCounter=new az(this.isNodeInDocument)}}const o5=function(t,r,n){return new pz(t,r,n)};function yT(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=yT(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function w1(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=yT(e))&&(n&&(n+=" "),n+=t);return n}const l5=ve.createContext(null);function gz({value:e,onValueChange:t,children:r,className:n}){return c.jsx(l5.Provider,{value:{value:e,onValueChange:t},children:c.jsx("div",{className:w1("w-full",n),children:r})})}function mz({children:e,className:t}){return c.jsx("div",{className:w1("flex space-x-2",t),children:e})}function Dp({value:e,children:t,className:r,style:n}){const i=ve.useContext(l5);if(!i)throw new Error("TabsTrigger must be used within Tabs");const a=i.value===e;return c.jsx("button",{type:"button",role:"tab","aria-selected":a,"data-state":a?"active":"inactive",onClick:()=>i.onValueChange(e),className:w1("flex-1 font-medium transition-all duration-200",a?"shadow-sm":"text-gray-600 hover:text-gray-900",r),style:n,children:t})}function Pp({value:e,children:t,className:r}){const n=ve.useContext(l5);if(!n)throw new Error("TabsContent must be used within Tabs");return n.value!==e?null:c.jsx("div",{role:"tabpanel","data-state":n.value===e?"active":"inactive",className:r,children:t})}function _x({isOpen:e,onClose:t,onAssign:r,lessonNumber:n,halfTerms:i,displayNumber:a}){const[s,o]=ve.useState("");if(ve.useEffect(()=>{e&&o("")},[e]),!e)return null;console.log("🎯 AssignToHalfTermModal rendered",{lessonNumber:n,halfTerms:i,selectedHalfTerm:s});const l=()=>{console.log("🚀 Assignment initiated:",{lessonNumber:n,selectedHalfTerm:s}),s?(console.log("✅ Calling onAssign with:",s),r(s),o(""),t(),console.log("🔒 Modal should now close")):console.warn("⚠️ No half-term selected for assignment")},A=()=>{console.log("❌ Modal closing - resetting selection"),o(""),t()},u=a?a.toString():n;return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[100]",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md overflow-hidden",children:[c.jsx("div",{className:"p-4 border-b border-gray-200 bg-gradient-to-r from-blue-600 to-indigo-600 text-white",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ns,{className:"h-5 w-5"}),c.jsx("h3",{className:"text-lg font-semibold",children:"Assign Lesson to Half-Term"})]}),c.jsx("button",{onClick:A,className:"p-2 text-white hover:bg-white hover:bg-opacity-20 rounded-lg transition-colors duration-200",children:c.jsx(Zr,{className:"h-5 w-5"})})]})}),c.jsxs("div",{className:"p-6",children:[c.jsxs("p",{className:"text-gray-700 mb-4",children:["Select a half-term to assign Lesson ",u,"."]}),c.jsx("div",{className:"space-y-2 mb-6",children:i.map(f=>c.jsxs("button",{onClick:()=>{console.log("🎯 Half-term selected:",f.id),o(f.id)},className:`w-full flex items-center justify-between p-3 rounded-lg border transition-colors duration-200 ${s===f.id?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-blue-300 hover:bg-blue-50"}`,children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:`w-3 h-3 rounded-full ${f.id.startsWith("A")?"bg-amber-500":f.id.startsWith("SP")?"bg-green-500":"bg-purple-500"}`}),c.jsxs("div",{className:"text-left",children:[c.jsx("p",{className:"font-medium",children:f.name}),c.jsx("p",{className:"text-xs text-gray-500",children:f.months})]})]}),s===f.id&&c.jsx(Ea,{className:"h-5 w-5 text-blue-600"})]},f.id))}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx("button",{onClick:A,className:"px-4 py-2 text-gray-600 hover:text-gray-800 font-medium rounded-lg transition-colors duration-200",children:"Cancel"}),c.jsxs("button",{onClick:l,disabled:!s,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium rounded-lg transition-colors duration-200 flex items-center space-x-2",children:[c.jsx(ns,{className:"h-4 w-4"}),c.jsx("span",{children:"Assign to Half-Term"})]})]})]})]})})}function wT({lessonNumber:e,displayNumber:t,lessonData:r,viewMode:n,onClick:i,onEdit:a,theme:s,onAssignToUnit:o,halfTerms:l=[]}){console.log("DEBUG - LessonLibraryCard received onEdit:",{lessonNumber:e,onEdit:typeof a,onEditExists:!!a});const{getCategoryColor:A}=Gi(),[u,f]=ve.useState(!1),h=es.useMemo(()=>{try{return!r||!r.grouped?0:Object.values(r.grouped).reduce((g,x)=>g+(Array.isArray(x)?x.length:0),0)}catch(g){return console.error("Error calculating total activities:",g),0}},[r]),d=g=>{g.stopPropagation(),g.preventDefault(),f(!0)},m=g=>{o&&(o(e,g),f(!1))};return n==="compact"?c.jsxs("div",{className:"relative group",children:[c.jsx("div",{className:"bg-white rounded-lg shadow-sm border-l-4 p-3 transition-all duration-200 hover:shadow-md cursor-pointer h-full",style:{borderLeftColor:s.primary},onClick:i,children:c.jsx("div",{className:"flex items-center justify-between h-full",children:c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("h4",{className:"font-medium text-gray-900 text-sm truncate",dir:"ltr",children:r.title||`Lesson ${t}`}),c.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[c.jsxs("span",{children:[r.totalTime," mins"]}),c.jsx("span",{children:"•"}),c.jsxs("span",{children:[h," activities"]})]})]})})}),(o&&l.length>0||a)&&c.jsx("div",{className:"absolute top-0 right-0 h-full flex items-center pr-2",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[o&&l.length>0&&c.jsxs("button",{onClick:d,className:"p-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg shadow-sm flex items-center space-x-1",title:"Assign to Unit",children:[c.jsx(ns,{className:"h-4 w-4"}),c.jsx("span",{className:"text-xs",children:"Assign"})]}),a&&c.jsxs("button",{onClick:g=>{g.stopPropagation(),a()},className:"p-2.5 bg-green-600 hover:bg-green-700 text-white rounded-lg shadow-sm flex items-center space-x-1",title:"Edit lesson activities",children:[c.jsx(ki,{className:"h-4 w-4"}),c.jsx("span",{className:"text-xs",children:"Edit"})]})]})}),u&&c.jsx(_x,{isOpen:u,onClose:()=>f(!1),onAssign:m,lessonNumber:t.toString(),halfTerms:l})]}):n==="list"?c.jsxs("div",{className:"relative group",children:[c.jsx("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 p-4 transition-all duration-200 hover:shadow-lg cursor-pointer hover:border-blue-300",onClick:i,children:c.jsxs("div",{className:"flex items-start",children:[c.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white font-bold flex-shrink-0 mr-4",style:{backgroundColor:s.primary},children:t}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("div",{className:"flex items-center justify-between",children:c.jsx("h4",{className:"font-semibold text-gray-900 text-base truncate",dir:"ltr",children:r.title||`Lesson ${t}`})}),c.jsxs("div",{className:"flex items-center space-x-3 mt-1 text-sm text-gray-600",children:[c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(_a,{className:"h-4 w-4 text-gray-500"}),c.jsxs("span",{children:[r.totalTime," mins"]})]}),c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(ym,{className:"h-4 w-4 text-gray-500"}),c.jsxs("span",{children:[h," activities"]})]})]}),c.jsx("p",{className:"mt-2 text-sm text-gray-600 line-clamp-1",dir:"ltr",children:r.description||""})]})]})}),(o&&l.length>0||a)&&c.jsxs("div",{className:"absolute top-2 right-2 flex items-center space-x-2",children:[o&&l.length>0&&c.jsxs("button",{onClick:d,className:"p-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg shadow-sm flex items-center space-x-1",title:"Assign to Unit",children:[c.jsx(ns,{className:"h-4 w-4"}),c.jsx("span",{className:"text-xs",children:"Assign"})]}),a&&c.jsxs("button",{onClick:g=>{g.stopPropagation(),a()},className:"p-2.5 bg-green-600 hover:bg-green-700 text-white rounded-lg shadow-sm flex items-center space-x-1",title:"Edit Lesson",children:[c.jsx(ki,{className:"h-4 w-4"}),c.jsx("span",{className:"text-xs",children:"Edit"})]})]}),u&&c.jsx(_x,{isOpen:u,onClose:()=>f(!1),onAssign:m,lessonNumber:t.toString(),halfTerms:l})]}):c.jsxs("div",{className:"relative group",children:[c.jsxs("div",{className:"bg-white rounded-xl shadow-lg border transition-all duration-300 hover:shadow-xl cursor-pointer overflow-hidden hover:scale-[1.02] h-full flex flex-col",style:{borderColor:s.primary,borderWidth:"1px"},onClick:i,children:[c.jsxs("div",{className:"p-4 text-white relative overflow-hidden",style:{background:`linear-gradient(135deg, ${s.primary} 0%, ${s.secondary} 100%)`},children:[c.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white bg-opacity-10 rounded-full -translate-y-10 translate-x-10"}),c.jsxs("div",{className:"relative z-10",children:[c.jsx("div",{className:"flex items-center justify-between mb-2",children:c.jsxs("h3",{className:"text-lg font-bold",children:["Lesson ",t]})}),c.jsx("p",{className:"text-white text-opacity-90 text-sm font-medium",dir:"ltr",children:r.title||`Lesson ${t}`})]})]}),c.jsxs("div",{className:"p-4 flex-grow flex flex-col",children:[c.jsxs("div",{className:"flex items-center space-x-4 text-gray-600 mb-3",children:[c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(_a,{className:"h-4 w-4"}),c.jsxs("span",{className:"text-sm",children:[r.totalTime," mins"]})]}),c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(ym,{className:"h-4 w-4"}),c.jsxs("span",{className:"text-sm",children:[h," activities"]})]})]}),c.jsx("div",{className:"mb-3",children:c.jsxs("div",{className:"flex flex-wrap gap-1",children:[r.categoryOrder.slice(0,4).map(g=>c.jsx("span",{className:"px-2 py-1 rounded-full text-sm font-medium border shadow-sm",style:{backgroundColor:`${A(g)}20`,color:A(g),borderColor:`${A(g)}40`},children:g},g)),r.categoryOrder.length>4&&c.jsxs("span",{className:"px-2 py-1 rounded-full text-sm font-medium bg-gray-100 text-gray-600 border border-gray-200 shadow-sm",children:["+",r.categoryOrder.length-4," more"]})]})}),c.jsx("p",{className:"mt-2 text-sm text-gray-600 line-clamp-1",dir:"ltr",children:r.description||""})]}),(o&&l.length>0||a)&&c.jsxs("div",{className:"absolute top-2 right-2 z-10 flex items-center space-x-2",children:[o&&l.length>0&&c.jsx("button",{onClick:d,className:"p-2 bg-white bg-opacity-80 hover:bg-opacity-100 rounded-lg shadow-sm text-blue-600 hover:text-blue-800 transition-colors",title:"Assign to Unit",children:c.jsx(ns,{className:"h-4 w-4"})}),a&&c.jsx("button",{onClick:g=>{g.stopPropagation(),a()},className:"p-2 bg-white bg-opacity-80 hover:bg-opacity-100 rounded-lg shadow-sm text-green-600 hover:text-green-800 transition-colors",title:"Edit Lesson",children:c.jsx(ki,{className:"h-4 w-4"})})]})]}),u&&c.jsx(_x,{isOpen:u,onClose:()=>f(!1),onAssign:m,lessonNumber:t.toString(),halfTerms:l})]})}function vz(){const[e,t]=ve.useState([]);return ve.useEffect(()=>{const i=localStorage.getItem("admin-editable-content");i&&t(JSON.parse(i))},[]),{getContent:(i,a="")=>{const s=e.find(o=>o.id===i);return s?s.content:a},getHtmlContent:(i,a="")=>{const s=e.find(o=>o.id===i);return s&&s.type==="html"?s.content:a},editableContents:e}}function Zc({id:e,fallback:t,className:r="",as:n="span",html:i=!1}){const{getContent:a,getHtmlContent:s}=vz(),o=i?s(e,t):a(e,t);return i?c.jsx(n,{className:r,dangerouslySetInnerHTML:{__html:o}}):c.jsx(n,{className:r,children:o})}function xz(){this.__data__=[],this.size=0}var yz=xz;function wz(e,t){return e===t||e!==e&&t!==t}var bT=wz,bz=bT;function Bz(e,t){for(var r=e.length;r--;)if(bz(e[r][0],t))return r;return-1}var b1=Bz,_z=b1,Cz=Array.prototype,Sz=Cz.splice;function Ez(e){var t=this.__data__,r=_z(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():Sz.call(t,r,1),--this.size,!0}var kz=Ez,Fz=b1;function Nz(e){var t=this.__data__,r=Fz(t,e);return r<0?void 0:t[r][1]}var Tz=Nz,Lz=b1;function Iz(e){return Lz(this.__data__,e)>-1}var Uz=Iz,Oz=b1;function jz(e,t){var r=this.__data__,n=Oz(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var Dz=jz,Pz=yz,Qz=kz,Rz=Tz,Mz=Uz,Hz=Dz;function ff(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ff.prototype.clear=Pz;ff.prototype.delete=Qz;ff.prototype.get=Rz;ff.prototype.has=Mz;ff.prototype.set=Hz;var B1=ff,Kz=B1;function Gz(){this.__data__=new Kz,this.size=0}var Vz=Gz;function Wz(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var $z=Wz;function qz(e){return this.__data__.get(e)}var zz=qz;function Xz(e){return this.__data__.has(e)}var Yz=Xz,Jz=typeof kr=="object"&&kr&&kr.Object===Object&&kr,BT=Jz,Zz=BT,eX=typeof self=="object"&&self&&self.Object===Object&&self,tX=Zz||eX||Function("return this")(),zo=tX,rX=zo,nX=rX.Symbol,A5=nX,eC=A5,_T=Object.prototype,iX=_T.hasOwnProperty,aX=_T.toString,ah=eC?eC.toStringTag:void 0;function sX(e){var t=iX.call(e,ah),r=e[ah];try{e[ah]=void 0;var n=!0}catch{}var i=aX.call(e);return n&&(t?e[ah]=r:delete e[ah]),i}var oX=sX,lX=Object.prototype,AX=lX.toString;function cX(e){return AX.call(e)}var uX=cX,tC=A5,fX=oX,hX=uX,dX="[object Null]",pX="[object Undefined]",rC=tC?tC.toStringTag:void 0;function gX(e){return e==null?e===void 0?pX:dX:rC&&rC in Object(e)?fX(e):hX(e)}var _1=gX;function mX(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var CT=mX,vX=_1,xX=CT,yX="[object AsyncFunction]",wX="[object Function]",bX="[object GeneratorFunction]",BX="[object Proxy]";function _X(e){if(!xX(e))return!1;var t=vX(e);return t==wX||t==bX||t==yX||t==BX}var ST=_X,CX=zo,SX=CX["__core-js_shared__"],EX=SX,Cx=EX,nC=function(){var e=/[^.]+$/.exec(Cx&&Cx.keys&&Cx.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function kX(e){return!!nC&&nC in e}var FX=kX,NX=Function.prototype,TX=NX.toString;function LX(e){if(e!=null){try{return TX.call(e)}catch{}try{return e+""}catch{}}return""}var ET=LX,IX=ST,UX=FX,OX=CT,jX=ET,DX=/[\\^$.*+?()[\]{}|]/g,PX=/^\[object .+?Constructor\]$/,QX=Function.prototype,RX=Object.prototype,MX=QX.toString,HX=RX.hasOwnProperty,KX=RegExp("^"+MX.call(HX).replace(DX,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function GX(e){if(!OX(e)||UX(e))return!1;var t=IX(e)?KX:PX;return t.test(jX(e))}var VX=GX;function WX(e,t){return e==null?void 0:e[t]}var $X=WX,qX=VX,zX=$X;function XX(e,t){var r=zX(e,t);return qX(r)?r:void 0}var hf=XX,YX=hf,JX=zo,ZX=YX(JX,"Map"),c5=ZX,eY=hf,tY=eY(Object,"create"),C1=tY,iC=C1;function rY(){this.__data__=iC?iC(null):{},this.size=0}var nY=rY;function iY(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var aY=iY,sY=C1,oY="__lodash_hash_undefined__",lY=Object.prototype,AY=lY.hasOwnProperty;function cY(e){var t=this.__data__;if(sY){var r=t[e];return r===oY?void 0:r}return AY.call(t,e)?t[e]:void 0}var uY=cY,fY=C1,hY=Object.prototype,dY=hY.hasOwnProperty;function pY(e){var t=this.__data__;return fY?t[e]!==void 0:dY.call(t,e)}var gY=pY,mY=C1,vY="__lodash_hash_undefined__";function xY(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=mY&&t===void 0?vY:t,this}var yY=xY,wY=nY,bY=aY,BY=uY,_Y=gY,CY=yY;function df(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}df.prototype.clear=wY;df.prototype.delete=bY;df.prototype.get=BY;df.prototype.has=_Y;df.prototype.set=CY;var SY=df,aC=SY,EY=B1,kY=c5;function FY(){this.size=0,this.__data__={hash:new aC,map:new(kY||EY),string:new aC}}var NY=FY;function TY(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var LY=TY,IY=LY;function UY(e,t){var r=e.__data__;return IY(t)?r[typeof t=="string"?"string":"hash"]:r.map}var S1=UY,OY=S1;function jY(e){var t=OY(this,e).delete(e);return this.size-=t?1:0,t}var DY=jY,PY=S1;function QY(e){return PY(this,e).get(e)}var RY=QY,MY=S1;function HY(e){return MY(this,e).has(e)}var KY=HY,GY=S1;function VY(e,t){var r=GY(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var WY=VY,$Y=NY,qY=DY,zY=RY,XY=KY,YY=WY;function pf(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}pf.prototype.clear=$Y;pf.prototype.delete=qY;pf.prototype.get=zY;pf.prototype.has=XY;pf.prototype.set=YY;var kT=pf,JY=B1,ZY=c5,eJ=kT,tJ=200;function rJ(e,t){var r=this.__data__;if(r instanceof JY){var n=r.__data__;if(!ZY||n.length<tJ-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new eJ(n)}return r.set(e,t),this.size=r.size,this}var nJ=rJ,iJ=B1,aJ=Vz,sJ=$z,oJ=zz,lJ=Yz,AJ=nJ;function gf(e){var t=this.__data__=new iJ(e);this.size=t.size}gf.prototype.clear=aJ;gf.prototype.delete=sJ;gf.prototype.get=oJ;gf.prototype.has=lJ;gf.prototype.set=AJ;var cJ=gf,uJ="__lodash_hash_undefined__";function fJ(e){return this.__data__.set(e,uJ),this}var hJ=fJ;function dJ(e){return this.__data__.has(e)}var pJ=dJ,gJ=kT,mJ=hJ,vJ=pJ;function wm(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new gJ;++t<r;)this.add(e[t])}wm.prototype.add=wm.prototype.push=mJ;wm.prototype.has=vJ;var xJ=wm;function yJ(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var wJ=yJ;function bJ(e,t){return e.has(t)}var BJ=bJ,_J=xJ,CJ=wJ,SJ=BJ,EJ=1,kJ=2;function FJ(e,t,r,n,i,a){var s=r&EJ,o=e.length,l=t.length;if(o!=l&&!(s&&l>o))return!1;var A=a.get(e),u=a.get(t);if(A&&u)return A==t&&u==e;var f=-1,h=!0,d=r&kJ?new _J:void 0;for(a.set(e,t),a.set(t,e);++f<o;){var m=e[f],g=t[f];if(n)var x=s?n(g,m,f,t,e,a):n(m,g,f,e,t,a);if(x!==void 0){if(x)continue;h=!1;break}if(d){if(!CJ(t,function(p,v){if(!SJ(d,v)&&(m===p||i(m,p,r,n,a)))return d.push(v)})){h=!1;break}}else if(!(m===g||i(m,g,r,n,a))){h=!1;break}}return a.delete(e),a.delete(t),h}var FT=FJ,NJ=zo,TJ=NJ.Uint8Array,LJ=TJ;function IJ(e){var t=-1,r=Array(e.size);return e.forEach(function(n,i){r[++t]=[i,n]}),r}var UJ=IJ;function OJ(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var jJ=OJ,sC=A5,oC=LJ,DJ=bT,PJ=FT,QJ=UJ,RJ=jJ,MJ=1,HJ=2,KJ="[object Boolean]",GJ="[object Date]",VJ="[object Error]",WJ="[object Map]",$J="[object Number]",qJ="[object RegExp]",zJ="[object Set]",XJ="[object String]",YJ="[object Symbol]",JJ="[object ArrayBuffer]",ZJ="[object DataView]",lC=sC?sC.prototype:void 0,Sx=lC?lC.valueOf:void 0;function eZ(e,t,r,n,i,a,s){switch(r){case ZJ:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case JJ:return!(e.byteLength!=t.byteLength||!a(new oC(e),new oC(t)));case KJ:case GJ:case $J:return DJ(+e,+t);case VJ:return e.name==t.name&&e.message==t.message;case qJ:case XJ:return e==t+"";case WJ:var o=QJ;case zJ:var l=n&MJ;if(o||(o=RJ),e.size!=t.size&&!l)return!1;var A=s.get(e);if(A)return A==t;n|=HJ,s.set(e,t);var u=PJ(o(e),o(t),n,i,a,s);return s.delete(e),u;case YJ:if(Sx)return Sx.call(e)==Sx.call(t)}return!1}var tZ=eZ;function rZ(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}var nZ=rZ,iZ=Array.isArray,u5=iZ,aZ=nZ,sZ=u5;function oZ(e,t,r){var n=t(e);return sZ(e)?n:aZ(n,r(e))}var lZ=oZ;function AZ(e,t){for(var r=-1,n=e==null?0:e.length,i=0,a=[];++r<n;){var s=e[r];t(s,r,e)&&(a[i++]=s)}return a}var cZ=AZ;function uZ(){return[]}var fZ=uZ,hZ=cZ,dZ=fZ,pZ=Object.prototype,gZ=pZ.propertyIsEnumerable,AC=Object.getOwnPropertySymbols,mZ=AC?function(e){return e==null?[]:(e=Object(e),hZ(AC(e),function(t){return gZ.call(e,t)}))}:dZ,vZ=mZ;function xZ(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var yZ=xZ;function wZ(e){return e!=null&&typeof e=="object"}var E1=wZ,bZ=_1,BZ=E1,_Z="[object Arguments]";function CZ(e){return BZ(e)&&bZ(e)==_Z}var SZ=CZ,cC=SZ,EZ=E1,NT=Object.prototype,kZ=NT.hasOwnProperty,FZ=NT.propertyIsEnumerable,NZ=cC(function(){return arguments}())?cC:function(e){return EZ(e)&&kZ.call(e,"callee")&&!FZ.call(e,"callee")},TZ=NZ,bm={exports:{}};function LZ(){return!1}var IZ=LZ;bm.exports;(function(e,t){var r=zo,n=IZ,i=t&&!t.nodeType&&t,a=i&&!0&&e&&!e.nodeType&&e,s=a&&a.exports===i,o=s?r.Buffer:void 0,l=o?o.isBuffer:void 0,A=l||n;e.exports=A})(bm,bm.exports);var TT=bm.exports,UZ=9007199254740991,OZ=/^(?:0|[1-9]\d*)$/;function jZ(e,t){var r=typeof e;return t=t??UZ,!!t&&(r=="number"||r!="symbol"&&OZ.test(e))&&e>-1&&e%1==0&&e<t}var DZ=jZ,PZ=9007199254740991;function QZ(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=PZ}var LT=QZ,RZ=_1,MZ=LT,HZ=E1,KZ="[object Arguments]",GZ="[object Array]",VZ="[object Boolean]",WZ="[object Date]",$Z="[object Error]",qZ="[object Function]",zZ="[object Map]",XZ="[object Number]",YZ="[object Object]",JZ="[object RegExp]",ZZ="[object Set]",eee="[object String]",tee="[object WeakMap]",ree="[object ArrayBuffer]",nee="[object DataView]",iee="[object Float32Array]",aee="[object Float64Array]",see="[object Int8Array]",oee="[object Int16Array]",lee="[object Int32Array]",Aee="[object Uint8Array]",cee="[object Uint8ClampedArray]",uee="[object Uint16Array]",fee="[object Uint32Array]",Qr={};Qr[iee]=Qr[aee]=Qr[see]=Qr[oee]=Qr[lee]=Qr[Aee]=Qr[cee]=Qr[uee]=Qr[fee]=!0;Qr[KZ]=Qr[GZ]=Qr[ree]=Qr[VZ]=Qr[nee]=Qr[WZ]=Qr[$Z]=Qr[qZ]=Qr[zZ]=Qr[XZ]=Qr[YZ]=Qr[JZ]=Qr[ZZ]=Qr[eee]=Qr[tee]=!1;function hee(e){return HZ(e)&&MZ(e.length)&&!!Qr[RZ(e)]}var dee=hee;function pee(e){return function(t){return e(t)}}var gee=pee,Bm={exports:{}};Bm.exports;(function(e,t){var r=BT,n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,a=i&&i.exports===n,s=a&&r.process,o=function(){try{var l=i&&i.require&&i.require("util").types;return l||s&&s.binding&&s.binding("util")}catch{}}();e.exports=o})(Bm,Bm.exports);var mee=Bm.exports,vee=dee,xee=gee,uC=mee,fC=uC&&uC.isTypedArray,yee=fC?xee(fC):vee,IT=yee,wee=yZ,bee=TZ,Bee=u5,_ee=TT,Cee=DZ,See=IT,Eee=Object.prototype,kee=Eee.hasOwnProperty;function Fee(e,t){var r=Bee(e),n=!r&&bee(e),i=!r&&!n&&_ee(e),a=!r&&!n&&!i&&See(e),s=r||n||i||a,o=s?wee(e.length,String):[],l=o.length;for(var A in e)(t||kee.call(e,A))&&!(s&&(A=="length"||i&&(A=="offset"||A=="parent")||a&&(A=="buffer"||A=="byteLength"||A=="byteOffset")||Cee(A,l)))&&o.push(A);return o}var Nee=Fee,Tee=Object.prototype;function Lee(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||Tee;return e===r}var Iee=Lee;function Uee(e,t){return function(r){return e(t(r))}}var Oee=Uee,jee=Oee,Dee=jee(Object.keys,Object),Pee=Dee,Qee=Iee,Ree=Pee,Mee=Object.prototype,Hee=Mee.hasOwnProperty;function Kee(e){if(!Qee(e))return Ree(e);var t=[];for(var r in Object(e))Hee.call(e,r)&&r!="constructor"&&t.push(r);return t}var Gee=Kee,Vee=ST,Wee=LT;function $ee(e){return e!=null&&Wee(e.length)&&!Vee(e)}var qee=$ee,zee=Nee,Xee=Gee,Yee=qee;function Jee(e){return Yee(e)?zee(e):Xee(e)}var Zee=Jee,ete=lZ,tte=vZ,rte=Zee;function nte(e){return ete(e,rte,tte)}var ite=nte,hC=ite,ate=1,ste=Object.prototype,ote=ste.hasOwnProperty;function lte(e,t,r,n,i,a){var s=r&ate,o=hC(e),l=o.length,A=hC(t),u=A.length;if(l!=u&&!s)return!1;for(var f=l;f--;){var h=o[f];if(!(s?h in t:ote.call(t,h)))return!1}var d=a.get(e),m=a.get(t);if(d&&m)return d==t&&m==e;var g=!0;a.set(e,t),a.set(t,e);for(var x=s;++f<l;){h=o[f];var p=e[h],v=t[h];if(n)var y=s?n(v,p,h,t,e,a):n(p,v,h,e,t,a);if(!(y===void 0?p===v||i(p,v,r,n,a):y)){g=!1;break}x||(x=h=="constructor")}if(g&&!x){var w=e.constructor,B=t.constructor;w!=B&&"constructor"in e&&"constructor"in t&&!(typeof w=="function"&&w instanceof w&&typeof B=="function"&&B instanceof B)&&(g=!1)}return a.delete(e),a.delete(t),g}var Ate=lte,cte=hf,ute=zo,fte=cte(ute,"DataView"),hte=fte,dte=hf,pte=zo,gte=dte(pte,"Promise"),mte=gte,vte=hf,xte=zo,yte=vte(xte,"Set"),wte=yte,bte=hf,Bte=zo,_te=bte(Bte,"WeakMap"),Cte=_te,Sy=hte,Ey=c5,ky=mte,Fy=wte,Ny=Cte,UT=_1,mf=ET,dC="[object Map]",Ste="[object Object]",pC="[object Promise]",gC="[object Set]",mC="[object WeakMap]",vC="[object DataView]",Ete=mf(Sy),kte=mf(Ey),Fte=mf(ky),Nte=mf(Fy),Tte=mf(Ny),kA=UT;(Sy&&kA(new Sy(new ArrayBuffer(1)))!=vC||Ey&&kA(new Ey)!=dC||ky&&kA(ky.resolve())!=pC||Fy&&kA(new Fy)!=gC||Ny&&kA(new Ny)!=mC)&&(kA=function(e){var t=UT(e),r=t==Ste?e.constructor:void 0,n=r?mf(r):"";if(n)switch(n){case Ete:return vC;case kte:return dC;case Fte:return pC;case Nte:return gC;case Tte:return mC}return t});var Lte=kA,Ex=cJ,Ite=FT,Ute=tZ,Ote=Ate,xC=Lte,yC=u5,wC=TT,jte=IT,Dte=1,bC="[object Arguments]",BC="[object Array]",Qp="[object Object]",Pte=Object.prototype,_C=Pte.hasOwnProperty;function Qte(e,t,r,n,i,a){var s=yC(e),o=yC(t),l=s?BC:xC(e),A=o?BC:xC(t);l=l==bC?Qp:l,A=A==bC?Qp:A;var u=l==Qp,f=A==Qp,h=l==A;if(h&&wC(e)){if(!wC(t))return!1;s=!0,u=!1}if(h&&!u)return a||(a=new Ex),s||jte(e)?Ite(e,t,r,n,i,a):Ute(e,t,l,r,n,i,a);if(!(r&Dte)){var d=u&&_C.call(e,"__wrapped__"),m=f&&_C.call(t,"__wrapped__");if(d||m){var g=d?e.value():e,x=m?t.value():t;return a||(a=new Ex),i(g,x,r,n,a)}}return h?(a||(a=new Ex),Ote(e,t,r,n,i,a)):!1}var Rte=Qte,Mte=Rte,CC=E1;function OT(e,t,r,n,i){return e===t?!0:e==null||t==null||!CC(e)&&!CC(t)?e!==e&&t!==t:Mte(e,t,r,n,OT,i)}var Hte=OT,Kte=Hte;function Gte(e,t){return Kte(e,t)}var Vte=Gte,jT={exports:{}};/*!
 * Quill Editor v1.3.7
 * https://quilljs.com/
 * Copyright (c) 2014, Jason Chen
 * Copyright (c) 2013, salesforce.com
 */(function(e,t){(function(n,i){e.exports=i()})(typeof self<"u"?self:kr,function(){return function(r){var n={};function i(a){if(n[a])return n[a].exports;var s=n[a]={i:a,l:!1,exports:{}};return r[a].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=r,i.c=n,i.d=function(a,s,o){i.o(a,s)||Object.defineProperty(a,s,{configurable:!1,enumerable:!0,get:o})},i.n=function(a){var s=a&&a.__esModule?function(){return a.default}:function(){return a};return i.d(s,"a",s),s},i.o=function(a,s){return Object.prototype.hasOwnProperty.call(a,s)},i.p="",i(i.s=109)}([function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(17),s=i(18),o=i(19),l=i(45),A=i(46),u=i(47),f=i(48),h=i(49),d=i(12),m=i(32),g=i(33),x=i(31),p=i(1),v={Scope:p.Scope,create:p.create,find:p.find,query:p.query,register:p.register,Container:a.default,Format:s.default,Leaf:o.default,Embed:f.default,Scroll:l.default,Block:u.default,Inline:A.default,Text:h.default,Attributor:{Attribute:d.default,Class:m.default,Style:g.default,Store:x.default}};n.default=v},function(r,n,i){var a=this&&this.__extends||function(){var x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,v){p.__proto__=v}||function(p,v){for(var y in v)v.hasOwnProperty(y)&&(p[y]=v[y])};return function(p,v){x(p,v);function y(){this.constructor=p}p.prototype=v===null?Object.create(v):(y.prototype=v.prototype,new y)}}();Object.defineProperty(n,"__esModule",{value:!0});var s=function(x){a(p,x);function p(v){var y=this;return v="[Parchment] "+v,y=x.call(this,v)||this,y.message=v,y.name=y.constructor.name,y}return p}(Error);n.ParchmentError=s;var o={},l={},A={},u={};n.DATA_KEY="__blot";var f;(function(x){x[x.TYPE=3]="TYPE",x[x.LEVEL=12]="LEVEL",x[x.ATTRIBUTE=13]="ATTRIBUTE",x[x.BLOT=14]="BLOT",x[x.INLINE=7]="INLINE",x[x.BLOCK=11]="BLOCK",x[x.BLOCK_BLOT=10]="BLOCK_BLOT",x[x.INLINE_BLOT=6]="INLINE_BLOT",x[x.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",x[x.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",x[x.ANY=15]="ANY"})(f=n.Scope||(n.Scope={}));function h(x,p){var v=m(x);if(v==null)throw new s("Unable to create "+x+" blot");var y=v,w=x instanceof Node||x.nodeType===Node.TEXT_NODE?x:y.create(p);return new y(w,p)}n.create=h;function d(x,p){return p===void 0&&(p=!1),x==null?null:x[n.DATA_KEY]!=null?x[n.DATA_KEY].blot:p?d(x.parentNode,p):null}n.find=d;function m(x,p){p===void 0&&(p=f.ANY);var v;if(typeof x=="string")v=u[x]||o[x];else if(x instanceof Text||x.nodeType===Node.TEXT_NODE)v=u.text;else if(typeof x=="number")x&f.LEVEL&f.BLOCK?v=u.block:x&f.LEVEL&f.INLINE&&(v=u.inline);else if(x instanceof HTMLElement){var y=(x.getAttribute("class")||"").split(/\s+/);for(var w in y)if(v=l[y[w]],v)break;v=v||A[x.tagName]}return v==null?null:p&f.LEVEL&v.scope&&p&f.TYPE&v.scope?v:null}n.query=m;function g(){for(var x=[],p=0;p<arguments.length;p++)x[p]=arguments[p];if(x.length>1)return x.map(function(w){return g(w)});var v=x[0];if(typeof v.blotName!="string"&&typeof v.attrName!="string")throw new s("Invalid definition");if(v.blotName==="abstract")throw new s("Cannot register abstract class");if(u[v.blotName||v.attrName]=v,typeof v.keyName=="string")o[v.keyName]=v;else if(v.className!=null&&(l[v.className]=v),v.tagName!=null){Array.isArray(v.tagName)?v.tagName=v.tagName.map(function(w){return w.toUpperCase()}):v.tagName=v.tagName.toUpperCase();var y=Array.isArray(v.tagName)?v.tagName:[v.tagName];y.forEach(function(w){(A[w]==null||v.className==null)&&(A[w]=v)})}return v}n.register=g},function(r,n,i){var a=i(51),s=i(11),o=i(3),l=i(20),A="\0",u=function(f){Array.isArray(f)?this.ops=f:f!=null&&Array.isArray(f.ops)?this.ops=f.ops:this.ops=[]};u.prototype.insert=function(f,h){var d={};return f.length===0?this:(d.insert=f,h!=null&&typeof h=="object"&&Object.keys(h).length>0&&(d.attributes=h),this.push(d))},u.prototype.delete=function(f){return f<=0?this:this.push({delete:f})},u.prototype.retain=function(f,h){if(f<=0)return this;var d={retain:f};return h!=null&&typeof h=="object"&&Object.keys(h).length>0&&(d.attributes=h),this.push(d)},u.prototype.push=function(f){var h=this.ops.length,d=this.ops[h-1];if(f=o(!0,{},f),typeof d=="object"){if(typeof f.delete=="number"&&typeof d.delete=="number")return this.ops[h-1]={delete:d.delete+f.delete},this;if(typeof d.delete=="number"&&f.insert!=null&&(h-=1,d=this.ops[h-1],typeof d!="object"))return this.ops.unshift(f),this;if(s(f.attributes,d.attributes)){if(typeof f.insert=="string"&&typeof d.insert=="string")return this.ops[h-1]={insert:d.insert+f.insert},typeof f.attributes=="object"&&(this.ops[h-1].attributes=f.attributes),this;if(typeof f.retain=="number"&&typeof d.retain=="number")return this.ops[h-1]={retain:d.retain+f.retain},typeof f.attributes=="object"&&(this.ops[h-1].attributes=f.attributes),this}}return h===this.ops.length?this.ops.push(f):this.ops.splice(h,0,f),this},u.prototype.chop=function(){var f=this.ops[this.ops.length-1];return f&&f.retain&&!f.attributes&&this.ops.pop(),this},u.prototype.filter=function(f){return this.ops.filter(f)},u.prototype.forEach=function(f){this.ops.forEach(f)},u.prototype.map=function(f){return this.ops.map(f)},u.prototype.partition=function(f){var h=[],d=[];return this.forEach(function(m){var g=f(m)?h:d;g.push(m)}),[h,d]},u.prototype.reduce=function(f,h){return this.ops.reduce(f,h)},u.prototype.changeLength=function(){return this.reduce(function(f,h){return h.insert?f+l.length(h):h.delete?f-h.delete:f},0)},u.prototype.length=function(){return this.reduce(function(f,h){return f+l.length(h)},0)},u.prototype.slice=function(f,h){f=f||0,typeof h!="number"&&(h=1/0);for(var d=[],m=l.iterator(this.ops),g=0;g<h&&m.hasNext();){var x;g<f?x=m.next(f-g):(x=m.next(h-g),d.push(x)),g+=l.length(x)}return new u(d)},u.prototype.compose=function(f){var h=l.iterator(this.ops),d=l.iterator(f.ops),m=[],g=d.peek();if(g!=null&&typeof g.retain=="number"&&g.attributes==null){for(var x=g.retain;h.peekType()==="insert"&&h.peekLength()<=x;)x-=h.peekLength(),m.push(h.next());g.retain-x>0&&d.next(g.retain-x)}for(var p=new u(m);h.hasNext()||d.hasNext();)if(d.peekType()==="insert")p.push(d.next());else if(h.peekType()==="delete")p.push(h.next());else{var v=Math.min(h.peekLength(),d.peekLength()),y=h.next(v),w=d.next(v);if(typeof w.retain=="number"){var B={};typeof y.retain=="number"?B.retain=v:B.insert=y.insert;var E=l.attributes.compose(y.attributes,w.attributes,typeof y.retain=="number");if(E&&(B.attributes=E),p.push(B),!d.hasNext()&&s(p.ops[p.ops.length-1],B)){var _=new u(h.rest());return p.concat(_).chop()}}else typeof w.delete=="number"&&typeof y.retain=="number"&&p.push(w)}return p.chop()},u.prototype.concat=function(f){var h=new u(this.ops.slice());return f.ops.length>0&&(h.push(f.ops[0]),h.ops=h.ops.concat(f.ops.slice(1))),h},u.prototype.diff=function(f,h){if(this.ops===f.ops)return new u;var d=[this,f].map(function(v){return v.map(function(y){if(y.insert!=null)return typeof y.insert=="string"?y.insert:A;var w=v===f?"on":"with";throw new Error("diff() called "+w+" non-document")}).join("")}),m=new u,g=a(d[0],d[1],h),x=l.iterator(this.ops),p=l.iterator(f.ops);return g.forEach(function(v){for(var y=v[1].length;y>0;){var w=0;switch(v[0]){case a.INSERT:w=Math.min(p.peekLength(),y),m.push(p.next(w));break;case a.DELETE:w=Math.min(y,x.peekLength()),x.next(w),m.delete(w);break;case a.EQUAL:w=Math.min(x.peekLength(),p.peekLength(),y);var B=x.next(w),E=p.next(w);s(B.insert,E.insert)?m.retain(w,l.attributes.diff(B.attributes,E.attributes)):m.push(E).delete(w);break}y-=w}}),m.chop()},u.prototype.eachLine=function(f,h){h=h||`
`;for(var d=l.iterator(this.ops),m=new u,g=0;d.hasNext();){if(d.peekType()!=="insert")return;var x=d.peek(),p=l.length(x)-d.peekLength(),v=typeof x.insert=="string"?x.insert.indexOf(h,p)-p:-1;if(v<0)m.push(d.next());else if(v>0)m.push(d.next(v));else{if(f(m,d.next(1).attributes||{},g)===!1)return;g+=1,m=new u}}m.length()>0&&f(m,{},g)},u.prototype.transform=function(f,h){if(h=!!h,typeof f=="number")return this.transformPosition(f,h);for(var d=l.iterator(this.ops),m=l.iterator(f.ops),g=new u;d.hasNext()||m.hasNext();)if(d.peekType()==="insert"&&(h||m.peekType()!=="insert"))g.retain(l.length(d.next()));else if(m.peekType()==="insert")g.push(m.next());else{var x=Math.min(d.peekLength(),m.peekLength()),p=d.next(x),v=m.next(x);if(p.delete)continue;v.delete?g.push(v):g.retain(x,l.attributes.transform(p.attributes,v.attributes,h))}return g.chop()},u.prototype.transformPosition=function(f,h){h=!!h;for(var d=l.iterator(this.ops),m=0;d.hasNext()&&m<=f;){var g=d.peekLength(),x=d.peekType();if(d.next(),x==="delete"){f-=Math.min(g,f-m);continue}else x==="insert"&&(m<f||!h)&&(f+=g);m+=g}return f},r.exports=u},function(r,n){var i=Object.prototype.hasOwnProperty,a=Object.prototype.toString,s=Object.defineProperty,o=Object.getOwnPropertyDescriptor,l=function(d){return typeof Array.isArray=="function"?Array.isArray(d):a.call(d)==="[object Array]"},A=function(d){if(!d||a.call(d)!=="[object Object]")return!1;var m=i.call(d,"constructor"),g=d.constructor&&d.constructor.prototype&&i.call(d.constructor.prototype,"isPrototypeOf");if(d.constructor&&!m&&!g)return!1;var x;for(x in d);return typeof x>"u"||i.call(d,x)},u=function(d,m){s&&m.name==="__proto__"?s(d,m.name,{enumerable:!0,configurable:!0,value:m.newValue,writable:!0}):d[m.name]=m.newValue},f=function(d,m){if(m==="__proto__")if(i.call(d,m)){if(o)return o(d,m).value}else return;return d[m]};r.exports=function h(){var d,m,g,x,p,v,y=arguments[0],w=1,B=arguments.length,E=!1;for(typeof y=="boolean"&&(E=y,y=arguments[1]||{},w=2),(y==null||typeof y!="object"&&typeof y!="function")&&(y={});w<B;++w)if(d=arguments[w],d!=null)for(m in d)g=f(y,m),x=f(d,m),y!==x&&(E&&x&&(A(x)||(p=l(x)))?(p?(p=!1,v=g&&l(g)?g:[]):v=g&&A(g)?g:{},u(y,{name:m,newValue:h(E,v,x)})):typeof x<"u"&&u(y,{name:m,newValue:x}));return y}},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BlockEmbed=n.bubbleFormats=void 0;var a=function(){function S(C,L){for(var R=0;R<L.length;R++){var W=L[R];W.enumerable=W.enumerable||!1,W.configurable=!0,"value"in W&&(W.writable=!0),Object.defineProperty(C,W.key,W)}}return function(C,L,R){return L&&S(C.prototype,L),R&&S(C,R),C}}(),s=function S(C,L,R){C===null&&(C=Function.prototype);var W=Object.getOwnPropertyDescriptor(C,L);if(W===void 0){var G=Object.getPrototypeOf(C);return G===null?void 0:S(G,L,R)}else{if("value"in W)return W.value;var V=W.get;return V===void 0?void 0:V.call(R)}},o=i(3),l=y(o),A=i(2),u=y(A),f=i(0),h=y(f),d=i(16),m=y(d),g=i(6),x=y(g),p=i(7),v=y(p);function y(S){return S&&S.__esModule?S:{default:S}}function w(S,C){if(!(S instanceof C))throw new TypeError("Cannot call a class as a function")}function B(S,C){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C&&(typeof C=="object"||typeof C=="function")?C:S}function E(S,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof C);S.prototype=Object.create(C&&C.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),C&&(Object.setPrototypeOf?Object.setPrototypeOf(S,C):S.__proto__=C)}var _=1,F=function(S){E(C,S);function C(){return w(this,C),B(this,(C.__proto__||Object.getPrototypeOf(C)).apply(this,arguments))}return a(C,[{key:"attach",value:function(){s(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"attach",this).call(this),this.attributes=new h.default.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return new u.default().insert(this.value(),(0,l.default)(this.formats(),this.attributes.values()))}},{key:"format",value:function(R,W){var G=h.default.query(R,h.default.Scope.BLOCK_ATTRIBUTE);G!=null&&this.attributes.attribute(G,W)}},{key:"formatAt",value:function(R,W,G,V){this.format(G,V)}},{key:"insertAt",value:function(R,W,G){if(typeof W=="string"&&W.endsWith(`
`)){var V=h.default.create(T.blotName);this.parent.insertBefore(V,R===0?this:this.next),V.insertAt(0,W.slice(0,-1))}else s(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"insertAt",this).call(this,R,W,G)}}]),C}(h.default.Embed);F.scope=h.default.Scope.BLOCK_BLOT;var T=function(S){E(C,S);function C(L){w(this,C);var R=B(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,L));return R.cache={},R}return a(C,[{key:"delta",value:function(){return this.cache.delta==null&&(this.cache.delta=this.descendants(h.default.Leaf).reduce(function(R,W){return W.length()===0?R:R.insert(W.value(),I(W))},new u.default).insert(`
`,I(this))),this.cache.delta}},{key:"deleteAt",value:function(R,W){s(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"deleteAt",this).call(this,R,W),this.cache={}}},{key:"formatAt",value:function(R,W,G,V){W<=0||(h.default.query(G,h.default.Scope.BLOCK)?R+W===this.length()&&this.format(G,V):s(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"formatAt",this).call(this,R,Math.min(W,this.length()-R-1),G,V),this.cache={})}},{key:"insertAt",value:function(R,W,G){if(G!=null)return s(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"insertAt",this).call(this,R,W,G);if(W.length!==0){var V=W.split(`
`),X=V.shift();X.length>0&&(R<this.length()-1||this.children.tail==null?s(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"insertAt",this).call(this,Math.min(R,this.length()-1),X):this.children.tail.insertAt(this.children.tail.length(),X),this.cache={});var Q=this;V.reduce(function(K,H){return Q=Q.split(K,!0),Q.insertAt(0,H),H.length},R+X.length)}}},{key:"insertBefore",value:function(R,W){var G=this.children.head;s(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"insertBefore",this).call(this,R,W),G instanceof m.default&&G.remove(),this.cache={}}},{key:"length",value:function(){return this.cache.length==null&&(this.cache.length=s(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"length",this).call(this)+_),this.cache.length}},{key:"moveChildren",value:function(R,W){s(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"moveChildren",this).call(this,R,W),this.cache={}}},{key:"optimize",value:function(R){s(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"optimize",this).call(this,R),this.cache={}}},{key:"path",value:function(R){return s(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"path",this).call(this,R,!0)}},{key:"removeChild",value:function(R){s(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"removeChild",this).call(this,R),this.cache={}}},{key:"split",value:function(R){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(W&&(R===0||R>=this.length()-_)){var G=this.clone();return R===0?(this.parent.insertBefore(G,this),this):(this.parent.insertBefore(G,this.next),G)}else{var V=s(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"split",this).call(this,R,W);return this.cache={},V}}}]),C}(h.default.Block);T.blotName="block",T.tagName="P",T.defaultChild="break",T.allowedChildren=[x.default,h.default.Embed,v.default];function I(S){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return S==null||(typeof S.formats=="function"&&(C=(0,l.default)(C,S.formats())),S.parent==null||S.parent.blotName=="scroll"||S.parent.statics.scope!==S.statics.scope)?C:I(S.parent,C)}n.bubbleFormats=I,n.BlockEmbed=F,n.default=T},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.overload=n.expandConfig=void 0;var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Q){return typeof Q}:function(Q){return Q&&typeof Symbol=="function"&&Q.constructor===Symbol&&Q!==Symbol.prototype?"symbol":typeof Q},s=function(){function Q(K,H){var k=[],U=!0,P=!1,D=void 0;try{for(var O=K[Symbol.iterator](),z;!(U=(z=O.next()).done)&&(k.push(z.value),!(H&&k.length===H));U=!0);}catch(J){P=!0,D=J}finally{try{!U&&O.return&&O.return()}finally{if(P)throw D}}return k}return function(K,H){if(Array.isArray(K))return K;if(Symbol.iterator in Object(K))return Q(K,H);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function Q(K,H){for(var k=0;k<H.length;k++){var U=H[k];U.enumerable=U.enumerable||!1,U.configurable=!0,"value"in U&&(U.writable=!0),Object.defineProperty(K,U.key,U)}}return function(K,H,k){return H&&Q(K.prototype,H),k&&Q(K,k),K}}();i(50);var l=i(2),A=I(l),u=i(14),f=I(u),h=i(8),d=I(h),m=i(9),g=I(m),x=i(0),p=I(x),v=i(15),y=I(v),w=i(3),B=I(w),E=i(10),_=I(E),F=i(34),T=I(F);function I(Q){return Q&&Q.__esModule?Q:{default:Q}}function S(Q,K,H){return K in Q?Object.defineProperty(Q,K,{value:H,enumerable:!0,configurable:!0,writable:!0}):Q[K]=H,Q}function C(Q,K){if(!(Q instanceof K))throw new TypeError("Cannot call a class as a function")}var L=(0,_.default)("quill"),R=function(){o(Q,null,[{key:"debug",value:function(H){H===!0&&(H="log"),_.default.level(H)}},{key:"find",value:function(H){return H.__quill||p.default.find(H)}},{key:"import",value:function(H){return this.imports[H]==null&&L.error("Cannot import "+H+". Are you sure it was registered?"),this.imports[H]}},{key:"register",value:function(H,k){var U=this,P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(typeof H!="string"){var D=H.attrName||H.blotName;typeof D=="string"?this.register("formats/"+D,H,k):Object.keys(H).forEach(function(O){U.register(O,H[O],k)})}else this.imports[H]!=null&&!P&&L.warn("Overwriting "+H+" with",k),this.imports[H]=k,(H.startsWith("blots/")||H.startsWith("formats/"))&&k.blotName!=="abstract"?p.default.register(k):H.startsWith("modules")&&typeof k.register=="function"&&k.register()}}]);function Q(K){var H=this,k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(C(this,Q),this.options=W(K,k),this.container=this.options.container,this.container==null)return L.error("Invalid Quill container",K);this.options.debug&&Q.debug(this.options.debug);var U=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new d.default,this.scroll=p.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new f.default(this.scroll),this.selection=new y.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(d.default.events.EDITOR_CHANGE,function(D){D===d.default.events.TEXT_CHANGE&&H.root.classList.toggle("ql-blank",H.editor.isBlank())}),this.emitter.on(d.default.events.SCROLL_UPDATE,function(D,O){var z=H.selection.lastRange,J=z&&z.length===0?z.index:void 0;G.call(H,function(){return H.editor.update(null,O,J)},D)});var P=this.clipboard.convert(`<div class='ql-editor' style="white-space: normal;">`+U+"<p><br></p></div>");this.setContents(P),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return o(Q,[{key:"addContainer",value:function(H){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof H=="string"){var U=H;H=document.createElement("div"),H.classList.add(U)}return this.container.insertBefore(H,k),H}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(H,k,U){var P=this,D=V(H,k,U),O=s(D,4);return H=O[0],k=O[1],U=O[3],G.call(this,function(){return P.editor.deleteText(H,k)},U,H,-1*k)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(H),this.container.classList.toggle("ql-disabled",!H)}},{key:"focus",value:function(){var H=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=H,this.scrollIntoView()}},{key:"format",value:function(H,k){var U=this,P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:d.default.sources.API;return G.call(this,function(){var D=U.getSelection(!0),O=new A.default;if(D==null)return O;if(p.default.query(H,p.default.Scope.BLOCK))O=U.editor.formatLine(D.index,D.length,S({},H,k));else{if(D.length===0)return U.selection.format(H,k),O;O=U.editor.formatText(D.index,D.length,S({},H,k))}return U.setSelection(D,d.default.sources.SILENT),O},P)}},{key:"formatLine",value:function(H,k,U,P,D){var O=this,z=void 0,J=V(H,k,U,P,D),Y=s(J,4);return H=Y[0],k=Y[1],z=Y[2],D=Y[3],G.call(this,function(){return O.editor.formatLine(H,k,z)},D,H,0)}},{key:"formatText",value:function(H,k,U,P,D){var O=this,z=void 0,J=V(H,k,U,P,D),Y=s(J,4);return H=Y[0],k=Y[1],z=Y[2],D=Y[3],G.call(this,function(){return O.editor.formatText(H,k,z)},D,H,0)}},{key:"getBounds",value:function(H){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,U=void 0;typeof H=="number"?U=this.selection.getBounds(H,k):U=this.selection.getBounds(H.index,H.length);var P=this.container.getBoundingClientRect();return{bottom:U.bottom-P.top,height:U.height,left:U.left-P.left,right:U.right-P.left,top:U.top-P.top,width:U.width}}},{key:"getContents",value:function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-H,U=V(H,k),P=s(U,2);return H=P[0],k=P[1],this.editor.getContents(H,k)}},{key:"getFormat",value:function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof H=="number"?this.editor.getFormat(H,k):this.editor.getFormat(H.index,H.length)}},{key:"getIndex",value:function(H){return H.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(H){return this.scroll.leaf(H)}},{key:"getLine",value:function(H){return this.scroll.line(H)}},{key:"getLines",value:function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof H!="number"?this.scroll.lines(H.index,H.length):this.scroll.lines(H,k)}},{key:"getModule",value:function(H){return this.theme.modules[H]}},{key:"getSelection",value:function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return H&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-H,U=V(H,k),P=s(U,2);return H=P[0],k=P[1],this.editor.getText(H,k)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(H,k,U){var P=this,D=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Q.sources.API;return G.call(this,function(){return P.editor.insertEmbed(H,k,U)},D,H)}},{key:"insertText",value:function(H,k,U,P,D){var O=this,z=void 0,J=V(H,0,U,P,D),Y=s(J,4);return H=Y[0],z=Y[2],D=Y[3],G.call(this,function(){return O.editor.insertText(H,k,z)},D,H,k.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(H,k,U){this.clipboard.dangerouslyPasteHTML(H,k,U)}},{key:"removeFormat",value:function(H,k,U){var P=this,D=V(H,k,U),O=s(D,4);return H=O[0],k=O[1],U=O[3],G.call(this,function(){return P.editor.removeFormat(H,k)},U,H)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(H){var k=this,U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d.default.sources.API;return G.call(this,function(){H=new A.default(H);var P=k.getLength(),D=k.editor.deleteText(0,P),O=k.editor.applyDelta(H),z=O.ops[O.ops.length-1];z!=null&&typeof z.insert=="string"&&z.insert[z.insert.length-1]===`
`&&(k.editor.deleteText(k.getLength()-1,1),O.delete(1));var J=D.compose(O);return J},U)}},{key:"setSelection",value:function(H,k,U){if(H==null)this.selection.setRange(null,k||Q.sources.API);else{var P=V(H,k,U),D=s(P,4);H=D[0],k=D[1],U=D[3],this.selection.setRange(new v.Range(H,k),U),U!==d.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(H){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d.default.sources.API,U=new A.default().insert(H);return this.setContents(U,k)}},{key:"update",value:function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:d.default.sources.USER,k=this.scroll.update(H);return this.selection.update(H),k}},{key:"updateContents",value:function(H){var k=this,U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d.default.sources.API;return G.call(this,function(){return H=new A.default(H),k.editor.applyDelta(H,U)},U,!0)}}]),Q}();R.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},R.events=d.default.events,R.sources=d.default.sources,R.version="1.3.7",R.imports={delta:A.default,parchment:p.default,"core/module":g.default,"core/theme":T.default};function W(Q,K){if(K=(0,B.default)(!0,{container:Q,modules:{clipboard:!0,keyboard:!0,history:!0}},K),!K.theme||K.theme===R.DEFAULTS.theme)K.theme=T.default;else if(K.theme=R.import("themes/"+K.theme),K.theme==null)throw new Error("Invalid theme "+K.theme+". Did you register it?");var H=(0,B.default)(!0,{},K.theme.DEFAULTS);[H,K].forEach(function(P){P.modules=P.modules||{},Object.keys(P.modules).forEach(function(D){P.modules[D]===!0&&(P.modules[D]={})})});var k=Object.keys(H.modules).concat(Object.keys(K.modules)),U=k.reduce(function(P,D){var O=R.import("modules/"+D);return O==null?L.error("Cannot load "+D+" module. Are you sure you registered it?"):P[D]=O.DEFAULTS||{},P},{});return K.modules!=null&&K.modules.toolbar&&K.modules.toolbar.constructor!==Object&&(K.modules.toolbar={container:K.modules.toolbar}),K=(0,B.default)(!0,{},R.DEFAULTS,{modules:U},H,K),["bounds","container","scrollingContainer"].forEach(function(P){typeof K[P]=="string"&&(K[P]=document.querySelector(K[P]))}),K.modules=Object.keys(K.modules).reduce(function(P,D){return K.modules[D]&&(P[D]=K.modules[D]),P},{}),K}function G(Q,K,H,k){if(this.options.strict&&!this.isEnabled()&&K===d.default.sources.USER)return new A.default;var U=H==null?null:this.getSelection(),P=this.editor.delta,D=Q();if(U!=null&&(H===!0&&(H=U.index),k==null?U=X(U,D,K):k!==0&&(U=X(U,H,k,K)),this.setSelection(U,d.default.sources.SILENT)),D.length()>0){var O,z=[d.default.events.TEXT_CHANGE,D,P,K];if((O=this.emitter).emit.apply(O,[d.default.events.EDITOR_CHANGE].concat(z)),K!==d.default.sources.SILENT){var J;(J=this.emitter).emit.apply(J,z)}}return D}function V(Q,K,H,k,U){var P={};return typeof Q.index=="number"&&typeof Q.length=="number"?typeof K!="number"?(U=k,k=H,H=K,K=Q.length,Q=Q.index):(K=Q.length,Q=Q.index):typeof K!="number"&&(U=k,k=H,H=K,K=0),(typeof H>"u"?"undefined":a(H))==="object"?(P=H,U=k):typeof H=="string"&&(k!=null?P[H]=k:U=H),U=U||d.default.sources.API,[Q,K,P,U]}function X(Q,K,H,k){if(Q==null)return null;var U=void 0,P=void 0;if(K instanceof A.default){var D=[Q.index,Q.index+Q.length].map(function(Y){return K.transformPosition(Y,k!==d.default.sources.USER)}),O=s(D,2);U=O[0],P=O[1]}else{var z=[Q.index,Q.index+Q.length].map(function(Y){return Y<K||Y===K&&k===d.default.sources.USER?Y:H>=0?Y+H:Math.max(K,Y+H)}),J=s(z,2);U=J[0],P=J[1]}return new v.Range(U,P-U)}n.expandConfig=W,n.overload=V,n.default=R},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function x(p,v){for(var y=0;y<v.length;y++){var w=v[y];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(p,w.key,w)}}return function(p,v,y){return v&&x(p.prototype,v),y&&x(p,y),p}}(),s=function x(p,v,y){p===null&&(p=Function.prototype);var w=Object.getOwnPropertyDescriptor(p,v);if(w===void 0){var B=Object.getPrototypeOf(p);return B===null?void 0:x(B,v,y)}else{if("value"in w)return w.value;var E=w.get;return E===void 0?void 0:E.call(y)}},o=i(7),l=f(o),A=i(0),u=f(A);function f(x){return x&&x.__esModule?x:{default:x}}function h(x,p){if(!(x instanceof p))throw new TypeError("Cannot call a class as a function")}function d(x,p){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:x}function m(x,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);x.prototype=Object.create(p&&p.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(x,p):x.__proto__=p)}var g=function(x){m(p,x);function p(){return h(this,p),d(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return a(p,[{key:"formatAt",value:function(y,w,B,E){if(p.compare(this.statics.blotName,B)<0&&u.default.query(B,u.default.Scope.BLOT)){var _=this.isolate(y,w);E&&_.wrap(B,E)}else s(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"formatAt",this).call(this,y,w,B,E)}},{key:"optimize",value:function(y){if(s(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"optimize",this).call(this,y),this.parent instanceof p&&p.compare(this.statics.blotName,this.parent.statics.blotName)>0){var w=this.parent.isolate(this.offset(),this.length());this.moveChildren(w),w.wrap(this)}}}],[{key:"compare",value:function(y,w){var B=p.order.indexOf(y),E=p.order.indexOf(w);return B>=0||E>=0?B-E:y===w?0:y<w?-1:1}}]),p}(u.default.Inline);g.allowedChildren=[g,u.default.Embed,l.default],g.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],n.default=g},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),s=o(a);function o(h){return h&&h.__esModule?h:{default:h}}function l(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")}function A(h,d){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:h}function u(h,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);h.prototype=Object.create(d&&d.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(h,d):h.__proto__=d)}var f=function(h){u(d,h);function d(){return l(this,d),A(this,(d.__proto__||Object.getPrototypeOf(d)).apply(this,arguments))}return d}(s.default.Text);n.default=f},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function v(y,w){for(var B=0;B<w.length;B++){var E=w[B];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(y,E.key,E)}}return function(y,w,B){return w&&v(y.prototype,w),B&&v(y,B),y}}(),s=function v(y,w,B){y===null&&(y=Function.prototype);var E=Object.getOwnPropertyDescriptor(y,w);if(E===void 0){var _=Object.getPrototypeOf(y);return _===null?void 0:v(_,w,B)}else{if("value"in E)return E.value;var F=E.get;return F===void 0?void 0:F.call(B)}},o=i(54),l=f(o),A=i(10),u=f(A);function f(v){return v&&v.__esModule?v:{default:v}}function h(v,y){if(!(v instanceof y))throw new TypeError("Cannot call a class as a function")}function d(v,y){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:v}function m(v,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);v.prototype=Object.create(y&&y.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(v,y):v.__proto__=y)}var g=(0,u.default)("quill:events"),x=["selectionchange","mousedown","mouseup","click"];x.forEach(function(v){document.addEventListener(v,function(){for(var y=arguments.length,w=Array(y),B=0;B<y;B++)w[B]=arguments[B];[].slice.call(document.querySelectorAll(".ql-container")).forEach(function(E){if(E.__quill&&E.__quill.emitter){var _;(_=E.__quill.emitter).handleDOM.apply(_,w)}})})});var p=function(v){m(y,v);function y(){h(this,y);var w=d(this,(y.__proto__||Object.getPrototypeOf(y)).call(this));return w.listeners={},w.on("error",g.error),w}return a(y,[{key:"emit",value:function(){g.log.apply(g,arguments),s(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(B){for(var E=arguments.length,_=Array(E>1?E-1:0),F=1;F<E;F++)_[F-1]=arguments[F];(this.listeners[B.type]||[]).forEach(function(T){var I=T.node,S=T.handler;(B.target===I||I.contains(B.target))&&S.apply(void 0,[B].concat(_))})}},{key:"listenDOM",value:function(B,E,_){this.listeners[B]||(this.listeners[B]=[]),this.listeners[B].push({node:E,handler:_})}}]),y}(l.default);p.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},p.sources={API:"api",SILENT:"silent",USER:"user"},n.default=p},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});function a(o,l){if(!(o instanceof l))throw new TypeError("Cannot call a class as a function")}var s=function o(l){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};a(this,o),this.quill=l,this.options=A};s.DEFAULTS={},n.default=s},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=["error","warn","log","info"],s="warn";function o(A){if(a.indexOf(A)<=a.indexOf(s)){for(var u,f=arguments.length,h=Array(f>1?f-1:0),d=1;d<f;d++)h[d-1]=arguments[d];(u=console)[A].apply(u,h)}}function l(A){return a.reduce(function(u,f){return u[f]=o.bind(console,f,A),u},{})}o.level=l.level=function(A){s=A},n.default=l},function(r,n,i){var a=Array.prototype.slice,s=i(52),o=i(53),l=r.exports=function(h,d,m){return m||(m={}),h===d?!0:h instanceof Date&&d instanceof Date?h.getTime()===d.getTime():!h||!d||typeof h!="object"&&typeof d!="object"?m.strict?h===d:h==d:f(h,d,m)};function A(h){return h==null}function u(h){return!(!h||typeof h!="object"||typeof h.length!="number"||typeof h.copy!="function"||typeof h.slice!="function"||h.length>0&&typeof h[0]!="number")}function f(h,d,m){var g,x;if(A(h)||A(d)||h.prototype!==d.prototype)return!1;if(o(h))return o(d)?(h=a.call(h),d=a.call(d),l(h,d,m)):!1;if(u(h)){if(!u(d)||h.length!==d.length)return!1;for(g=0;g<h.length;g++)if(h[g]!==d[g])return!1;return!0}try{var p=s(h),v=s(d)}catch{return!1}if(p.length!=v.length)return!1;for(p.sort(),v.sort(),g=p.length-1;g>=0;g--)if(p[g]!=v[g])return!1;for(g=p.length-1;g>=0;g--)if(x=p[g],!l(h[x],d[x],m))return!1;return typeof h==typeof d}},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(1),s=function(){function o(l,A,u){u===void 0&&(u={}),this.attrName=l,this.keyName=A;var f=a.Scope.TYPE&a.Scope.ATTRIBUTE;u.scope!=null?this.scope=u.scope&a.Scope.LEVEL|f:this.scope=a.Scope.ATTRIBUTE,u.whitelist!=null&&(this.whitelist=u.whitelist)}return o.keys=function(l){return[].map.call(l.attributes,function(A){return A.name})},o.prototype.add=function(l,A){return this.canAdd(l,A)?(l.setAttribute(this.keyName,A),!0):!1},o.prototype.canAdd=function(l,A){var u=a.query(l,a.Scope.BLOT&(this.scope|a.Scope.TYPE));return u==null?!1:this.whitelist==null?!0:typeof A=="string"?this.whitelist.indexOf(A.replace(/["']/g,""))>-1:this.whitelist.indexOf(A)>-1},o.prototype.remove=function(l){l.removeAttribute(this.keyName)},o.prototype.value=function(l){var A=l.getAttribute(this.keyName);return this.canAdd(l,A)&&A?A:""},o}();n.default=s},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Code=void 0;var a=function(){function F(T,I){var S=[],C=!0,L=!1,R=void 0;try{for(var W=T[Symbol.iterator](),G;!(C=(G=W.next()).done)&&(S.push(G.value),!(I&&S.length===I));C=!0);}catch(V){L=!0,R=V}finally{try{!C&&W.return&&W.return()}finally{if(L)throw R}}return S}return function(T,I){if(Array.isArray(T))return T;if(Symbol.iterator in Object(T))return F(T,I);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function F(T,I){for(var S=0;S<I.length;S++){var C=I[S];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(T,C.key,C)}}return function(T,I,S){return I&&F(T.prototype,I),S&&F(T,S),T}}(),o=function F(T,I,S){T===null&&(T=Function.prototype);var C=Object.getOwnPropertyDescriptor(T,I);if(C===void 0){var L=Object.getPrototypeOf(T);return L===null?void 0:F(L,I,S)}else{if("value"in C)return C.value;var R=C.get;return R===void 0?void 0:R.call(S)}},l=i(2),A=v(l),u=i(0),f=v(u),h=i(4),d=v(h),m=i(6),g=v(m),x=i(7),p=v(x);function v(F){return F&&F.__esModule?F:{default:F}}function y(F,T){if(!(F instanceof T))throw new TypeError("Cannot call a class as a function")}function w(F,T){if(!F)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T&&(typeof T=="object"||typeof T=="function")?T:F}function B(F,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof T);F.prototype=Object.create(T&&T.prototype,{constructor:{value:F,enumerable:!1,writable:!0,configurable:!0}}),T&&(Object.setPrototypeOf?Object.setPrototypeOf(F,T):F.__proto__=T)}var E=function(F){B(T,F);function T(){return y(this,T),w(this,(T.__proto__||Object.getPrototypeOf(T)).apply(this,arguments))}return T}(g.default);E.blotName="code",E.tagName="CODE";var _=function(F){B(T,F);function T(){return y(this,T),w(this,(T.__proto__||Object.getPrototypeOf(T)).apply(this,arguments))}return s(T,[{key:"delta",value:function(){var S=this,C=this.domNode.textContent;return C.endsWith(`
`)&&(C=C.slice(0,-1)),C.split(`
`).reduce(function(L,R){return L.insert(R).insert(`
`,S.formats())},new A.default)}},{key:"format",value:function(S,C){if(!(S===this.statics.blotName&&C)){var L=this.descendant(p.default,this.length()-1),R=a(L,1),W=R[0];W!=null&&W.deleteAt(W.length()-1,1),o(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"format",this).call(this,S,C)}}},{key:"formatAt",value:function(S,C,L,R){if(C!==0&&!(f.default.query(L,f.default.Scope.BLOCK)==null||L===this.statics.blotName&&R===this.statics.formats(this.domNode))){var W=this.newlineIndex(S);if(!(W<0||W>=S+C)){var G=this.newlineIndex(S,!0)+1,V=W-G+1,X=this.isolate(G,V),Q=X.next;X.format(L,R),Q instanceof T&&Q.formatAt(0,S-G+C-V,L,R)}}}},{key:"insertAt",value:function(S,C,L){if(L==null){var R=this.descendant(p.default,S),W=a(R,2),G=W[0],V=W[1];G.insertAt(V,C)}}},{key:"length",value:function(){var S=this.domNode.textContent.length;return this.domNode.textContent.endsWith(`
`)?S:S+1}},{key:"newlineIndex",value:function(S){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(C)return this.domNode.textContent.slice(0,S).lastIndexOf(`
`);var L=this.domNode.textContent.slice(S).indexOf(`
`);return L>-1?S+L:-1}},{key:"optimize",value:function(S){this.domNode.textContent.endsWith(`
`)||this.appendChild(f.default.create("text",`
`)),o(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"optimize",this).call(this,S);var C=this.next;C!=null&&C.prev===this&&C.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===C.statics.formats(C.domNode)&&(C.optimize(S),C.moveChildren(this),C.remove())}},{key:"replace",value:function(S){o(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"replace",this).call(this,S),[].slice.call(this.domNode.querySelectorAll("*")).forEach(function(C){var L=f.default.find(C);L==null?C.parentNode.removeChild(C):L instanceof f.default.Embed?L.remove():L.unwrap()})}}],[{key:"create",value:function(S){var C=o(T.__proto__||Object.getPrototypeOf(T),"create",this).call(this,S);return C.setAttribute("spellcheck",!1),C}},{key:"formats",value:function(){return!0}}]),T}(d.default);_.blotName="code-block",_.tagName="PRE",_.TAB="  ",n.Code=E,n.default=_},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Q){return typeof Q}:function(Q){return Q&&typeof Symbol=="function"&&Q.constructor===Symbol&&Q!==Symbol.prototype?"symbol":typeof Q},s=function(){function Q(K,H){var k=[],U=!0,P=!1,D=void 0;try{for(var O=K[Symbol.iterator](),z;!(U=(z=O.next()).done)&&(k.push(z.value),!(H&&k.length===H));U=!0);}catch(J){P=!0,D=J}finally{try{!U&&O.return&&O.return()}finally{if(P)throw D}}return k}return function(K,H){if(Array.isArray(K))return K;if(Symbol.iterator in Object(K))return Q(K,H);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function Q(K,H){for(var k=0;k<H.length;k++){var U=H[k];U.enumerable=U.enumerable||!1,U.configurable=!0,"value"in U&&(U.writable=!0),Object.defineProperty(K,U.key,U)}}return function(K,H,k){return H&&Q(K.prototype,H),k&&Q(K,k),K}}(),l=i(2),A=C(l),u=i(20),f=C(u),h=i(0),d=C(h),m=i(13),g=C(m),x=i(24),p=C(x),v=i(4),y=C(v),w=i(16),B=C(w),E=i(21),_=C(E),F=i(11),T=C(F),I=i(3),S=C(I);function C(Q){return Q&&Q.__esModule?Q:{default:Q}}function L(Q,K,H){return K in Q?Object.defineProperty(Q,K,{value:H,enumerable:!0,configurable:!0,writable:!0}):Q[K]=H,Q}function R(Q,K){if(!(Q instanceof K))throw new TypeError("Cannot call a class as a function")}var W=/^[ -~]*$/,G=function(){function Q(K){R(this,Q),this.scroll=K,this.delta=this.getDelta()}return o(Q,[{key:"applyDelta",value:function(H){var k=this,U=!1;this.scroll.update();var P=this.scroll.length();return this.scroll.batchStart(),H=X(H),H.reduce(function(D,O){var z=O.retain||O.delete||O.insert.length||1,J=O.attributes||{};if(O.insert!=null){if(typeof O.insert=="string"){var Y=O.insert;Y.endsWith(`
`)&&U&&(U=!1,Y=Y.slice(0,-1)),D>=P&&!Y.endsWith(`
`)&&(U=!0),k.scroll.insertAt(D,Y);var le=k.scroll.line(D),we=s(le,2),ne=we[0],Me=we[1],qe=(0,S.default)({},(0,v.bubbleFormats)(ne));if(ne instanceof y.default){var Fe=ne.descendant(d.default.Leaf,Me),he=s(Fe,1),Be=he[0];qe=(0,S.default)(qe,(0,v.bubbleFormats)(Be))}J=f.default.attributes.diff(qe,J)||{}}else if(a(O.insert)==="object"){var xe=Object.keys(O.insert)[0];if(xe==null)return D;k.scroll.insertAt(D,xe,O.insert[xe])}P+=z}return Object.keys(J).forEach(function(se){k.scroll.formatAt(D,z,se,J[se])}),D+z},0),H.reduce(function(D,O){return typeof O.delete=="number"?(k.scroll.deleteAt(D,O.delete),D):D+(O.retain||O.insert.length||1)},0),this.scroll.batchEnd(),this.update(H)}},{key:"deleteText",value:function(H,k){return this.scroll.deleteAt(H,k),this.update(new A.default().retain(H).delete(k))}},{key:"formatLine",value:function(H,k){var U=this,P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.scroll.update(),Object.keys(P).forEach(function(D){if(!(U.scroll.whitelist!=null&&!U.scroll.whitelist[D])){var O=U.scroll.lines(H,Math.max(k,1)),z=k;O.forEach(function(J){var Y=J.length();if(!(J instanceof g.default))J.format(D,P[D]);else{var le=H-J.offset(U.scroll),we=J.newlineIndex(le+z)-le+1;J.formatAt(le,we,D,P[D])}z-=Y})}}),this.scroll.optimize(),this.update(new A.default().retain(H).retain(k,(0,_.default)(P)))}},{key:"formatText",value:function(H,k){var U=this,P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Object.keys(P).forEach(function(D){U.scroll.formatAt(H,k,D,P[D])}),this.update(new A.default().retain(H).retain(k,(0,_.default)(P)))}},{key:"getContents",value:function(H,k){return this.delta.slice(H,H+k)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce(function(H,k){return H.concat(k.delta())},new A.default)}},{key:"getFormat",value:function(H){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,U=[],P=[];k===0?this.scroll.path(H).forEach(function(O){var z=s(O,1),J=z[0];J instanceof y.default?U.push(J):J instanceof d.default.Leaf&&P.push(J)}):(U=this.scroll.lines(H,k),P=this.scroll.descendants(d.default.Leaf,H,k));var D=[U,P].map(function(O){if(O.length===0)return{};for(var z=(0,v.bubbleFormats)(O.shift());Object.keys(z).length>0;){var J=O.shift();if(J==null)return z;z=V((0,v.bubbleFormats)(J),z)}return z});return S.default.apply(S.default,D)}},{key:"getText",value:function(H,k){return this.getContents(H,k).filter(function(U){return typeof U.insert=="string"}).map(function(U){return U.insert}).join("")}},{key:"insertEmbed",value:function(H,k,U){return this.scroll.insertAt(H,k,U),this.update(new A.default().retain(H).insert(L({},k,U)))}},{key:"insertText",value:function(H,k){var U=this,P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return k=k.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(H,k),Object.keys(P).forEach(function(D){U.scroll.formatAt(H,k.length,D,P[D])}),this.update(new A.default().retain(H).insert(k,(0,_.default)(P)))}},{key:"isBlank",value:function(){if(this.scroll.children.length==0)return!0;if(this.scroll.children.length>1)return!1;var H=this.scroll.children.head;return H.statics.blotName!==y.default.blotName||H.children.length>1?!1:H.children.head instanceof B.default}},{key:"removeFormat",value:function(H,k){var U=this.getText(H,k),P=this.scroll.line(H+k),D=s(P,2),O=D[0],z=D[1],J=0,Y=new A.default;O!=null&&(O instanceof g.default?J=O.newlineIndex(z)-z+1:J=O.length()-z,Y=O.delta().slice(z,z+J-1).insert(`
`));var le=this.getContents(H,k+J),we=le.diff(new A.default().insert(U).concat(Y)),ne=new A.default().retain(H).concat(we);return this.applyDelta(ne)}},{key:"update",value:function(H){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,P=this.delta;if(k.length===1&&k[0].type==="characterData"&&k[0].target.data.match(W)&&d.default.find(k[0].target)){var D=d.default.find(k[0].target),O=(0,v.bubbleFormats)(D),z=D.offset(this.scroll),J=k[0].oldValue.replace(p.default.CONTENTS,""),Y=new A.default().insert(J),le=new A.default().insert(D.value()),we=new A.default().retain(z).concat(Y.diff(le,U));H=we.reduce(function(ne,Me){return Me.insert?ne.insert(Me.insert,O):ne.push(Me)},new A.default),this.delta=P.compose(H)}else this.delta=this.getDelta(),(!H||!(0,T.default)(P.compose(H),this.delta))&&(H=P.diff(this.delta,U));return H}}]),Q}();function V(Q,K){return Object.keys(K).reduce(function(H,k){return Q[k]==null||(K[k]===Q[k]?H[k]=K[k]:Array.isArray(K[k])?K[k].indexOf(Q[k])<0&&(H[k]=K[k].concat([Q[k]])):H[k]=[K[k],Q[k]]),H},{})}function X(Q){return Q.reduce(function(K,H){if(H.insert===1){var k=(0,_.default)(H.attributes);return delete k.image,K.insert({image:H.attributes.image},k)}if(H.attributes!=null&&(H.attributes.list===!0||H.attributes.bullet===!0)&&(H=(0,_.default)(H),H.attributes.list?H.attributes.list="ordered":(H.attributes.list="bullet",delete H.attributes.bullet)),typeof H.insert=="string"){var U=H.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return K.insert(U,H.attributes)}return K.push(H)},new A.default)}n.default=G},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Range=void 0;var a=function(){function F(T,I){var S=[],C=!0,L=!1,R=void 0;try{for(var W=T[Symbol.iterator](),G;!(C=(G=W.next()).done)&&(S.push(G.value),!(I&&S.length===I));C=!0);}catch(V){L=!0,R=V}finally{try{!C&&W.return&&W.return()}finally{if(L)throw R}}return S}return function(T,I){if(Array.isArray(T))return T;if(Symbol.iterator in Object(T))return F(T,I);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function F(T,I){for(var S=0;S<I.length;S++){var C=I[S];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(T,C.key,C)}}return function(T,I,S){return I&&F(T.prototype,I),S&&F(T,S),T}}(),o=i(0),l=p(o),A=i(21),u=p(A),f=i(11),h=p(f),d=i(8),m=p(d),g=i(10),x=p(g);function p(F){return F&&F.__esModule?F:{default:F}}function v(F){if(Array.isArray(F)){for(var T=0,I=Array(F.length);T<F.length;T++)I[T]=F[T];return I}else return Array.from(F)}function y(F,T){if(!(F instanceof T))throw new TypeError("Cannot call a class as a function")}var w=(0,x.default)("quill:selection"),B=function F(T){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;y(this,F),this.index=T,this.length=I},E=function(){function F(T,I){var S=this;y(this,F),this.emitter=I,this.scroll=T,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=l.default.create("cursor",this),this.lastRange=this.savedRange=new B(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,function(){S.mouseDown||setTimeout(S.update.bind(S,m.default.sources.USER),1)}),this.emitter.on(m.default.events.EDITOR_CHANGE,function(C,L){C===m.default.events.TEXT_CHANGE&&L.length()>0&&S.update(m.default.sources.SILENT)}),this.emitter.on(m.default.events.SCROLL_BEFORE_UPDATE,function(){if(S.hasFocus()){var C=S.getNativeRange();C!=null&&C.start.node!==S.cursor.textNode&&S.emitter.once(m.default.events.SCROLL_UPDATE,function(){try{S.setNativeRange(C.start.node,C.start.offset,C.end.node,C.end.offset)}catch{}})}}),this.emitter.on(m.default.events.SCROLL_OPTIMIZE,function(C,L){if(L.range){var R=L.range,W=R.startNode,G=R.startOffset,V=R.endNode,X=R.endOffset;S.setNativeRange(W,G,V,X)}}),this.update(m.default.sources.SILENT)}return s(F,[{key:"handleComposition",value:function(){var I=this;this.root.addEventListener("compositionstart",function(){I.composing=!0}),this.root.addEventListener("compositionend",function(){if(I.composing=!1,I.cursor.parent){var S=I.cursor.restore();if(!S)return;setTimeout(function(){I.setNativeRange(S.startNode,S.startOffset,S.endNode,S.endOffset)},1)}})}},{key:"handleDragging",value:function(){var I=this;this.emitter.listenDOM("mousedown",document.body,function(){I.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,function(){I.mouseDown=!1,I.update(m.default.sources.USER)})}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(I,S){if(!(this.scroll.whitelist!=null&&!this.scroll.whitelist[I])){this.scroll.update();var C=this.getNativeRange();if(!(C==null||!C.native.collapsed||l.default.query(I,l.default.Scope.BLOCK))){if(C.start.node!==this.cursor.textNode){var L=l.default.find(C.start.node,!1);if(L==null)return;if(L instanceof l.default.Leaf){var R=L.split(C.start.offset);L.parent.insertBefore(this.cursor,R)}else L.insertBefore(this.cursor,C.start.node);this.cursor.attach()}this.cursor.format(I,S),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(I){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,C=this.scroll.length();I=Math.min(I,C-1),S=Math.min(I+S,C-1)-I;var L=void 0,R=this.scroll.leaf(I),W=a(R,2),G=W[0],V=W[1];if(G==null)return null;var X=G.position(V,!0),Q=a(X,2);L=Q[0],V=Q[1];var K=document.createRange();if(S>0){K.setStart(L,V);var H=this.scroll.leaf(I+S),k=a(H,2);if(G=k[0],V=k[1],G==null)return null;var U=G.position(V,!0),P=a(U,2);return L=P[0],V=P[1],K.setEnd(L,V),K.getBoundingClientRect()}else{var D="left",O=void 0;return L instanceof Text?(V<L.data.length?(K.setStart(L,V),K.setEnd(L,V+1)):(K.setStart(L,V-1),K.setEnd(L,V),D="right"),O=K.getBoundingClientRect()):(O=G.domNode.getBoundingClientRect(),V>0&&(D="right")),{bottom:O.top+O.height,height:O.height,left:O[D],right:O[D],top:O.top,width:0}}}},{key:"getNativeRange",value:function(){var I=document.getSelection();if(I==null||I.rangeCount<=0)return null;var S=I.getRangeAt(0);if(S==null)return null;var C=this.normalizeNative(S);return w.info("getNativeRange",C),C}},{key:"getRange",value:function(){var I=this.getNativeRange();if(I==null)return[null,null];var S=this.normalizedToRange(I);return[S,I]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(I){var S=this,C=[[I.start.node,I.start.offset]];I.native.collapsed||C.push([I.end.node,I.end.offset]);var L=C.map(function(G){var V=a(G,2),X=V[0],Q=V[1],K=l.default.find(X,!0),H=K.offset(S.scroll);return Q===0?H:K instanceof l.default.Container?H+K.length():H+K.index(X,Q)}),R=Math.min(Math.max.apply(Math,v(L)),this.scroll.length()-1),W=Math.min.apply(Math,[R].concat(v(L)));return new B(W,R-W)}},{key:"normalizeNative",value:function(I){if(!_(this.root,I.startContainer)||!I.collapsed&&!_(this.root,I.endContainer))return null;var S={start:{node:I.startContainer,offset:I.startOffset},end:{node:I.endContainer,offset:I.endOffset},native:I};return[S.start,S.end].forEach(function(C){for(var L=C.node,R=C.offset;!(L instanceof Text)&&L.childNodes.length>0;)if(L.childNodes.length>R)L=L.childNodes[R],R=0;else if(L.childNodes.length===R)L=L.lastChild,R=L instanceof Text?L.data.length:L.childNodes.length+1;else break;C.node=L,C.offset=R}),S}},{key:"rangeToNative",value:function(I){var S=this,C=I.collapsed?[I.index]:[I.index,I.index+I.length],L=[],R=this.scroll.length();return C.forEach(function(W,G){W=Math.min(R-1,W);var V=void 0,X=S.scroll.leaf(W),Q=a(X,2),K=Q[0],H=Q[1],k=K.position(H,G!==0),U=a(k,2);V=U[0],H=U[1],L.push(V,H)}),L.length<2&&(L=L.concat(L)),L}},{key:"scrollIntoView",value:function(I){var S=this.lastRange;if(S!=null){var C=this.getBounds(S.index,S.length);if(C!=null){var L=this.scroll.length()-1,R=this.scroll.line(Math.min(S.index,L)),W=a(R,1),G=W[0],V=G;if(S.length>0){var X=this.scroll.line(Math.min(S.index+S.length,L)),Q=a(X,1);V=Q[0]}if(!(G==null||V==null)){var K=I.getBoundingClientRect();C.top<K.top?I.scrollTop-=K.top-C.top:C.bottom>K.bottom&&(I.scrollTop+=C.bottom-K.bottom)}}}}},{key:"setNativeRange",value:function(I,S){var C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:I,L=arguments.length>3&&arguments[3]!==void 0?arguments[3]:S,R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(w.info("setNativeRange",I,S,C,L),!(I!=null&&(this.root.parentNode==null||I.parentNode==null||C.parentNode==null))){var W=document.getSelection();if(W!=null)if(I!=null){this.hasFocus()||this.root.focus();var G=(this.getNativeRange()||{}).native;if(G==null||R||I!==G.startContainer||S!==G.startOffset||C!==G.endContainer||L!==G.endOffset){I.tagName=="BR"&&(S=[].indexOf.call(I.parentNode.childNodes,I),I=I.parentNode),C.tagName=="BR"&&(L=[].indexOf.call(C.parentNode.childNodes,C),C=C.parentNode);var V=document.createRange();V.setStart(I,S),V.setEnd(C,L),W.removeAllRanges(),W.addRange(V)}}else W.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(I){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:m.default.sources.API;if(typeof S=="string"&&(C=S,S=!1),w.info("setRange",I),I!=null){var L=this.rangeToNative(I);this.setNativeRange.apply(this,v(L).concat([S]))}else this.setNativeRange(null);this.update(C)}},{key:"update",value:function(){var I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:m.default.sources.USER,S=this.lastRange,C=this.getRange(),L=a(C,2),R=L[0],W=L[1];if(this.lastRange=R,this.lastRange!=null&&(this.savedRange=this.lastRange),!(0,h.default)(S,this.lastRange)){var G;!this.composing&&W!=null&&W.native.collapsed&&W.start.node!==this.cursor.textNode&&this.cursor.restore();var V=[m.default.events.SELECTION_CHANGE,(0,u.default)(this.lastRange),(0,u.default)(S),I];if((G=this.emitter).emit.apply(G,[m.default.events.EDITOR_CHANGE].concat(V)),I!==m.default.sources.SILENT){var X;(X=this.emitter).emit.apply(X,V)}}}}]),F}();function _(F,T){try{T.parentNode}catch{return!1}return T instanceof Text&&(T=T.parentNode),F.contains(T)}n.Range=B,n.default=E},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function m(g,x){for(var p=0;p<x.length;p++){var v=x[p];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(g,v.key,v)}}return function(g,x,p){return x&&m(g.prototype,x),p&&m(g,p),g}}(),s=function m(g,x,p){g===null&&(g=Function.prototype);var v=Object.getOwnPropertyDescriptor(g,x);if(v===void 0){var y=Object.getPrototypeOf(g);return y===null?void 0:m(y,x,p)}else{if("value"in v)return v.value;var w=v.get;return w===void 0?void 0:w.call(p)}},o=i(0),l=A(o);function A(m){return m&&m.__esModule?m:{default:m}}function u(m,g){if(!(m instanceof g))throw new TypeError("Cannot call a class as a function")}function f(m,g){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:m}function h(m,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);m.prototype=Object.create(g&&g.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(m,g):m.__proto__=g)}var d=function(m){h(g,m);function g(){return u(this,g),f(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return a(g,[{key:"insertInto",value:function(p,v){p.children.length===0?s(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"insertInto",this).call(this,p,v):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),g}(l.default.Embed);d.blotName="break",d.tagName="BR",n.default=d},function(r,n,i){var a=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,d){h.__proto__=d}||function(h,d){for(var m in d)d.hasOwnProperty(m)&&(h[m]=d[m])};return function(h,d){f(h,d);function m(){this.constructor=h}h.prototype=d===null?Object.create(d):(m.prototype=d.prototype,new m)}}();Object.defineProperty(n,"__esModule",{value:!0});var s=i(44),o=i(30),l=i(1),A=function(f){a(h,f);function h(d){var m=f.call(this,d)||this;return m.build(),m}return h.prototype.appendChild=function(d){this.insertBefore(d)},h.prototype.attach=function(){f.prototype.attach.call(this),this.children.forEach(function(d){d.attach()})},h.prototype.build=function(){var d=this;this.children=new s.default,[].slice.call(this.domNode.childNodes).reverse().forEach(function(m){try{var g=u(m);d.insertBefore(g,d.children.head||void 0)}catch(x){if(x instanceof l.ParchmentError)return;throw x}})},h.prototype.deleteAt=function(d,m){if(d===0&&m===this.length())return this.remove();this.children.forEachAt(d,m,function(g,x,p){g.deleteAt(x,p)})},h.prototype.descendant=function(d,m){var g=this.children.find(m),x=g[0],p=g[1];return d.blotName==null&&d(x)||d.blotName!=null&&x instanceof d?[x,p]:x instanceof h?x.descendant(d,p):[null,-1]},h.prototype.descendants=function(d,m,g){m===void 0&&(m=0),g===void 0&&(g=Number.MAX_VALUE);var x=[],p=g;return this.children.forEachAt(m,g,function(v,y,w){(d.blotName==null&&d(v)||d.blotName!=null&&v instanceof d)&&x.push(v),v instanceof h&&(x=x.concat(v.descendants(d,y,p))),p-=w}),x},h.prototype.detach=function(){this.children.forEach(function(d){d.detach()}),f.prototype.detach.call(this)},h.prototype.formatAt=function(d,m,g,x){this.children.forEachAt(d,m,function(p,v,y){p.formatAt(v,y,g,x)})},h.prototype.insertAt=function(d,m,g){var x=this.children.find(d),p=x[0],v=x[1];if(p)p.insertAt(v,m,g);else{var y=g==null?l.create("text",m):l.create(m,g);this.appendChild(y)}},h.prototype.insertBefore=function(d,m){if(this.statics.allowedChildren!=null&&!this.statics.allowedChildren.some(function(g){return d instanceof g}))throw new l.ParchmentError("Cannot insert "+d.statics.blotName+" into "+this.statics.blotName);d.insertInto(this,m)},h.prototype.length=function(){return this.children.reduce(function(d,m){return d+m.length()},0)},h.prototype.moveChildren=function(d,m){this.children.forEach(function(g){d.insertBefore(g,m)})},h.prototype.optimize=function(d){if(f.prototype.optimize.call(this,d),this.children.length===0)if(this.statics.defaultChild!=null){var m=l.create(this.statics.defaultChild);this.appendChild(m),m.optimize(d)}else this.remove()},h.prototype.path=function(d,m){m===void 0&&(m=!1);var g=this.children.find(d,m),x=g[0],p=g[1],v=[[this,d]];return x instanceof h?v.concat(x.path(p,m)):(x!=null&&v.push([x,p]),v)},h.prototype.removeChild=function(d){this.children.remove(d)},h.prototype.replace=function(d){d instanceof h&&d.moveChildren(this),f.prototype.replace.call(this,d)},h.prototype.split=function(d,m){if(m===void 0&&(m=!1),!m){if(d===0)return this;if(d===this.length())return this.next}var g=this.clone();return this.parent.insertBefore(g,this.next),this.children.forEachAt(d,this.length(),function(x,p,v){x=x.split(p,m),g.appendChild(x)}),g},h.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},h.prototype.update=function(d,m){var g=this,x=[],p=[];d.forEach(function(v){v.target===g.domNode&&v.type==="childList"&&(x.push.apply(x,v.addedNodes),p.push.apply(p,v.removedNodes))}),p.forEach(function(v){if(!(v.parentNode!=null&&v.tagName!=="IFRAME"&&document.body.compareDocumentPosition(v)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var y=l.find(v);y!=null&&(y.domNode.parentNode==null||y.domNode.parentNode===g.domNode)&&y.detach()}}),x.filter(function(v){return v.parentNode==g.domNode}).sort(function(v,y){return v===y?0:v.compareDocumentPosition(y)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1}).forEach(function(v){var y=null;v.nextSibling!=null&&(y=l.find(v.nextSibling));var w=u(v);(w.next!=y||w.next==null)&&(w.parent!=null&&w.parent.removeChild(g),g.insertBefore(w,y||void 0))})},h}(o.default);function u(f){var h=l.find(f);if(h==null)try{h=l.create(f)}catch{h=l.create(l.Scope.INLINE),[].slice.call(f.childNodes).forEach(function(m){h.domNode.appendChild(m)}),f.parentNode&&f.parentNode.replaceChild(h.domNode,f),h.attach()}return h}n.default=A},function(r,n,i){var a=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,d){h.__proto__=d}||function(h,d){for(var m in d)d.hasOwnProperty(m)&&(h[m]=d[m])};return function(h,d){f(h,d);function m(){this.constructor=h}h.prototype=d===null?Object.create(d):(m.prototype=d.prototype,new m)}}();Object.defineProperty(n,"__esModule",{value:!0});var s=i(12),o=i(31),l=i(17),A=i(1),u=function(f){a(h,f);function h(d){var m=f.call(this,d)||this;return m.attributes=new o.default(m.domNode),m}return h.formats=function(d){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return d.tagName.toLowerCase()},h.prototype.format=function(d,m){var g=A.query(d);g instanceof s.default?this.attributes.attribute(g,m):m&&g!=null&&(d!==this.statics.blotName||this.formats()[d]!==m)&&this.replaceWith(d,m)},h.prototype.formats=function(){var d=this.attributes.values(),m=this.statics.formats(this.domNode);return m!=null&&(d[this.statics.blotName]=m),d},h.prototype.replaceWith=function(d,m){var g=f.prototype.replaceWith.call(this,d,m);return this.attributes.copy(g),g},h.prototype.update=function(d,m){var g=this;f.prototype.update.call(this,d,m),d.some(function(x){return x.target===g.domNode&&x.type==="attributes"})&&this.attributes.build()},h.prototype.wrap=function(d,m){var g=f.prototype.wrap.call(this,d,m);return g instanceof h&&g.statics.scope===this.statics.scope&&this.attributes.move(g),g},h}(l.default);n.default=u},function(r,n,i){var a=this&&this.__extends||function(){var A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var h in f)f.hasOwnProperty(h)&&(u[h]=f[h])};return function(u,f){A(u,f);function h(){this.constructor=u}u.prototype=f===null?Object.create(f):(h.prototype=f.prototype,new h)}}();Object.defineProperty(n,"__esModule",{value:!0});var s=i(30),o=i(1),l=function(A){a(u,A);function u(){return A!==null&&A.apply(this,arguments)||this}return u.value=function(f){return!0},u.prototype.index=function(f,h){return this.domNode===f||this.domNode.compareDocumentPosition(f)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(h,1):-1},u.prototype.position=function(f,h){var d=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return f>0&&(d+=1),[this.parent.domNode,d]},u.prototype.value=function(){var f;return f={},f[this.statics.blotName]=this.statics.value(this.domNode)||!0,f},u.scope=o.Scope.INLINE_BLOT,u}(s.default);n.default=l},function(r,n,i){var a=i(11),s=i(3),o={attributes:{compose:function(A,u,f){typeof A!="object"&&(A={}),typeof u!="object"&&(u={});var h=s(!0,{},u);f||(h=Object.keys(h).reduce(function(m,g){return h[g]!=null&&(m[g]=h[g]),m},{}));for(var d in A)A[d]!==void 0&&u[d]===void 0&&(h[d]=A[d]);return Object.keys(h).length>0?h:void 0},diff:function(A,u){typeof A!="object"&&(A={}),typeof u!="object"&&(u={});var f=Object.keys(A).concat(Object.keys(u)).reduce(function(h,d){return a(A[d],u[d])||(h[d]=u[d]===void 0?null:u[d]),h},{});return Object.keys(f).length>0?f:void 0},transform:function(A,u,f){if(typeof A!="object")return u;if(typeof u=="object"){if(!f)return u;var h=Object.keys(u).reduce(function(d,m){return A[m]===void 0&&(d[m]=u[m]),d},{});return Object.keys(h).length>0?h:void 0}}},iterator:function(A){return new l(A)},length:function(A){return typeof A.delete=="number"?A.delete:typeof A.retain=="number"?A.retain:typeof A.insert=="string"?A.insert.length:1}};function l(A){this.ops=A,this.index=0,this.offset=0}l.prototype.hasNext=function(){return this.peekLength()<1/0},l.prototype.next=function(A){A||(A=1/0);var u=this.ops[this.index];if(u){var f=this.offset,h=o.length(u);if(A>=h-f?(A=h-f,this.index+=1,this.offset=0):this.offset+=A,typeof u.delete=="number")return{delete:A};var d={};return u.attributes&&(d.attributes=u.attributes),typeof u.retain=="number"?d.retain=A:typeof u.insert=="string"?d.insert=u.insert.substr(f,A):d.insert=u.insert,d}else return{retain:1/0}},l.prototype.peek=function(){return this.ops[this.index]},l.prototype.peekLength=function(){return this.ops[this.index]?o.length(this.ops[this.index])-this.offset:1/0},l.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},l.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var A=this.offset,u=this.index,f=this.next(),h=this.ops.slice(this.index);return this.offset=A,this.index=u,[f].concat(h)}else return[]},r.exports=o},function(r,n){var i=function(){function a(g,x){return x!=null&&g instanceof x}var s;try{s=Map}catch{s=function(){}}var o;try{o=Set}catch{o=function(){}}var l;try{l=Promise}catch{l=function(){}}function A(g,x,p,v,y){typeof x=="object"&&(p=x.depth,v=x.prototype,y=x.includeNonEnumerable,x=x.circular);var w=[],B=[],E=typeof Buffer<"u";typeof x>"u"&&(x=!0),typeof p>"u"&&(p=1/0);function _(F,T){if(F===null)return null;if(T===0)return F;var I,S;if(typeof F!="object")return F;if(a(F,s))I=new s;else if(a(F,o))I=new o;else if(a(F,l))I=new l(function(K,H){F.then(function(k){K(_(k,T-1))},function(k){H(_(k,T-1))})});else if(A.__isArray(F))I=[];else if(A.__isRegExp(F))I=new RegExp(F.source,m(F)),F.lastIndex&&(I.lastIndex=F.lastIndex);else if(A.__isDate(F))I=new Date(F.getTime());else{if(E&&Buffer.isBuffer(F))return Buffer.allocUnsafe?I=Buffer.allocUnsafe(F.length):I=new Buffer(F.length),F.copy(I),I;a(F,Error)?I=Object.create(F):typeof v>"u"?(S=Object.getPrototypeOf(F),I=Object.create(S)):(I=Object.create(v),S=v)}if(x){var C=w.indexOf(F);if(C!=-1)return B[C];w.push(F),B.push(I)}a(F,s)&&F.forEach(function(K,H){var k=_(H,T-1),U=_(K,T-1);I.set(k,U)}),a(F,o)&&F.forEach(function(K){var H=_(K,T-1);I.add(H)});for(var L in F){var R;S&&(R=Object.getOwnPropertyDescriptor(S,L)),!(R&&R.set==null)&&(I[L]=_(F[L],T-1))}if(Object.getOwnPropertySymbols)for(var W=Object.getOwnPropertySymbols(F),L=0;L<W.length;L++){var G=W[L],V=Object.getOwnPropertyDescriptor(F,G);V&&!V.enumerable&&!y||(I[G]=_(F[G],T-1),V.enumerable||Object.defineProperty(I,G,{enumerable:!1}))}if(y)for(var X=Object.getOwnPropertyNames(F),L=0;L<X.length;L++){var Q=X[L],V=Object.getOwnPropertyDescriptor(F,Q);V&&V.enumerable||(I[Q]=_(F[Q],T-1),Object.defineProperty(I,Q,{enumerable:!1}))}return I}return _(g,p)}A.clonePrototype=function(x){if(x===null)return null;var p=function(){};return p.prototype=x,new p};function u(g){return Object.prototype.toString.call(g)}A.__objToStr=u;function f(g){return typeof g=="object"&&u(g)==="[object Date]"}A.__isDate=f;function h(g){return typeof g=="object"&&u(g)==="[object Array]"}A.__isArray=h;function d(g){return typeof g=="object"&&u(g)==="[object RegExp]"}A.__isRegExp=d;function m(g){var x="";return g.global&&(x+="g"),g.ignoreCase&&(x+="i"),g.multiline&&(x+="m"),x}return A.__getRegExpFlags=m,A}();typeof r=="object"&&r.exports&&(r.exports=i)},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function I(S,C){var L=[],R=!0,W=!1,G=void 0;try{for(var V=S[Symbol.iterator](),X;!(R=(X=V.next()).done)&&(L.push(X.value),!(C&&L.length===C));R=!0);}catch(Q){W=!0,G=Q}finally{try{!R&&V.return&&V.return()}finally{if(W)throw G}}return L}return function(S,C){if(Array.isArray(S))return S;if(Symbol.iterator in Object(S))return I(S,C);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function I(S,C){for(var L=0;L<C.length;L++){var R=C[L];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(S,R.key,R)}}return function(S,C,L){return C&&I(S.prototype,C),L&&I(S,L),S}}(),o=function I(S,C,L){S===null&&(S=Function.prototype);var R=Object.getOwnPropertyDescriptor(S,C);if(R===void 0){var W=Object.getPrototypeOf(S);return W===null?void 0:I(W,C,L)}else{if("value"in R)return R.value;var G=R.get;return G===void 0?void 0:G.call(L)}},l=i(0),A=w(l),u=i(8),f=w(u),h=i(4),d=w(h),m=i(16),g=w(m),x=i(13),p=w(x),v=i(25),y=w(v);function w(I){return I&&I.__esModule?I:{default:I}}function B(I,S){if(!(I instanceof S))throw new TypeError("Cannot call a class as a function")}function E(I,S){if(!I)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:I}function _(I,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);I.prototype=Object.create(S&&S.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(I,S):I.__proto__=S)}function F(I){return I instanceof d.default||I instanceof h.BlockEmbed}var T=function(I){_(S,I);function S(C,L){B(this,S);var R=E(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,C));return R.emitter=L.emitter,Array.isArray(L.whitelist)&&(R.whitelist=L.whitelist.reduce(function(W,G){return W[G]=!0,W},{})),R.domNode.addEventListener("DOMNodeInserted",function(){}),R.optimize(),R.enable(),R}return s(S,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(L,R){var W=this.line(L),G=a(W,2),V=G[0],X=G[1],Q=this.line(L+R),K=a(Q,1),H=K[0];if(o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"deleteAt",this).call(this,L,R),H!=null&&V!==H&&X>0){if(V instanceof h.BlockEmbed||H instanceof h.BlockEmbed){this.optimize();return}if(V instanceof p.default){var k=V.newlineIndex(V.length(),!0);if(k>-1&&(V=V.split(k+1),V===H)){this.optimize();return}}else if(H instanceof p.default){var U=H.newlineIndex(0);U>-1&&H.split(U+1)}var P=H.children.head instanceof g.default?null:H.children.head;V.moveChildren(H,P),V.remove()}this.optimize()}},{key:"enable",value:function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",L)}},{key:"formatAt",value:function(L,R,W,G){this.whitelist!=null&&!this.whitelist[W]||(o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"formatAt",this).call(this,L,R,W,G),this.optimize())}},{key:"insertAt",value:function(L,R,W){if(!(W!=null&&this.whitelist!=null&&!this.whitelist[R])){if(L>=this.length())if(W==null||A.default.query(R,A.default.Scope.BLOCK)==null){var G=A.default.create(this.statics.defaultChild);this.appendChild(G),W==null&&R.endsWith(`
`)&&(R=R.slice(0,-1)),G.insertAt(0,R,W)}else{var V=A.default.create(R,W);this.appendChild(V)}else o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"insertAt",this).call(this,L,R,W);this.optimize()}}},{key:"insertBefore",value:function(L,R){if(L.statics.scope===A.default.Scope.INLINE_BLOT){var W=A.default.create(this.statics.defaultChild);W.appendChild(L),L=W}o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"insertBefore",this).call(this,L,R)}},{key:"leaf",value:function(L){return this.path(L).pop()||[null,-1]}},{key:"line",value:function(L){return L===this.length()?this.line(L-1):this.descendant(F,L)}},{key:"lines",value:function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,W=function G(V,X,Q){var K=[],H=Q;return V.children.forEachAt(X,Q,function(k,U,P){F(k)?K.push(k):k instanceof A.default.Container&&(K=K.concat(G(k,U,H))),H-=P}),K};return W(this,L,R)}},{key:"optimize",value:function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch!==!0&&(o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"optimize",this).call(this,L,R),L.length>0&&this.emitter.emit(f.default.events.SCROLL_OPTIMIZE,L,R))}},{key:"path",value:function(L){return o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"path",this).call(this,L).slice(1)}},{key:"update",value:function(L){if(this.batch!==!0){var R=f.default.sources.USER;typeof L=="string"&&(R=L),Array.isArray(L)||(L=this.observer.takeRecords()),L.length>0&&this.emitter.emit(f.default.events.SCROLL_BEFORE_UPDATE,R,L),o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"update",this).call(this,L.concat([])),L.length>0&&this.emitter.emit(f.default.events.SCROLL_UPDATE,R,L)}}}]),S}(A.default.Scroll);T.blotName="scroll",T.className="ql-editor",T.tagName="DIV",T.defaultChild="block",T.allowedChildren=[d.default,h.BlockEmbed,y.default],n.default=T},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SHORTKEY=n.default=void 0;var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(O){return typeof O}:function(O){return O&&typeof Symbol=="function"&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O},s=function(){function O(z,J){var Y=[],le=!0,we=!1,ne=void 0;try{for(var Me=z[Symbol.iterator](),qe;!(le=(qe=Me.next()).done)&&(Y.push(qe.value),!(J&&Y.length===J));le=!0);}catch(Fe){we=!0,ne=Fe}finally{try{!le&&Me.return&&Me.return()}finally{if(we)throw ne}}return Y}return function(z,J){if(Array.isArray(z))return z;if(Symbol.iterator in Object(z))return O(z,J);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function O(z,J){for(var Y=0;Y<J.length;Y++){var le=J[Y];le.enumerable=le.enumerable||!1,le.configurable=!0,"value"in le&&(le.writable=!0),Object.defineProperty(z,le.key,le)}}return function(z,J,Y){return J&&O(z.prototype,J),Y&&O(z,Y),z}}(),l=i(21),A=I(l),u=i(11),f=I(u),h=i(3),d=I(h),m=i(2),g=I(m),x=i(20),p=I(x),v=i(0),y=I(v),w=i(5),B=I(w),E=i(10),_=I(E),F=i(9),T=I(F);function I(O){return O&&O.__esModule?O:{default:O}}function S(O,z,J){return z in O?Object.defineProperty(O,z,{value:J,enumerable:!0,configurable:!0,writable:!0}):O[z]=J,O}function C(O,z){if(!(O instanceof z))throw new TypeError("Cannot call a class as a function")}function L(O,z){if(!O)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return z&&(typeof z=="object"||typeof z=="function")?z:O}function R(O,z){if(typeof z!="function"&&z!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof z);O.prototype=Object.create(z&&z.prototype,{constructor:{value:O,enumerable:!1,writable:!0,configurable:!0}}),z&&(Object.setPrototypeOf?Object.setPrototypeOf(O,z):O.__proto__=z)}var W=(0,_.default)("quill:keyboard"),G=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",V=function(O){R(z,O),o(z,null,[{key:"match",value:function(Y,le){return le=D(le),["altKey","ctrlKey","metaKey","shiftKey"].some(function(we){return!!le[we]!==Y[we]&&le[we]!==null})?!1:le.key===(Y.which||Y.keyCode)}}]);function z(J,Y){C(this,z);var le=L(this,(z.__proto__||Object.getPrototypeOf(z)).call(this,J,Y));return le.bindings={},Object.keys(le.options.bindings).forEach(function(we){we==="list autofill"&&J.scroll.whitelist!=null&&!J.scroll.whitelist.list||le.options.bindings[we]&&le.addBinding(le.options.bindings[we])}),le.addBinding({key:z.keys.ENTER,shiftKey:null},k),le.addBinding({key:z.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},function(){}),/Firefox/i.test(navigator.userAgent)?(le.addBinding({key:z.keys.BACKSPACE},{collapsed:!0},Q),le.addBinding({key:z.keys.DELETE},{collapsed:!0},K)):(le.addBinding({key:z.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},Q),le.addBinding({key:z.keys.DELETE},{collapsed:!0,suffix:/^.?$/},K)),le.addBinding({key:z.keys.BACKSPACE},{collapsed:!1},H),le.addBinding({key:z.keys.DELETE},{collapsed:!1},H),le.addBinding({key:z.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},Q),le.listen(),le}return o(z,[{key:"addBinding",value:function(Y){var le=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},we=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},ne=D(Y);if(ne==null||ne.key==null)return W.warn("Attempted to add invalid keyboard binding",ne);typeof le=="function"&&(le={handler:le}),typeof we=="function"&&(we={handler:we}),ne=(0,d.default)(ne,le,we),this.bindings[ne.key]=this.bindings[ne.key]||[],this.bindings[ne.key].push(ne)}},{key:"listen",value:function(){var Y=this;this.quill.root.addEventListener("keydown",function(le){if(!le.defaultPrevented){var we=le.which||le.keyCode,ne=(Y.bindings[we]||[]).filter(function(at){return z.match(le,at)});if(ne.length!==0){var Me=Y.quill.getSelection();if(!(Me==null||!Y.quill.hasFocus())){var qe=Y.quill.getLine(Me.index),Fe=s(qe,2),he=Fe[0],Be=Fe[1],xe=Y.quill.getLeaf(Me.index),se=s(xe,2),be=se[0],Te=se[1],pe=Me.length===0?[be,Te]:Y.quill.getLeaf(Me.index+Me.length),je=s(pe,2),Ve=je[0],We=je[1],ft=be instanceof y.default.Text?be.value().slice(0,Te):"",Et=Ve instanceof y.default.Text?Ve.value().slice(We):"",ut={collapsed:Me.length===0,empty:Me.length===0&&he.length()<=1,format:Y.quill.getFormat(Me),offset:Be,prefix:ft,suffix:Et},wt=ne.some(function(at){if(at.collapsed!=null&&at.collapsed!==ut.collapsed||at.empty!=null&&at.empty!==ut.empty||at.offset!=null&&at.offset!==ut.offset)return!1;if(Array.isArray(at.format)){if(at.format.every(function(et){return ut.format[et]==null}))return!1}else if(a(at.format)==="object"&&!Object.keys(at.format).every(function(et){return at.format[et]===!0?ut.format[et]!=null:at.format[et]===!1?ut.format[et]==null:(0,f.default)(at.format[et],ut.format[et])}))return!1;return at.prefix!=null&&!at.prefix.test(ut.prefix)||at.suffix!=null&&!at.suffix.test(ut.suffix)?!1:at.handler.call(Y,Me,ut)!==!0});wt&&le.preventDefault()}}}})}}]),z}(T.default);V.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},V.DEFAULTS={bindings:{bold:P("bold"),italic:P("italic"),underline:P("underline"),indent:{key:V.keys.TAB,format:["blockquote","indent","list"],handler:function(z,J){if(J.collapsed&&J.offset!==0)return!0;this.quill.format("indent","+1",B.default.sources.USER)}},outdent:{key:V.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(z,J){if(J.collapsed&&J.offset!==0)return!0;this.quill.format("indent","-1",B.default.sources.USER)}},"outdent backspace":{key:V.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(z,J){J.format.indent!=null?this.quill.format("indent","-1",B.default.sources.USER):J.format.list!=null&&this.quill.format("list",!1,B.default.sources.USER)}},"indent code-block":U(!0),"outdent code-block":U(!1),"remove tab":{key:V.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(z){this.quill.deleteText(z.index-1,1,B.default.sources.USER)}},tab:{key:V.keys.TAB,handler:function(z){this.quill.history.cutoff();var J=new g.default().retain(z.index).delete(z.length).insert("	");this.quill.updateContents(J,B.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(z.index+1,B.default.sources.SILENT)}},"list empty enter":{key:V.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(z,J){this.quill.format("list",!1,B.default.sources.USER),J.format.indent&&this.quill.format("indent",!1,B.default.sources.USER)}},"checklist enter":{key:V.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(z){var J=this.quill.getLine(z.index),Y=s(J,2),le=Y[0],we=Y[1],ne=(0,d.default)({},le.formats(),{list:"checked"}),Me=new g.default().retain(z.index).insert(`
`,ne).retain(le.length()-we-1).retain(1,{list:"unchecked"});this.quill.updateContents(Me,B.default.sources.USER),this.quill.setSelection(z.index+1,B.default.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:V.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(z,J){var Y=this.quill.getLine(z.index),le=s(Y,2),we=le[0],ne=le[1],Me=new g.default().retain(z.index).insert(`
`,J.format).retain(we.length()-ne-1).retain(1,{header:null});this.quill.updateContents(Me,B.default.sources.USER),this.quill.setSelection(z.index+1,B.default.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(z,J){var Y=J.prefix.length,le=this.quill.getLine(z.index),we=s(le,2),ne=we[0],Me=we[1];if(Me>Y)return!0;var qe=void 0;switch(J.prefix.trim()){case"[]":case"[ ]":qe="unchecked";break;case"[x]":qe="checked";break;case"-":case"*":qe="bullet";break;default:qe="ordered"}this.quill.insertText(z.index," ",B.default.sources.USER),this.quill.history.cutoff();var Fe=new g.default().retain(z.index-Me).delete(Y+1).retain(ne.length()-2-Me).retain(1,{list:qe});this.quill.updateContents(Fe,B.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(z.index-Y,B.default.sources.SILENT)}},"code exit":{key:V.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(z){var J=this.quill.getLine(z.index),Y=s(J,2),le=Y[0],we=Y[1],ne=new g.default().retain(z.index+le.length()-we-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(ne,B.default.sources.USER)}},"embed left":X(V.keys.LEFT,!1),"embed left shift":X(V.keys.LEFT,!0),"embed right":X(V.keys.RIGHT,!1),"embed right shift":X(V.keys.RIGHT,!0)}};function X(O,z){var J,Y=O===V.keys.LEFT?"prefix":"suffix";return J={key:O,shiftKey:z,altKey:null},S(J,Y,/^$/),S(J,"handler",function(we){var ne=we.index;O===V.keys.RIGHT&&(ne+=we.length+1);var Me=this.quill.getLeaf(ne),qe=s(Me,1),Fe=qe[0];return Fe instanceof y.default.Embed?(O===V.keys.LEFT?z?this.quill.setSelection(we.index-1,we.length+1,B.default.sources.USER):this.quill.setSelection(we.index-1,B.default.sources.USER):z?this.quill.setSelection(we.index,we.length+1,B.default.sources.USER):this.quill.setSelection(we.index+we.length+1,B.default.sources.USER),!1):!0}),J}function Q(O,z){if(!(O.index===0||this.quill.getLength()<=1)){var J=this.quill.getLine(O.index),Y=s(J,1),le=Y[0],we={};if(z.offset===0){var ne=this.quill.getLine(O.index-1),Me=s(ne,1),qe=Me[0];if(qe!=null&&qe.length()>1){var Fe=le.formats(),he=this.quill.getFormat(O.index-1,1);we=p.default.attributes.diff(Fe,he)||{}}}var Be=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(z.prefix)?2:1;this.quill.deleteText(O.index-Be,Be,B.default.sources.USER),Object.keys(we).length>0&&this.quill.formatLine(O.index-Be,Be,we,B.default.sources.USER),this.quill.focus()}}function K(O,z){var J=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(z.suffix)?2:1;if(!(O.index>=this.quill.getLength()-J)){var Y={},le=0,we=this.quill.getLine(O.index),ne=s(we,1),Me=ne[0];if(z.offset>=Me.length()-1){var qe=this.quill.getLine(O.index+1),Fe=s(qe,1),he=Fe[0];if(he){var Be=Me.formats(),xe=this.quill.getFormat(O.index,1);Y=p.default.attributes.diff(Be,xe)||{},le=he.length()}}this.quill.deleteText(O.index,J,B.default.sources.USER),Object.keys(Y).length>0&&this.quill.formatLine(O.index+le-1,J,Y,B.default.sources.USER)}}function H(O){var z=this.quill.getLines(O),J={};if(z.length>1){var Y=z[0].formats(),le=z[z.length-1].formats();J=p.default.attributes.diff(le,Y)||{}}this.quill.deleteText(O,B.default.sources.USER),Object.keys(J).length>0&&this.quill.formatLine(O.index,1,J,B.default.sources.USER),this.quill.setSelection(O.index,B.default.sources.SILENT),this.quill.focus()}function k(O,z){var J=this;O.length>0&&this.quill.scroll.deleteAt(O.index,O.length);var Y=Object.keys(z.format).reduce(function(le,we){return y.default.query(we,y.default.Scope.BLOCK)&&!Array.isArray(z.format[we])&&(le[we]=z.format[we]),le},{});this.quill.insertText(O.index,`
`,Y,B.default.sources.USER),this.quill.setSelection(O.index+1,B.default.sources.SILENT),this.quill.focus(),Object.keys(z.format).forEach(function(le){Y[le]==null&&(Array.isArray(z.format[le])||le!=="link"&&J.quill.format(le,z.format[le],B.default.sources.USER))})}function U(O){return{key:V.keys.TAB,shiftKey:!O,format:{"code-block":!0},handler:function(J){var Y=y.default.query("code-block"),le=J.index,we=J.length,ne=this.quill.scroll.descendant(Y,le),Me=s(ne,2),qe=Me[0],Fe=Me[1];if(qe!=null){var he=this.quill.getIndex(qe),Be=qe.newlineIndex(Fe,!0)+1,xe=qe.newlineIndex(he+Fe+we),se=qe.domNode.textContent.slice(Be,xe).split(`
`);Fe=0,se.forEach(function(be,Te){O?(qe.insertAt(Be+Fe,Y.TAB),Fe+=Y.TAB.length,Te===0?le+=Y.TAB.length:we+=Y.TAB.length):be.startsWith(Y.TAB)&&(qe.deleteAt(Be+Fe,Y.TAB.length),Fe-=Y.TAB.length,Te===0?le-=Y.TAB.length:we-=Y.TAB.length),Fe+=be.length+1}),this.quill.update(B.default.sources.USER),this.quill.setSelection(le,we,B.default.sources.SILENT)}}}}function P(O){return{key:O[0].toUpperCase(),shortKey:!0,handler:function(J,Y){this.quill.format(O,!Y.format[O],B.default.sources.USER)}}}function D(O){if(typeof O=="string"||typeof O=="number")return D({key:O});if((typeof O>"u"?"undefined":a(O))==="object"&&(O=(0,A.default)(O,!1)),typeof O.key=="string")if(V.keys[O.key.toUpperCase()]!=null)O.key=V.keys[O.key.toUpperCase()];else if(O.key.length===1)O.key=O.key.toUpperCase().charCodeAt(0);else return null;return O.shortKey&&(O[G]=O.shortKey,delete O.shortKey),O}n.default=V,n.SHORTKEY=G},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function p(v,y){var w=[],B=!0,E=!1,_=void 0;try{for(var F=v[Symbol.iterator](),T;!(B=(T=F.next()).done)&&(w.push(T.value),!(y&&w.length===y));B=!0);}catch(I){E=!0,_=I}finally{try{!B&&F.return&&F.return()}finally{if(E)throw _}}return w}return function(v,y){if(Array.isArray(v))return v;if(Symbol.iterator in Object(v))return p(v,y);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function p(v,y,w){v===null&&(v=Function.prototype);var B=Object.getOwnPropertyDescriptor(v,y);if(B===void 0){var E=Object.getPrototypeOf(v);return E===null?void 0:p(E,y,w)}else{if("value"in B)return B.value;var _=B.get;return _===void 0?void 0:_.call(w)}},o=function(){function p(v,y){for(var w=0;w<y.length;w++){var B=y[w];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(v,B.key,B)}}return function(v,y,w){return y&&p(v.prototype,y),w&&p(v,w),v}}(),l=i(0),A=h(l),u=i(7),f=h(u);function h(p){return p&&p.__esModule?p:{default:p}}function d(p,v){if(!(p instanceof v))throw new TypeError("Cannot call a class as a function")}function m(p,v){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:p}function g(p,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);p.prototype=Object.create(v&&v.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(p,v):p.__proto__=v)}var x=function(p){g(v,p),o(v,null,[{key:"value",value:function(){}}]);function v(y,w){d(this,v);var B=m(this,(v.__proto__||Object.getPrototypeOf(v)).call(this,y));return B.selection=w,B.textNode=document.createTextNode(v.CONTENTS),B.domNode.appendChild(B.textNode),B._length=0,B}return o(v,[{key:"detach",value:function(){this.parent!=null&&this.parent.removeChild(this)}},{key:"format",value:function(w,B){if(this._length!==0)return s(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"format",this).call(this,w,B);for(var E=this,_=0;E!=null&&E.statics.scope!==A.default.Scope.BLOCK_BLOT;)_+=E.offset(E.parent),E=E.parent;E!=null&&(this._length=v.CONTENTS.length,E.optimize(),E.formatAt(_,v.CONTENTS.length,w,B),this._length=0)}},{key:"index",value:function(w,B){return w===this.textNode?0:s(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"index",this).call(this,w,B)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){s(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!(this.selection.composing||this.parent==null)){var w=this.textNode,B=this.selection.getNativeRange(),E=void 0,_=void 0,F=void 0;if(B!=null&&B.start.node===w&&B.end.node===w){var T=[w,B.start.offset,B.end.offset];E=T[0],_=T[1],F=T[2]}for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==v.CONTENTS){var I=this.textNode.data.split(v.CONTENTS).join("");this.next instanceof f.default?(E=this.next.domNode,this.next.insertAt(0,I),this.textNode.data=v.CONTENTS):(this.textNode.data=I,this.parent.insertBefore(A.default.create(this.textNode),this),this.textNode=document.createTextNode(v.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),_!=null){var S=[_,F].map(function(L){return Math.max(0,Math.min(E.data.length,L-1))}),C=a(S,2);return _=C[0],F=C[1],{startNode:E,startOffset:_,endNode:E,endOffset:F}}}}},{key:"update",value:function(w,B){var E=this;if(w.some(function(F){return F.type==="characterData"&&F.target===E.textNode})){var _=this.restore();_&&(B.range=_)}}},{key:"value",value:function(){return""}}]),v}(A.default.Embed);x.blotName="cursor",x.className="ql-cursor",x.tagName="span",x.CONTENTS="\uFEFF",n.default=x},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),s=A(a),o=i(4),l=A(o);function A(m){return m&&m.__esModule?m:{default:m}}function u(m,g){if(!(m instanceof g))throw new TypeError("Cannot call a class as a function")}function f(m,g){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:m}function h(m,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);m.prototype=Object.create(g&&g.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(m,g):m.__proto__=g)}var d=function(m){h(g,m);function g(){return u(this,g),f(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return g}(s.default.Container);d.allowedChildren=[l.default,o.BlockEmbed,d],n.default=d},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ColorStyle=n.ColorClass=n.ColorAttributor=void 0;var a=function(){function x(p,v){for(var y=0;y<v.length;y++){var w=v[y];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(p,w.key,w)}}return function(p,v,y){return v&&x(p.prototype,v),y&&x(p,y),p}}(),s=function x(p,v,y){p===null&&(p=Function.prototype);var w=Object.getOwnPropertyDescriptor(p,v);if(w===void 0){var B=Object.getPrototypeOf(p);return B===null?void 0:x(B,v,y)}else{if("value"in w)return w.value;var E=w.get;return E===void 0?void 0:E.call(y)}},o=i(0),l=A(o);function A(x){return x&&x.__esModule?x:{default:x}}function u(x,p){if(!(x instanceof p))throw new TypeError("Cannot call a class as a function")}function f(x,p){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:x}function h(x,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);x.prototype=Object.create(p&&p.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(x,p):x.__proto__=p)}var d=function(x){h(p,x);function p(){return u(this,p),f(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return a(p,[{key:"value",value:function(y){var w=s(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"value",this).call(this,y);return w.startsWith("rgb(")?(w=w.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+w.split(",").map(function(B){return("00"+parseInt(B).toString(16)).slice(-2)}).join("")):w}}]),p}(l.default.Attributor.Style),m=new l.default.Attributor.Class("color","ql-color",{scope:l.default.Scope.INLINE}),g=new d("color","color",{scope:l.default.Scope.INLINE});n.ColorAttributor=d,n.ColorClass=m,n.ColorStyle=g},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.sanitize=n.default=void 0;var a=function(){function g(x,p){for(var v=0;v<p.length;v++){var y=p[v];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(x,y.key,y)}}return function(x,p,v){return p&&g(x.prototype,p),v&&g(x,v),x}}(),s=function g(x,p,v){x===null&&(x=Function.prototype);var y=Object.getOwnPropertyDescriptor(x,p);if(y===void 0){var w=Object.getPrototypeOf(x);return w===null?void 0:g(w,p,v)}else{if("value"in y)return y.value;var B=y.get;return B===void 0?void 0:B.call(v)}},o=i(6),l=A(o);function A(g){return g&&g.__esModule?g:{default:g}}function u(g,x){if(!(g instanceof x))throw new TypeError("Cannot call a class as a function")}function f(g,x){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:g}function h(g,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);g.prototype=Object.create(x&&x.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(g,x):g.__proto__=x)}var d=function(g){h(x,g);function x(){return u(this,x),f(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return a(x,[{key:"format",value:function(v,y){if(v!==this.statics.blotName||!y)return s(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"format",this).call(this,v,y);y=this.constructor.sanitize(y),this.domNode.setAttribute("href",y)}}],[{key:"create",value:function(v){var y=s(x.__proto__||Object.getPrototypeOf(x),"create",this).call(this,v);return v=this.sanitize(v),y.setAttribute("href",v),y.setAttribute("rel","noopener noreferrer"),y.setAttribute("target","_blank"),y}},{key:"formats",value:function(v){return v.getAttribute("href")}},{key:"sanitize",value:function(v){return m(v,this.PROTOCOL_WHITELIST)?v:this.SANITIZED_URL}}]),x}(l.default);d.blotName="link",d.tagName="A",d.SANITIZED_URL="about:blank",d.PROTOCOL_WHITELIST=["http","https","mailto","tel"];function m(g,x){var p=document.createElement("a");p.href=g;var v=p.href.slice(0,p.href.indexOf(":"));return x.indexOf(v)>-1}n.default=d,n.sanitize=m},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},s=function(){function x(p,v){for(var y=0;y<v.length;y++){var w=v[y];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(p,w.key,w)}}return function(p,v,y){return v&&x(p.prototype,v),y&&x(p,y),p}}(),o=i(23),l=f(o),A=i(107),u=f(A);function f(x){return x&&x.__esModule?x:{default:x}}function h(x,p){if(!(x instanceof p))throw new TypeError("Cannot call a class as a function")}var d=0;function m(x,p){x.setAttribute(p,x.getAttribute(p)!=="true")}var g=function(){function x(p){var v=this;h(this,x),this.select=p,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",function(){v.togglePicker()}),this.label.addEventListener("keydown",function(y){switch(y.keyCode){case l.default.keys.ENTER:v.togglePicker();break;case l.default.keys.ESCAPE:v.escape(),y.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}return s(x,[{key:"togglePicker",value:function(){this.container.classList.toggle("ql-expanded"),m(this.label,"aria-expanded"),m(this.options,"aria-hidden")}},{key:"buildItem",value:function(v){var y=this,w=document.createElement("span");return w.tabIndex="0",w.setAttribute("role","button"),w.classList.add("ql-picker-item"),v.hasAttribute("value")&&w.setAttribute("data-value",v.getAttribute("value")),v.textContent&&w.setAttribute("data-label",v.textContent),w.addEventListener("click",function(){y.selectItem(w,!0)}),w.addEventListener("keydown",function(B){switch(B.keyCode){case l.default.keys.ENTER:y.selectItem(w,!0),B.preventDefault();break;case l.default.keys.ESCAPE:y.escape(),B.preventDefault();break}}),w}},{key:"buildLabel",value:function(){var v=document.createElement("span");return v.classList.add("ql-picker-label"),v.innerHTML=u.default,v.tabIndex="0",v.setAttribute("role","button"),v.setAttribute("aria-expanded","false"),this.container.appendChild(v),v}},{key:"buildOptions",value:function(){var v=this,y=document.createElement("span");y.classList.add("ql-picker-options"),y.setAttribute("aria-hidden","true"),y.tabIndex="-1",y.id="ql-picker-options-"+d,d+=1,this.label.setAttribute("aria-controls",y.id),this.options=y,[].slice.call(this.select.options).forEach(function(w){var B=v.buildItem(w);y.appendChild(B),w.selected===!0&&v.selectItem(B)}),this.container.appendChild(y)}},{key:"buildPicker",value:function(){var v=this;[].slice.call(this.select.attributes).forEach(function(y){v.container.setAttribute(y.name,y.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}},{key:"escape",value:function(){var v=this;this.close(),setTimeout(function(){return v.label.focus()},1)}},{key:"close",value:function(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}},{key:"selectItem",value:function(v){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,w=this.container.querySelector(".ql-selected");if(v!==w&&(w!=null&&w.classList.remove("ql-selected"),v!=null&&(v.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(v.parentNode.children,v),v.hasAttribute("data-value")?this.label.setAttribute("data-value",v.getAttribute("data-value")):this.label.removeAttribute("data-value"),v.hasAttribute("data-label")?this.label.setAttribute("data-label",v.getAttribute("data-label")):this.label.removeAttribute("data-label"),y))){if(typeof Event=="function")this.select.dispatchEvent(new Event("change"));else if((typeof Event>"u"?"undefined":a(Event))==="object"){var B=document.createEvent("Event");B.initEvent("change",!0,!0),this.select.dispatchEvent(B)}this.close()}}},{key:"update",value:function(){var v=void 0;if(this.select.selectedIndex>-1){var y=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];v=this.select.options[this.select.selectedIndex],this.selectItem(y)}else this.selectItem(null);var w=v!=null&&v!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",w)}}]),x}();n.default=g},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(0),s=W(a),o=i(5),l=W(o),A=i(4),u=W(A),f=i(16),h=W(f),d=i(25),m=W(d),g=i(24),x=W(g),p=i(35),v=W(p),y=i(6),w=W(y),B=i(22),E=W(B),_=i(7),F=W(_),T=i(55),I=W(T),S=i(42),C=W(S),L=i(23),R=W(L);function W(G){return G&&G.__esModule?G:{default:G}}l.default.register({"blots/block":u.default,"blots/block/embed":A.BlockEmbed,"blots/break":h.default,"blots/container":m.default,"blots/cursor":x.default,"blots/embed":v.default,"blots/inline":w.default,"blots/scroll":E.default,"blots/text":F.default,"modules/clipboard":I.default,"modules/history":C.default,"modules/keyboard":R.default}),s.default.register(u.default,h.default,x.default,w.default,E.default,F.default),n.default=l.default},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(1),s=function(){function o(l){this.domNode=l,this.domNode[a.DATA_KEY]={blot:this}}return Object.defineProperty(o.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),o.create=function(l){if(this.tagName==null)throw new a.ParchmentError("Blot definition missing tagName");var A;return Array.isArray(this.tagName)?(typeof l=="string"&&(l=l.toUpperCase(),parseInt(l).toString()===l&&(l=parseInt(l))),typeof l=="number"?A=document.createElement(this.tagName[l-1]):this.tagName.indexOf(l)>-1?A=document.createElement(l):A=document.createElement(this.tagName[0])):A=document.createElement(this.tagName),this.className&&A.classList.add(this.className),A},o.prototype.attach=function(){this.parent!=null&&(this.scroll=this.parent.scroll)},o.prototype.clone=function(){var l=this.domNode.cloneNode(!1);return a.create(l)},o.prototype.detach=function(){this.parent!=null&&this.parent.removeChild(this),delete this.domNode[a.DATA_KEY]},o.prototype.deleteAt=function(l,A){var u=this.isolate(l,A);u.remove()},o.prototype.formatAt=function(l,A,u,f){var h=this.isolate(l,A);if(a.query(u,a.Scope.BLOT)!=null&&f)h.wrap(u,f);else if(a.query(u,a.Scope.ATTRIBUTE)!=null){var d=a.create(this.statics.scope);h.wrap(d),d.format(u,f)}},o.prototype.insertAt=function(l,A,u){var f=u==null?a.create("text",A):a.create(A,u),h=this.split(l);this.parent.insertBefore(f,h)},o.prototype.insertInto=function(l,A){A===void 0&&(A=null),this.parent!=null&&this.parent.children.remove(this);var u=null;l.children.insertBefore(this,A),A!=null&&(u=A.domNode),(this.domNode.parentNode!=l.domNode||this.domNode.nextSibling!=u)&&l.domNode.insertBefore(this.domNode,u),this.parent=l,this.attach()},o.prototype.isolate=function(l,A){var u=this.split(l);return u.split(A),u},o.prototype.length=function(){return 1},o.prototype.offset=function(l){return l===void 0&&(l=this.parent),this.parent==null||this==l?0:this.parent.children.offset(this)+this.parent.offset(l)},o.prototype.optimize=function(l){this.domNode[a.DATA_KEY]!=null&&delete this.domNode[a.DATA_KEY].mutations},o.prototype.remove=function(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},o.prototype.replace=function(l){l.parent!=null&&(l.parent.insertBefore(this,l.next),l.remove())},o.prototype.replaceWith=function(l,A){var u=typeof l=="string"?a.create(l,A):l;return u.replace(this),u},o.prototype.split=function(l,A){return l===0?this:this.next},o.prototype.update=function(l,A){},o.prototype.wrap=function(l,A){var u=typeof l=="string"?a.create(l,A):l;return this.parent!=null&&this.parent.insertBefore(u,this.next),u.appendChild(this),u},o.blotName="abstract",o}();n.default=s},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(12),s=i(32),o=i(33),l=i(1),A=function(){function u(f){this.attributes={},this.domNode=f,this.build()}return u.prototype.attribute=function(f,h){h?f.add(this.domNode,h)&&(f.value(this.domNode)!=null?this.attributes[f.attrName]=f:delete this.attributes[f.attrName]):(f.remove(this.domNode),delete this.attributes[f.attrName])},u.prototype.build=function(){var f=this;this.attributes={};var h=a.default.keys(this.domNode),d=s.default.keys(this.domNode),m=o.default.keys(this.domNode);h.concat(d).concat(m).forEach(function(g){var x=l.query(g,l.Scope.ATTRIBUTE);x instanceof a.default&&(f.attributes[x.attrName]=x)})},u.prototype.copy=function(f){var h=this;Object.keys(this.attributes).forEach(function(d){var m=h.attributes[d].value(h.domNode);f.format(d,m)})},u.prototype.move=function(f){var h=this;this.copy(f),Object.keys(this.attributes).forEach(function(d){h.attributes[d].remove(h.domNode)}),this.attributes={}},u.prototype.values=function(){var f=this;return Object.keys(this.attributes).reduce(function(h,d){return h[d]=f.attributes[d].value(f.domNode),h},{})},u}();n.default=A},function(r,n,i){var a=this&&this.__extends||function(){var A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var h in f)f.hasOwnProperty(h)&&(u[h]=f[h])};return function(u,f){A(u,f);function h(){this.constructor=u}u.prototype=f===null?Object.create(f):(h.prototype=f.prototype,new h)}}();Object.defineProperty(n,"__esModule",{value:!0});var s=i(12);function o(A,u){var f=A.getAttribute("class")||"";return f.split(/\s+/).filter(function(h){return h.indexOf(u+"-")===0})}var l=function(A){a(u,A);function u(){return A!==null&&A.apply(this,arguments)||this}return u.keys=function(f){return(f.getAttribute("class")||"").split(/\s+/).map(function(h){return h.split("-").slice(0,-1).join("-")})},u.prototype.add=function(f,h){return this.canAdd(f,h)?(this.remove(f),f.classList.add(this.keyName+"-"+h),!0):!1},u.prototype.remove=function(f){var h=o(f,this.keyName);h.forEach(function(d){f.classList.remove(d)}),f.classList.length===0&&f.removeAttribute("class")},u.prototype.value=function(f){var h=o(f,this.keyName)[0]||"",d=h.slice(this.keyName.length+1);return this.canAdd(f,d)?d:""},u}(s.default);n.default=l},function(r,n,i){var a=this&&this.__extends||function(){var A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var h in f)f.hasOwnProperty(h)&&(u[h]=f[h])};return function(u,f){A(u,f);function h(){this.constructor=u}u.prototype=f===null?Object.create(f):(h.prototype=f.prototype,new h)}}();Object.defineProperty(n,"__esModule",{value:!0});var s=i(12);function o(A){var u=A.split("-"),f=u.slice(1).map(function(h){return h[0].toUpperCase()+h.slice(1)}).join("");return u[0]+f}var l=function(A){a(u,A);function u(){return A!==null&&A.apply(this,arguments)||this}return u.keys=function(f){return(f.getAttribute("style")||"").split(";").map(function(h){var d=h.split(":");return d[0].trim()})},u.prototype.add=function(f,h){return this.canAdd(f,h)?(f.style[o(this.keyName)]=h,!0):!1},u.prototype.remove=function(f){f.style[o(this.keyName)]="",f.getAttribute("style")||f.removeAttribute("style")},u.prototype.value=function(f){var h=f.style[o(this.keyName)];return this.canAdd(f,h)?h:""},u}(s.default);n.default=l},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function l(A,u){for(var f=0;f<u.length;f++){var h=u[f];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(A,h.key,h)}}return function(A,u,f){return u&&l(A.prototype,u),f&&l(A,f),A}}();function s(l,A){if(!(l instanceof A))throw new TypeError("Cannot call a class as a function")}var o=function(){function l(A,u){s(this,l),this.quill=A,this.options=u,this.modules={}}return a(l,[{key:"init",value:function(){var u=this;Object.keys(this.options.modules).forEach(function(f){u.modules[f]==null&&u.addModule(f)})}},{key:"addModule",value:function(u){var f=this.quill.constructor.import("modules/"+u);return this.modules[u]=new f(this.quill,this.options.modules[u]||{}),this.modules[u]}}]),l}();o.DEFAULTS={modules:{}},o.themes={default:o},n.default=o},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function p(v,y){for(var w=0;w<y.length;w++){var B=y[w];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(v,B.key,B)}}return function(v,y,w){return y&&p(v.prototype,y),w&&p(v,w),v}}(),s=function p(v,y,w){v===null&&(v=Function.prototype);var B=Object.getOwnPropertyDescriptor(v,y);if(B===void 0){var E=Object.getPrototypeOf(v);return E===null?void 0:p(E,y,w)}else{if("value"in B)return B.value;var _=B.get;return _===void 0?void 0:_.call(w)}},o=i(0),l=f(o),A=i(7),u=f(A);function f(p){return p&&p.__esModule?p:{default:p}}function h(p,v){if(!(p instanceof v))throw new TypeError("Cannot call a class as a function")}function d(p,v){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:p}function m(p,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);p.prototype=Object.create(v&&v.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(p,v):p.__proto__=v)}var g="\uFEFF",x=function(p){m(v,p);function v(y){h(this,v);var w=d(this,(v.__proto__||Object.getPrototypeOf(v)).call(this,y));return w.contentNode=document.createElement("span"),w.contentNode.setAttribute("contenteditable",!1),[].slice.call(w.domNode.childNodes).forEach(function(B){w.contentNode.appendChild(B)}),w.leftGuard=document.createTextNode(g),w.rightGuard=document.createTextNode(g),w.domNode.appendChild(w.leftGuard),w.domNode.appendChild(w.contentNode),w.domNode.appendChild(w.rightGuard),w}return a(v,[{key:"index",value:function(w,B){return w===this.leftGuard?0:w===this.rightGuard?1:s(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"index",this).call(this,w,B)}},{key:"restore",value:function(w){var B=void 0,E=void 0,_=w.data.split(g).join("");if(w===this.leftGuard)if(this.prev instanceof u.default){var F=this.prev.length();this.prev.insertAt(F,_),B={startNode:this.prev.domNode,startOffset:F+_.length}}else E=document.createTextNode(_),this.parent.insertBefore(l.default.create(E),this),B={startNode:E,startOffset:_.length};else w===this.rightGuard&&(this.next instanceof u.default?(this.next.insertAt(0,_),B={startNode:this.next.domNode,startOffset:_.length}):(E=document.createTextNode(_),this.parent.insertBefore(l.default.create(E),this.next),B={startNode:E,startOffset:_.length}));return w.data=g,B}},{key:"update",value:function(w,B){var E=this;w.forEach(function(_){if(_.type==="characterData"&&(_.target===E.leftGuard||_.target===E.rightGuard)){var F=E.restore(_.target);F&&(B.range=F)}})}}]),v}(l.default.Embed);n.default=x},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.AlignStyle=n.AlignClass=n.AlignAttribute=void 0;var a=i(0),s=o(a);function o(h){return h&&h.__esModule?h:{default:h}}var l={scope:s.default.Scope.BLOCK,whitelist:["right","center","justify"]},A=new s.default.Attributor.Attribute("align","align",l),u=new s.default.Attributor.Class("align","ql-align",l),f=new s.default.Attributor.Style("align","text-align",l);n.AlignAttribute=A,n.AlignClass=u,n.AlignStyle=f},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.BackgroundStyle=n.BackgroundClass=void 0;var a=i(0),s=l(a),o=i(26);function l(f){return f&&f.__esModule?f:{default:f}}var A=new s.default.Attributor.Class("background","ql-bg",{scope:s.default.Scope.INLINE}),u=new o.ColorAttributor("background","background-color",{scope:s.default.Scope.INLINE});n.BackgroundClass=A,n.BackgroundStyle=u},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.DirectionStyle=n.DirectionClass=n.DirectionAttribute=void 0;var a=i(0),s=o(a);function o(h){return h&&h.__esModule?h:{default:h}}var l={scope:s.default.Scope.BLOCK,whitelist:["rtl"]},A=new s.default.Attributor.Attribute("direction","dir",l),u=new s.default.Attributor.Class("direction","ql-direction",l),f=new s.default.Attributor.Style("direction","direction",l);n.DirectionAttribute=A,n.DirectionClass=u,n.DirectionStyle=f},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.FontClass=n.FontStyle=void 0;var a=function(){function p(v,y){for(var w=0;w<y.length;w++){var B=y[w];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(v,B.key,B)}}return function(v,y,w){return y&&p(v.prototype,y),w&&p(v,w),v}}(),s=function p(v,y,w){v===null&&(v=Function.prototype);var B=Object.getOwnPropertyDescriptor(v,y);if(B===void 0){var E=Object.getPrototypeOf(v);return E===null?void 0:p(E,y,w)}else{if("value"in B)return B.value;var _=B.get;return _===void 0?void 0:_.call(w)}},o=i(0),l=A(o);function A(p){return p&&p.__esModule?p:{default:p}}function u(p,v){if(!(p instanceof v))throw new TypeError("Cannot call a class as a function")}function f(p,v){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:p}function h(p,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);p.prototype=Object.create(v&&v.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(p,v):p.__proto__=v)}var d={scope:l.default.Scope.INLINE,whitelist:["serif","monospace"]},m=new l.default.Attributor.Class("font","ql-font",d),g=function(p){h(v,p);function v(){return u(this,v),f(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return a(v,[{key:"value",value:function(w){return s(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"value",this).call(this,w).replace(/["']/g,"")}}]),v}(l.default.Attributor.Style),x=new g("font","font-family",d);n.FontStyle=x,n.FontClass=m},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SizeStyle=n.SizeClass=void 0;var a=i(0),s=o(a);function o(u){return u&&u.__esModule?u:{default:u}}var l=new s.default.Attributor.Class("size","ql-size",{scope:s.default.Scope.INLINE,whitelist:["small","large","huge"]}),A=new s.default.Attributor.Style("size","font-size",{scope:s.default.Scope.INLINE,whitelist:["10px","18px","32px"]});n.SizeClass=l,n.SizeStyle=A},function(r,n,i){r.exports={align:{"":i(76),center:i(77),right:i(78),justify:i(79)},background:i(80),blockquote:i(81),bold:i(82),clean:i(83),code:i(58),"code-block":i(58),color:i(84),direction:{"":i(85),rtl:i(86)},float:{center:i(87),full:i(88),left:i(89),right:i(90)},formula:i(91),header:{1:i(92),2:i(93)},italic:i(94),image:i(95),indent:{"+1":i(96),"-1":i(97)},link:i(98),list:{ordered:i(99),bullet:i(100),check:i(101)},script:{sub:i(102),super:i(103)},strike:i(104),underline:i(105),video:i(106)}},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.getLastChangeIndex=n.default=void 0;var a=function(){function y(w,B){for(var E=0;E<B.length;E++){var _=B[E];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(w,_.key,_)}}return function(w,B,E){return B&&y(w.prototype,B),E&&y(w,E),w}}(),s=i(0),o=h(s),l=i(5),A=h(l),u=i(9),f=h(u);function h(y){return y&&y.__esModule?y:{default:y}}function d(y,w){if(!(y instanceof w))throw new TypeError("Cannot call a class as a function")}function m(y,w){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:y}function g(y,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);y.prototype=Object.create(w&&w.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(y,w):y.__proto__=w)}var x=function(y){g(w,y);function w(B,E){d(this,w);var _=m(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,B,E));return _.lastRecorded=0,_.ignoreChange=!1,_.clear(),_.quill.on(A.default.events.EDITOR_CHANGE,function(F,T,I,S){F!==A.default.events.TEXT_CHANGE||_.ignoreChange||(!_.options.userOnly||S===A.default.sources.USER?_.record(T,I):_.transform(T))}),_.quill.keyboard.addBinding({key:"Z",shortKey:!0},_.undo.bind(_)),_.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},_.redo.bind(_)),/Win/i.test(navigator.platform)&&_.quill.keyboard.addBinding({key:"Y",shortKey:!0},_.redo.bind(_)),_}return a(w,[{key:"change",value:function(E,_){if(this.stack[E].length!==0){var F=this.stack[E].pop();this.stack[_].push(F),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(F[E],A.default.sources.USER),this.ignoreChange=!1;var T=v(F[E]);this.quill.setSelection(T)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(E,_){if(E.ops.length!==0){this.stack.redo=[];var F=this.quill.getContents().diff(_),T=Date.now();if(this.lastRecorded+this.options.delay>T&&this.stack.undo.length>0){var I=this.stack.undo.pop();F=F.compose(I.undo),E=I.redo.compose(E)}else this.lastRecorded=T;this.stack.undo.push({redo:E,undo:F}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(E){this.stack.undo.forEach(function(_){_.undo=E.transform(_.undo,!0),_.redo=E.transform(_.redo,!0)}),this.stack.redo.forEach(function(_){_.undo=E.transform(_.undo,!0),_.redo=E.transform(_.redo,!0)})}},{key:"undo",value:function(){this.change("undo","redo")}}]),w}(f.default);x.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};function p(y){var w=y.ops[y.ops.length-1];return w==null?!1:w.insert!=null?typeof w.insert=="string"&&w.insert.endsWith(`
`):w.attributes!=null?Object.keys(w.attributes).some(function(B){return o.default.query(B,o.default.Scope.BLOCK)!=null}):!1}function v(y){var w=y.reduce(function(E,_){return E+=_.delete||0,E},0),B=y.length()-w;return p(y)&&(B-=1),B}n.default=x,n.getLastChangeIndex=v},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BaseTooltip=void 0;var a=function(){function k(U,P){for(var D=0;D<P.length;D++){var O=P[D];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(U,O.key,O)}}return function(U,P,D){return P&&k(U.prototype,P),D&&k(U,D),U}}(),s=function k(U,P,D){U===null&&(U=Function.prototype);var O=Object.getOwnPropertyDescriptor(U,P);if(O===void 0){var z=Object.getPrototypeOf(U);return z===null?void 0:k(z,P,D)}else{if("value"in O)return O.value;var J=O.get;return J===void 0?void 0:J.call(D)}},o=i(3),l=T(o),A=i(2),u=T(A),f=i(8),h=T(f),d=i(23),m=T(d),g=i(34),x=T(g),p=i(59),v=T(p),y=i(60),w=T(y),B=i(28),E=T(B),_=i(61),F=T(_);function T(k){return k&&k.__esModule?k:{default:k}}function I(k,U){if(!(k instanceof U))throw new TypeError("Cannot call a class as a function")}function S(k,U){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return U&&(typeof U=="object"||typeof U=="function")?U:k}function C(k,U){if(typeof U!="function"&&U!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof U);k.prototype=Object.create(U&&U.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),U&&(Object.setPrototypeOf?Object.setPrototypeOf(k,U):k.__proto__=U)}var L=[!1,"center","right","justify"],R=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],W=[!1,"serif","monospace"],G=["1","2","3",!1],V=["small",!1,"large","huge"],X=function(k){C(U,k);function U(P,D){I(this,U);var O=S(this,(U.__proto__||Object.getPrototypeOf(U)).call(this,P,D)),z=function J(Y){if(!document.body.contains(P.root))return document.body.removeEventListener("click",J);O.tooltip!=null&&!O.tooltip.root.contains(Y.target)&&document.activeElement!==O.tooltip.textbox&&!O.quill.hasFocus()&&O.tooltip.hide(),O.pickers!=null&&O.pickers.forEach(function(le){le.container.contains(Y.target)||le.close()})};return P.emitter.listenDOM("click",document.body,z),O}return a(U,[{key:"addModule",value:function(D){var O=s(U.prototype.__proto__||Object.getPrototypeOf(U.prototype),"addModule",this).call(this,D);return D==="toolbar"&&this.extendToolbar(O),O}},{key:"buildButtons",value:function(D,O){D.forEach(function(z){var J=z.getAttribute("class")||"";J.split(/\s+/).forEach(function(Y){if(Y.startsWith("ql-")&&(Y=Y.slice(3),O[Y]!=null))if(Y==="direction")z.innerHTML=O[Y][""]+O[Y].rtl;else if(typeof O[Y]=="string")z.innerHTML=O[Y];else{var le=z.value||"";le!=null&&O[Y][le]&&(z.innerHTML=O[Y][le])}})})}},{key:"buildPickers",value:function(D,O){var z=this;this.pickers=D.map(function(Y){if(Y.classList.contains("ql-align"))return Y.querySelector("option")==null&&H(Y,L),new w.default(Y,O.align);if(Y.classList.contains("ql-background")||Y.classList.contains("ql-color")){var le=Y.classList.contains("ql-background")?"background":"color";return Y.querySelector("option")==null&&H(Y,R,le==="background"?"#ffffff":"#000000"),new v.default(Y,O[le])}else return Y.querySelector("option")==null&&(Y.classList.contains("ql-font")?H(Y,W):Y.classList.contains("ql-header")?H(Y,G):Y.classList.contains("ql-size")&&H(Y,V)),new E.default(Y)});var J=function(){z.pickers.forEach(function(le){le.update()})};this.quill.on(h.default.events.EDITOR_CHANGE,J)}}]),U}(x.default);X.DEFAULTS=(0,l.default)(!0,{},x.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var U=this,P=this.container.querySelector("input.ql-image[type=file]");P==null&&(P=document.createElement("input"),P.setAttribute("type","file"),P.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),P.classList.add("ql-image"),P.addEventListener("change",function(){if(P.files!=null&&P.files[0]!=null){var D=new FileReader;D.onload=function(O){var z=U.quill.getSelection(!0);U.quill.updateContents(new u.default().retain(z.index).delete(z.length).insert({image:O.target.result}),h.default.sources.USER),U.quill.setSelection(z.index+1,h.default.sources.SILENT),P.value=""},D.readAsDataURL(P.files[0])}}),this.container.appendChild(P)),P.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var Q=function(k){C(U,k);function U(P,D){I(this,U);var O=S(this,(U.__proto__||Object.getPrototypeOf(U)).call(this,P,D));return O.textbox=O.root.querySelector('input[type="text"]'),O.listen(),O}return a(U,[{key:"listen",value:function(){var D=this;this.textbox.addEventListener("keydown",function(O){m.default.match(O,"enter")?(D.save(),O.preventDefault()):m.default.match(O,"escape")&&(D.cancel(),O.preventDefault())})}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),O!=null?this.textbox.value=O:D!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+D)||""),this.root.setAttribute("data-mode",D)}},{key:"restoreFocus",value:function(){var D=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=D}},{key:"save",value:function(){var D=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":{var O=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",D,h.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",D,h.default.sources.USER)),this.quill.root.scrollTop=O;break}case"video":D=K(D);case"formula":{if(!D)break;var z=this.quill.getSelection(!0);if(z!=null){var J=z.index+z.length;this.quill.insertEmbed(J,this.root.getAttribute("data-mode"),D,h.default.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(J+1," ",h.default.sources.USER),this.quill.setSelection(J+2,h.default.sources.USER)}break}}this.textbox.value="",this.hide()}}]),U}(F.default);function K(k){var U=k.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||k.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return U?(U[1]||"https")+"://www.youtube.com/embed/"+U[2]+"?showinfo=0":(U=k.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?(U[1]||"https")+"://player.vimeo.com/video/"+U[2]+"/":k}function H(k,U){var P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;U.forEach(function(D){var O=document.createElement("option");D===P?O.setAttribute("selected","selected"):O.setAttribute("value",D),k.appendChild(O)})}n.BaseTooltip=Q,n.default=X},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function s(){this.head=this.tail=null,this.length=0}return s.prototype.append=function(){for(var o=[],l=0;l<arguments.length;l++)o[l]=arguments[l];this.insertBefore(o[0],null),o.length>1&&this.append.apply(this,o.slice(1))},s.prototype.contains=function(o){for(var l,A=this.iterator();l=A();)if(l===o)return!0;return!1},s.prototype.insertBefore=function(o,l){o&&(o.next=l,l!=null?(o.prev=l.prev,l.prev!=null&&(l.prev.next=o),l.prev=o,l===this.head&&(this.head=o)):this.tail!=null?(this.tail.next=o,o.prev=this.tail,this.tail=o):(o.prev=null,this.head=this.tail=o),this.length+=1)},s.prototype.offset=function(o){for(var l=0,A=this.head;A!=null;){if(A===o)return l;l+=A.length(),A=A.next}return-1},s.prototype.remove=function(o){this.contains(o)&&(o.prev!=null&&(o.prev.next=o.next),o.next!=null&&(o.next.prev=o.prev),o===this.head&&(this.head=o.next),o===this.tail&&(this.tail=o.prev),this.length-=1)},s.prototype.iterator=function(o){return o===void 0&&(o=this.head),function(){var l=o;return o!=null&&(o=o.next),l}},s.prototype.find=function(o,l){l===void 0&&(l=!1);for(var A,u=this.iterator();A=u();){var f=A.length();if(o<f||l&&o===f&&(A.next==null||A.next.length()!==0))return[A,o];o-=f}return[null,0]},s.prototype.forEach=function(o){for(var l,A=this.iterator();l=A();)o(l)},s.prototype.forEachAt=function(o,l,A){if(!(l<=0))for(var u=this.find(o),f=u[0],h=u[1],d,m=o-h,g=this.iterator(f);(d=g())&&m<o+l;){var x=d.length();o>m?A(d,o-m,Math.min(l,m+x-o)):A(d,0,Math.min(x,o+l-m)),m+=x}},s.prototype.map=function(o){return this.reduce(function(l,A){return l.push(o(A)),l},[])},s.prototype.reduce=function(o,l){for(var A,u=this.iterator();A=u();)l=o(l,A);return l},s}();n.default=a},function(r,n,i){var a=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,d){h.__proto__=d}||function(h,d){for(var m in d)d.hasOwnProperty(m)&&(h[m]=d[m])};return function(h,d){f(h,d);function m(){this.constructor=h}h.prototype=d===null?Object.create(d):(m.prototype=d.prototype,new m)}}();Object.defineProperty(n,"__esModule",{value:!0});var s=i(17),o=i(1),l={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},A=100,u=function(f){a(h,f);function h(d){var m=f.call(this,d)||this;return m.scroll=m,m.observer=new MutationObserver(function(g){m.update(g)}),m.observer.observe(m.domNode,l),m.attach(),m}return h.prototype.detach=function(){f.prototype.detach.call(this),this.observer.disconnect()},h.prototype.deleteAt=function(d,m){this.update(),d===0&&m===this.length()?this.children.forEach(function(g){g.remove()}):f.prototype.deleteAt.call(this,d,m)},h.prototype.formatAt=function(d,m,g,x){this.update(),f.prototype.formatAt.call(this,d,m,g,x)},h.prototype.insertAt=function(d,m,g){this.update(),f.prototype.insertAt.call(this,d,m,g)},h.prototype.optimize=function(d,m){var g=this;d===void 0&&(d=[]),m===void 0&&(m={}),f.prototype.optimize.call(this,m);for(var x=[].slice.call(this.observer.takeRecords());x.length>0;)d.push(x.pop());for(var p=function(B,E){E===void 0&&(E=!0),!(B==null||B===g)&&B.domNode.parentNode!=null&&(B.domNode[o.DATA_KEY].mutations==null&&(B.domNode[o.DATA_KEY].mutations=[]),E&&p(B.parent))},v=function(B){B.domNode[o.DATA_KEY]==null||B.domNode[o.DATA_KEY].mutations==null||(B instanceof s.default&&B.children.forEach(v),B.optimize(m))},y=d,w=0;y.length>0;w+=1){if(w>=A)throw new Error("[Parchment] Maximum optimize iterations reached");for(y.forEach(function(B){var E=o.find(B.target,!0);E!=null&&(E.domNode===B.target&&(B.type==="childList"?(p(o.find(B.previousSibling,!1)),[].forEach.call(B.addedNodes,function(_){var F=o.find(_,!1);p(F,!1),F instanceof s.default&&F.children.forEach(function(T){p(T,!1)})})):B.type==="attributes"&&p(E.prev)),p(E))}),this.children.forEach(v),y=[].slice.call(this.observer.takeRecords()),x=y.slice();x.length>0;)d.push(x.pop())}},h.prototype.update=function(d,m){var g=this;m===void 0&&(m={}),d=d||this.observer.takeRecords(),d.map(function(x){var p=o.find(x.target,!0);return p==null?null:p.domNode[o.DATA_KEY].mutations==null?(p.domNode[o.DATA_KEY].mutations=[x],p):(p.domNode[o.DATA_KEY].mutations.push(x),null)}).forEach(function(x){x==null||x===g||x.domNode[o.DATA_KEY]==null||x.update(x.domNode[o.DATA_KEY].mutations||[],m)}),this.domNode[o.DATA_KEY].mutations!=null&&f.prototype.update.call(this,this.domNode[o.DATA_KEY].mutations,m),this.optimize(d,m)},h.blotName="scroll",h.defaultChild="block",h.scope=o.Scope.BLOCK_BLOT,h.tagName="DIV",h}(s.default);n.default=u},function(r,n,i){var a=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,h){f.__proto__=h}||function(f,h){for(var d in h)h.hasOwnProperty(d)&&(f[d]=h[d])};return function(f,h){u(f,h);function d(){this.constructor=f}f.prototype=h===null?Object.create(h):(d.prototype=h.prototype,new d)}}();Object.defineProperty(n,"__esModule",{value:!0});var s=i(18),o=i(1);function l(u,f){if(Object.keys(u).length!==Object.keys(f).length)return!1;for(var h in u)if(u[h]!==f[h])return!1;return!0}var A=function(u){a(f,u);function f(){return u!==null&&u.apply(this,arguments)||this}return f.formats=function(h){if(h.tagName!==f.tagName)return u.formats.call(this,h)},f.prototype.format=function(h,d){var m=this;h===this.statics.blotName&&!d?(this.children.forEach(function(g){g instanceof s.default||(g=g.wrap(f.blotName,!0)),m.attributes.copy(g)}),this.unwrap()):u.prototype.format.call(this,h,d)},f.prototype.formatAt=function(h,d,m,g){if(this.formats()[m]!=null||o.query(m,o.Scope.ATTRIBUTE)){var x=this.isolate(h,d);x.format(m,g)}else u.prototype.formatAt.call(this,h,d,m,g)},f.prototype.optimize=function(h){u.prototype.optimize.call(this,h);var d=this.formats();if(Object.keys(d).length===0)return this.unwrap();var m=this.next;m instanceof f&&m.prev===this&&l(d,m.formats())&&(m.moveChildren(this),m.remove())},f.blotName="inline",f.scope=o.Scope.INLINE_BLOT,f.tagName="SPAN",f}(s.default);n.default=A},function(r,n,i){var a=this&&this.__extends||function(){var A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var h in f)f.hasOwnProperty(h)&&(u[h]=f[h])};return function(u,f){A(u,f);function h(){this.constructor=u}u.prototype=f===null?Object.create(f):(h.prototype=f.prototype,new h)}}();Object.defineProperty(n,"__esModule",{value:!0});var s=i(18),o=i(1),l=function(A){a(u,A);function u(){return A!==null&&A.apply(this,arguments)||this}return u.formats=function(f){var h=o.query(u.blotName).tagName;if(f.tagName!==h)return A.formats.call(this,f)},u.prototype.format=function(f,h){o.query(f,o.Scope.BLOCK)!=null&&(f===this.statics.blotName&&!h?this.replaceWith(u.blotName):A.prototype.format.call(this,f,h))},u.prototype.formatAt=function(f,h,d,m){o.query(d,o.Scope.BLOCK)!=null?this.format(d,m):A.prototype.formatAt.call(this,f,h,d,m)},u.prototype.insertAt=function(f,h,d){if(d==null||o.query(h,o.Scope.INLINE)!=null)A.prototype.insertAt.call(this,f,h,d);else{var m=this.split(f),g=o.create(h,d);m.parent.insertBefore(g,m)}},u.prototype.update=function(f,h){navigator.userAgent.match(/Trident/)?this.build():A.prototype.update.call(this,f,h)},u.blotName="block",u.scope=o.Scope.BLOCK_BLOT,u.tagName="P",u}(s.default);n.default=l},function(r,n,i){var a=this&&this.__extends||function(){var l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,u){A.__proto__=u}||function(A,u){for(var f in u)u.hasOwnProperty(f)&&(A[f]=u[f])};return function(A,u){l(A,u);function f(){this.constructor=A}A.prototype=u===null?Object.create(u):(f.prototype=u.prototype,new f)}}();Object.defineProperty(n,"__esModule",{value:!0});var s=i(19),o=function(l){a(A,l);function A(){return l!==null&&l.apply(this,arguments)||this}return A.formats=function(u){},A.prototype.format=function(u,f){l.prototype.formatAt.call(this,0,this.length(),u,f)},A.prototype.formatAt=function(u,f,h,d){u===0&&f===this.length()?this.format(h,d):l.prototype.formatAt.call(this,u,f,h,d)},A.prototype.formats=function(){return this.statics.formats(this.domNode)},A}(s.default);n.default=o},function(r,n,i){var a=this&&this.__extends||function(){var A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var h in f)f.hasOwnProperty(h)&&(u[h]=f[h])};return function(u,f){A(u,f);function h(){this.constructor=u}u.prototype=f===null?Object.create(f):(h.prototype=f.prototype,new h)}}();Object.defineProperty(n,"__esModule",{value:!0});var s=i(19),o=i(1),l=function(A){a(u,A);function u(f){var h=A.call(this,f)||this;return h.text=h.statics.value(h.domNode),h}return u.create=function(f){return document.createTextNode(f)},u.value=function(f){var h=f.data;return h.normalize&&(h=h.normalize()),h},u.prototype.deleteAt=function(f,h){this.domNode.data=this.text=this.text.slice(0,f)+this.text.slice(f+h)},u.prototype.index=function(f,h){return this.domNode===f?h:-1},u.prototype.insertAt=function(f,h,d){d==null?(this.text=this.text.slice(0,f)+h+this.text.slice(f),this.domNode.data=this.text):A.prototype.insertAt.call(this,f,h,d)},u.prototype.length=function(){return this.text.length},u.prototype.optimize=function(f){A.prototype.optimize.call(this,f),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof u&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},u.prototype.position=function(f,h){return[this.domNode,f]},u.prototype.split=function(f,h){if(h===void 0&&(h=!1),!h){if(f===0)return this;if(f===this.length())return this.next}var d=o.create(this.domNode.splitText(f));return this.parent.insertBefore(d,this.next),this.text=this.statics.value(this.domNode),d},u.prototype.update=function(f,h){var d=this;f.some(function(m){return m.type==="characterData"&&m.target===d.domNode})&&(this.text=this.statics.value(this.domNode))},u.prototype.value=function(){return this.text},u.blotName="text",u.scope=o.Scope.INLINE_BLOT,u}(s.default);n.default=l},function(r,n,i){var a=document.createElement("div");if(a.classList.toggle("test-class",!1),a.classList.contains("test-class")){var s=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(o,l){return arguments.length>1&&!this.contains(o)==!l?l:s.call(this,o)}}String.prototype.startsWith||(String.prototype.startsWith=function(o,l){return l=l||0,this.substr(l,o.length)===o}),String.prototype.endsWith||(String.prototype.endsWith=function(o,l){var A=this.toString();(typeof l!="number"||!isFinite(l)||Math.floor(l)!==l||l>A.length)&&(l=A.length),l-=o.length;var u=A.indexOf(o,l);return u!==-1&&u===l}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(l){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof l!="function")throw new TypeError("predicate must be a function");for(var A=Object(this),u=A.length>>>0,f=arguments[1],h,d=0;d<u;d++)if(h=A[d],l.call(f,h,d,A))return h}}),document.addEventListener("DOMContentLoaded",function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)})},function(r,n){var i=-1,a=1,s=0;function o(w,B,E){if(w==B)return w?[[s,w]]:[];(E<0||w.length<E)&&(E=null);var _=f(w,B),F=w.substring(0,_);w=w.substring(_),B=B.substring(_),_=h(w,B);var T=w.substring(w.length-_);w=w.substring(0,w.length-_),B=B.substring(0,B.length-_);var I=l(w,B);return F&&I.unshift([s,F]),T&&I.push([s,T]),m(I),E!=null&&(I=p(I,E)),I=v(I),I}function l(w,B){var E;if(!w)return[[a,B]];if(!B)return[[i,w]];var _=w.length>B.length?w:B,F=w.length>B.length?B:w,T=_.indexOf(F);if(T!=-1)return E=[[a,_.substring(0,T)],[s,F],[a,_.substring(T+F.length)]],w.length>B.length&&(E[0][0]=E[2][0]=i),E;if(F.length==1)return[[i,w],[a,B]];var I=d(w,B);if(I){var S=I[0],C=I[1],L=I[2],R=I[3],W=I[4],G=o(S,L),V=o(C,R);return G.concat([[s,W]],V)}return A(w,B)}function A(w,B){for(var E=w.length,_=B.length,F=Math.ceil((E+_)/2),T=F,I=2*F,S=new Array(I),C=new Array(I),L=0;L<I;L++)S[L]=-1,C[L]=-1;S[T+1]=0,C[T+1]=0;for(var R=E-_,W=R%2!=0,G=0,V=0,X=0,Q=0,K=0;K<F;K++){for(var H=-K+G;H<=K-V;H+=2){var k=T+H,U;H==-K||H!=K&&S[k-1]<S[k+1]?U=S[k+1]:U=S[k-1]+1;for(var P=U-H;U<E&&P<_&&w.charAt(U)==B.charAt(P);)U++,P++;if(S[k]=U,U>E)V+=2;else if(P>_)G+=2;else if(W){var D=T+R-H;if(D>=0&&D<I&&C[D]!=-1){var O=E-C[D];if(U>=O)return u(w,B,U,P)}}}for(var z=-K+X;z<=K-Q;z+=2){var D=T+z,O;z==-K||z!=K&&C[D-1]<C[D+1]?O=C[D+1]:O=C[D-1]+1;for(var J=O-z;O<E&&J<_&&w.charAt(E-O-1)==B.charAt(_-J-1);)O++,J++;if(C[D]=O,O>E)Q+=2;else if(J>_)X+=2;else if(!W){var k=T+R-z;if(k>=0&&k<I&&S[k]!=-1){var U=S[k],P=T+U-k;if(O=E-O,U>=O)return u(w,B,U,P)}}}}return[[i,w],[a,B]]}function u(w,B,E,_){var F=w.substring(0,E),T=B.substring(0,_),I=w.substring(E),S=B.substring(_),C=o(F,T),L=o(I,S);return C.concat(L)}function f(w,B){if(!w||!B||w.charAt(0)!=B.charAt(0))return 0;for(var E=0,_=Math.min(w.length,B.length),F=_,T=0;E<F;)w.substring(T,F)==B.substring(T,F)?(E=F,T=E):_=F,F=Math.floor((_-E)/2+E);return F}function h(w,B){if(!w||!B||w.charAt(w.length-1)!=B.charAt(B.length-1))return 0;for(var E=0,_=Math.min(w.length,B.length),F=_,T=0;E<F;)w.substring(w.length-F,w.length-T)==B.substring(B.length-F,B.length-T)?(E=F,T=E):_=F,F=Math.floor((_-E)/2+E);return F}function d(w,B){var E=w.length>B.length?w:B,_=w.length>B.length?B:w;if(E.length<4||_.length*2<E.length)return null;function F(V,X,Q){for(var K=V.substring(Q,Q+Math.floor(V.length/4)),H=-1,k="",U,P,D,O;(H=X.indexOf(K,H+1))!=-1;){var z=f(V.substring(Q),X.substring(H)),J=h(V.substring(0,Q),X.substring(0,H));k.length<J+z&&(k=X.substring(H-J,H)+X.substring(H,H+z),U=V.substring(0,Q-J),P=V.substring(Q+z),D=X.substring(0,H-J),O=X.substring(H+z))}return k.length*2>=V.length?[U,P,D,O,k]:null}var T=F(E,_,Math.ceil(E.length/4)),I=F(E,_,Math.ceil(E.length/2)),S;if(!T&&!I)return null;I?T?S=T[4].length>I[4].length?T:I:S=I:S=T;var C,L,R,W;w.length>B.length?(C=S[0],L=S[1],R=S[2],W=S[3]):(R=S[0],W=S[1],C=S[2],L=S[3]);var G=S[4];return[C,L,R,W,G]}function m(w){w.push([s,""]);for(var B=0,E=0,_=0,F="",T="",I;B<w.length;)switch(w[B][0]){case a:_++,T+=w[B][1],B++;break;case i:E++,F+=w[B][1],B++;break;case s:E+_>1?(E!==0&&_!==0&&(I=f(T,F),I!==0&&(B-E-_>0&&w[B-E-_-1][0]==s?w[B-E-_-1][1]+=T.substring(0,I):(w.splice(0,0,[s,T.substring(0,I)]),B++),T=T.substring(I),F=F.substring(I)),I=h(T,F),I!==0&&(w[B][1]=T.substring(T.length-I)+w[B][1],T=T.substring(0,T.length-I),F=F.substring(0,F.length-I))),E===0?w.splice(B-_,E+_,[a,T]):_===0?w.splice(B-E,E+_,[i,F]):w.splice(B-E-_,E+_,[i,F],[a,T]),B=B-E-_+(E?1:0)+(_?1:0)+1):B!==0&&w[B-1][0]==s?(w[B-1][1]+=w[B][1],w.splice(B,1)):B++,_=0,E=0,F="",T="";break}w[w.length-1][1]===""&&w.pop();var S=!1;for(B=1;B<w.length-1;)w[B-1][0]==s&&w[B+1][0]==s&&(w[B][1].substring(w[B][1].length-w[B-1][1].length)==w[B-1][1]?(w[B][1]=w[B-1][1]+w[B][1].substring(0,w[B][1].length-w[B-1][1].length),w[B+1][1]=w[B-1][1]+w[B+1][1],w.splice(B-1,1),S=!0):w[B][1].substring(0,w[B+1][1].length)==w[B+1][1]&&(w[B-1][1]+=w[B+1][1],w[B][1]=w[B][1].substring(w[B+1][1].length)+w[B+1][1],w.splice(B+1,1),S=!0)),B++;S&&m(w)}var g=o;g.INSERT=a,g.DELETE=i,g.EQUAL=s,r.exports=g;function x(w,B){if(B===0)return[s,w];for(var E=0,_=0;_<w.length;_++){var F=w[_];if(F[0]===i||F[0]===s){var T=E+F[1].length;if(B===T)return[_+1,w];if(B<T){w=w.slice();var I=B-E,S=[F[0],F[1].slice(0,I)],C=[F[0],F[1].slice(I)];return w.splice(_,1,S,C),[_+1,w]}else E=T}}throw new Error("cursor_pos is out of bounds!")}function p(w,B){var E=x(w,B),_=E[1],F=E[0],T=_[F],I=_[F+1];if(T==null)return w;if(T[0]!==s)return w;if(I!=null&&T[1]+I[1]===I[1]+T[1])return _.splice(F,2,I,T),y(_,F,2);if(I!=null&&I[1].indexOf(T[1])===0){_.splice(F,2,[I[0],T[1]],[0,T[1]]);var S=I[1].slice(T[1].length);return S.length>0&&_.splice(F+2,0,[I[0],S]),y(_,F,3)}else return w}function v(w){for(var B=!1,E=function(I){return I.charCodeAt(0)>=56320&&I.charCodeAt(0)<=57343},_=function(I){return I.charCodeAt(I.length-1)>=55296&&I.charCodeAt(I.length-1)<=56319},F=2;F<w.length;F+=1)w[F-2][0]===s&&_(w[F-2][1])&&w[F-1][0]===i&&E(w[F-1][1])&&w[F][0]===a&&E(w[F][1])&&(B=!0,w[F-1][1]=w[F-2][1].slice(-1)+w[F-1][1],w[F][1]=w[F-2][1].slice(-1)+w[F][1],w[F-2][1]=w[F-2][1].slice(0,-1));if(!B)return w;for(var T=[],F=0;F<w.length;F+=1)w[F][1].length>0&&T.push(w[F]);return T}function y(w,B,E){for(var _=B+E-1;_>=0&&_>=B-1;_--)if(_+1<w.length){var F=w[_],T=w[_+1];F[0]===T[1]&&w.splice(_,2,[F[0],F[1]+T[1]])}return w}},function(r,n){n=r.exports=typeof Object.keys=="function"?Object.keys:i,n.shim=i;function i(a){var s=[];for(var o in a)s.push(o);return s}},function(r,n){var i=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";n=r.exports=i?a:s,n.supported=a;function a(o){return Object.prototype.toString.call(o)=="[object Arguments]"}n.unsupported=s;function s(o){return o&&typeof o=="object"&&typeof o.length=="number"&&Object.prototype.hasOwnProperty.call(o,"callee")&&!Object.prototype.propertyIsEnumerable.call(o,"callee")||!1}},function(r,n){var i=Object.prototype.hasOwnProperty,a="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(a=!1));function o(A,u,f){this.fn=A,this.context=u,this.once=f||!1}function l(){this._events=new s,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],f,h;if(this._eventsCount===0)return u;for(h in f=this._events)i.call(f,h)&&u.push(a?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(f)):u},l.prototype.listeners=function(u,f){var h=a?a+u:u,d=this._events[h];if(f)return!!d;if(!d)return[];if(d.fn)return[d.fn];for(var m=0,g=d.length,x=new Array(g);m<g;m++)x[m]=d[m].fn;return x},l.prototype.emit=function(u,f,h,d,m,g){var x=a?a+u:u;if(!this._events[x])return!1;var p=this._events[x],v=arguments.length,y,w;if(p.fn){switch(p.once&&this.removeListener(u,p.fn,void 0,!0),v){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,f),!0;case 3:return p.fn.call(p.context,f,h),!0;case 4:return p.fn.call(p.context,f,h,d),!0;case 5:return p.fn.call(p.context,f,h,d,m),!0;case 6:return p.fn.call(p.context,f,h,d,m,g),!0}for(w=1,y=new Array(v-1);w<v;w++)y[w-1]=arguments[w];p.fn.apply(p.context,y)}else{var B=p.length,E;for(w=0;w<B;w++)switch(p[w].once&&this.removeListener(u,p[w].fn,void 0,!0),v){case 1:p[w].fn.call(p[w].context);break;case 2:p[w].fn.call(p[w].context,f);break;case 3:p[w].fn.call(p[w].context,f,h);break;case 4:p[w].fn.call(p[w].context,f,h,d);break;default:if(!y)for(E=1,y=new Array(v-1);E<v;E++)y[E-1]=arguments[E];p[w].fn.apply(p[w].context,y)}}return!0},l.prototype.on=function(u,f,h){var d=new o(f,h||this),m=a?a+u:u;return this._events[m]?this._events[m].fn?this._events[m]=[this._events[m],d]:this._events[m].push(d):(this._events[m]=d,this._eventsCount++),this},l.prototype.once=function(u,f,h){var d=new o(f,h||this,!0),m=a?a+u:u;return this._events[m]?this._events[m].fn?this._events[m]=[this._events[m],d]:this._events[m].push(d):(this._events[m]=d,this._eventsCount++),this},l.prototype.removeListener=function(u,f,h,d){var m=a?a+u:u;if(!this._events[m])return this;if(!f)return--this._eventsCount===0?this._events=new s:delete this._events[m],this;var g=this._events[m];if(g.fn)g.fn===f&&(!d||g.once)&&(!h||g.context===h)&&(--this._eventsCount===0?this._events=new s:delete this._events[m]);else{for(var x=0,p=[],v=g.length;x<v;x++)(g[x].fn!==f||d&&!g[x].once||h&&g[x].context!==h)&&p.push(g[x]);p.length?this._events[m]=p.length===1?p[0]:p:--this._eventsCount===0?this._events=new s:delete this._events[m]}return this},l.prototype.removeAllListeners=function(u){var f;return u?(f=a?a+u:u,this._events[f]&&(--this._eventsCount===0?this._events=new s:delete this._events[f])):(this._events=new s,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prototype.setMaxListeners=function(){return this},l.prefixed=a,l.EventEmitter=l,typeof r<"u"&&(r.exports=l)},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.matchText=n.matchSpacing=n.matchNewline=n.matchBlot=n.matchAttributor=n.default=void 0;var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(xe){return typeof xe}:function(xe){return xe&&typeof Symbol=="function"&&xe.constructor===Symbol&&xe!==Symbol.prototype?"symbol":typeof xe},s=function(){function xe(se,be){var Te=[],pe=!0,je=!1,Ve=void 0;try{for(var We=se[Symbol.iterator](),ft;!(pe=(ft=We.next()).done)&&(Te.push(ft.value),!(be&&Te.length===be));pe=!0);}catch(Et){je=!0,Ve=Et}finally{try{!pe&&We.return&&We.return()}finally{if(je)throw Ve}}return Te}return function(se,be){if(Array.isArray(se))return se;if(Symbol.iterator in Object(se))return xe(se,be);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function xe(se,be){for(var Te=0;Te<be.length;Te++){var pe=be[Te];pe.enumerable=pe.enumerable||!1,pe.configurable=!0,"value"in pe&&(pe.writable=!0),Object.defineProperty(se,pe.key,pe)}}return function(se,be,Te){return be&&xe(se.prototype,be),Te&&xe(se,Te),se}}(),l=i(3),A=C(l),u=i(2),f=C(u),h=i(0),d=C(h),m=i(5),g=C(m),x=i(10),p=C(x),v=i(9),y=C(v),w=i(36),B=i(37),E=i(13),_=C(E),F=i(26),T=i(38),I=i(39),S=i(40);function C(xe){return xe&&xe.__esModule?xe:{default:xe}}function L(xe,se,be){return se in xe?Object.defineProperty(xe,se,{value:be,enumerable:!0,configurable:!0,writable:!0}):xe[se]=be,xe}function R(xe,se){if(!(xe instanceof se))throw new TypeError("Cannot call a class as a function")}function W(xe,se){if(!xe)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return se&&(typeof se=="object"||typeof se=="function")?se:xe}function G(xe,se){if(typeof se!="function"&&se!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof se);xe.prototype=Object.create(se&&se.prototype,{constructor:{value:xe,enumerable:!1,writable:!0,configurable:!0}}),se&&(Object.setPrototypeOf?Object.setPrototypeOf(xe,se):xe.__proto__=se)}var V=(0,p.default)("quill:clipboard"),X="__ql-matcher",Q=[[Node.TEXT_NODE,Be],[Node.TEXT_NODE,qe],["br",we],[Node.ELEMENT_NODE,qe],[Node.ELEMENT_NODE,le],[Node.ELEMENT_NODE,Fe],[Node.ELEMENT_NODE,Y],[Node.ELEMENT_NODE,he],["li",Me],["b",J.bind(J,"bold")],["i",J.bind(J,"italic")],["style",ne]],K=[w.AlignAttribute,T.DirectionAttribute].reduce(function(xe,se){return xe[se.keyName]=se,xe},{}),H=[w.AlignStyle,B.BackgroundStyle,F.ColorStyle,T.DirectionStyle,I.FontStyle,S.SizeStyle].reduce(function(xe,se){return xe[se.keyName]=se,xe},{}),k=function(xe){G(se,xe);function se(be,Te){R(this,se);var pe=W(this,(se.__proto__||Object.getPrototypeOf(se)).call(this,be,Te));return pe.quill.root.addEventListener("paste",pe.onPaste.bind(pe)),pe.container=pe.quill.addContainer("ql-clipboard"),pe.container.setAttribute("contenteditable",!0),pe.container.setAttribute("tabindex",-1),pe.matchers=[],Q.concat(pe.options.matchers).forEach(function(je){var Ve=s(je,2),We=Ve[0],ft=Ve[1];!Te.matchVisual&&ft===Fe||pe.addMatcher(We,ft)}),pe}return o(se,[{key:"addMatcher",value:function(Te,pe){this.matchers.push([Te,pe])}},{key:"convert",value:function(Te){if(typeof Te=="string")return this.container.innerHTML=Te.replace(/\>\r?\n +\</g,"><"),this.convert();var pe=this.quill.getFormat(this.quill.selection.savedRange.index);if(pe[_.default.blotName]){var je=this.container.innerText;return this.container.innerHTML="",new f.default().insert(je,L({},_.default.blotName,pe[_.default.blotName]))}var Ve=this.prepareMatching(),We=s(Ve,2),ft=We[0],Et=We[1],ut=z(this.container,ft,Et);return D(ut,`
`)&&ut.ops[ut.ops.length-1].attributes==null&&(ut=ut.compose(new f.default().retain(ut.length()-1).delete(1))),V.log("convert",this.container.innerHTML,ut),this.container.innerHTML="",ut}},{key:"dangerouslyPasteHTML",value:function(Te,pe){var je=arguments.length>2&&arguments[2]!==void 0?arguments[2]:g.default.sources.API;if(typeof Te=="string")this.quill.setContents(this.convert(Te),pe),this.quill.setSelection(0,g.default.sources.SILENT);else{var Ve=this.convert(pe);this.quill.updateContents(new f.default().retain(Te).concat(Ve),je),this.quill.setSelection(Te+Ve.length(),g.default.sources.SILENT)}}},{key:"onPaste",value:function(Te){var pe=this;if(!(Te.defaultPrevented||!this.quill.isEnabled())){var je=this.quill.getSelection(),Ve=new f.default().retain(je.index),We=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(g.default.sources.SILENT),setTimeout(function(){Ve=Ve.concat(pe.convert()).delete(je.length),pe.quill.updateContents(Ve,g.default.sources.USER),pe.quill.setSelection(Ve.length()-je.length,g.default.sources.SILENT),pe.quill.scrollingContainer.scrollTop=We,pe.quill.focus()},1)}}},{key:"prepareMatching",value:function(){var Te=this,pe=[],je=[];return this.matchers.forEach(function(Ve){var We=s(Ve,2),ft=We[0],Et=We[1];switch(ft){case Node.TEXT_NODE:je.push(Et);break;case Node.ELEMENT_NODE:pe.push(Et);break;default:[].forEach.call(Te.container.querySelectorAll(ft),function(ut){ut[X]=ut[X]||[],ut[X].push(Et)});break}}),[pe,je]}}]),se}(y.default);k.DEFAULTS={matchers:[],matchVisual:!0};function U(xe,se,be){return(typeof se>"u"?"undefined":a(se))==="object"?Object.keys(se).reduce(function(Te,pe){return U(Te,pe,se[pe])},xe):xe.reduce(function(Te,pe){return pe.attributes&&pe.attributes[se]?Te.push(pe):Te.insert(pe.insert,(0,A.default)({},L({},se,be),pe.attributes))},new f.default)}function P(xe){if(xe.nodeType!==Node.ELEMENT_NODE)return{};var se="__ql-computed-style";return xe[se]||(xe[se]=window.getComputedStyle(xe))}function D(xe,se){for(var be="",Te=xe.ops.length-1;Te>=0&&be.length<se.length;--Te){var pe=xe.ops[Te];if(typeof pe.insert!="string")break;be=pe.insert+be}return be.slice(-1*se.length)===se}function O(xe){if(xe.childNodes.length===0)return!1;var se=P(xe);return["block","list-item"].indexOf(se.display)>-1}function z(xe,se,be){return xe.nodeType===xe.TEXT_NODE?be.reduce(function(Te,pe){return pe(xe,Te)},new f.default):xe.nodeType===xe.ELEMENT_NODE?[].reduce.call(xe.childNodes||[],function(Te,pe){var je=z(pe,se,be);return pe.nodeType===xe.ELEMENT_NODE&&(je=se.reduce(function(Ve,We){return We(pe,Ve)},je),je=(pe[X]||[]).reduce(function(Ve,We){return We(pe,Ve)},je)),Te.concat(je)},new f.default):new f.default}function J(xe,se,be){return U(be,xe,!0)}function Y(xe,se){var be=d.default.Attributor.Attribute.keys(xe),Te=d.default.Attributor.Class.keys(xe),pe=d.default.Attributor.Style.keys(xe),je={};return be.concat(Te).concat(pe).forEach(function(Ve){var We=d.default.query(Ve,d.default.Scope.ATTRIBUTE);We!=null&&(je[We.attrName]=We.value(xe),je[We.attrName])||(We=K[Ve],We!=null&&(We.attrName===Ve||We.keyName===Ve)&&(je[We.attrName]=We.value(xe)||void 0),We=H[Ve],We!=null&&(We.attrName===Ve||We.keyName===Ve)&&(We=H[Ve],je[We.attrName]=We.value(xe)||void 0))}),Object.keys(je).length>0&&(se=U(se,je)),se}function le(xe,se){var be=d.default.query(xe);if(be==null)return se;if(be.prototype instanceof d.default.Embed){var Te={},pe=be.value(xe);pe!=null&&(Te[be.blotName]=pe,se=new f.default().insert(Te,be.formats(xe)))}else typeof be.formats=="function"&&(se=U(se,be.blotName,be.formats(xe)));return se}function we(xe,se){return D(se,`
`)||se.insert(`
`),se}function ne(){return new f.default}function Me(xe,se){var be=d.default.query(xe);if(be==null||be.blotName!=="list-item"||!D(se,`
`))return se;for(var Te=-1,pe=xe.parentNode;!pe.classList.contains("ql-clipboard");)(d.default.query(pe)||{}).blotName==="list"&&(Te+=1),pe=pe.parentNode;return Te<=0?se:se.compose(new f.default().retain(se.length()-1).retain(1,{indent:Te}))}function qe(xe,se){return D(se,`
`)||(O(xe)||se.length()>0&&xe.nextSibling&&O(xe.nextSibling))&&se.insert(`
`),se}function Fe(xe,se){if(O(xe)&&xe.nextElementSibling!=null&&!D(se,`

`)){var be=xe.offsetHeight+parseFloat(P(xe).marginTop)+parseFloat(P(xe).marginBottom);xe.nextElementSibling.offsetTop>xe.offsetTop+be*1.5&&se.insert(`
`)}return se}function he(xe,se){var be={},Te=xe.style||{};return Te.fontStyle&&P(xe).fontStyle==="italic"&&(be.italic=!0),Te.fontWeight&&(P(xe).fontWeight.startsWith("bold")||parseInt(P(xe).fontWeight)>=700)&&(be.bold=!0),Object.keys(be).length>0&&(se=U(se,be)),parseFloat(Te.textIndent||0)>0&&(se=new f.default().insert("	").concat(se)),se}function Be(xe,se){var be=xe.data;if(xe.parentNode.tagName==="O:P")return se.insert(be.trim());if(be.trim().length===0&&xe.parentNode.classList.contains("ql-clipboard"))return se;if(!P(xe.parentNode).whiteSpace.startsWith("pre")){var Te=function(je,Ve){return Ve=Ve.replace(/[^\u00a0]/g,""),Ve.length<1&&je?" ":Ve};be=be.replace(/\r\n/g," ").replace(/\n/g," "),be=be.replace(/\s\s+/g,Te.bind(Te,!0)),(xe.previousSibling==null&&O(xe.parentNode)||xe.previousSibling!=null&&O(xe.previousSibling))&&(be=be.replace(/^\s+/,Te.bind(Te,!1))),(xe.nextSibling==null&&O(xe.parentNode)||xe.nextSibling!=null&&O(xe.nextSibling))&&(be=be.replace(/\s+$/,Te.bind(Te,!1)))}return se.insert(be)}n.default=k,n.matchAttributor=Y,n.matchBlot=le,n.matchNewline=qe,n.matchSpacing=Fe,n.matchText=Be},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function m(g,x){for(var p=0;p<x.length;p++){var v=x[p];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(g,v.key,v)}}return function(g,x,p){return x&&m(g.prototype,x),p&&m(g,p),g}}(),s=function m(g,x,p){g===null&&(g=Function.prototype);var v=Object.getOwnPropertyDescriptor(g,x);if(v===void 0){var y=Object.getPrototypeOf(g);return y===null?void 0:m(y,x,p)}else{if("value"in v)return v.value;var w=v.get;return w===void 0?void 0:w.call(p)}},o=i(6),l=A(o);function A(m){return m&&m.__esModule?m:{default:m}}function u(m,g){if(!(m instanceof g))throw new TypeError("Cannot call a class as a function")}function f(m,g){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:m}function h(m,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);m.prototype=Object.create(g&&g.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(m,g):m.__proto__=g)}var d=function(m){h(g,m);function g(){return u(this,g),f(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return a(g,[{key:"optimize",value:function(p){s(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"optimize",this).call(this,p),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return s(g.__proto__||Object.getPrototypeOf(g),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),g}(l.default);d.blotName="bold",d.tagName=["STRONG","B"],n.default=d},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.addControls=n.default=void 0;var a=function(){function S(C,L){var R=[],W=!0,G=!1,V=void 0;try{for(var X=C[Symbol.iterator](),Q;!(W=(Q=X.next()).done)&&(R.push(Q.value),!(L&&R.length===L));W=!0);}catch(K){G=!0,V=K}finally{try{!W&&X.return&&X.return()}finally{if(G)throw V}}return R}return function(C,L){if(Array.isArray(C))return C;if(Symbol.iterator in Object(C))return S(C,L);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function S(C,L){for(var R=0;R<L.length;R++){var W=L[R];W.enumerable=W.enumerable||!1,W.configurable=!0,"value"in W&&(W.writable=!0),Object.defineProperty(C,W.key,W)}}return function(C,L,R){return L&&S(C.prototype,L),R&&S(C,R),C}}(),o=i(2),l=p(o),A=i(0),u=p(A),f=i(5),h=p(f),d=i(10),m=p(d),g=i(9),x=p(g);function p(S){return S&&S.__esModule?S:{default:S}}function v(S,C,L){return C in S?Object.defineProperty(S,C,{value:L,enumerable:!0,configurable:!0,writable:!0}):S[C]=L,S}function y(S,C){if(!(S instanceof C))throw new TypeError("Cannot call a class as a function")}function w(S,C){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C&&(typeof C=="object"||typeof C=="function")?C:S}function B(S,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof C);S.prototype=Object.create(C&&C.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),C&&(Object.setPrototypeOf?Object.setPrototypeOf(S,C):S.__proto__=C)}var E=(0,m.default)("quill:toolbar"),_=function(S){B(C,S);function C(L,R){y(this,C);var W=w(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,L,R));if(Array.isArray(W.options.container)){var G=document.createElement("div");T(G,W.options.container),L.container.parentNode.insertBefore(G,L.container),W.container=G}else typeof W.options.container=="string"?W.container=document.querySelector(W.options.container):W.container=W.options.container;if(!(W.container instanceof HTMLElement)){var V;return V=E.error("Container required for toolbar",W.options),w(W,V)}return W.container.classList.add("ql-toolbar"),W.controls=[],W.handlers={},Object.keys(W.options.handlers).forEach(function(X){W.addHandler(X,W.options.handlers[X])}),[].forEach.call(W.container.querySelectorAll("button, select"),function(X){W.attach(X)}),W.quill.on(h.default.events.EDITOR_CHANGE,function(X,Q){X===h.default.events.SELECTION_CHANGE&&W.update(Q)}),W.quill.on(h.default.events.SCROLL_OPTIMIZE,function(){var X=W.quill.selection.getRange(),Q=a(X,1),K=Q[0];W.update(K)}),W}return s(C,[{key:"addHandler",value:function(R,W){this.handlers[R]=W}},{key:"attach",value:function(R){var W=this,G=[].find.call(R.classList,function(X){return X.indexOf("ql-")===0});if(G){if(G=G.slice(3),R.tagName==="BUTTON"&&R.setAttribute("type","button"),this.handlers[G]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[G]==null){E.warn("ignoring attaching to disabled format",G,R);return}if(u.default.query(G)==null){E.warn("ignoring attaching to nonexistent format",G,R);return}}var V=R.tagName==="SELECT"?"change":"click";R.addEventListener(V,function(X){var Q=void 0;if(R.tagName==="SELECT"){if(R.selectedIndex<0)return;var K=R.options[R.selectedIndex];K.hasAttribute("selected")?Q=!1:Q=K.value||!1}else R.classList.contains("ql-active")?Q=!1:Q=R.value||!R.hasAttribute("value"),X.preventDefault();W.quill.focus();var H=W.quill.selection.getRange(),k=a(H,1),U=k[0];if(W.handlers[G]!=null)W.handlers[G].call(W,Q);else if(u.default.query(G).prototype instanceof u.default.Embed){if(Q=prompt("Enter "+G),!Q)return;W.quill.updateContents(new l.default().retain(U.index).delete(U.length).insert(v({},G,Q)),h.default.sources.USER)}else W.quill.format(G,Q,h.default.sources.USER);W.update(U)}),this.controls.push([G,R])}}},{key:"update",value:function(R){var W=R==null?{}:this.quill.getFormat(R);this.controls.forEach(function(G){var V=a(G,2),X=V[0],Q=V[1];if(Q.tagName==="SELECT"){var K=void 0;if(R==null)K=null;else if(W[X]==null)K=Q.querySelector("option[selected]");else if(!Array.isArray(W[X])){var H=W[X];typeof H=="string"&&(H=H.replace(/\"/g,'\\"')),K=Q.querySelector('option[value="'+H+'"]')}K==null?(Q.value="",Q.selectedIndex=-1):K.selected=!0}else if(R==null)Q.classList.remove("ql-active");else if(Q.hasAttribute("value")){var k=W[X]===Q.getAttribute("value")||W[X]!=null&&W[X].toString()===Q.getAttribute("value")||W[X]==null&&!Q.getAttribute("value");Q.classList.toggle("ql-active",k)}else Q.classList.toggle("ql-active",W[X]!=null)})}}]),C}(x.default);_.DEFAULTS={};function F(S,C,L){var R=document.createElement("button");R.setAttribute("type","button"),R.classList.add("ql-"+C),L!=null&&(R.value=L),S.appendChild(R)}function T(S,C){Array.isArray(C[0])||(C=[C]),C.forEach(function(L){var R=document.createElement("span");R.classList.add("ql-formats"),L.forEach(function(W){if(typeof W=="string")F(R,W);else{var G=Object.keys(W)[0],V=W[G];Array.isArray(V)?I(R,G,V):F(R,G,V)}}),S.appendChild(R)})}function I(S,C,L){var R=document.createElement("select");R.classList.add("ql-"+C),L.forEach(function(W){var G=document.createElement("option");W!==!1?G.setAttribute("value",W):G.setAttribute("selected","selected"),R.appendChild(G)}),S.appendChild(R)}_.DEFAULTS={container:null,handlers:{clean:function(){var C=this,L=this.quill.getSelection();if(L!=null)if(L.length==0){var R=this.quill.getFormat();Object.keys(R).forEach(function(W){u.default.query(W,u.default.Scope.INLINE)!=null&&C.quill.format(W,!1)})}else this.quill.removeFormat(L,h.default.sources.USER)},direction:function(C){var L=this.quill.getFormat().align;C==="rtl"&&L==null?this.quill.format("align","right",h.default.sources.USER):!C&&L==="right"&&this.quill.format("align",!1,h.default.sources.USER),this.quill.format("direction",C,h.default.sources.USER)},indent:function(C){var L=this.quill.getSelection(),R=this.quill.getFormat(L),W=parseInt(R.indent||0);if(C==="+1"||C==="-1"){var G=C==="+1"?1:-1;R.direction==="rtl"&&(G*=-1),this.quill.format("indent",W+G,h.default.sources.USER)}},link:function(C){C===!0&&(C=prompt("Enter link URL:")),this.quill.format("link",C,h.default.sources.USER)},list:function(C){var L=this.quill.getSelection(),R=this.quill.getFormat(L);C==="check"?R.list==="checked"||R.list==="unchecked"?this.quill.format("list",!1,h.default.sources.USER):this.quill.format("list","unchecked",h.default.sources.USER):this.quill.format("list",C,h.default.sources.USER)}}},n.default=_,n.addControls=T},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function m(g,x){for(var p=0;p<x.length;p++){var v=x[p];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(g,v.key,v)}}return function(g,x,p){return x&&m(g.prototype,x),p&&m(g,p),g}}(),s=function m(g,x,p){g===null&&(g=Function.prototype);var v=Object.getOwnPropertyDescriptor(g,x);if(v===void 0){var y=Object.getPrototypeOf(g);return y===null?void 0:m(y,x,p)}else{if("value"in v)return v.value;var w=v.get;return w===void 0?void 0:w.call(p)}},o=i(28),l=A(o);function A(m){return m&&m.__esModule?m:{default:m}}function u(m,g){if(!(m instanceof g))throw new TypeError("Cannot call a class as a function")}function f(m,g){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:m}function h(m,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);m.prototype=Object.create(g&&g.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(m,g):m.__proto__=g)}var d=function(m){h(g,m);function g(x,p){u(this,g);var v=f(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,x));return v.label.innerHTML=p,v.container.classList.add("ql-color-picker"),[].slice.call(v.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(y){y.classList.add("ql-primary")}),v}return a(g,[{key:"buildItem",value:function(p){var v=s(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"buildItem",this).call(this,p);return v.style.backgroundColor=p.getAttribute("value")||"",v}},{key:"selectItem",value:function(p,v){s(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"selectItem",this).call(this,p,v);var y=this.label.querySelector(".ql-color-label"),w=p&&p.getAttribute("data-value")||"";y&&(y.tagName==="line"?y.style.stroke=w:y.style.fill=w)}}]),g}(l.default);n.default=d},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function m(g,x){for(var p=0;p<x.length;p++){var v=x[p];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(g,v.key,v)}}return function(g,x,p){return x&&m(g.prototype,x),p&&m(g,p),g}}(),s=function m(g,x,p){g===null&&(g=Function.prototype);var v=Object.getOwnPropertyDescriptor(g,x);if(v===void 0){var y=Object.getPrototypeOf(g);return y===null?void 0:m(y,x,p)}else{if("value"in v)return v.value;var w=v.get;return w===void 0?void 0:w.call(p)}},o=i(28),l=A(o);function A(m){return m&&m.__esModule?m:{default:m}}function u(m,g){if(!(m instanceof g))throw new TypeError("Cannot call a class as a function")}function f(m,g){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:m}function h(m,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);m.prototype=Object.create(g&&g.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(m,g):m.__proto__=g)}var d=function(m){h(g,m);function g(x,p){u(this,g);var v=f(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,x));return v.container.classList.add("ql-icon-picker"),[].forEach.call(v.container.querySelectorAll(".ql-picker-item"),function(y){y.innerHTML=p[y.getAttribute("data-value")||""]}),v.defaultItem=v.container.querySelector(".ql-selected"),v.selectItem(v.defaultItem),v}return a(g,[{key:"selectItem",value:function(p,v){s(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"selectItem",this).call(this,p,v),p=p||this.defaultItem,this.label.innerHTML=p.innerHTML}}]),g}(l.default);n.default=d},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function l(A,u){for(var f=0;f<u.length;f++){var h=u[f];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(A,h.key,h)}}return function(A,u,f){return u&&l(A.prototype,u),f&&l(A,f),A}}();function s(l,A){if(!(l instanceof A))throw new TypeError("Cannot call a class as a function")}var o=function(){function l(A,u){var f=this;s(this,l),this.quill=A,this.boundsContainer=u||document.body,this.root=A.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){f.root.style.marginTop=-1*f.quill.root.scrollTop+"px"}),this.hide()}return a(l,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(u){var f=u.left+u.width/2-this.root.offsetWidth/2,h=u.bottom+this.quill.root.scrollTop;this.root.style.left=f+"px",this.root.style.top=h+"px",this.root.classList.remove("ql-flip");var d=this.boundsContainer.getBoundingClientRect(),m=this.root.getBoundingClientRect(),g=0;if(m.right>d.right&&(g=d.right-m.right,this.root.style.left=f+g+"px"),m.left<d.left&&(g=d.left-m.left,this.root.style.left=f+g+"px"),m.bottom>d.bottom){var x=m.bottom-m.top,p=u.bottom-u.top+x;this.root.style.top=h-p+"px",this.root.classList.add("ql-flip")}return g}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),l}();n.default=o},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function I(S,C){var L=[],R=!0,W=!1,G=void 0;try{for(var V=S[Symbol.iterator](),X;!(R=(X=V.next()).done)&&(L.push(X.value),!(C&&L.length===C));R=!0);}catch(Q){W=!0,G=Q}finally{try{!R&&V.return&&V.return()}finally{if(W)throw G}}return L}return function(S,C){if(Array.isArray(S))return S;if(Symbol.iterator in Object(S))return I(S,C);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function I(S,C,L){S===null&&(S=Function.prototype);var R=Object.getOwnPropertyDescriptor(S,C);if(R===void 0){var W=Object.getPrototypeOf(S);return W===null?void 0:I(W,C,L)}else{if("value"in R)return R.value;var G=R.get;return G===void 0?void 0:G.call(L)}},o=function(){function I(S,C){for(var L=0;L<C.length;L++){var R=C[L];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(S,R.key,R)}}return function(S,C,L){return C&&I(S.prototype,C),L&&I(S,L),S}}(),l=i(3),A=y(l),u=i(8),f=y(u),h=i(43),d=y(h),m=i(27),g=y(m),x=i(15),p=i(41),v=y(p);function y(I){return I&&I.__esModule?I:{default:I}}function w(I,S){if(!(I instanceof S))throw new TypeError("Cannot call a class as a function")}function B(I,S){if(!I)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:I}function E(I,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);I.prototype=Object.create(S&&S.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(I,S):I.__proto__=S)}var _=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],F=function(I){E(S,I);function S(C,L){w(this,S),L.modules.toolbar!=null&&L.modules.toolbar.container==null&&(L.modules.toolbar.container=_);var R=B(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,C,L));return R.quill.container.classList.add("ql-snow"),R}return o(S,[{key:"extendToolbar",value:function(L){L.container.classList.add("ql-snow"),this.buildButtons([].slice.call(L.container.querySelectorAll("button")),v.default),this.buildPickers([].slice.call(L.container.querySelectorAll("select")),v.default),this.tooltip=new T(this.quill,this.options.bounds),L.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function(R,W){L.handlers.link.call(L,!W.format.link)})}}]),S}(d.default);F.DEFAULTS=(0,A.default)(!0,{},d.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(S){if(S){var C=this.quill.getSelection();if(C==null||C.length==0)return;var L=this.quill.getText(C);/^\S+@\S+\.\S+$/.test(L)&&L.indexOf("mailto:")!==0&&(L="mailto:"+L);var R=this.quill.theme.tooltip;R.edit("link",L)}else this.quill.format("link",!1)}}}}});var T=function(I){E(S,I);function S(C,L){w(this,S);var R=B(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,C,L));return R.preview=R.root.querySelector("a.ql-preview"),R}return o(S,[{key:"listen",value:function(){var L=this;s(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function(R){L.root.classList.contains("ql-editing")?L.save():L.edit("link",L.preview.textContent),R.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function(R){if(L.linkRange!=null){var W=L.linkRange;L.restoreFocus(),L.quill.formatText(W,"link",!1,f.default.sources.USER),delete L.linkRange}R.preventDefault(),L.hide()}),this.quill.on(f.default.events.SELECTION_CHANGE,function(R,W,G){if(R!=null){if(R.length===0&&G===f.default.sources.USER){var V=L.quill.scroll.descendant(g.default,R.index),X=a(V,2),Q=X[0],K=X[1];if(Q!=null){L.linkRange=new x.Range(R.index-K,Q.length());var H=g.default.formats(Q.domNode);L.preview.textContent=H,L.preview.setAttribute("href",H),L.show(),L.position(L.quill.getBounds(L.linkRange));return}}else delete L.linkRange;L.hide()}})}},{key:"show",value:function(){s(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),S}(h.BaseTooltip);T.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),n.default=F},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(29),s=pe(a),o=i(36),l=i(38),A=i(64),u=i(65),f=pe(u),h=i(66),d=pe(h),m=i(67),g=pe(m),x=i(37),p=i(26),v=i(39),y=i(40),w=i(56),B=pe(w),E=i(68),_=pe(E),F=i(27),T=pe(F),I=i(69),S=pe(I),C=i(70),L=pe(C),R=i(71),W=pe(R),G=i(72),V=pe(G),X=i(73),Q=pe(X),K=i(13),H=pe(K),k=i(74),U=pe(k),P=i(75),D=pe(P),O=i(57),z=pe(O),J=i(41),Y=pe(J),le=i(28),we=pe(le),ne=i(59),Me=pe(ne),qe=i(60),Fe=pe(qe),he=i(61),Be=pe(he),xe=i(108),se=pe(xe),be=i(62),Te=pe(be);function pe(je){return je&&je.__esModule?je:{default:je}}s.default.register({"attributors/attribute/direction":l.DirectionAttribute,"attributors/class/align":o.AlignClass,"attributors/class/background":x.BackgroundClass,"attributors/class/color":p.ColorClass,"attributors/class/direction":l.DirectionClass,"attributors/class/font":v.FontClass,"attributors/class/size":y.SizeClass,"attributors/style/align":o.AlignStyle,"attributors/style/background":x.BackgroundStyle,"attributors/style/color":p.ColorStyle,"attributors/style/direction":l.DirectionStyle,"attributors/style/font":v.FontStyle,"attributors/style/size":y.SizeStyle},!0),s.default.register({"formats/align":o.AlignClass,"formats/direction":l.DirectionClass,"formats/indent":A.IndentClass,"formats/background":x.BackgroundStyle,"formats/color":p.ColorStyle,"formats/font":v.FontClass,"formats/size":y.SizeClass,"formats/blockquote":f.default,"formats/code-block":H.default,"formats/header":d.default,"formats/list":g.default,"formats/bold":B.default,"formats/code":K.Code,"formats/italic":_.default,"formats/link":T.default,"formats/script":S.default,"formats/strike":L.default,"formats/underline":W.default,"formats/image":V.default,"formats/video":Q.default,"formats/list/item":m.ListItem,"modules/formula":U.default,"modules/syntax":D.default,"modules/toolbar":z.default,"themes/bubble":se.default,"themes/snow":Te.default,"ui/icons":Y.default,"ui/picker":we.default,"ui/icon-picker":Fe.default,"ui/color-picker":Me.default,"ui/tooltip":Be.default},!0),n.default=s.default},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.IndentClass=void 0;var a=function(){function g(x,p){for(var v=0;v<p.length;v++){var y=p[v];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(x,y.key,y)}}return function(x,p,v){return p&&g(x.prototype,p),v&&g(x,v),x}}(),s=function g(x,p,v){x===null&&(x=Function.prototype);var y=Object.getOwnPropertyDescriptor(x,p);if(y===void 0){var w=Object.getPrototypeOf(x);return w===null?void 0:g(w,p,v)}else{if("value"in y)return y.value;var B=y.get;return B===void 0?void 0:B.call(v)}},o=i(0),l=A(o);function A(g){return g&&g.__esModule?g:{default:g}}function u(g,x){if(!(g instanceof x))throw new TypeError("Cannot call a class as a function")}function f(g,x){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:g}function h(g,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);g.prototype=Object.create(x&&x.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(g,x):g.__proto__=x)}var d=function(g){h(x,g);function x(){return u(this,x),f(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return a(x,[{key:"add",value:function(v,y){if(y==="+1"||y==="-1"){var w=this.value(v)||0;y=y==="+1"?w+1:w-1}return y===0?(this.remove(v),!0):s(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"add",this).call(this,v,y)}},{key:"canAdd",value:function(v,y){return s(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"canAdd",this).call(this,v,y)||s(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"canAdd",this).call(this,v,parseInt(y))}},{key:"value",value:function(v){return parseInt(s(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"value",this).call(this,v))||void 0}}]),x}(l.default.Attributor.Class),m=new d("indent","ql-indent",{scope:l.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});n.IndentClass=m},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(4),s=o(a);function o(h){return h&&h.__esModule?h:{default:h}}function l(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")}function A(h,d){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:h}function u(h,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);h.prototype=Object.create(d&&d.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(h,d):h.__proto__=d)}var f=function(h){u(d,h);function d(){return l(this,d),A(this,(d.__proto__||Object.getPrototypeOf(d)).apply(this,arguments))}return d}(s.default);f.blotName="blockquote",f.tagName="blockquote",n.default=f},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function d(m,g){for(var x=0;x<g.length;x++){var p=g[x];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,p.key,p)}}return function(m,g,x){return g&&d(m.prototype,g),x&&d(m,x),m}}(),s=i(4),o=l(s);function l(d){return d&&d.__esModule?d:{default:d}}function A(d,m){if(!(d instanceof m))throw new TypeError("Cannot call a class as a function")}function u(d,m){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:d}function f(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);d.prototype=Object.create(m&&m.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(d,m):d.__proto__=m)}var h=function(d){f(m,d);function m(){return A(this,m),u(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return a(m,null,[{key:"formats",value:function(x){return this.tagName.indexOf(x.tagName)+1}}]),m}(o.default);h.blotName="header",h.tagName=["H1","H2","H3","H4","H5","H6"],n.default=h},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.ListItem=void 0;var a=function(){function w(B,E){for(var _=0;_<E.length;_++){var F=E[_];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(B,F.key,F)}}return function(B,E,_){return E&&w(B.prototype,E),_&&w(B,_),B}}(),s=function w(B,E,_){B===null&&(B=Function.prototype);var F=Object.getOwnPropertyDescriptor(B,E);if(F===void 0){var T=Object.getPrototypeOf(B);return T===null?void 0:w(T,E,_)}else{if("value"in F)return F.value;var I=F.get;return I===void 0?void 0:I.call(_)}},o=i(0),l=d(o),A=i(4),u=d(A),f=i(25),h=d(f);function d(w){return w&&w.__esModule?w:{default:w}}function m(w,B,E){return B in w?Object.defineProperty(w,B,{value:E,enumerable:!0,configurable:!0,writable:!0}):w[B]=E,w}function g(w,B){if(!(w instanceof B))throw new TypeError("Cannot call a class as a function")}function x(w,B){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return B&&(typeof B=="object"||typeof B=="function")?B:w}function p(w,B){if(typeof B!="function"&&B!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof B);w.prototype=Object.create(B&&B.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),B&&(Object.setPrototypeOf?Object.setPrototypeOf(w,B):w.__proto__=B)}var v=function(w){p(B,w);function B(){return g(this,B),x(this,(B.__proto__||Object.getPrototypeOf(B)).apply(this,arguments))}return a(B,[{key:"format",value:function(_,F){_===y.blotName&&!F?this.replaceWith(l.default.create(this.statics.scope)):s(B.prototype.__proto__||Object.getPrototypeOf(B.prototype),"format",this).call(this,_,F)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():s(B.prototype.__proto__||Object.getPrototypeOf(B.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(_,F){return this.parent.isolate(this.offset(this.parent),this.length()),_===this.parent.statics.blotName?(this.parent.replaceWith(_,F),this):(this.parent.unwrap(),s(B.prototype.__proto__||Object.getPrototypeOf(B.prototype),"replaceWith",this).call(this,_,F))}}],[{key:"formats",value:function(_){return _.tagName===this.tagName?void 0:s(B.__proto__||Object.getPrototypeOf(B),"formats",this).call(this,_)}}]),B}(u.default);v.blotName="list-item",v.tagName="LI";var y=function(w){p(B,w),a(B,null,[{key:"create",value:function(_){var F=_==="ordered"?"OL":"UL",T=s(B.__proto__||Object.getPrototypeOf(B),"create",this).call(this,F);return(_==="checked"||_==="unchecked")&&T.setAttribute("data-checked",_==="checked"),T}},{key:"formats",value:function(_){if(_.tagName==="OL")return"ordered";if(_.tagName==="UL")return _.hasAttribute("data-checked")?_.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function B(E){g(this,B);var _=x(this,(B.__proto__||Object.getPrototypeOf(B)).call(this,E)),F=function(I){if(I.target.parentNode===E){var S=_.statics.formats(E),C=l.default.find(I.target);S==="checked"?C.format("list","unchecked"):S==="unchecked"&&C.format("list","checked")}};return E.addEventListener("touchstart",F),E.addEventListener("mousedown",F),_}return a(B,[{key:"format",value:function(_,F){this.children.length>0&&this.children.tail.format(_,F)}},{key:"formats",value:function(){return m({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(_,F){if(_ instanceof v)s(B.prototype.__proto__||Object.getPrototypeOf(B.prototype),"insertBefore",this).call(this,_,F);else{var T=F==null?this.length():F.offset(this),I=this.split(T);I.parent.insertBefore(_,I)}}},{key:"optimize",value:function(_){s(B.prototype.__proto__||Object.getPrototypeOf(B.prototype),"optimize",this).call(this,_);var F=this.next;F!=null&&F.prev===this&&F.statics.blotName===this.statics.blotName&&F.domNode.tagName===this.domNode.tagName&&F.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(F.moveChildren(this),F.remove())}},{key:"replace",value:function(_){if(_.statics.blotName!==this.statics.blotName){var F=l.default.create(this.statics.defaultChild);_.moveChildren(F),this.appendChild(F)}s(B.prototype.__proto__||Object.getPrototypeOf(B.prototype),"replace",this).call(this,_)}}]),B}(h.default);y.blotName="list",y.scope=l.default.Scope.BLOCK_BLOT,y.tagName=["OL","UL"],y.defaultChild="list-item",y.allowedChildren=[v],n.ListItem=v,n.default=y},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(56),s=o(a);function o(h){return h&&h.__esModule?h:{default:h}}function l(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")}function A(h,d){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:h}function u(h,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);h.prototype=Object.create(d&&d.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(h,d):h.__proto__=d)}var f=function(h){u(d,h);function d(){return l(this,d),A(this,(d.__proto__||Object.getPrototypeOf(d)).apply(this,arguments))}return d}(s.default);f.blotName="italic",f.tagName=["EM","I"],n.default=f},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function m(g,x){for(var p=0;p<x.length;p++){var v=x[p];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(g,v.key,v)}}return function(g,x,p){return x&&m(g.prototype,x),p&&m(g,p),g}}(),s=function m(g,x,p){g===null&&(g=Function.prototype);var v=Object.getOwnPropertyDescriptor(g,x);if(v===void 0){var y=Object.getPrototypeOf(g);return y===null?void 0:m(y,x,p)}else{if("value"in v)return v.value;var w=v.get;return w===void 0?void 0:w.call(p)}},o=i(6),l=A(o);function A(m){return m&&m.__esModule?m:{default:m}}function u(m,g){if(!(m instanceof g))throw new TypeError("Cannot call a class as a function")}function f(m,g){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:m}function h(m,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);m.prototype=Object.create(g&&g.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(m,g):m.__proto__=g)}var d=function(m){h(g,m);function g(){return u(this,g),f(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return a(g,null,[{key:"create",value:function(p){return p==="super"?document.createElement("sup"):p==="sub"?document.createElement("sub"):s(g.__proto__||Object.getPrototypeOf(g),"create",this).call(this,p)}},{key:"formats",value:function(p){if(p.tagName==="SUB")return"sub";if(p.tagName==="SUP")return"super"}}]),g}(l.default);d.blotName="script",d.tagName=["SUB","SUP"],n.default=d},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(6),s=o(a);function o(h){return h&&h.__esModule?h:{default:h}}function l(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")}function A(h,d){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:h}function u(h,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);h.prototype=Object.create(d&&d.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(h,d):h.__proto__=d)}var f=function(h){u(d,h);function d(){return l(this,d),A(this,(d.__proto__||Object.getPrototypeOf(d)).apply(this,arguments))}return d}(s.default);f.blotName="strike",f.tagName="S",n.default=f},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=i(6),s=o(a);function o(h){return h&&h.__esModule?h:{default:h}}function l(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")}function A(h,d){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d&&(typeof d=="object"||typeof d=="function")?d:h}function u(h,d){if(typeof d!="function"&&d!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof d);h.prototype=Object.create(d&&d.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(h,d):h.__proto__=d)}var f=function(h){u(d,h);function d(){return l(this,d),A(this,(d.__proto__||Object.getPrototypeOf(d)).apply(this,arguments))}return d}(s.default);f.blotName="underline",f.tagName="U",n.default=f},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function x(p,v){for(var y=0;y<v.length;y++){var w=v[y];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(p,w.key,w)}}return function(p,v,y){return v&&x(p.prototype,v),y&&x(p,y),p}}(),s=function x(p,v,y){p===null&&(p=Function.prototype);var w=Object.getOwnPropertyDescriptor(p,v);if(w===void 0){var B=Object.getPrototypeOf(p);return B===null?void 0:x(B,v,y)}else{if("value"in w)return w.value;var E=w.get;return E===void 0?void 0:E.call(y)}},o=i(0),l=u(o),A=i(27);function u(x){return x&&x.__esModule?x:{default:x}}function f(x,p){if(!(x instanceof p))throw new TypeError("Cannot call a class as a function")}function h(x,p){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:x}function d(x,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);x.prototype=Object.create(p&&p.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(x,p):x.__proto__=p)}var m=["alt","height","width"],g=function(x){d(p,x);function p(){return f(this,p),h(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return a(p,[{key:"format",value:function(y,w){m.indexOf(y)>-1?w?this.domNode.setAttribute(y,w):this.domNode.removeAttribute(y):s(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"format",this).call(this,y,w)}}],[{key:"create",value:function(y){var w=s(p.__proto__||Object.getPrototypeOf(p),"create",this).call(this,y);return typeof y=="string"&&w.setAttribute("src",this.sanitize(y)),w}},{key:"formats",value:function(y){return m.reduce(function(w,B){return y.hasAttribute(B)&&(w[B]=y.getAttribute(B)),w},{})}},{key:"match",value:function(y){return/\.(jpe?g|gif|png)$/.test(y)||/^data:image\/.+;base64/.test(y)}},{key:"sanitize",value:function(y){return(0,A.sanitize)(y,["http","https","data"])?y:"//:0"}},{key:"value",value:function(y){return y.getAttribute("src")}}]),p}(l.default.Embed);g.blotName="image",g.tagName="IMG",n.default=g},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function x(p,v){for(var y=0;y<v.length;y++){var w=v[y];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(p,w.key,w)}}return function(p,v,y){return v&&x(p.prototype,v),y&&x(p,y),p}}(),s=function x(p,v,y){p===null&&(p=Function.prototype);var w=Object.getOwnPropertyDescriptor(p,v);if(w===void 0){var B=Object.getPrototypeOf(p);return B===null?void 0:x(B,v,y)}else{if("value"in w)return w.value;var E=w.get;return E===void 0?void 0:E.call(y)}},o=i(4),l=i(27),A=u(l);function u(x){return x&&x.__esModule?x:{default:x}}function f(x,p){if(!(x instanceof p))throw new TypeError("Cannot call a class as a function")}function h(x,p){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:x}function d(x,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);x.prototype=Object.create(p&&p.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(x,p):x.__proto__=p)}var m=["height","width"],g=function(x){d(p,x);function p(){return f(this,p),h(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return a(p,[{key:"format",value:function(y,w){m.indexOf(y)>-1?w?this.domNode.setAttribute(y,w):this.domNode.removeAttribute(y):s(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"format",this).call(this,y,w)}}],[{key:"create",value:function(y){var w=s(p.__proto__||Object.getPrototypeOf(p),"create",this).call(this,y);return w.setAttribute("frameborder","0"),w.setAttribute("allowfullscreen",!0),w.setAttribute("src",this.sanitize(y)),w}},{key:"formats",value:function(y){return m.reduce(function(w,B){return y.hasAttribute(B)&&(w[B]=y.getAttribute(B)),w},{})}},{key:"sanitize",value:function(y){return A.default.sanitize(y)}},{key:"value",value:function(y){return y.getAttribute("src")}}]),p}(o.BlockEmbed);g.blotName="video",g.className="ql-video",g.tagName="IFRAME",n.default=g},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.FormulaBlot=void 0;var a=function(){function y(w,B){for(var E=0;E<B.length;E++){var _=B[E];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(w,_.key,_)}}return function(w,B,E){return B&&y(w.prototype,B),E&&y(w,E),w}}(),s=function y(w,B,E){w===null&&(w=Function.prototype);var _=Object.getOwnPropertyDescriptor(w,B);if(_===void 0){var F=Object.getPrototypeOf(w);return F===null?void 0:y(F,B,E)}else{if("value"in _)return _.value;var T=_.get;return T===void 0?void 0:T.call(E)}},o=i(35),l=d(o),A=i(5),u=d(A),f=i(9),h=d(f);function d(y){return y&&y.__esModule?y:{default:y}}function m(y,w){if(!(y instanceof w))throw new TypeError("Cannot call a class as a function")}function g(y,w){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:y}function x(y,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);y.prototype=Object.create(w&&w.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(y,w):y.__proto__=w)}var p=function(y){x(w,y);function w(){return m(this,w),g(this,(w.__proto__||Object.getPrototypeOf(w)).apply(this,arguments))}return a(w,null,[{key:"create",value:function(E){var _=s(w.__proto__||Object.getPrototypeOf(w),"create",this).call(this,E);return typeof E=="string"&&(window.katex.render(E,_,{throwOnError:!1,errorColor:"#f00"}),_.setAttribute("data-value",E)),_}},{key:"value",value:function(E){return E.getAttribute("data-value")}}]),w}(l.default);p.blotName="formula",p.className="ql-formula",p.tagName="SPAN";var v=function(y){x(w,y),a(w,null,[{key:"register",value:function(){u.default.register(p,!0)}}]);function w(){m(this,w);var B=g(this,(w.__proto__||Object.getPrototypeOf(w)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return B}return w}(h.default);n.FormulaBlot=p,n.default=v},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.CodeToken=n.CodeBlock=void 0;var a=function(){function E(_,F){for(var T=0;T<F.length;T++){var I=F[T];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(_,I.key,I)}}return function(_,F,T){return F&&E(_.prototype,F),T&&E(_,T),_}}(),s=function E(_,F,T){_===null&&(_=Function.prototype);var I=Object.getOwnPropertyDescriptor(_,F);if(I===void 0){var S=Object.getPrototypeOf(_);return S===null?void 0:E(S,F,T)}else{if("value"in I)return I.value;var C=I.get;return C===void 0?void 0:C.call(T)}},o=i(0),l=g(o),A=i(5),u=g(A),f=i(9),h=g(f),d=i(13),m=g(d);function g(E){return E&&E.__esModule?E:{default:E}}function x(E,_){if(!(E instanceof _))throw new TypeError("Cannot call a class as a function")}function p(E,_){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:E}function v(E,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);E.prototype=Object.create(_&&_.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(E,_):E.__proto__=_)}var y=function(E){v(_,E);function _(){return x(this,_),p(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return a(_,[{key:"replaceWith",value:function(T){this.domNode.textContent=this.domNode.textContent,this.attach(),s(_.prototype.__proto__||Object.getPrototypeOf(_.prototype),"replaceWith",this).call(this,T)}},{key:"highlight",value:function(T){var I=this.domNode.textContent;this.cachedText!==I&&((I.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=T(I),this.domNode.normalize(),this.attach()),this.cachedText=I)}}]),_}(m.default);y.className="ql-syntax";var w=new l.default.Attributor.Class("token","hljs",{scope:l.default.Scope.INLINE}),B=function(E){v(_,E),a(_,null,[{key:"register",value:function(){u.default.register(w,!0),u.default.register(y,!0)}}]);function _(F,T){x(this,_);var I=p(this,(_.__proto__||Object.getPrototypeOf(_)).call(this,F,T));if(typeof I.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var S=null;return I.quill.on(u.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(S),S=setTimeout(function(){I.highlight(),S=null},I.options.interval)}),I.highlight(),I}return a(_,[{key:"highlight",value:function(){var T=this;if(!this.quill.selection.composing){this.quill.update(u.default.sources.USER);var I=this.quill.getSelection();this.quill.scroll.descendants(y).forEach(function(S){S.highlight(T.options.highlight)}),this.quill.update(u.default.sources.SILENT),I!=null&&this.quill.setSelection(I,u.default.sources.SILENT)}}}]),_}(h.default);B.DEFAULTS={highlight:function(){return window.hljs==null?null:function(E){var _=window.hljs.highlightAuto(E);return _.value}}(),interval:1e3},n.CodeBlock=y,n.CodeToken=w,n.default=B},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(r,n){r.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(r,n){r.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(r,n){r.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(r,n){r.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(r,n){r.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(r,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BubbleTooltip=void 0;var a=function _(F,T,I){F===null&&(F=Function.prototype);var S=Object.getOwnPropertyDescriptor(F,T);if(S===void 0){var C=Object.getPrototypeOf(F);return C===null?void 0:_(C,T,I)}else{if("value"in S)return S.value;var L=S.get;return L===void 0?void 0:L.call(I)}},s=function(){function _(F,T){for(var I=0;I<T.length;I++){var S=T[I];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(F,S.key,S)}}return function(F,T,I){return T&&_(F.prototype,T),I&&_(F,I),F}}(),o=i(3),l=x(o),A=i(8),u=x(A),f=i(43),h=x(f),d=i(15),m=i(41),g=x(m);function x(_){return _&&_.__esModule?_:{default:_}}function p(_,F){if(!(_ instanceof F))throw new TypeError("Cannot call a class as a function")}function v(_,F){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F&&(typeof F=="object"||typeof F=="function")?F:_}function y(_,F){if(typeof F!="function"&&F!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof F);_.prototype=Object.create(F&&F.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),F&&(Object.setPrototypeOf?Object.setPrototypeOf(_,F):_.__proto__=F)}var w=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],B=function(_){y(F,_);function F(T,I){p(this,F),I.modules.toolbar!=null&&I.modules.toolbar.container==null&&(I.modules.toolbar.container=w);var S=v(this,(F.__proto__||Object.getPrototypeOf(F)).call(this,T,I));return S.quill.container.classList.add("ql-bubble"),S}return s(F,[{key:"extendToolbar",value:function(I){this.tooltip=new E(this.quill,this.options.bounds),this.tooltip.root.appendChild(I.container),this.buildButtons([].slice.call(I.container.querySelectorAll("button")),g.default),this.buildPickers([].slice.call(I.container.querySelectorAll("select")),g.default)}}]),F}(h.default);B.DEFAULTS=(0,l.default)(!0,{},h.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(F){F?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var E=function(_){y(F,_);function F(T,I){p(this,F);var S=v(this,(F.__proto__||Object.getPrototypeOf(F)).call(this,T,I));return S.quill.on(u.default.events.EDITOR_CHANGE,function(C,L,R,W){if(C===u.default.events.SELECTION_CHANGE)if(L!=null&&L.length>0&&W===u.default.sources.USER){S.show(),S.root.style.left="0px",S.root.style.width="",S.root.style.width=S.root.offsetWidth+"px";var G=S.quill.getLines(L.index,L.length);if(G.length===1)S.position(S.quill.getBounds(L));else{var V=G[G.length-1],X=S.quill.getIndex(V),Q=Math.min(V.length()-1,L.index+L.length-X),K=S.quill.getBounds(new d.Range(X,Q));S.position(K)}}else document.activeElement!==S.textbox&&S.quill.hasFocus()&&S.hide()}),S}return s(F,[{key:"listen",value:function(){var I=this;a(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){I.root.classList.remove("ql-editing")}),this.quill.on(u.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!I.root.classList.contains("ql-hidden")){var S=I.quill.getSelection();S!=null&&I.position(I.quill.getBounds(S))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(I){var S=a(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"position",this).call(this,I),C=this.root.querySelector(".ql-tooltip-arrow");if(C.style.marginLeft="",S===0)return S;C.style.marginLeft=-1*S-C.offsetWidth/2+"px"}}]),F}(f.BaseTooltip);E.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),n.BubbleTooltip=E,n.default=B},function(r,n,i){r.exports=i(63)}]).default})})(jT);var Wte=jT.exports,$te=kr&&kr.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)i.hasOwnProperty(a)&&(n[a]=i[a])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),_m=kr&&kr.__assign||function(){return _m=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},_m.apply(this,arguments)},qte=kr&&kr.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var a=arguments[t],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n},k1=kr&&kr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Ws=k1(ve),zte=k1(ck),sh=k1(Vte),SC=k1(Wte),Xte=function(e){$te(t,e);function t(r){var n=e.call(this,r)||this;n.dirtyProps=["modules","formats","bounds","theme","children"],n.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],n.state={generation:0},n.selection=null,n.onEditorChange=function(a,s,o,l){var A,u,f,h;a==="text-change"?(u=(A=n).onEditorChangeText)===null||u===void 0||u.call(A,n.editor.root.innerHTML,s,l,n.unprivilegedEditor):a==="selection-change"&&((h=(f=n).onEditorChangeSelection)===null||h===void 0||h.call(f,s,l,n.unprivilegedEditor))};var i=n.isControlled()?r.value:r.defaultValue;return n.value=i??"",n}return t.prototype.validateProps=function(r){var n;if(Ws.default.Children.count(r.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(Ws.default.Children.count(r.children)){var i=Ws.default.Children.only(r.children);if(((n=i)===null||n===void 0?void 0:n.type)==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.")}if(this.lastDeltaChangeSet&&r.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")},t.prototype.shouldComponentUpdate=function(r,n){var i=this,a;if(this.validateProps(r),!this.editor||this.state.generation!==n.generation)return!0;if("value"in r){var s=this.getEditorContents(),o=(a=r.value,a??"");this.isEqualValue(o,s)||this.setEditorContents(this.editor,o)}return r.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,r.readOnly),qte(this.cleanProps,this.dirtyProps).some(function(l){return!sh.default(r[l],i.props[l])})},t.prototype.shouldComponentRegenerate=function(r){var n=this;return this.dirtyProps.some(function(i){return!sh.default(r[i],n.props[i])})},t.prototype.componentDidMount=function(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())},t.prototype.componentWillUnmount=function(){this.destroyEditor()},t.prototype.componentDidUpdate=function(r,n){var i=this;if(this.editor&&this.shouldComponentRegenerate(r)){var a=this.editor.getContents(),s=this.editor.getSelection();this.regenerationSnapshot={delta:a,selection:s},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.state.generation!==n.generation){var o=this.regenerationSnapshot,a=o.delta,l=o.selection;delete this.regenerationSnapshot,this.instantiateEditor();var A=this.editor;A.setContents(a),EC(function(){return i.setEditorSelection(A,l)})}},t.prototype.instantiateEditor=function(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())},t.prototype.destroyEditor=function(){this.editor&&this.unhookEditor(this.editor)},t.prototype.isControlled=function(){return"value"in this.props},t.prototype.getEditorConfig=function(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,scrollingContainer:this.props.scrollingContainer,tabIndex:this.props.tabIndex,theme:this.props.theme}},t.prototype.getEditor=function(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor},t.prototype.createEditor=function(r,n){var i=new SC.default(r,n);return n.tabIndex!=null&&this.setEditorTabIndex(i,n.tabIndex),this.hookEditor(i),i},t.prototype.hookEditor=function(r){this.unprivilegedEditor=this.makeUnprivilegedEditor(r),r.on("editor-change",this.onEditorChange)},t.prototype.unhookEditor=function(r){r.off("editor-change",this.onEditorChange)},t.prototype.getEditorContents=function(){return this.value},t.prototype.getEditorSelection=function(){return this.selection},t.prototype.isDelta=function(r){return r&&r.ops},t.prototype.isEqualValue=function(r,n){return this.isDelta(r)&&this.isDelta(n)?sh.default(r.ops,n.ops):sh.default(r,n)},t.prototype.setEditorContents=function(r,n){var i=this;this.value=n;var a=this.getEditorSelection();typeof n=="string"?r.setContents(r.clipboard.convert(n)):r.setContents(n),EC(function(){return i.setEditorSelection(r,a)})},t.prototype.setEditorSelection=function(r,n){if(this.selection=n,n){var i=r.getLength();n.index=Math.max(0,Math.min(n.index,i-1)),n.length=Math.max(0,Math.min(n.length,i-1-n.index)),r.setSelection(n)}},t.prototype.setEditorTabIndex=function(r,n){var i,a;!((a=(i=r)===null||i===void 0?void 0:i.scroll)===null||a===void 0)&&a.domNode&&(r.scroll.domNode.tabIndex=n)},t.prototype.setEditorReadOnly=function(r,n){n?r.disable():r.enable()},t.prototype.makeUnprivilegedEditor=function(r){var n=r;return{getHTML:function(){return n.root.innerHTML},getLength:n.getLength.bind(n),getText:n.getText.bind(n),getContents:n.getContents.bind(n),getSelection:n.getSelection.bind(n),getBounds:n.getBounds.bind(n)}},t.prototype.getEditingArea=function(){if(!this.editingArea)throw new Error("Instantiating on missing editing area");var r=zte.default.findDOMNode(this.editingArea);if(!r)throw new Error("Cannot find element for editing area");if(r.nodeType===3)throw new Error("Editing area cannot be a text node");return r},t.prototype.renderEditingArea=function(){var r=this,n=this.props,i=n.children,a=n.preserveWhitespace,s=this.state.generation,o={key:s,ref:function(l){r.editingArea=l}};return Ws.default.Children.count(i)?Ws.default.cloneElement(Ws.default.Children.only(i),o):a?Ws.default.createElement("pre",_m({},o)):Ws.default.createElement("div",_m({},o))},t.prototype.render=function(){var r;return Ws.default.createElement("div",{id:this.props.id,style:this.props.style,key:this.state.generation,className:"quill "+(r=this.props.className,r??""),onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())},t.prototype.onEditorChangeText=function(r,n,i,a){var s,o;if(this.editor){var l=this.isDelta(this.value)?a.getContents():a.getHTML();l!==this.getEditorContents()&&(this.lastDeltaChangeSet=n,this.value=l,(o=(s=this.props).onChange)===null||o===void 0||o.call(s,r,n,i,a))}},t.prototype.onEditorChangeSelection=function(r,n,i){var a,s,o,l,A,u;if(this.editor){var f=this.getEditorSelection(),h=!f&&r,d=f&&!r;sh.default(r,f)||(this.selection=r,(s=(a=this.props).onChangeSelection)===null||s===void 0||s.call(a,r,n,i),h?(l=(o=this.props).onFocus)===null||l===void 0||l.call(o,r,n,i):d&&((u=(A=this.props).onBlur)===null||u===void 0||u.call(A,f,n,i)))}},t.prototype.focus=function(){this.editor&&this.editor.focus()},t.prototype.blur=function(){this.editor&&(this.selection=null,this.editor.blur())},t.displayName="React Quill",t.Quill=SC.default,t.defaultProps={theme:"snow",modules:{},readOnly:!1},t}(Ws.default.Component);function EC(e){Promise.resolve().then(e)}var Yte=Xte;const Jte=fw(Yte);function Vd({value:e,onChange:t,placeholder:r="Enter text here...",minHeight:n="150px",className:i=""}){const a=ve.useRef(null);ve.useEffect(()=>{if(a.current){const l=a.current.getEditor();l.root.dir="ltr"}},[]);const s={toolbar:[["bold","italic","underline"],[{list:"ordered"},{list:"bullet"}],["clean"]]},o=["bold","italic","underline","list","bullet","indent"];return c.jsxs("div",{className:`rich-text-editor ${i}`,style:{direction:"ltr"},children:[c.jsx("style",{jsx:!0,children:`
        .rich-text-editor .ql-container {
          min-height: ${n};
          border-bottom-left-radius: 0.5rem;
          border-bottom-right-radius: 0.5rem;
          background: white;
        }
        .rich-text-editor .ql-toolbar {
          border-top-left-radius: 0.5rem;
          border-top-right-radius: 0.5rem;
          background: #f9fafb;
        }
        .rich-text-editor .ql-editor {
          min-height: ${n};
          direction: ltr;
          text-align: left;
        }
      `}),c.jsx(Jte,{ref:a,theme:"snow",value:e,onChange:t,modules:s,formats:o,placeholder:r})]})}function DT({url:e,title:t,type:r="link",onClose:n}){return ve.useEffect(()=>{console.log("LinkViewer opened with URL:",e),(()=>{try{const a=window.open(e,"_blank",`fullscreen=yes,width=${screen.width},height=${screen.height},left=0,top=0,resizable=yes,scrollbars=yes,toolbar=no,menubar=no,location=no,status=no`);if(a)try{a.moveTo(0,0),a.resizeTo(screen.width,screen.height)}catch{console.log("Could not resize window programmatically")}}catch{console.log("Fullscreen failed, opening regular new tab"),window.open(e,"_blank","noopener,noreferrer")}})(),n()},[e,n]),c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:c.jsx("div",{className:"bg-white rounded-xl shadow-2xl p-8 max-w-md",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Opening Link"}),c.jsx("p",{className:"text-gray-600",children:t}),c.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Opening in fullscreen..."})]})})})}function Ju({activity:e,onClose:t,onAddToLesson:r,isEditing:n=!1,onUpdate:i,initialResource:a=null,onDelete:s}){const{allEyfsStatements:o,eyfsStatements:l,addEyfsToLesson:A,removeEyfsFromLesson:u}=oi(),[f,h]=ve.useState(null),[d,m]=ve.useState(!1),[g,x]=ve.useState(!1),[p,v]=ve.useState(e.eyfsStandards||[]),[y,w]=ve.useState({...e}),[B,E]=ve.useState(n),[_,F]=ve.useState(!1);ve.useState(!1);const[T,I]=ve.useState(null),S=ve.useRef(null),C=ve.useRef(null),L=!i;ve.useEffect(()=>{a&&h(a)},[a]);const R=async()=>{if(S.current)try{d?document.exitFullscreen&&await document.exitFullscreen():S.current.requestFullscreen&&await S.current.requestFullscreen()}catch(P){console.error("Fullscreen error:",P)}};ve.useEffect(()=>{const P=()=>{m(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",P),()=>document.removeEventListener("fullscreenchange",P)},[]),ve.useEffect(()=>{w({...e}),v(e.eyfsStandards||[]),E(n&&!L)},[e,n,L]);const W=()=>{i&&!L&&i({...y,eyfsStandards:p}),E(!1)},G=P=>{var z;if(L)return;const D=(z=P.target.files)==null?void 0:z[0];if(!D)return;const O=new FileReader;O.onload=J=>{var le;const Y=(le=J.target)==null?void 0:le.result;w(we=>({...we,imageLink:Y}))},O.readAsDataURL(D)},V=()=>{L||F(!0)},X=()=>{s&&!L&&(s(e._id||e.id||""),t()),F(!1)},Q=()=>{if(B&&!L)return c.jsx(Vd,{value:y.description,onChange:D=>w(O=>({...O,description:D})),placeholder:"Enter activity description...",minHeight:"150px"});if(e.htmlDescription)return c.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:e.htmlDescription},dir:"ltr"});if(e.description.includes("<"))return c.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:e.description},dir:"ltr"});const P=e.description.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/_(.*?)_/g,"<u>$1</u>").replace(/\n/g,"<br>");return c.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:P},dir:"ltr"})},K=()=>B&&!L?c.jsx(Vd,{value:y.activityText||"",onChange:P=>w(D=>({...D,activityText:P})),placeholder:"Enter activity instructions...",minHeight:"100px"}):e.activityText?c.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:e.activityText},dir:"ltr"}):null,H=[{label:"Video",url:B?y.videoLink:e.videoLink,icon:Gd,color:"text-red-600 bg-red-50 border-red-200",type:"video"},{label:"Music",url:B?y.musicLink:e.musicLink,icon:Kd,color:"text-green-600 bg-green-50 border-green-200",type:"music"},{label:"Backing",url:B?y.backingLink:e.backingLink,icon:eo,color:"text-blue-600 bg-blue-50 border-blue-200",type:"backing"},{label:"Resource",url:B?y.resourceLink:e.resourceLink,icon:Is,color:"text-purple-600 bg-purple-50 border-purple-200",type:"resource"},{label:"Link",url:B?y.link:e.link,icon:Hd,color:"text-gray-600 bg-gray-50 border-gray-200",type:"link"},{label:"Vocals",url:B?y.vocalsLink:e.vocalsLink,icon:eo,color:"text-orange-600 bg-orange-50 border-orange-200",type:"vocals"},{label:"Image",url:B?y.imageLink:e.imageLink,icon:Md,color:"text-pink-600 bg-pink-50 border-pink-200",type:"image"}].filter(P=>P.url&&P.url.trim()),k=P=>{h({url:P.url,title:`${e.activity} - ${P.label}`,type:P.type})},U=P=>{p.includes(P)?(v(D=>D.filter(O=>O!==P)),e.lessonNumber&&(u(e.lessonNumber,P),I(new Date),setTimeout(()=>I(null),3e3))):(v(D=>[...D,P]),e.lessonNumber&&(A(e.lessonNumber,P),I(new Date),setTimeout(()=>I(null),3e3)))};return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:c.jsxs("div",{ref:S,className:`bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-hidden modal-content modal-responsive ${d?"fixed inset-0 rounded-none max-w-none max-h-none":""}`,children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[c.jsxs("div",{children:[B&&!L?c.jsx("input",{type:"text",value:y.activity,onChange:P=>w(D=>({...D,activity:P.target.value})),className:"text-xl font-bold text-gray-900 border-b border-gray-300 focus:border-blue-500 focus:outline-none w-full",dir:"ltr"}):c.jsx("h2",{className:"text-xl font-bold text-gray-900",children:e.activity}),c.jsxs("div",{className:"flex items-center space-x-3 mt-1",children:[B&&!L?c.jsxs("select",{value:y.category,onChange:P=>w(D=>({...D,category:P.target.value})),className:"text-sm text-gray-600 border border-gray-300 rounded px-2 py-1",dir:"ltr",children:[c.jsx("option",{value:"",children:"Select Category"}),c.jsx("option",{value:"Welcome",children:"Welcome"}),c.jsx("option",{value:"Kodaly Songs",children:"Kodaly Songs"}),c.jsx("option",{value:"Kodaly Action Songs",children:"Kodaly Action Songs"}),c.jsx("option",{value:"Action/Games Songs",children:"Action/Games Songs"}),c.jsx("option",{value:"Rhythm Sticks",children:"Rhythm Sticks"}),c.jsx("option",{value:"Scarf Songs",children:"Scarf Songs"}),c.jsx("option",{value:"General Game",children:"General Game"}),c.jsx("option",{value:"Core Songs",children:"Core Songs"}),c.jsx("option",{value:"Parachute Games",children:"Parachute Games"}),c.jsx("option",{value:"Percussion Games",children:"Percussion Games"}),c.jsx("option",{value:"Teaching Units",children:"Teaching Units"}),c.jsx("option",{value:"Goodbye",children:"Goodbye"}),c.jsx("option",{value:"Kodaly Rhythms",children:"Kodaly Rhythms"}),c.jsx("option",{value:"Kodaly Games",children:"Kodaly Games"}),c.jsx("option",{value:"IWB Games",children:"IWB Games"})]}):c.jsx("p",{className:"text-sm text-gray-600",children:e.category}),e.level&&!B&&c.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full",children:e.level}),B&&!L&&c.jsxs("select",{value:y.level,onChange:P=>w(D=>({...D,level:P.target.value})),className:"text-sm text-gray-600 border border-gray-300 rounded px-2 py-1",dir:"ltr",children:[c.jsx("option",{value:"",children:"Select Level"}),c.jsx("option",{value:"All",children:"All"}),c.jsx("option",{value:"LKG",children:"LKG"}),c.jsx("option",{value:"UKG",children:"UKG"}),c.jsx("option",{value:"Reception",children:"Reception"})]})]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[L&&c.jsxs("div",{className:"flex items-center space-x-1 px-3 py-2 bg-amber-50 text-amber-800 rounded-lg border border-amber-200",children:[c.jsx(vy,{className:"h-4 w-4"}),c.jsx("span",{className:"text-xs font-medium",children:"Read-only"})]}),!B&&s&&!L&&c.jsx("button",{onClick:V,className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg transition-colors duration-200",title:"Delete Activity",children:c.jsx(_i,{className:"h-5 w-5"})}),!B&&!L&&c.jsx("button",{onClick:()=>E(!0),className:"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-lg transition-colors duration-200",title:"Edit Activity",children:c.jsx(ki,{className:"h-5 w-5"})}),c.jsx("button",{onClick:()=>x(!g),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors duration-200",title:"EYFS Standards",children:c.jsx(Pn,{className:"h-5 w-5"})}),c.jsx("button",{onClick:R,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors duration-200",title:d?"Exit Fullscreen":"Enter Fullscreen",children:d?c.jsx(ZW,{className:"h-5 w-5"}):c.jsx(YW,{className:"h-5 w-5"})}),c.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:c.jsx(Zr,{className:"h-6 w-6"})})]})]}),L&&c.jsx("div",{className:"mx-6 mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx(vy,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-blue-700",children:"Read-only mode."}),c.jsxs("p",{className:"text-sm text-green-700 mt-1",children:[c.jsx("span",{className:"font-medium",children:"✓ Switch to Activities tab to edit."}),c.jsx("br",{}),c.jsx("span",{className:"font-medium",children:"✓ EYFS Standards are editable"})]})]})]})}),c.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-200px)]",children:[g&&e.lessonNumber&&c.jsxs("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsxs("h3",{className:"text-md font-semibold text-blue-900 flex items-center space-x-2",children:[c.jsx(Pn,{className:"h-4 w-4"}),c.jsx("span",{children:"EYFS Standards for this Activity"}),L&&c.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full",children:"Editable"}),T&&c.jsxs("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full flex items-center space-x-1",children:[c.jsx(Ea,{className:"h-3 w-3"}),c.jsx("span",{children:"Saved"})]})]}),c.jsx("button",{onClick:()=>x(!1),className:"text-blue-600 hover:text-blue-800 p-1 hover:bg-blue-100 rounded-full",children:c.jsx(Zr,{className:"h-4 w-4"})})]}),c.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto p-2",children:o.map(P=>c.jsxs("div",{className:"flex items-center space-x-2 p-2 hover:bg-blue-100 rounded-lg cursor-pointer",onClick:()=>U(P),children:[c.jsx("div",{className:`w-5 h-5 flex-shrink-0 rounded border ${p.includes(P)?"bg-blue-600 border-blue-600 flex items-center justify-center":"border-gray-300"}`,children:p.includes(P)&&c.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),c.jsx("span",{className:"text-sm text-gray-700",dir:"ltr",children:P})]},P))}),L&&c.jsx("div",{className:"mt-3 p-2 bg-green-50 border border-green-200 rounded text-xs text-green-700",children:c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(Ea,{className:"h-3 w-3"}),c.jsx("span",{children:"Changes are automatically saved to the lesson plan"})]})})]}),(e.time>0||B&&!L)&&c.jsxs("div",{className:"flex items-center space-x-2 mb-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[c.jsx(_a,{className:"h-5 w-5 text-blue-600"}),B&&!L?c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Duration:"}),c.jsx("input",{type:"number",value:y.time,onChange:P=>w(D=>({...D,time:parseInt(P.target.value)||0})),className:"w-16 px-2 py-1 border border-blue-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"0",dir:"ltr"}),c.jsx("span",{className:"text-sm font-medium text-blue-900",children:"minutes"})]}):c.jsxs("span",{className:"text-sm font-medium text-blue-900",children:["Duration: ",e.time," minutes"]})]}),(y.activityText||B&&!L)&&c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:c.jsx(Zc,{id:"activity-text-heading",fallback:"Activity"})}),c.jsx("div",{className:"text-gray-700 leading-relaxed",children:K()})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:c.jsx(Zc,{id:"activity-description-heading",fallback:"Description"})}),c.jsx("div",{className:"text-gray-700 leading-relaxed",children:Q()})]}),(e.unitName||B&&!L)&&c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:c.jsx(Zc,{id:"activity-unit-heading",fallback:"Unit"})}),B&&!L?c.jsx("input",{type:"text",value:y.unitName,onChange:P=>w(D=>({...D,unitName:P.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter unit name",dir:"ltr"}):c.jsx("p",{className:"text-gray-700",dir:"ltr",children:e.unitName})]}),p.length>0&&c.jsxs("div",{className:"mb-6",children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center space-x-2",children:[c.jsx(Pn,{className:"h-4 w-4 text-blue-600"}),c.jsx("span",{children:"EYFS Standards"}),L&&c.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full",children:"Editable"})]}),c.jsx("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-200",children:c.jsx("ul",{className:"space-y-2",children:p.map((P,D)=>c.jsxs("li",{className:"flex items-start space-x-2",children:[c.jsx("svg",{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),c.jsx("span",{className:"text-sm text-gray-700",dir:"ltr",children:P})]},D))})})]}),B&&!L&&c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Activity Image"}),c.jsxs("div",{className:"flex items-center space-x-4",children:[y.imageLink?c.jsxs("div",{className:"relative",children:[c.jsx("img",{src:y.imageLink,alt:"Activity",className:"w-32 h-32 object-cover rounded-lg border border-gray-200"}),c.jsx("button",{onClick:()=>w(P=>({...P,imageLink:""})),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1",children:c.jsx(Zr,{className:"h-4 w-4"})})]}):c.jsx("div",{className:"w-32 h-32 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center bg-gray-50",children:c.jsx(Md,{className:"h-8 w-8 text-gray-400"})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Upload an image for this activity or provide an image URL"}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsxs("button",{onClick:()=>{var P;return(P=C.current)==null?void 0:P.click()},className:"px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg flex items-center space-x-1",children:[c.jsx(Vl,{className:"h-4 w-4"}),c.jsx("span",{children:"Upload"})]}),c.jsx("input",{ref:C,type:"file",accept:"image/*",className:"hidden",onChange:G}),c.jsx("input",{type:"url",value:y.imageLink,onChange:P=>w(D=>({...D,imageLink:P.target.value})),placeholder:"Or paste image URL",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",dir:"ltr"})]})]})]})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:c.jsx(Zc,{id:"activity-resources-heading",fallback:"Resources"})}),B&&!L?c.jsx("div",{className:"space-y-4",children:[{key:"videoLink",label:"Video URL",icon:Gd},{key:"musicLink",label:"Music URL",icon:Kd},{key:"backingLink",label:"Backing Track URL",icon:eo},{key:"resourceLink",label:"Resource URL",icon:Is},{key:"link",label:"Additional Link",icon:Hd},{key:"vocalsLink",label:"Vocals URL",icon:eo}].map(({key:P,label:D,icon:O})=>c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(O,{className:"h-5 w-5 text-gray-500 flex-shrink-0"}),c.jsx("input",{type:"url",value:y[P],onChange:z=>w(J=>({...J,[P]:z.target.value})),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:D,dir:"ltr"})]},P))}):c.jsx(c.Fragment,{children:H.length>0?c.jsx("div",{className:"grid grid-cols-2 gap-2",children:H.map((P,D)=>{const O=P.icon;return c.jsxs("button",{onClick:()=>k(P),className:`flex items-center space-x-2 p-2 rounded-lg border transition-all duration-200 hover:scale-105 hover:shadow-sm ${P.color}`,children:[c.jsx(O,{className:"h-4 w-4 flex-shrink-0"}),c.jsx("span",{className:"text-sm font-medium truncate",dir:"ltr",children:P.label}),c.jsx(ko,{className:"h-3 w-3 flex-shrink-0 opacity-60"})]},D)})}):c.jsxs("div",{className:"text-center py-8",children:[c.jsx(Is,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),c.jsx("p",{className:"text-gray-500",children:c.jsx(Zc,{id:"activity-no-resources-message",fallback:"No additional resources available"})})]})})]})]}),c.jsx("div",{className:"flex justify-between p-6 border-t border-gray-200 bg-gray-50",children:B&&!L?c.jsxs("div",{className:"flex space-x-3",children:[c.jsx("button",{onClick:()=>E(!1),className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg transition-colors duration-200",children:"Cancel"}),c.jsxs("button",{onClick:W,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200 flex items-center space-x-2",children:[c.jsx(ao,{className:"h-4 w-4"}),c.jsx("span",{children:"Save Changes"})]})]}):c.jsxs("div",{className:"flex justify-between w-full",children:[c.jsx("div",{children:r&&c.jsxs("button",{onClick:r,className:"px-6 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors duration-200 flex items-center space-x-2",children:[c.jsx(ka,{className:"h-4 w-4"}),c.jsx("span",{children:"Add to Lesson"})]})}),c.jsx("div",{className:"flex items-center space-x-3",children:c.jsx("button",{onClick:t,className:"px-6 py-2 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg transition-colors duration-200",children:c.jsx(Zc,{id:"activity-close-button",fallback:"Close"})})})]})})]})}),f&&c.jsx(DT,{url:f.url,title:f.title,type:f.type,onClose:()=>h(null)}),_&&!L&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[c.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Delete Activity"}),c.jsxs("p",{className:"text-gray-700 mb-6",children:['Are you sure you want to delete "',e.activity,'"? This action cannot be undone.']}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx("button",{onClick:()=>F(!1),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg transition-colors",children:"Cancel"}),c.jsxs("button",{onClick:X,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors flex items-center space-x-2",children:[c.jsx(_i,{className:"h-4 w-4"}),c.jsx("span",{children:"Delete Activity"})]})]})]})})]})}var Si=Uint8Array,ba=Uint16Array,f5=Int32Array,F1=new Si([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),N1=new Si([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ty=new Si([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),PT=function(e,t){for(var r=new ba(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new f5(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)i[a]=a-r[n]<<5|n;return{b:r,r:i}},QT=PT(F1,2),RT=QT.b,Ly=QT.r;RT[28]=258,Ly[258]=28;var MT=PT(N1,0),Zte=MT.b,kC=MT.r,Iy=new ba(32768);for(var Mr=0;Mr<32768;++Mr){var fl=(Mr&43690)>>1|(Mr&21845)<<1;fl=(fl&52428)>>2|(fl&13107)<<2,fl=(fl&61680)>>4|(fl&3855)<<4,Iy[Mr]=((fl&65280)>>8|(fl&255)<<8)>>1}var io=function(e,t,r){for(var n=e.length,i=0,a=new ba(t);i<n;++i)e[i]&&++a[e[i]-1];var s=new ba(t);for(i=1;i<t;++i)s[i]=s[i-1]+a[i-1]<<1;var o;if(r){o=new ba(1<<t);var l=15-t;for(i=0;i<n;++i)if(e[i])for(var A=i<<4|e[i],u=t-e[i],f=s[e[i]-1]++<<u,h=f|(1<<u)-1;f<=h;++f)o[Iy[f]>>l]=A}else for(o=new ba(n),i=0;i<n;++i)e[i]&&(o[i]=Iy[s[e[i]-1]++]>>15-e[i]);return o},nA=new Si(288);for(var Mr=0;Mr<144;++Mr)nA[Mr]=8;for(var Mr=144;Mr<256;++Mr)nA[Mr]=9;for(var Mr=256;Mr<280;++Mr)nA[Mr]=7;for(var Mr=280;Mr<288;++Mr)nA[Mr]=8;var Wd=new Si(32);for(var Mr=0;Mr<32;++Mr)Wd[Mr]=5;var ere=io(nA,9,0),tre=io(nA,9,1),rre=io(Wd,5,0),nre=io(Wd,5,1),kx=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},ms=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(t&7)&r},Fx=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},h5=function(e){return(e+7)/8|0},HT=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new Si(e.subarray(t,r))},ire=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],bs=function(e,t,r){var n=new Error(t||ire[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,bs),!r)throw n;return n},are=function(e,t,r,n){var i=e.length,a=0;if(!i||t.f&&!t.l)return r||new Si(0);var s=!r,o=s||t.i!=2,l=t.i;s&&(r=new Si(i*3));var A=function(we){var ne=r.length;if(we>ne){var Me=new Si(Math.max(ne*2,we));Me.set(r),r=Me}},u=t.f||0,f=t.p||0,h=t.b||0,d=t.l,m=t.d,g=t.m,x=t.n,p=i*8;do{if(!d){u=ms(e,f,1);var v=ms(e,f+1,3);if(f+=3,v)if(v==1)d=tre,m=nre,g=9,x=5;else if(v==2){var E=ms(e,f,31)+257,_=ms(e,f+10,15)+4,F=E+ms(e,f+5,31)+1;f+=14;for(var T=new Si(F),I=new Si(19),S=0;S<_;++S)I[Ty[S]]=ms(e,f+S*3,7);f+=_*3;for(var C=kx(I),L=(1<<C)-1,R=io(I,C,1),S=0;S<F;){var W=R[ms(e,f,L)];f+=W&15;var y=W>>4;if(y<16)T[S++]=y;else{var G=0,V=0;for(y==16?(V=3+ms(e,f,3),f+=2,G=T[S-1]):y==17?(V=3+ms(e,f,7),f+=3):y==18&&(V=11+ms(e,f,127),f+=7);V--;)T[S++]=G}}var X=T.subarray(0,E),Q=T.subarray(E);g=kx(X),x=kx(Q),d=io(X,g,1),m=io(Q,x,1)}else bs(1);else{var y=h5(f)+4,w=e[y-4]|e[y-3]<<8,B=y+w;if(B>i){l&&bs(0);break}o&&A(h+w),r.set(e.subarray(y,B),h),t.b=h+=w,t.p=f=B*8,t.f=u;continue}if(f>p){l&&bs(0);break}}o&&A(h+131072);for(var K=(1<<g)-1,H=(1<<x)-1,k=f;;k=f){var G=d[Fx(e,f)&K],U=G>>4;if(f+=G&15,f>p){l&&bs(0);break}if(G||bs(2),U<256)r[h++]=U;else if(U==256){k=f,d=null;break}else{var P=U-254;if(U>264){var S=U-257,D=F1[S];P=ms(e,f,(1<<D)-1)+RT[S],f+=D}var O=m[Fx(e,f)&H],z=O>>4;O||bs(3),f+=O&15;var Q=Zte[z];if(z>3){var D=N1[z];Q+=Fx(e,f)&(1<<D)-1,f+=D}if(f>p){l&&bs(0);break}o&&A(h+131072);var J=h+P;if(h<Q){var Y=a-Q,le=Math.min(Q,J);for(Y+h<0&&bs(3);h<le;++h)r[h]=n[Y+h]}for(;h<J;++h)r[h]=r[h-Q]}}t.l=d,t.p=k,t.b=h,t.f=u,d&&(u=1,t.m=g,t.d=m,t.n=x)}while(!u);return h!=r.length&&s?HT(r,0,h):r.subarray(0,h)},bo=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},oh=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},Nx=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,a=r.slice();if(!i)return{t:GT,l:0};if(i==1){var s=new Si(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(B,E){return B.f-E.f}),r.push({s:-1,f:25001});var o=r[0],l=r[1],A=0,u=1,f=2;for(r[0]={s:-1,f:o.f+l.f,l:o,r:l};u!=i-1;)o=r[r[A].f<r[f].f?A++:f++],l=r[A!=u&&r[A].f<r[f].f?A++:f++],r[u++]={s:-1,f:o.f+l.f,l:o,r:l};for(var h=a[0].s,n=1;n<i;++n)a[n].s>h&&(h=a[n].s);var d=new ba(h+1),m=Uy(r[u-1],d,0);if(m>t){var n=0,g=0,x=m-t,p=1<<x;for(a.sort(function(E,_){return d[_.s]-d[E.s]||E.f-_.f});n<i;++n){var v=a[n].s;if(d[v]>t)g+=p-(1<<m-d[v]),d[v]=t;else break}for(g>>=x;g>0;){var y=a[n].s;d[y]<t?g-=1<<t-d[y]++-1:++n}for(;n>=0&&g;--n){var w=a[n].s;d[w]==t&&(--d[w],++g)}m=t}return{t:new Si(d),l:m}},Uy=function(e,t,r){return e.s==-1?Math.max(Uy(e.l,t,r+1),Uy(e.r,t,r+1)):t[e.s]=r},FC=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new ba(++t),n=0,i=e[0],a=1,s=function(l){r[n++]=l},o=1;o<=t;++o)if(e[o]==i&&o!=t)++a;else{if(!i&&a>2){for(;a>138;a-=138)s(32754);a>2&&(s(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(s(i),--a;a>6;a-=6)s(8304);a>2&&(s(a-3<<5|8208),a=0)}for(;a--;)s(i);a=1,i=e[o]}return{c:r.subarray(0,n),n:t}},lh=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},KT=function(e,t,r){var n=r.length,i=h5(t+2);e[i]=n&255,e[i+1]=n>>8,e[i+2]=e[i]^255,e[i+3]=e[i+1]^255;for(var a=0;a<n;++a)e[i+a+4]=r[a];return(i+4+n)*8},NC=function(e,t,r,n,i,a,s,o,l,A,u){bo(t,u++,r),++i[256];for(var f=Nx(i,15),h=f.t,d=f.l,m=Nx(a,15),g=m.t,x=m.l,p=FC(h),v=p.c,y=p.n,w=FC(g),B=w.c,E=w.n,_=new ba(19),F=0;F<v.length;++F)++_[v[F]&31];for(var F=0;F<B.length;++F)++_[B[F]&31];for(var T=Nx(_,7),I=T.t,S=T.l,C=19;C>4&&!I[Ty[C-1]];--C);var L=A+5<<3,R=lh(i,nA)+lh(a,Wd)+s,W=lh(i,h)+lh(a,g)+s+14+3*C+lh(_,I)+2*_[16]+3*_[17]+7*_[18];if(l>=0&&L<=R&&L<=W)return KT(t,u,e.subarray(l,l+A));var G,V,X,Q;if(bo(t,u,1+(W<R)),u+=2,W<R){G=io(h,d,0),V=h,X=io(g,x,0),Q=g;var K=io(I,S,0);bo(t,u,y-257),bo(t,u+5,E-1),bo(t,u+10,C-4),u+=14;for(var F=0;F<C;++F)bo(t,u+3*F,I[Ty[F]]);u+=3*C;for(var H=[v,B],k=0;k<2;++k)for(var U=H[k],F=0;F<U.length;++F){var P=U[F]&31;bo(t,u,K[P]),u+=I[P],P>15&&(bo(t,u,U[F]>>5&127),u+=U[F]>>12)}}else G=ere,V=nA,X=rre,Q=Wd;for(var F=0;F<o;++F){var D=n[F];if(D>255){var P=D>>18&31;oh(t,u,G[P+257]),u+=V[P+257],P>7&&(bo(t,u,D>>23&31),u+=F1[P]);var O=D&31;oh(t,u,X[O]),u+=Q[O],O>3&&(oh(t,u,D>>5&8191),u+=N1[O])}else oh(t,u,G[D]),u+=V[D]}return oh(t,u,G[256]),u+V[256]},sre=new f5([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),GT=new Si(0),ore=function(e,t,r,n,i,a){var s=a.z||e.length,o=new Si(n+s+5*(1+Math.ceil(s/7e3))+i),l=o.subarray(n,o.length-i),A=a.l,u=(a.r||0)&7;if(t){u&&(l[0]=a.r>>3);for(var f=sre[t-1],h=f>>13,d=f&8191,m=(1<<r)-1,g=a.p||new ba(32768),x=a.h||new ba(m+1),p=Math.ceil(r/3),v=2*p,y=function(qe){return(e[qe]^e[qe+1]<<p^e[qe+2]<<v)&m},w=new f5(25e3),B=new ba(288),E=new ba(32),_=0,F=0,T=a.i||0,I=0,S=a.w||0,C=0;T+2<s;++T){var L=y(T),R=T&32767,W=x[L];if(g[R]=W,x[L]=R,S<=T){var G=s-T;if((_>7e3||I>24576)&&(G>423||!A)){u=NC(e,l,0,w,B,E,F,I,C,T-C,u),I=_=F=0,C=T;for(var V=0;V<286;++V)B[V]=0;for(var V=0;V<30;++V)E[V]=0}var X=2,Q=0,K=d,H=R-W&32767;if(G>2&&L==y(T-H))for(var k=Math.min(h,G)-1,U=Math.min(32767,T),P=Math.min(258,G);H<=U&&--K&&R!=W;){if(e[T+X]==e[T+X-H]){for(var D=0;D<P&&e[T+D]==e[T+D-H];++D);if(D>X){if(X=D,Q=H,D>k)break;for(var O=Math.min(H,D-2),z=0,V=0;V<O;++V){var J=T-H+V&32767,Y=g[J],le=J-Y&32767;le>z&&(z=le,W=J)}}}R=W,W=g[R],H+=R-W&32767}if(Q){w[I++]=268435456|Ly[X]<<18|kC[Q];var we=Ly[X]&31,ne=kC[Q]&31;F+=F1[we]+N1[ne],++B[257+we],++E[ne],S=T+X,++_}else w[I++]=e[T],++B[e[T]]}}for(T=Math.max(T,S);T<s;++T)w[I++]=e[T],++B[e[T]];u=NC(e,l,A,w,B,E,F,I,C,T-C,u),A||(a.r=u&7|l[u/8|0]<<3,u-=7,a.h=x,a.p=g,a.i=T,a.w=S)}else{for(var T=a.w||0;T<s+A;T+=65535){var Me=T+65535;Me>=s&&(l[u/8|0]=A,Me=s),u=KT(l,u+1,e.subarray(T,Me))}a.i=s}return HT(o,0,n+h5(u)+i)},VT=function(){var e=1,t=0;return{p:function(r){for(var n=e,i=t,a=r.length|0,s=0;s!=a;){for(var o=Math.min(s+2655,a);s<o;++s)i+=n+=r[s];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}e=n,t=i},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},lre=function(e,t,r,n,i){if(!i&&(i={l:1},t.dictionary)){var a=t.dictionary.subarray(-32768),s=new Si(a.length+e.length);s.set(a),s.set(e,a.length),e=s,i.w=a.length}return ore(e,t.level==null?6:t.level,t.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,i)},WT=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},Are=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=VT();i.p(t.dictionary),WT(e,2,i.d())}},cre=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&bs(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&bs(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function Oy(e,t){t||(t={});var r=VT();r.p(e);var n=lre(e,t,t.dictionary?6:2,4);return Are(n,t),WT(n,n.length-4,r.d()),n}function ure(e,t){return are(e.subarray(cre(e,t),-4),{i:2},t,t)}var fre=typeof TextDecoder<"u"&&new TextDecoder,hre=0;try{fre.decode(GT,{stream:!0}),hre=1}catch{}var jt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Tx(){jt.console&&typeof jt.console.log=="function"&&jt.console.log.apply(jt.console,arguments)}var Lr={log:Tx,warn:function(e){jt.console&&(typeof jt.console.warn=="function"?jt.console.warn.apply(jt.console,arguments):Tx.call(null,arguments))},error:function(e){jt.console&&(typeof jt.console.error=="function"?jt.console.error.apply(jt.console,arguments):Tx(e))}};function Lx(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){FA(n.response,t,r)},n.onerror=function(){Lr.error("could not download file")},n.send()}function TC(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Rp(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var ed,jy,FA=jt.saveAs||((typeof window>"u"?"undefined":_r(window))!=="object"||window!==jt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=jt.URL||jt.webkitURL,i=document.createElement("a");t=t||e.name||"download",i.download=t,i.rel="noopener",typeof e=="string"?(i.href=e,i.origin!==location.origin?TC(i.href)?Lx(e,t,r):Rp(i,i.target="_blank"):Rp(i)):(i.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){Rp(i)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(TC(e))Lx(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){Rp(n)})}else navigator.msSaveOrOpenBlob(function(i,a){return a===void 0?a={autoBom:!1}:_r(a)!=="object"&&(Lr.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return Lx(e,t,r);var i=e.type==="application/octet-stream",a=/constructor/i.test(jt.HTMLElement)||jt.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&a)&&(typeof FileReader>"u"?"undefined":_r(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var u=o.result;u=s?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},o.readAsDataURL(e)}else{var l=jt.URL||jt.webkitURL,A=l.createObjectURL(e);n?n.location=A:location.href=A,n=null,setTimeout(function(){l.revokeObjectURL(A)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function $T(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,a=r[n].process,s=i.exec(e);s&&(t=a(s),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),A=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),A.length==1&&(A="0"+A),"#"+o+l+A}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Ix(e,t){var r=e[0],n=e[1],i=e[2],a=e[3];r=hi(r,n,i,a,t[0],7,-680876936),a=hi(a,r,n,i,t[1],12,-389564586),i=hi(i,a,r,n,t[2],17,606105819),n=hi(n,i,a,r,t[3],22,-1044525330),r=hi(r,n,i,a,t[4],7,-176418897),a=hi(a,r,n,i,t[5],12,1200080426),i=hi(i,a,r,n,t[6],17,-1473231341),n=hi(n,i,a,r,t[7],22,-45705983),r=hi(r,n,i,a,t[8],7,1770035416),a=hi(a,r,n,i,t[9],12,-1958414417),i=hi(i,a,r,n,t[10],17,-42063),n=hi(n,i,a,r,t[11],22,-1990404162),r=hi(r,n,i,a,t[12],7,1804603682),a=hi(a,r,n,i,t[13],12,-40341101),i=hi(i,a,r,n,t[14],17,-1502002290),r=di(r,n=hi(n,i,a,r,t[15],22,1236535329),i,a,t[1],5,-165796510),a=di(a,r,n,i,t[6],9,-1069501632),i=di(i,a,r,n,t[11],14,643717713),n=di(n,i,a,r,t[0],20,-373897302),r=di(r,n,i,a,t[5],5,-701558691),a=di(a,r,n,i,t[10],9,38016083),i=di(i,a,r,n,t[15],14,-660478335),n=di(n,i,a,r,t[4],20,-405537848),r=di(r,n,i,a,t[9],5,568446438),a=di(a,r,n,i,t[14],9,-1019803690),i=di(i,a,r,n,t[3],14,-187363961),n=di(n,i,a,r,t[8],20,1163531501),r=di(r,n,i,a,t[13],5,-1444681467),a=di(a,r,n,i,t[2],9,-51403784),i=di(i,a,r,n,t[7],14,1735328473),r=pi(r,n=di(n,i,a,r,t[12],20,-1926607734),i,a,t[5],4,-378558),a=pi(a,r,n,i,t[8],11,-2022574463),i=pi(i,a,r,n,t[11],16,1839030562),n=pi(n,i,a,r,t[14],23,-35309556),r=pi(r,n,i,a,t[1],4,-1530992060),a=pi(a,r,n,i,t[4],11,1272893353),i=pi(i,a,r,n,t[7],16,-155497632),n=pi(n,i,a,r,t[10],23,-1094730640),r=pi(r,n,i,a,t[13],4,681279174),a=pi(a,r,n,i,t[0],11,-358537222),i=pi(i,a,r,n,t[3],16,-722521979),n=pi(n,i,a,r,t[6],23,76029189),r=pi(r,n,i,a,t[9],4,-640364487),a=pi(a,r,n,i,t[12],11,-421815835),i=pi(i,a,r,n,t[15],16,530742520),r=gi(r,n=pi(n,i,a,r,t[2],23,-995338651),i,a,t[0],6,-198630844),a=gi(a,r,n,i,t[7],10,1126891415),i=gi(i,a,r,n,t[14],15,-1416354905),n=gi(n,i,a,r,t[5],21,-57434055),r=gi(r,n,i,a,t[12],6,1700485571),a=gi(a,r,n,i,t[3],10,-1894986606),i=gi(i,a,r,n,t[10],15,-1051523),n=gi(n,i,a,r,t[1],21,-2054922799),r=gi(r,n,i,a,t[8],6,1873313359),a=gi(a,r,n,i,t[15],10,-30611744),i=gi(i,a,r,n,t[6],15,-1560198380),n=gi(n,i,a,r,t[13],21,1309151649),r=gi(r,n,i,a,t[4],6,-145523070),a=gi(a,r,n,i,t[11],10,-1120210379),i=gi(i,a,r,n,t[2],15,718787259),n=gi(n,i,a,r,t[9],21,-343485551),e[0]=Ll(r,e[0]),e[1]=Ll(n,e[1]),e[2]=Ll(i,e[2]),e[3]=Ll(a,e[3])}function T1(e,t,r,n,i,a){return t=Ll(Ll(t,e),Ll(n,a)),Ll(t<<i|t>>>32-i,r)}function hi(e,t,r,n,i,a,s){return T1(t&r|~t&n,e,t,i,a,s)}function di(e,t,r,n,i,a,s){return T1(t&n|r&~n,e,t,i,a,s)}function pi(e,t,r,n,i,a,s){return T1(t^r^n,e,t,i,a,s)}function gi(e,t,r,n,i,a,s){return T1(r^(t|~n),e,t,i,a,s)}function qT(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Ix(n,dre(e.substring(t-64,t)));e=e.substring(t-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)i[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(Ix(n,i),t=0;t<16;t++)i[t]=0;return i[14]=8*r,Ix(n,i),n}function dre(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}ed=jt.atob.bind(jt),jy=jt.btoa.bind(jt);var LC="0123456789abcdef".split("");function pre(e){for(var t="",r=0;r<4;r++)t+=LC[e>>8*r+4&15]+LC[e>>8*r&15];return t}function gre(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Dy(e){return qT(e).map(gre).join("")}var mre=function(e){for(var t=0;t<e.length;t++)e[t]=pre(e[t]);return e.join("")}(qT("hello"))!="5d41402abc4b2a76b9719d911017c592";function Ll(e,t){if(mre){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Py(e,t){var r,n,i,a;if(e!==r){for(var s=(i=e,a=1+(256/e.length>>0),new Array(a+1).join(i)),o=[],l=0;l<256;l++)o[l]=l;var A=0;for(l=0;l<256;l++){var u=o[l];A=(A+u+s.charCodeAt(l))%256,o[l]=o[A],o[A]=u}r=e,n=o}else o=n;var f=t.length,h=0,d=0,m="";for(l=0;l<f;l++)d=(d+(u=o[h=(h+1)%256]))%256,o[h]=o[d],o[d]=u,s=o[(o[h]+o[d])%256],m+=String.fromCharCode(t.charCodeAt(l)^s);return m}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var IC={print:4,modify:8,copy:16,"annot-forms":32};function uu(e,t,r,n){this.v=1,this.r=2;var i=192;e.forEach(function(o){if(IC.perm!==void 0)throw new Error("Invalid permission: "+o);i+=IC[o]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var a=(t+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,s),this.P=-(1+(255^i)),this.encryptionKey=Dy(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Py(this.encryptionKey,this.padding)}function fu(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var i=e.charCodeAt(n);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?t+="#"+("0"+i.toString(16)).slice(-2):t+=e[n]}return t}function UC(e){if(_r(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var a=Math.random().toString(35);return t[r][a]=[n,!!i],a},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var a in t[r]){var s=t[r][a];try{s[0].apply(e,n)}catch(o){jt.console&&Lr.error("jsPDF PubSub Error",o.message,o)}s[1]&&i.push(a)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function $d(e){if(!(this instanceof $d))return new $d(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function zT(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Sl(e,t,r,n,i){if(!(this instanceof Sl))return new Sl(e,t,r,n,i);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,zT.call(this,n,i)}function PA(e,t,r,n,i){if(!(this instanceof PA))return new PA(e,t,r,n,i);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,zT.call(this,n,i)}function Ut(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],a=arguments[3],s=[],o=1,l=16,A="S",u=null;_r(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,i=e.format||i,a=e.compress||e.compressPdf||a,(u=e.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(l=e.floatPrecision),A=e.defaultPathOperation||"S"),s=e.filters||(a===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,h={},d={internal:{},__private__:{}};d.__private__.PubSub=UC;var m="1.3",g=d.__private__.getPdfVersion=function(){return m};d.__private__.setPdfVersion=function(j){m=j};var x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};d.__private__.getPageFormats=function(){return x};var p=d.__private__.getPageFormat=function(j){return x[j]};i=i||"a4";var v={COMPAT:"compat",ADVANCED:"advanced"},y=v.COMPAT;function w(){this.saveGraphicsState(),he(new ye(et,0,0,-et,0,Jo()*et).toString()+" cm"),this.setFontSize(this.getFontSize()/et),A="n",y=v.ADVANCED}function B(){this.restoreGraphicsState(),A="S",y=v.COMPAT}var E=d.__private__.combineFontStyleAndFontWeight=function(j,ee){if(j=="bold"&&ee=="normal"||j=="bold"&&ee==400||j=="normal"&&ee=="italic"||j=="bold"&&ee=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ee&&(j=ee==400||ee==="normal"?j==="italic"?"italic":"normal":ee!=700&&ee!=="bold"||j!=="normal"?(ee==700?"bold":ee)+""+j:"bold"),j};d.advancedAPI=function(j){var ee=y===v.COMPAT;return ee&&w.call(this),typeof j!="function"||(j(this),ee&&B.call(this)),this},d.compatAPI=function(j){var ee=y===v.ADVANCED;return ee&&B.call(this),typeof j!="function"||(j(this),ee&&w.call(this)),this},d.isAdvancedAPI=function(){return y===v.ADVANCED};var _,F=function(j){if(y!==v.ADVANCED)throw new Error(j+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},T=d.roundToPrecision=d.__private__.roundToPrecision=function(j,ee){var me=t||ee;if(isNaN(j)||isNaN(me))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return j.toFixed(me).replace(/0+$/,"")};_=d.hpf=d.__private__.hpf=typeof l=="number"?function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return T(j,l)}:l==="smart"?function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return T(j,j>-1&&j<1?16:5)}:function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return T(j,16)};var I=d.f2=d.__private__.f2=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.f2");return T(j,2)},S=d.__private__.f3=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.f3");return T(j,3)},C=d.scale=d.__private__.scale=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.scale");return y===v.COMPAT?j*et:y===v.ADVANCED?j:void 0},L=function(j){return y===v.COMPAT?Jo()-j:y===v.ADVANCED?j:void 0},R=function(j){return C(L(j))};d.__private__.setPrecision=d.setPrecision=function(j){typeof parseInt(j,10)=="number"&&(t=parseInt(j,10))};var W,G="00000000000000000000000000000000",V=d.__private__.getFileId=function(){return G},X=d.__private__.setFileId=function(j){return G=j!==void 0&&/^[a-fA-F0-9]{32}$/.test(j)?j.toUpperCase():G.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(li=new uu(u.userPermissions,u.userPassword,u.ownerPassword,G)),G};d.setFileId=function(j){return X(j),this},d.getFileId=function(){return V()};var Q=d.__private__.convertDateToPDFDate=function(j){var ee=j.getTimezoneOffset(),me=ee<0?"+":"-",Se=Math.floor(Math.abs(ee/60)),Ue=Math.abs(ee%60),$e=[me,P(Se),"'",P(Ue),"'"].join("");return["D:",j.getFullYear(),P(j.getMonth()+1),P(j.getDate()),P(j.getHours()),P(j.getMinutes()),P(j.getSeconds()),$e].join("")},K=d.__private__.convertPDFDateToDate=function(j){var ee=parseInt(j.substr(2,4),10),me=parseInt(j.substr(6,2),10)-1,Se=parseInt(j.substr(8,2),10),Ue=parseInt(j.substr(10,2),10),$e=parseInt(j.substr(12,2),10),it=parseInt(j.substr(14,2),10);return new Date(ee,me,Se,Ue,$e,it,0)},H=d.__private__.setCreationDate=function(j){var ee;if(j===void 0&&(j=new Date),j instanceof Date)ee=Q(j);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(j))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ee=j}return W=ee},k=d.__private__.getCreationDate=function(j){var ee=W;return j==="jsDate"&&(ee=K(W)),ee};d.setCreationDate=function(j){return H(j),this},d.getCreationDate=function(j){return k(j)};var U,P=d.__private__.padd2=function(j){return("0"+parseInt(j)).slice(-2)},D=d.__private__.padd2Hex=function(j){return("00"+(j=j.toString())).substr(j.length)},O=0,z=[],J=[],Y=0,le=[],we=[],ne=!1,Me=J,qe=function(){O=0,Y=0,J=[],z=[],le=[],ae=Xt(),Ae=Xt()};d.__private__.setCustomOutputDestination=function(j){ne=!0,Me=j};var Fe=function(j){ne||(Me=j)};d.__private__.resetCustomOutputDestination=function(){ne=!1,Me=J};var he=d.__private__.out=function(j){return j=j.toString(),Y+=j.length+1,Me.push(j),Me},Be=d.__private__.write=function(j){return he(arguments.length===1?j.toString():Array.prototype.join.call(arguments," "))},xe=d.__private__.getArrayBuffer=function(j){for(var ee=j.length,me=new ArrayBuffer(ee),Se=new Uint8Array(me);ee--;)Se[ee]=j.charCodeAt(ee);return me},se=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];d.__private__.getStandardFonts=function(){return se};var be=e.fontSize||16;d.__private__.setFontSize=d.setFontSize=function(j){return be=y===v.ADVANCED?j/et:j,this};var Te,pe=d.__private__.getFontSize=d.getFontSize=function(){return y===v.COMPAT?be:be*et},je=e.R2L||!1;d.__private__.setR2L=d.setR2L=function(j){return je=j,this},d.__private__.getR2L=d.getR2L=function(){return je};var Ve,We=d.__private__.setZoomMode=function(j){var ee=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(j))Te=j;else if(isNaN(j)){if(ee.indexOf(j)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+j+'" is not recognized.');Te=j}else Te=parseInt(j,10)};d.__private__.getZoomMode=function(){return Te};var ft,Et=d.__private__.setPageMode=function(j){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(j)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+j+'" is not recognized.');Ve=j};d.__private__.getPageMode=function(){return Ve};var ut=d.__private__.setLayoutMode=function(j){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(j)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+j+'" is not recognized.');ft=j};d.__private__.getLayoutMode=function(){return ft},d.__private__.setDisplayMode=d.setDisplayMode=function(j,ee,me){return We(j),ut(ee),Et(me),this};var wt={title:"",subject:"",author:"",keywords:"",creator:""};d.__private__.getDocumentProperty=function(j){if(Object.keys(wt).indexOf(j)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return wt[j]},d.__private__.getDocumentProperties=function(){return wt},d.__private__.setDocumentProperties=d.setProperties=d.setDocumentProperties=function(j){for(var ee in wt)wt.hasOwnProperty(ee)&&j[ee]&&(wt[ee]=j[ee]);return this},d.__private__.setDocumentProperty=function(j,ee){if(Object.keys(wt).indexOf(j)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return wt[j]=ee};var at,et,ur,Ft,tn,fr={},dr={},Rn=[],nr={},Ta={},Nr={},Li={},Aa=null,vr=0,Pt=[],ir=new UC(d),ls=e.hotfixes||[],_e={},Ce={},De=[],ye=function j(ee,me,Se,Ue,$e,it){if(!(this instanceof j))return new j(ee,me,Se,Ue,$e,it);isNaN(ee)&&(ee=1),isNaN(me)&&(me=0),isNaN(Se)&&(Se=0),isNaN(Ue)&&(Ue=1),isNaN($e)&&($e=0),isNaN(it)&&(it=0),this._matrix=[ee,me,Se,Ue,$e,it]};Object.defineProperty(ye.prototype,"sx",{get:function(){return this._matrix[0]},set:function(j){this._matrix[0]=j}}),Object.defineProperty(ye.prototype,"shy",{get:function(){return this._matrix[1]},set:function(j){this._matrix[1]=j}}),Object.defineProperty(ye.prototype,"shx",{get:function(){return this._matrix[2]},set:function(j){this._matrix[2]=j}}),Object.defineProperty(ye.prototype,"sy",{get:function(){return this._matrix[3]},set:function(j){this._matrix[3]=j}}),Object.defineProperty(ye.prototype,"tx",{get:function(){return this._matrix[4]},set:function(j){this._matrix[4]=j}}),Object.defineProperty(ye.prototype,"ty",{get:function(){return this._matrix[5]},set:function(j){this._matrix[5]=j}}),Object.defineProperty(ye.prototype,"a",{get:function(){return this._matrix[0]},set:function(j){this._matrix[0]=j}}),Object.defineProperty(ye.prototype,"b",{get:function(){return this._matrix[1]},set:function(j){this._matrix[1]=j}}),Object.defineProperty(ye.prototype,"c",{get:function(){return this._matrix[2]},set:function(j){this._matrix[2]=j}}),Object.defineProperty(ye.prototype,"d",{get:function(){return this._matrix[3]},set:function(j){this._matrix[3]=j}}),Object.defineProperty(ye.prototype,"e",{get:function(){return this._matrix[4]},set:function(j){this._matrix[4]=j}}),Object.defineProperty(ye.prototype,"f",{get:function(){return this._matrix[5]},set:function(j){this._matrix[5]=j}}),Object.defineProperty(ye.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ye.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ye.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ye.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),ye.prototype.join=function(j){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(_).join(j)},ye.prototype.multiply=function(j){var ee=j.sx*this.sx+j.shy*this.shx,me=j.sx*this.shy+j.shy*this.sy,Se=j.shx*this.sx+j.sy*this.shx,Ue=j.shx*this.shy+j.sy*this.sy,$e=j.tx*this.sx+j.ty*this.shx+this.tx,it=j.tx*this.shy+j.ty*this.sy+this.ty;return new ye(ee,me,Se,Ue,$e,it)},ye.prototype.decompose=function(){var j=this.sx,ee=this.shy,me=this.shx,Se=this.sy,Ue=this.tx,$e=this.ty,it=Math.sqrt(j*j+ee*ee),vt=(j/=it)*me+(ee/=it)*Se;me-=j*vt,Se-=ee*vt;var Tt=Math.sqrt(me*me+Se*Se);return vt/=Tt,j*(Se/=Tt)<ee*(me/=Tt)&&(j=-j,ee=-ee,vt=-vt,it=-it),{scale:new ye(it,0,0,Tt,0,0),translate:new ye(1,0,0,1,Ue,$e),rotate:new ye(j,ee,-ee,j,0,0),skew:new ye(1,0,vt,1,0,0)}},ye.prototype.toString=function(j){return this.join(" ")},ye.prototype.inversed=function(){var j=this.sx,ee=this.shy,me=this.shx,Se=this.sy,Ue=this.tx,$e=this.ty,it=1/(j*Se-ee*me),vt=Se*it,Tt=-ee*it,Gt=-me*it,Ht=j*it;return new ye(vt,Tt,Gt,Ht,-vt*Ue-Gt*$e,-Tt*Ue-Ht*$e)},ye.prototype.applyToPoint=function(j){var ee=j.x*this.sx+j.y*this.shx+this.tx,me=j.x*this.shy+j.y*this.sy+this.ty;return new Sc(ee,me)},ye.prototype.applyToRectangle=function(j){var ee=this.applyToPoint(j),me=this.applyToPoint(new Sc(j.x+j.w,j.y+j.h));return new kf(ee.x,ee.y,me.x-ee.x,me.y-ee.y)},ye.prototype.clone=function(){var j=this.sx,ee=this.shy,me=this.shx,Se=this.sy,Ue=this.tx,$e=this.ty;return new ye(j,ee,me,Se,Ue,$e)},d.Matrix=ye;var rt=d.matrixMult=function(j,ee){return ee.multiply(j)},Ct=new ye(1,0,0,1,0,0);d.unitMatrix=d.identityMatrix=Ct;var St=function(j,ee){if(!Ta[j]){var me=(ee instanceof Sl?"Sh":"P")+(Object.keys(nr).length+1).toString(10);ee.id=me,Ta[j]=me,nr[me]=ee,ir.publish("addPattern",ee)}};d.ShadingPattern=Sl,d.TilingPattern=PA,d.addShadingPattern=function(j,ee){return F("addShadingPattern()"),St(j,ee),this},d.beginTilingPattern=function(j){F("beginTilingPattern()"),T0(j.boundingBox[0],j.boundingBox[1],j.boundingBox[2]-j.boundingBox[0],j.boundingBox[3]-j.boundingBox[1],j.matrix)},d.endTilingPattern=function(j,ee){F("endTilingPattern()"),ee.stream=we[U].join(`
`),St(j,ee),ir.publish("endTilingPattern",ee),De.pop().restore()};var kt=d.__private__.newObject=function(){var j=Xt();return te(j,!0),j},Xt=d.__private__.newObjectDeferred=function(){return O++,z[O]=function(){return Y},O},te=function(j,ee){return ee=typeof ee=="boolean"&&ee,z[j]=Y,ee&&he(j+" 0 obj"),j},ue=d.__private__.newAdditionalObject=function(){var j={objId:Xt(),content:""};return le.push(j),j},ae=Xt(),Ae=Xt(),fe=d.__private__.decodeColorString=function(j){var ee=j.split(" ");if(ee.length!==2||ee[1]!=="g"&&ee[1]!=="G")ee.length===5&&(ee[4]==="k"||ee[4]==="K")&&(ee=[(1-ee[0])*(1-ee[3]),(1-ee[1])*(1-ee[3]),(1-ee[2])*(1-ee[3]),"r"]);else{var me=parseFloat(ee[0]);ee=[me,me,me,"r"]}for(var Se="#",Ue=0;Ue<3;Ue++)Se+=("0"+Math.floor(255*parseFloat(ee[Ue])).toString(16)).slice(-2);return Se},ge=d.__private__.encodeColorString=function(j){var ee;typeof j=="string"&&(j={ch1:j});var me=j.ch1,Se=j.ch2,Ue=j.ch3,$e=j.ch4,it=j.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof me=="string"&&me.charAt(0)!=="#"){var vt=new $T(me);if(vt.ok)me=vt.toHex();else if(!/^\d*\.?\d*$/.test(me))throw new Error('Invalid color "'+me+'" passed to jsPDF.encodeColorString.')}if(typeof me=="string"&&/^#[0-9A-Fa-f]{3}$/.test(me)&&(me="#"+me[1]+me[1]+me[2]+me[2]+me[3]+me[3]),typeof me=="string"&&/^#[0-9A-Fa-f]{6}$/.test(me)){var Tt=parseInt(me.substr(1),16);me=Tt>>16&255,Se=Tt>>8&255,Ue=255&Tt}if(Se===void 0||$e===void 0&&me===Se&&Se===Ue)if(typeof me=="string")ee=me+" "+it[0];else switch(j.precision){case 2:ee=I(me/255)+" "+it[0];break;case 3:default:ee=S(me/255)+" "+it[0]}else if($e===void 0||_r($e)==="object"){if($e&&!isNaN($e.a)&&$e.a===0)return ee=["1.","1.","1.",it[1]].join(" ");if(typeof me=="string")ee=[me,Se,Ue,it[1]].join(" ");else switch(j.precision){case 2:ee=[I(me/255),I(Se/255),I(Ue/255),it[1]].join(" ");break;default:case 3:ee=[S(me/255),S(Se/255),S(Ue/255),it[1]].join(" ")}}else if(typeof me=="string")ee=[me,Se,Ue,$e,it[2]].join(" ");else switch(j.precision){case 2:ee=[I(me),I(Se),I(Ue),I($e),it[2]].join(" ");break;case 3:default:ee=[S(me),S(Se),S(Ue),S($e),it[2]].join(" ")}return ee},Oe=d.__private__.getFilters=function(){return s},Ke=d.__private__.putStream=function(j){var ee=(j=j||{}).data||"",me=j.filters||Oe(),Se=j.alreadyAppliedFilters||[],Ue=j.addLength1||!1,$e=ee.length,it=j.objectId,vt=function(Ai){return Ai};if(u!==null&&it===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(vt=li.encryptor(it,0));var Tt={};me===!0&&(me=["FlateEncode"]);var Gt=j.additionalKeyValues||[],Ht=(Tt=Ut.API.processDataByFilters!==void 0?Ut.API.processDataByFilters(ee,me):{data:ee,reverseChain:[]}).reverseChain+(Array.isArray(Se)?Se.join(" "):Se.toString());if(Tt.data.length!==0&&(Gt.push({key:"Length",value:Tt.data.length}),Ue===!0&&Gt.push({key:"Length1",value:$e})),Ht.length!=0)if(Ht.split("/").length-1==1)Gt.push({key:"Filter",value:Ht});else{Gt.push({key:"Filter",value:"["+Ht+"]"});for(var ar=0;ar<Gt.length;ar+=1)if(Gt[ar].key==="DecodeParms"){for(var qr=[],nn=0;nn<Tt.reverseChain.split("/").length-1;nn+=1)qr.push("null");qr.push(Gt[ar].value),Gt[ar].value="["+qr.join(" ")+"]"}}he("<<");for(var _n=0;_n<Gt.length;_n++)he("/"+Gt[_n].key+" "+Gt[_n].value);he(">>"),Tt.data.length!==0&&(he("stream"),he(vt(Tt.data)),he("endstream"))},Ie=d.__private__.putPage=function(j){var ee=j.number,me=j.data,Se=j.objId,Ue=j.contentsObjId;te(Se,!0),he("<</Type /Page"),he("/Parent "+j.rootDictionaryObjId+" 0 R"),he("/Resources "+j.resourceDictionaryObjId+" 0 R"),he("/MediaBox ["+parseFloat(_(j.mediaBox.bottomLeftX))+" "+parseFloat(_(j.mediaBox.bottomLeftY))+" "+_(j.mediaBox.topRightX)+" "+_(j.mediaBox.topRightY)+"]"),j.cropBox!==null&&he("/CropBox ["+_(j.cropBox.bottomLeftX)+" "+_(j.cropBox.bottomLeftY)+" "+_(j.cropBox.topRightX)+" "+_(j.cropBox.topRightY)+"]"),j.bleedBox!==null&&he("/BleedBox ["+_(j.bleedBox.bottomLeftX)+" "+_(j.bleedBox.bottomLeftY)+" "+_(j.bleedBox.topRightX)+" "+_(j.bleedBox.topRightY)+"]"),j.trimBox!==null&&he("/TrimBox ["+_(j.trimBox.bottomLeftX)+" "+_(j.trimBox.bottomLeftY)+" "+_(j.trimBox.topRightX)+" "+_(j.trimBox.topRightY)+"]"),j.artBox!==null&&he("/ArtBox ["+_(j.artBox.bottomLeftX)+" "+_(j.artBox.bottomLeftY)+" "+_(j.artBox.topRightX)+" "+_(j.artBox.topRightY)+"]"),typeof j.userUnit=="number"&&j.userUnit!==1&&he("/UserUnit "+j.userUnit),ir.publish("putPage",{objId:Se,pageContext:Pt[ee],pageNumber:ee,page:me}),he("/Contents "+Ue+" 0 R"),he(">>"),he("endobj");var $e=me.join(`
`);return y===v.ADVANCED&&($e+=`
Q`),te(Ue,!0),Ke({data:$e,filters:Oe(),objectId:Ue}),he("endobj"),Se},Re=d.__private__.putPages=function(){var j,ee,me=[];for(j=1;j<=vr;j++)Pt[j].objId=Xt(),Pt[j].contentsObjId=Xt();for(j=1;j<=vr;j++)me.push(Ie({number:j,data:we[j],objId:Pt[j].objId,contentsObjId:Pt[j].contentsObjId,mediaBox:Pt[j].mediaBox,cropBox:Pt[j].cropBox,bleedBox:Pt[j].bleedBox,trimBox:Pt[j].trimBox,artBox:Pt[j].artBox,userUnit:Pt[j].userUnit,rootDictionaryObjId:ae,resourceDictionaryObjId:Ae}));te(ae,!0),he("<</Type /Pages");var Se="/Kids [";for(ee=0;ee<vr;ee++)Se+=me[ee]+" 0 R ";he(Se+"]"),he("/Count "+vr),he(">>"),he("endobj"),ir.publish("postPutPages")},He=function(j){ir.publish("putFont",{font:j,out:he,newObject:kt,putStream:Ke}),j.isAlreadyPutted!==!0&&(j.objectNumber=kt(),he("<<"),he("/Type /Font"),he("/BaseFont /"+fu(j.postScriptName)),he("/Subtype /Type1"),typeof j.encoding=="string"&&he("/Encoding /"+j.encoding),he("/FirstChar 32"),he("/LastChar 255"),he(">>"),he("endobj"))},nt=function(){for(var j in fr)fr.hasOwnProperty(j)&&(f===!1||f===!0&&h.hasOwnProperty(j))&&He(fr[j])},lt=function(j){j.objectNumber=kt();var ee=[];ee.push({key:"Type",value:"/XObject"}),ee.push({key:"Subtype",value:"/Form"}),ee.push({key:"BBox",value:"["+[_(j.x),_(j.y),_(j.x+j.width),_(j.y+j.height)].join(" ")+"]"}),ee.push({key:"Matrix",value:"["+j.matrix.toString()+"]"});var me=j.pages[1].join(`
`);Ke({data:me,additionalKeyValues:ee,objectId:j.objectNumber}),he("endobj")},pt=function(){for(var j in _e)_e.hasOwnProperty(j)&&lt(_e[j])},st=function(j,ee){var me,Se=[],Ue=1/(ee-1);for(me=0;me<1;me+=Ue)Se.push(me);if(Se.push(1),j[0].offset!=0){var $e={offset:0,color:j[0].color};j.unshift($e)}if(j[j.length-1].offset!=1){var it={offset:1,color:j[j.length-1].color};j.push(it)}for(var vt="",Tt=0,Gt=0;Gt<Se.length;Gt++){for(me=Se[Gt];me>j[Tt+1].offset;)Tt++;var Ht=j[Tt].offset,ar=(me-Ht)/(j[Tt+1].offset-Ht),qr=j[Tt].color,nn=j[Tt+1].color;vt+=D(Math.round((1-ar)*qr[0]+ar*nn[0]).toString(16))+D(Math.round((1-ar)*qr[1]+ar*nn[1]).toString(16))+D(Math.round((1-ar)*qr[2]+ar*nn[2]).toString(16))}return vt.trim()},dt=function(j,ee){ee||(ee=21);var me=kt(),Se=st(j.colors,ee),Ue=[];Ue.push({key:"FunctionType",value:"0"}),Ue.push({key:"Domain",value:"[0.0 1.0]"}),Ue.push({key:"Size",value:"["+ee+"]"}),Ue.push({key:"BitsPerSample",value:"8"}),Ue.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ue.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ke({data:Se,additionalKeyValues:Ue,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:me}),he("endobj"),j.objectNumber=kt(),he("<< /ShadingType "+j.type),he("/ColorSpace /DeviceRGB");var $e="/Coords ["+_(parseFloat(j.coords[0]))+" "+_(parseFloat(j.coords[1]))+" ";j.type===2?$e+=_(parseFloat(j.coords[2]))+" "+_(parseFloat(j.coords[3])):$e+=_(parseFloat(j.coords[2]))+" "+_(parseFloat(j.coords[3]))+" "+_(parseFloat(j.coords[4]))+" "+_(parseFloat(j.coords[5])),he($e+="]"),j.matrix&&he("/Matrix ["+j.matrix.toString()+"]"),he("/Function "+me+" 0 R"),he("/Extend [true true]"),he(">>"),he("endobj")},Nt=function(j,ee){var me=Xt(),Se=kt();ee.push({resourcesOid:me,objectOid:Se}),j.objectNumber=Se;var Ue=[];Ue.push({key:"Type",value:"/Pattern"}),Ue.push({key:"PatternType",value:"1"}),Ue.push({key:"PaintType",value:"1"}),Ue.push({key:"TilingType",value:"1"}),Ue.push({key:"BBox",value:"["+j.boundingBox.map(_).join(" ")+"]"}),Ue.push({key:"XStep",value:_(j.xStep)}),Ue.push({key:"YStep",value:_(j.yStep)}),Ue.push({key:"Resources",value:me+" 0 R"}),j.matrix&&Ue.push({key:"Matrix",value:"["+j.matrix.toString()+"]"}),Ke({data:j.stream,additionalKeyValues:Ue,objectId:j.objectNumber}),he("endobj")},pr=function(j){var ee;for(ee in nr)nr.hasOwnProperty(ee)&&(nr[ee]instanceof Sl?dt(nr[ee]):nr[ee]instanceof PA&&Nt(nr[ee],j))},Rt=function(j){for(var ee in j.objectNumber=kt(),he("<<"),j)switch(ee){case"opacity":he("/ca "+I(j[ee]));break;case"stroke-opacity":he("/CA "+I(j[ee]))}he(">>"),he("endobj")},rn=function(){var j;for(j in Nr)Nr.hasOwnProperty(j)&&Rt(Nr[j])},Vi=function(){for(var j in he("/XObject <<"),_e)_e.hasOwnProperty(j)&&_e[j].objectNumber>=0&&he("/"+j+" "+_e[j].objectNumber+" 0 R");ir.publish("putXobjectDict"),he(">>")},uo=function(){li.oid=kt(),he("<<"),he("/Filter /Standard"),he("/V "+li.v),he("/R "+li.r),he("/U <"+li.toHexString(li.U)+">"),he("/O <"+li.toHexString(li.O)+">"),he("/P "+li.P),he(">>"),he("endobj")},Ps=function(){for(var j in he("/Font <<"),fr)fr.hasOwnProperty(j)&&(f===!1||f===!0&&h.hasOwnProperty(j))&&he("/"+j+" "+fr[j].objectNumber+" 0 R");he(">>")},As=function(){if(Object.keys(nr).length>0){for(var j in he("/Shading <<"),nr)nr.hasOwnProperty(j)&&nr[j]instanceof Sl&&nr[j].objectNumber>=0&&he("/"+j+" "+nr[j].objectNumber+" 0 R");ir.publish("putShadingPatternDict"),he(">>")}},Qs=function(j){if(Object.keys(nr).length>0){for(var ee in he("/Pattern <<"),nr)nr.hasOwnProperty(ee)&&nr[ee]instanceof d.TilingPattern&&nr[ee].objectNumber>=0&&nr[ee].objectNumber<j&&he("/"+ee+" "+nr[ee].objectNumber+" 0 R");ir.publish("putTilingPatternDict"),he(">>")}},ca=function(){if(Object.keys(Nr).length>0){var j;for(j in he("/ExtGState <<"),Nr)Nr.hasOwnProperty(j)&&Nr[j].objectNumber>=0&&he("/"+j+" "+Nr[j].objectNumber+" 0 R");ir.publish("putGStateDict"),he(">>")}},un=function(j){te(j.resourcesOid,!0),he("<<"),he("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Ps(),As(),Qs(j.objectOid),ca(),Vi(),he(">>"),he("endobj")},g0=function(){var j=[];nt(),rn(),pt(),pr(j),ir.publish("putResources"),j.forEach(un),un({resourcesOid:Ae,objectOid:Number.MAX_SAFE_INTEGER}),ir.publish("postPutResources")},m0=function(){ir.publish("putAdditionalObjects");for(var j=0;j<le.length;j++){var ee=le[j];te(ee.objId,!0),he(ee.content),he("endobj")}ir.publish("postPutAdditionalObjects")},v0=function(j){dr[j.fontName]=dr[j.fontName]||{},dr[j.fontName][j.fontStyle]=j.id},xf=function(j,ee,me,Se,Ue){var $e={id:"F"+(Object.keys(fr).length+1).toString(10),postScriptName:j,fontName:ee,fontStyle:me,encoding:Se,isStandardFont:Ue||!1,metadata:{}};return ir.publish("addFont",{font:$e,instance:this}),fr[$e.id]=$e,v0($e),$e.id},H1=function(j){for(var ee=0,me=se.length;ee<me;ee++){var Se=xf.call(this,j[ee][0],j[ee][1],j[ee][2],se[ee][3],!0);f===!1&&(h[Se]=!0);var Ue=j[ee][0].split("-");v0({id:Se,fontName:Ue[0],fontStyle:Ue[1]||""})}ir.publish("addFonts",{fonts:fr,dictionary:dr})},cs=function(j){return j.foo=function(){try{return j.apply(this,arguments)}catch(Se){var ee=Se.stack||"";~ee.indexOf(" at ")&&(ee=ee.split(" at ")[1]);var me="Error in function "+ee.split(`
`)[0].split("<")[0]+": "+Se.message;if(!jt.console)throw new Error(me);jt.console.error(me,Se),jt.alert&&alert(me)}},j.foo.bar=j,j.foo},yc=function(j,ee){var me,Se,Ue,$e,it,vt,Tt,Gt,Ht;if(Ue=(ee=ee||{}).sourceEncoding||"Unicode",it=ee.outputEncoding,(ee.autoencode||it)&&fr[at].metadata&&fr[at].metadata[Ue]&&fr[at].metadata[Ue].encoding&&($e=fr[at].metadata[Ue].encoding,!it&&fr[at].encoding&&(it=fr[at].encoding),!it&&$e.codePages&&(it=$e.codePages[0]),typeof it=="string"&&(it=$e[it]),it)){for(Tt=!1,vt=[],me=0,Se=j.length;me<Se;me++)(Gt=it[j.charCodeAt(me)])?vt.push(String.fromCharCode(Gt)):vt.push(j[me]),vt[me].charCodeAt(0)>>8&&(Tt=!0);j=vt.join("")}for(me=j.length;Tt===void 0&&me!==0;)j.charCodeAt(me-1)>>8&&(Tt=!0),me--;if(!Tt)return j;for(vt=ee.noBOM?[]:[254,255],me=0,Se=j.length;me<Se;me++){if((Ht=(Gt=j.charCodeAt(me))>>8)>>8)throw new Error("Character at position "+me+" of string '"+j+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");vt.push(Ht),vt.push(Gt-(Ht<<8))}return String.fromCharCode.apply(void 0,vt)},Wi=d.__private__.pdfEscape=d.pdfEscape=function(j,ee){return yc(j,ee).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},yf=d.__private__.beginPage=function(j){we[++vr]=[],Pt[vr]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(j[0]),topRightY:Number(j[1])}},y0(vr),Fe(we[U])},x0=function(j,ee){var me,Se,Ue;switch(r=ee||r,typeof j=="string"&&(me=p(j.toLowerCase()),Array.isArray(me)&&(Se=me[0],Ue=me[1])),Array.isArray(j)&&(Se=j[0]*et,Ue=j[1]*et),isNaN(Se)&&(Se=i[0],Ue=i[1]),(Se>14400||Ue>14400)&&(Lr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Se=Math.min(14400,Se),Ue=Math.min(14400,Ue)),i=[Se,Ue],r.substr(0,1)){case"l":Ue>Se&&(i=[Ue,Se]);break;case"p":Se>Ue&&(i=[Ue,Se])}yf(i),S0(_f),he(us),Sf!==0&&he(Sf+" J"),Ef!==0&&he(Ef+" j"),ir.publish("addPage",{pageNumber:vr})},K1=function(j){j>0&&j<=vr&&(we.splice(j,1),Pt.splice(j,1),vr--,U>vr&&(U=vr),this.setPage(U))},y0=function(j){j>0&&j<=vr&&(U=j)},G1=d.__private__.getNumberOfPages=d.getNumberOfPages=function(){return we.length-1},w0=function(j,ee,me){var Se,Ue=void 0;return me=me||{},j=j!==void 0?j:fr[at].fontName,ee=ee!==void 0?ee:fr[at].fontStyle,Se=j.toLowerCase(),dr[Se]!==void 0&&dr[Se][ee]!==void 0?Ue=dr[Se][ee]:dr[j]!==void 0&&dr[j][ee]!==void 0?Ue=dr[j][ee]:me.disableWarning===!1&&Lr.warn("Unable to look up font label for font '"+j+"', '"+ee+"'. Refer to getFontList() for available fonts."),Ue||me.noFallback||(Ue=dr.times[ee])==null&&(Ue=dr.times.normal),Ue},V1=d.__private__.putInfo=function(){var j=kt(),ee=function(Se){return Se};for(var me in u!==null&&(ee=li.encryptor(j,0)),he("<<"),he("/Producer ("+Wi(ee("jsPDF "+Ut.version))+")"),wt)wt.hasOwnProperty(me)&&wt[me]&&he("/"+me.substr(0,1).toUpperCase()+me.substr(1)+" ("+Wi(ee(wt[me]))+")");he("/CreationDate ("+Wi(ee(W))+")"),he(">>"),he("endobj")},wf=d.__private__.putCatalog=function(j){var ee=(j=j||{}).rootDictionaryObjId||ae;switch(kt(),he("<<"),he("/Type /Catalog"),he("/Pages "+ee+" 0 R"),Te||(Te="fullwidth"),Te){case"fullwidth":he("/OpenAction [3 0 R /FitH null]");break;case"fullheight":he("/OpenAction [3 0 R /FitV null]");break;case"fullpage":he("/OpenAction [3 0 R /Fit]");break;case"original":he("/OpenAction [3 0 R /XYZ null null 1]");break;default:var me=""+Te;me.substr(me.length-1)==="%"&&(Te=parseInt(Te)/100),typeof Te=="number"&&he("/OpenAction [3 0 R /XYZ null null "+I(Te)+"]")}switch(ft||(ft="continuous"),ft){case"continuous":he("/PageLayout /OneColumn");break;case"single":he("/PageLayout /SinglePage");break;case"two":case"twoleft":he("/PageLayout /TwoColumnLeft");break;case"tworight":he("/PageLayout /TwoColumnRight")}Ve&&he("/PageMode /"+Ve),ir.publish("putCatalog"),he(">>"),he("endobj")},W1=d.__private__.putTrailer=function(){he("trailer"),he("<<"),he("/Size "+(O+1)),he("/Root "+O+" 0 R"),he("/Info "+(O-1)+" 0 R"),u!==null&&he("/Encrypt "+li.oid+" 0 R"),he("/ID [ <"+G+"> <"+G+"> ]"),he(">>")},$1=d.__private__.putHeader=function(){he("%PDF-"+m),he("%ºß¬à")},q1=d.__private__.putXRef=function(){var j="0000000000";he("xref"),he("0 "+(O+1)),he("0000000000 65535 f ");for(var ee=1;ee<=O;ee++)typeof z[ee]=="function"?he((j+z[ee]()).slice(-10)+" 00000 n "):z[ee]!==void 0?he((j+z[ee]).slice(-10)+" 00000 n "):he("0000000000 00000 n ")},fo=d.__private__.buildDocument=function(){qe(),Fe(J),ir.publish("buildDocument"),$1(),Re(),m0(),g0(),u!==null&&uo(),V1(),wf();var j=Y;return q1(),W1(),he("startxref"),he(""+j),he("%%EOF"),Fe(we[U]),J.join(`
`)},wc=d.__private__.getBlob=function(j){return new Blob([xe(j)],{type:"application/pdf"})},bc=d.output=d.__private__.output=cs(function(j,ee){switch(typeof(ee=ee||{})=="string"?ee={filename:ee}:ee.filename=ee.filename||"generated.pdf",j){case void 0:return fo();case"save":d.save(ee.filename);break;case"arraybuffer":return xe(fo());case"blob":return wc(fo());case"bloburi":case"bloburl":if(jt.URL!==void 0&&typeof jt.URL.createObjectURL=="function")return jt.URL&&jt.URL.createObjectURL(wc(fo()))||void 0;Lr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var me="",Se=fo();try{me=jy(Se)}catch{me=jy(unescape(encodeURIComponent(Se)))}return"data:application/pdf;filename="+ee.filename+";base64,"+me;case"pdfobjectnewwindow":if(Object.prototype.toString.call(jt)==="[object Window]"){var Ue="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",$e=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ee.pdfObjectUrl&&(Ue=ee.pdfObjectUrl,$e="");var it='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ue+'"'+$e+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ee)+");<\/script></body></html>",vt=jt.open();return vt!==null&&vt.document.write(it),vt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(jt)==="[object Window]"){var Tt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ee.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ee.filename+'" width="500px" height="400px" /></body></html>',Gt=jt.open();if(Gt!==null){Gt.document.write(Tt);var Ht=this;Gt.document.documentElement.querySelector("#pdfViewer").onload=function(){Gt.document.title=ee.filename,Gt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Ht.output("bloburl"))}}return Gt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(jt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var ar='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ee)+'"></iframe></body></html>',qr=jt.open();if(qr!==null&&(qr.document.write(ar),qr.document.title=ee.filename),qr||typeof safari>"u")return qr;break;case"datauri":case"dataurl":return jt.document.location.href=this.output("datauristring",ee);default:return null}}),b0=function(j){return Array.isArray(ls)===!0&&ls.indexOf(j)>-1};switch(n){case"pt":et=1;break;case"mm":et=72/25.4;break;case"cm":et=72/2.54;break;case"in":et=72;break;case"px":et=b0("px_scaling")==1?.75:96/72;break;case"pc":case"em":et=12;break;case"ex":et=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);et=n}var li=null;H(),X();var z1=function(j){return u!==null?li.encryptor(j,0):function(ee){return ee}},B0=d.__private__.getPageInfo=d.getPageInfo=function(j){if(isNaN(j)||j%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Pt[j].objId,pageNumber:j,pageContext:Pt[j]}},Mt=d.__private__.getPageInfoByObjId=function(j){if(isNaN(j)||j%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ee in Pt)if(Pt[ee].objId===j)break;return B0(ee)},X1=d.__private__.getCurrentPageInfo=d.getCurrentPageInfo=function(){return{objId:Pt[U].objId,pageNumber:U,pageContext:Pt[U]}};d.addPage=function(){return x0.apply(this,arguments),this},d.setPage=function(){return y0.apply(this,arguments),Fe.call(this,we[U]),this},d.insertPage=function(j){return this.addPage(),this.movePage(U,j),this},d.movePage=function(j,ee){var me,Se;if(j>ee){me=we[j],Se=Pt[j];for(var Ue=j;Ue>ee;Ue--)we[Ue]=we[Ue-1],Pt[Ue]=Pt[Ue-1];we[ee]=me,Pt[ee]=Se,this.setPage(ee)}else if(j<ee){me=we[j],Se=Pt[j];for(var $e=j;$e<ee;$e++)we[$e]=we[$e+1],Pt[$e]=Pt[$e+1];we[ee]=me,Pt[ee]=Se,this.setPage(ee)}return this},d.deletePage=function(){return K1.apply(this,arguments),this},d.__private__.text=d.text=function(j,ee,me,Se,Ue){var $e,it,vt,Tt,Gt,Ht,ar,qr,nn,_n=(Se=Se||{}).scope||this;if(typeof j=="number"&&typeof ee=="number"&&(typeof me=="string"||Array.isArray(me))){var Ai=me;me=ee,ee=j,j=Ai}if(arguments[3]instanceof ye?(F("The transform parameter of text() with a Matrix value"),nn=Ue):(vt=arguments[4],Tt=arguments[5],_r(ar=arguments[3])==="object"&&ar!==null||(typeof vt=="string"&&(Tt=vt,vt=null),typeof ar=="string"&&(Tt=ar,ar=null),typeof ar=="number"&&(vt=ar,ar=null),Se={flags:ar,angle:vt,align:Tt})),isNaN(ee)||isNaN(me)||j==null)throw new Error("Invalid arguments passed to jsPDF.text");if(j.length===0)return _n;var Mn="",fs=!1,ua=typeof Se.lineHeightFactor=="number"?Se.lineHeightFactor:dA,Hs=_n.internal.scaleFactor;function L0(Ir){return Ir=Ir.split("	").join(Array(Se.TabLen||9).join(" ")),Wi(Ir,ar)}function Lf(Ir){for(var Ur,hn=Ir.concat(),Ln=[],vo=hn.length;vo--;)typeof(Ur=hn.shift())=="string"?Ln.push(Ur):Array.isArray(Ir)&&(Ur.length===1||Ur[1]===void 0&&Ur[2]===void 0)?Ln.push(Ur[0]):Ln.push([Ur[0],Ur[1],Ur[2]]);return Ln}function If(Ir,Ur){var hn;if(typeof Ir=="string")hn=Ur(Ir)[0];else if(Array.isArray(Ir)){for(var Ln,vo,Mf=Ir.concat(),Dc=[],D0=Mf.length;D0--;)typeof(Ln=Mf.shift())=="string"?Dc.push(Ur(Ln)[0]):Array.isArray(Ln)&&typeof Ln[0]=="string"&&(vo=Ur(Ln[0],Ln[1],Ln[2]),Dc.push([vo[0],vo[1],vo[2]]));hn=Dc}return hn}var kc=!1,Uf=!0;if(typeof j=="string")kc=!0;else if(Array.isArray(j)){var Of=j.concat();it=[];for(var Fc,Yn=Of.length;Yn--;)(typeof(Fc=Of.shift())!="string"||Array.isArray(Fc)&&typeof Fc[0]!="string")&&(Uf=!1);kc=Uf}if(kc===!1)throw new Error('Type of text must be string or Array. "'+j+'" is not recognized.');typeof j=="string"&&(j=j.match(/[\r?\n]/)?j.split(/\r\n|\r|\n/g):[j]);var Nc=be/_n.internal.scaleFactor,Tc=Nc*(ua-1);switch(Se.baseline){case"bottom":me-=Tc;break;case"top":me+=Nc-Tc;break;case"hanging":me+=Nc-2*Tc;break;case"middle":me+=Nc/2-Tc}if((Ht=Se.maxWidth||0)>0&&(typeof j=="string"?j=_n.splitTextToSize(j,Ht):Object.prototype.toString.call(j)==="[object Array]"&&(j=j.reduce(function(Ir,Ur){return Ir.concat(_n.splitTextToSize(Ur,Ht))},[]))),$e={text:j,x:ee,y:me,options:Se,mutex:{pdfEscape:Wi,activeFontKey:at,fonts:fr,activeFontSize:be}},ir.publish("preProcessText",$e),j=$e.text,vt=(Se=$e.options).angle,!(nn instanceof ye)&&vt&&typeof vt=="number"){vt*=Math.PI/180,Se.rotationDirection===0&&(vt=-vt),y===v.ADVANCED&&(vt=-vt);var Lc=Math.cos(vt),jf=Math.sin(vt);nn=new ye(Lc,jf,-jf,Lc,0,0)}else vt&&vt instanceof ye&&(nn=vt);y!==v.ADVANCED||nn||(nn=Ct),(Gt=Se.charSpace||Cc)!==void 0&&(Mn+=_(C(Gt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(qr=Se.horizontalScale)!==void 0&&(Mn+=_(100*qr)+` Tz
`),Se.lang;var $i=-1,sv=Se.renderingMode!==void 0?Se.renderingMode:Se.stroke,Df=_n.internal.getCurrentPageInfo().pageContext;switch(sv){case 0:case!1:case"fill":$i=0;break;case 1:case!0:case"stroke":$i=1;break;case 2:case"fillThenStroke":$i=2;break;case 3:case"invisible":$i=3;break;case 4:case"fillAndAddForClipping":$i=4;break;case 5:case"strokeAndAddPathForClipping":$i=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":$i=6;break;case 7:case"addToPathForClipping":$i=7}var I0=Df.usedRenderingMode!==void 0?Df.usedRenderingMode:-1;$i!==-1?Mn+=$i+` Tr
`:I0!==-1&&(Mn+=`0 Tr
`),$i!==-1&&(Df.usedRenderingMode=$i),Tt=Se.align||"left";var La,Ic=be*ua,U0=_n.internal.pageSize.getWidth(),O0=fr[at];Gt=Se.charSpace||Cc,Ht=Se.maxWidth||0,ar=Object.assign({autoencode:!0,noBOM:!0},Se.flags);var Zo=[],mA=function(Ir){return _n.getStringUnitWidth(Ir,{font:O0,charSpace:Gt,fontSize:be,doKerning:!1})*be/Hs};if(Object.prototype.toString.call(j)==="[object Array]"){var qi;it=Lf(j),Tt!=="left"&&(La=it.map(mA));var Ii,el=0;if(Tt==="right"){ee-=La[0],j=[],Yn=it.length;for(var po=0;po<Yn;po++)po===0?(Ii=Ms(ee),qi=ho(me)):(Ii=C(el-La[po]),qi=-Ic),j.push([it[po],Ii,qi]),el=La[po]}else if(Tt==="center"){ee-=La[0]/2,j=[],Yn=it.length;for(var go=0;go<Yn;go++)go===0?(Ii=Ms(ee),qi=ho(me)):(Ii=C((el-La[go])/2),qi=-Ic),j.push([it[go],Ii,qi]),el=La[go]}else if(Tt==="left"){j=[],Yn=it.length;for(var Uc=0;Uc<Yn;Uc++)j.push(it[Uc])}else if(Tt==="justify"&&O0.encoding==="Identity-H"){j=[],Yn=it.length,Ht=Ht!==0?Ht:U0;for(var mo=0,fn=0;fn<Yn;fn++)if(qi=fn===0?ho(me):-Ic,Ii=fn===0?Ms(ee):mo,fn<Yn-1){var Pf=C((Ht-La[fn])/(it[fn].split(" ").length-1)),Ui=it[fn].split(" ");j.push([Ui[0]+" ",Ii,qi]),mo=0;for(var Ia=1;Ia<Ui.length;Ia++){var Oc=(mA(Ui[Ia-1]+" "+Ui[Ia])-mA(Ui[Ia]))*Hs+Pf;Ia==Ui.length-1?j.push([Ui[Ia],Oc,0]):j.push([Ui[Ia]+" ",Oc,0]),mo-=Oc}}else j.push([it[fn],Ii,qi]);j.push(["",mo,0])}else{if(Tt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(j=[],Yn=it.length,Ht=Ht!==0?Ht:U0,fn=0;fn<Yn;fn++)qi=fn===0?ho(me):-Ic,Ii=fn===0?Ms(ee):0,fn<Yn-1?Zo.push(_(C((Ht-La[fn])/(it[fn].split(" ").length-1)))):Zo.push(0),j.push([it[fn],Ii,qi])}}var j0=typeof Se.R2L=="boolean"?Se.R2L:je;j0===!0&&(j=If(j,function(Ir,Ur,hn){return[Ir.split("").reverse().join(""),Ur,hn]})),$e={text:j,x:ee,y:me,options:Se,mutex:{pdfEscape:Wi,activeFontKey:at,fonts:fr,activeFontSize:be}},ir.publish("postProcessText",$e),j=$e.text,fs=$e.mutex.isHex||!1;var Qf=fr[at].encoding;Qf!=="WinAnsiEncoding"&&Qf!=="StandardEncoding"||(j=If(j,function(Ir,Ur,hn){return[L0(Ir),Ur,hn]})),it=Lf(j),j=[];for(var vA,xA,tl,yA=0,jc=1,wA=Array.isArray(it[0])?jc:yA,rl="",Rf=function(Ir,Ur,hn){var Ln="";return hn instanceof ye?(hn=typeof Se.angle=="number"?rt(hn,new ye(1,0,0,1,Ir,Ur)):rt(new ye(1,0,0,1,Ir,Ur),hn),y===v.ADVANCED&&(hn=rt(new ye(1,0,0,-1,0,0),hn)),Ln=hn.join(" ")+` Tm
`):Ln=_(Ir)+" "+_(Ur)+` Td
`,Ln},Ua=0;Ua<it.length;Ua++){switch(rl="",wA){case jc:tl=(fs?"<":"(")+it[Ua][0]+(fs?">":")"),vA=parseFloat(it[Ua][1]),xA=parseFloat(it[Ua][2]);break;case yA:tl=(fs?"<":"(")+it[Ua]+(fs?">":")"),vA=Ms(ee),xA=ho(me)}Zo!==void 0&&Zo[Ua]!==void 0&&(rl=Zo[Ua]+` Tw
`),Ua===0?j.push(rl+Rf(vA,xA,nn)+tl):wA===yA?j.push(rl+tl):wA===jc&&j.push(rl+Rf(vA,xA,nn)+tl)}j=wA===yA?j.join(` Tj
T* `):j.join(` Tj
`),j+=` Tj
`;var Oa=`BT
/`;return Oa+=at+" "+be+` Tf
`,Oa+=_(be*ua)+` TL
`,Oa+=pA+`
`,Oa+=Mn,Oa+=j,he(Oa+="ET"),h[at]=!0,_n};var Y1=d.__private__.clip=d.clip=function(j){return he(j==="evenodd"?"W*":"W"),this};d.clipEvenOdd=function(){return Y1("evenodd")},d.__private__.discardPath=d.discardPath=function(){return he("n"),this};var Rs=d.__private__.isValidStyle=function(j){var ee=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(j)!==-1&&(ee=!0),ee};d.__private__.setDefaultPathOperation=d.setDefaultPathOperation=function(j){return Rs(j)&&(A=j),this};var _0=d.__private__.getStyle=d.getStyle=function(j){var ee=A;switch(j){case"D":case"S":ee="S";break;case"F":ee="f";break;case"FD":case"DF":ee="B";break;case"f":case"f*":case"B":case"B*":ee=j}return ee},C0=d.close=function(){return he("h"),this};d.stroke=function(){return he("S"),this},d.fill=function(j){return Bc("f",j),this},d.fillEvenOdd=function(j){return Bc("f*",j),this},d.fillStroke=function(j){return Bc("B",j),this},d.fillStrokeEvenOdd=function(j){return Bc("B*",j),this};var Bc=function(j,ee){_r(ee)==="object"?Z1(ee,j):he(j)},bf=function(j){j===null||y===v.ADVANCED&&j===void 0||(j=_0(j),he(j))};function J1(j,ee,me,Se,Ue){var $e=new PA(ee||this.boundingBox,me||this.xStep,Se||this.yStep,this.gState,Ue||this.matrix);$e.stream=this.stream;var it=j+"$$"+this.cloneIndex+++"$$";return St(it,$e),$e}var Z1=function(j,ee){var me=Ta[j.key],Se=nr[me];if(Se instanceof Sl)he("q"),he(ev(ee)),Se.gState&&d.setGState(Se.gState),he(j.matrix.toString()+" cm"),he("/"+me+" sh"),he("Q");else if(Se instanceof PA){var Ue=new ye(1,0,0,-1,0,Jo());j.matrix&&(Ue=Ue.multiply(j.matrix||Ct),me=J1.call(Se,j.key,j.boundingBox,j.xStep,j.yStep,Ue).id),he("q"),he("/Pattern cs"),he("/"+me+" scn"),Se.gState&&d.setGState(Se.gState),he(ee),he("Q")}},ev=function(j){switch(j){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Bf=d.moveTo=function(j,ee){return he(_(C(j))+" "+_(R(ee))+" m"),this},hA=d.lineTo=function(j,ee){return he(_(C(j))+" "+_(R(ee))+" l"),this},Xo=d.curveTo=function(j,ee,me,Se,Ue,$e){return he([_(C(j)),_(R(ee)),_(C(me)),_(R(Se)),_(C(Ue)),_(R($e)),"c"].join(" ")),this};d.__private__.line=d.line=function(j,ee,me,Se,Ue){if(isNaN(j)||isNaN(ee)||isNaN(me)||isNaN(Se)||!Rs(Ue))throw new Error("Invalid arguments passed to jsPDF.line");return y===v.COMPAT?this.lines([[me-j,Se-ee]],j,ee,[1,1],Ue||"S"):this.lines([[me-j,Se-ee]],j,ee,[1,1]).stroke()},d.__private__.lines=d.lines=function(j,ee,me,Se,Ue,$e){var it,vt,Tt,Gt,Ht,ar,qr,nn,_n,Ai,Mn,fs;if(typeof j=="number"&&(fs=me,me=ee,ee=j,j=fs),Se=Se||[1,1],$e=$e||!1,isNaN(ee)||isNaN(me)||!Array.isArray(j)||!Array.isArray(Se)||!Rs(Ue)||typeof $e!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Bf(ee,me),it=Se[0],vt=Se[1],Gt=j.length,Ai=ee,Mn=me,Tt=0;Tt<Gt;Tt++)(Ht=j[Tt]).length===2?(Ai=Ht[0]*it+Ai,Mn=Ht[1]*vt+Mn,hA(Ai,Mn)):(ar=Ht[0]*it+Ai,qr=Ht[1]*vt+Mn,nn=Ht[2]*it+Ai,_n=Ht[3]*vt+Mn,Ai=Ht[4]*it+Ai,Mn=Ht[5]*vt+Mn,Xo(ar,qr,nn,_n,Ai,Mn));return $e&&C0(),bf(Ue),this},d.path=function(j){for(var ee=0;ee<j.length;ee++){var me=j[ee],Se=me.c;switch(me.op){case"m":Bf(Se[0],Se[1]);break;case"l":hA(Se[0],Se[1]);break;case"c":Xo.apply(this,Se);break;case"h":C0()}}return this},d.__private__.rect=d.rect=function(j,ee,me,Se,Ue){if(isNaN(j)||isNaN(ee)||isNaN(me)||isNaN(Se)||!Rs(Ue))throw new Error("Invalid arguments passed to jsPDF.rect");return y===v.COMPAT&&(Se=-Se),he([_(C(j)),_(R(ee)),_(C(me)),_(C(Se)),"re"].join(" ")),bf(Ue),this},d.__private__.triangle=d.triangle=function(j,ee,me,Se,Ue,$e,it){if(isNaN(j)||isNaN(ee)||isNaN(me)||isNaN(Se)||isNaN(Ue)||isNaN($e)||!Rs(it))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[me-j,Se-ee],[Ue-me,$e-Se],[j-Ue,ee-$e]],j,ee,[1,1],it,!0),this},d.__private__.roundedRect=d.roundedRect=function(j,ee,me,Se,Ue,$e,it){if(isNaN(j)||isNaN(ee)||isNaN(me)||isNaN(Se)||isNaN(Ue)||isNaN($e)||!Rs(it))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var vt=4/3*(Math.SQRT2-1);return Ue=Math.min(Ue,.5*me),$e=Math.min($e,.5*Se),this.lines([[me-2*Ue,0],[Ue*vt,0,Ue,$e-$e*vt,Ue,$e],[0,Se-2*$e],[0,$e*vt,-Ue*vt,$e,-Ue,$e],[2*Ue-me,0],[-Ue*vt,0,-Ue,-$e*vt,-Ue,-$e],[0,2*$e-Se],[0,-$e*vt,Ue*vt,-$e,Ue,-$e]],j+Ue,ee,[1,1],it,!0),this},d.__private__.ellipse=d.ellipse=function(j,ee,me,Se,Ue){if(isNaN(j)||isNaN(ee)||isNaN(me)||isNaN(Se)||!Rs(Ue))throw new Error("Invalid arguments passed to jsPDF.ellipse");var $e=4/3*(Math.SQRT2-1)*me,it=4/3*(Math.SQRT2-1)*Se;return Bf(j+me,ee),Xo(j+me,ee-it,j+$e,ee-Se,j,ee-Se),Xo(j-$e,ee-Se,j-me,ee-it,j-me,ee),Xo(j-me,ee+it,j-$e,ee+Se,j,ee+Se),Xo(j+$e,ee+Se,j+me,ee+it,j+me,ee),bf(Ue),this},d.__private__.circle=d.circle=function(j,ee,me,Se){if(isNaN(j)||isNaN(ee)||isNaN(me)||!Rs(Se))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(j,ee,me,me,Se)},d.setFont=function(j,ee,me){return me&&(ee=E(ee,me)),at=w0(j,ee,{disableWarning:!1}),this};var tv=d.__private__.getFont=d.getFont=function(){return fr[w0.apply(d,arguments)]};d.__private__.getFontList=d.getFontList=function(){var j,ee,me={};for(j in dr)if(dr.hasOwnProperty(j))for(ee in me[j]=[],dr[j])dr[j].hasOwnProperty(ee)&&me[j].push(ee);return me},d.addFont=function(j,ee,me,Se,Ue){var $e=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&$e.indexOf(arguments[3])!==-1?Ue=arguments[3]:arguments[3]&&$e.indexOf(arguments[3])==-1&&(me=E(me,Se)),Ue=Ue||"Identity-H",xf.call(this,j,ee,me,Ue)};var dA,_f=e.lineWidth||.200025,_c=d.__private__.getLineWidth=d.getLineWidth=function(){return _f},S0=d.__private__.setLineWidth=d.setLineWidth=function(j){return _f=j,he(_(C(j))+" w"),this};d.__private__.setLineDash=Ut.API.setLineDash=Ut.API.setLineDashPattern=function(j,ee){if(j=j||[],ee=ee||0,isNaN(ee)||!Array.isArray(j))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return j=j.map(function(me){return _(C(me))}).join(" "),ee=_(C(ee)),he("["+j+"] "+ee+" d"),this};var E0=d.__private__.getLineHeight=d.getLineHeight=function(){return be*dA};d.__private__.getLineHeight=d.getLineHeight=function(){return be*dA};var k0=d.__private__.setLineHeightFactor=d.setLineHeightFactor=function(j){return typeof(j=j||1.15)=="number"&&(dA=j),this},F0=d.__private__.getLineHeightFactor=d.getLineHeightFactor=function(){return dA};k0(e.lineHeight);var Ms=d.__private__.getHorizontalCoordinate=function(j){return C(j)},ho=d.__private__.getVerticalCoordinate=function(j){return y===v.ADVANCED?j:Pt[U].mediaBox.topRightY-Pt[U].mediaBox.bottomLeftY-C(j)},rv=d.__private__.getHorizontalCoordinateString=d.getHorizontalCoordinateString=function(j){return _(Ms(j))},Yo=d.__private__.getVerticalCoordinateString=d.getVerticalCoordinateString=function(j){return _(ho(j))},us=e.strokeColor||"0 G";d.__private__.getStrokeColor=d.getDrawColor=function(){return fe(us)},d.__private__.setStrokeColor=d.setDrawColor=function(j,ee,me,Se){return us=ge({ch1:j,ch2:ee,ch3:me,ch4:Se,pdfColorType:"draw",precision:2}),he(us),this};var Cf=e.fillColor||"0 g";d.__private__.getFillColor=d.getFillColor=function(){return fe(Cf)},d.__private__.setFillColor=d.setFillColor=function(j,ee,me,Se){return Cf=ge({ch1:j,ch2:ee,ch3:me,ch4:Se,pdfColorType:"fill",precision:2}),he(Cf),this};var pA=e.textColor||"0 g",nv=d.__private__.getTextColor=d.getTextColor=function(){return fe(pA)};d.__private__.setTextColor=d.setTextColor=function(j,ee,me,Se){return pA=ge({ch1:j,ch2:ee,ch3:me,ch4:Se,pdfColorType:"text",precision:3}),this};var Cc=e.charSpace,iv=d.__private__.getCharSpace=d.getCharSpace=function(){return parseFloat(Cc||0)};d.__private__.setCharSpace=d.setCharSpace=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Cc=j,this};var Sf=0;d.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},d.__private__.setLineCap=d.setLineCap=function(j){var ee=d.CapJoinStyles[j];if(ee===void 0)throw new Error("Line cap style of '"+j+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Sf=ee,he(ee+" J"),this};var Ef=0;d.__private__.setLineJoin=d.setLineJoin=function(j){var ee=d.CapJoinStyles[j];if(ee===void 0)throw new Error("Line join style of '"+j+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ef=ee,he(ee+" j"),this},d.__private__.setLineMiterLimit=d.__private__.setMiterLimit=d.setLineMiterLimit=d.setMiterLimit=function(j){if(j=j||0,isNaN(j))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return he(_(C(j))+" M"),this},d.GState=$d,d.setGState=function(j){(j=typeof j=="string"?Nr[Li[j]]:N0(null,j)).equals(Aa)||(he("/"+j.id+" gs"),Aa=j)};var N0=function(j,ee){if(!j||!Li[j]){var me=!1;for(var Se in Nr)if(Nr.hasOwnProperty(Se)&&Nr[Se].equals(ee)){me=!0;break}if(me)ee=Nr[Se];else{var Ue="GS"+(Object.keys(Nr).length+1).toString(10);Nr[Ue]=ee,ee.id=Ue}return j&&(Li[j]=ee.id),ir.publish("addGState",ee),ee}};d.addGState=function(j,ee){return N0(j,ee),this},d.saveGraphicsState=function(){return he("q"),Rn.push({key:at,size:be,color:pA}),this},d.restoreGraphicsState=function(){he("Q");var j=Rn.pop();return at=j.key,be=j.size,pA=j.color,Aa=null,this},d.setCurrentTransformationMatrix=function(j){return he(j.toString()+" cm"),this},d.comment=function(j){return he("#"+j),this};var Sc=function(j,ee){var me=j||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return me},set:function($e){isNaN($e)||(me=parseFloat($e))}});var Se=ee||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Se},set:function($e){isNaN($e)||(Se=parseFloat($e))}});var Ue="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ue},set:function($e){Ue=$e.toString()}}),this},kf=function(j,ee,me,Se){Sc.call(this,j,ee),this.type="rect";var Ue=me||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ue},set:function(it){isNaN(it)||(Ue=parseFloat(it))}});var $e=Se||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return $e},set:function(it){isNaN(it)||($e=parseFloat(it))}}),this},Ff=function(){this.page=vr,this.currentPage=U,this.pages=we.slice(0),this.pagesContext=Pt.slice(0),this.x=ur,this.y=Ft,this.matrix=tn,this.width=gA(U),this.height=Jo(U),this.outputDestination=Me,this.id="",this.objectNumber=-1};Ff.prototype.restore=function(){vr=this.page,U=this.currentPage,Pt=this.pagesContext,we=this.pages,ur=this.x,Ft=this.y,tn=this.matrix,Nf(U,this.width),Tf(U,this.height),Me=this.outputDestination};var T0=function(j,ee,me,Se,Ue){De.push(new Ff),vr=U=0,we=[],ur=j,Ft=ee,tn=Ue,yf([me,Se])},av=function(j){if(Ce[j])De.pop().restore();else{var ee=new Ff,me="Xo"+(Object.keys(_e).length+1).toString(10);ee.id=me,Ce[j]=me,_e[me]=ee,ir.publish("addFormObject",ee),De.pop().restore()}};for(var Ec in d.beginFormObject=function(j,ee,me,Se,Ue){return T0(j,ee,me,Se,Ue),this},d.endFormObject=function(j){return av(j),this},d.doFormObject=function(j,ee){var me=_e[Ce[j]];return he("q"),he(ee.toString()+" cm"),he("/"+me.id+" Do"),he("Q"),this},d.getFormObject=function(j){var ee=_e[Ce[j]];return{x:ee.x,y:ee.y,width:ee.width,height:ee.height,matrix:ee.matrix}},d.save=function(j,ee){return j=j||"generated.pdf",(ee=ee||{}).returnPromise=ee.returnPromise||!1,ee.returnPromise===!1?(FA(wc(fo()),j),typeof FA.unload=="function"&&jt.setTimeout&&setTimeout(FA.unload,911),this):new Promise(function(me,Se){try{var Ue=FA(wc(fo()),j);typeof FA.unload=="function"&&jt.setTimeout&&setTimeout(FA.unload,911),me(Ue)}catch($e){Se($e.message)}})},Ut.API)Ut.API.hasOwnProperty(Ec)&&(Ec==="events"&&Ut.API.events.length?function(j,ee){var me,Se,Ue;for(Ue=ee.length-1;Ue!==-1;Ue--)me=ee[Ue][0],Se=ee[Ue][1],j.subscribe.apply(j,[me].concat(typeof Se=="function"?[Se]:Se))}(ir,Ut.API.events):d[Ec]=Ut.API[Ec]);var gA=d.getPageWidth=function(j){return(Pt[j=j||U].mediaBox.topRightX-Pt[j].mediaBox.bottomLeftX)/et},Nf=d.setPageWidth=function(j,ee){Pt[j].mediaBox.topRightX=ee*et+Pt[j].mediaBox.bottomLeftX},Jo=d.getPageHeight=function(j){return(Pt[j=j||U].mediaBox.topRightY-Pt[j].mediaBox.bottomLeftY)/et},Tf=d.setPageHeight=function(j,ee){Pt[j].mediaBox.topRightY=ee*et+Pt[j].mediaBox.bottomLeftY};return d.internal={pdfEscape:Wi,getStyle:_0,getFont:tv,getFontSize:pe,getCharSpace:iv,getTextColor:nv,getLineHeight:E0,getLineHeightFactor:F0,getLineWidth:_c,write:Be,getHorizontalCoordinate:Ms,getVerticalCoordinate:ho,getCoordinateString:rv,getVerticalCoordinateString:Yo,collections:{},newObject:kt,newAdditionalObject:ue,newObjectDeferred:Xt,newObjectDeferredBegin:te,getFilters:Oe,putStream:Ke,events:ir,scaleFactor:et,pageSize:{getWidth:function(){return gA(U)},setWidth:function(j){Nf(U,j)},getHeight:function(){return Jo(U)},setHeight:function(j){Tf(U,j)}},encryptionOptions:u,encryption:li,getEncryptor:z1,output:bc,getNumberOfPages:G1,pages:we,out:he,f2:I,f3:S,getPageInfo:B0,getPageInfoByObjId:Mt,getCurrentPageInfo:X1,getPDFVersion:g,Point:Sc,Rectangle:kf,Matrix:ye,hasHotfix:b0},Object.defineProperty(d.internal.pageSize,"width",{get:function(){return gA(U)},set:function(j){Nf(U,j)},enumerable:!0,configurable:!0}),Object.defineProperty(d.internal.pageSize,"height",{get:function(){return Jo(U)},set:function(j){Tf(U,j)},enumerable:!0,configurable:!0}),H1.call(d,se),at="F1",x0(i,r),ir.publish("initialized"),d}uu.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},uu.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},uu.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},uu.prototype.processOwnerPassword=function(e,t){return Py(Dy(t).substr(0,5),e)},uu.prototype.encryptor=function(e,t){var r=Dy(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return Py(r,n)}},$d.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||_r(e)!==_r(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},Ut.API={events:[]},Ut.version="2.5.2";var sn=Ut.API,d5=1,xc=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},eu=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Kt=function(e){return e.toFixed(2)},hl=function(e){return e.toFixed(5)};sn.__acroform__={};var la=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},OC=function(e){return e*d5},Xs=function(e){var t=new YT,r=Bt.internal.getHeight(e)||0,n=Bt.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Kt(n)),Number(Kt(r))],t},vre=sn.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},xre=sn.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},yre=sn.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},xn=sn.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return yre(e,t-1)},yn=sn.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return vre(e,t-1)},wn=sn.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return xre(e,t-1)},wre=sn.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,i=e[0],a=e[1],s=e[2],o=e[3],l={};return l.lowerLeft_X=r(i)||0,l.lowerLeft_Y=n(a+o)||0,l.upperRight_X=r(i+s)||0,l.upperRight_Y=n(a)||0,[Number(Kt(l.lowerLeft_X)),Number(Kt(l.lowerLeft_Y)),Number(Kt(l.upperRight_X)),Number(Kt(l.upperRight_Y))]},bre=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=Qy(e,r),i=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+i+" "+Kt(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var a=Xs(e);return a.scope=e.scope,a.stream=t.join(`
`),a}},Qy=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},i=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");i=e.multiline?i.map(function(S){return S.split(`
`)}):i.map(function(S){return[S]});var a=r,s=Bt.internal.getHeight(e)||0;s=s<0?-s:s;var o=Bt.internal.getWidth(e)||0;o=o<0?-o:o;var l=function(S,C,L){if(S+1<i.length){var R=C+" "+i[S+1][0];return Mp(R,e,L).width<=o-4}return!1};a++;e:for(;a>0;){t="",a--;var A,u,f=Mp("3",e,a).height,h=e.multiline?s-a:(s-f)/2,d=h+=2,m=0,g=0,x=0;if(a<=0){t=`(...) Tj
`,t+="% Width of Text: "+Mp(t,e,a=12).width+", FieldWidth:"+o+`
`;break}for(var p="",v=0,y=0;y<i.length;y++)if(i.hasOwnProperty(y)){var w=!1;if(i[y].length!==1&&x!==i[y].length-1){if((f+2)*(v+2)+2>s)continue e;p+=i[y][x],w=!0,g=y,y--}else{p=(p+=i[y][x]+" ").substr(p.length-1)==" "?p.substr(0,p.length-1):p;var B=parseInt(y),E=l(B,p,a),_=y>=i.length-1;if(E&&!_){p+=" ",x=0;continue}if(E||_){if(_)g=B;else if(e.multiline&&(f+2)*(v+2)+2>s)continue e}else{if(!e.multiline||(f+2)*(v+2)+2>s)continue e;g=B}}for(var F="",T=m;T<=g;T++){var I=i[T];if(e.multiline){if(T===g){F+=I[x]+" ",x=(x+1)%I.length;continue}if(T===m){F+=I[I.length-1]+" ";continue}}F+=I[0]+" "}switch(F=F.substr(F.length-1)==" "?F.substr(0,F.length-1):F,u=Mp(F,e,a).width,e.textAlign){case"right":A=o-u-2;break;case"center":A=(o-u)/2;break;case"left":default:A=2}t+=Kt(A)+" "+Kt(d)+` Td
`,t+="("+xc(F)+`) Tj
`,t+=-Kt(A)+` 0 Td
`,d=-(a+2),u=0,m=w?g:g+1,v++,p=""}break}return n.text=t,n.fontSize=a,n},Mp=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),i=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},Bre={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},_re=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},Cre=function(e,t){for(var r in e)if(e.hasOwnProperty(r)){var n=r,i=e[r];t.internal.newObjectDeferredBegin(i.objId,!0),_r(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete e[n]}},Sre=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Os.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(Bre)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");d5=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new JT,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var a=n[i];a.objId=void 0,a.hasAnnotation&&_re(a,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,i){var a=!n;for(var s in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var o=n[s],l=[],A=o.Rect;if(o.Rect&&(o.Rect=wre(o.Rect,i)),i.internal.newObjectDeferredBegin(o.objId,!0),o.DA=Bt.createDefaultAppearanceStream(o),_r(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=A,o.hasAppearanceStream&&!o.appearanceStreamContent){var u=bre(o);l.push({key:"AP",value:"<</N "+u+">>"}),i.internal.acroformPlugin.xForms.push(u)}if(o.appearanceStreamContent){var f="";for(var h in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(h)){var d=o.appearanceStreamContent[h];if(f+="/"+h+" ",f+="<<",Object.keys(d).length>=1||Array.isArray(d)){for(var s in d)if(d.hasOwnProperty(s)){var m=d[s];typeof m=="function"&&(m=m.call(i,o)),f+="/"+s+" "+m+" ",i.internal.acroformPlugin.xForms.indexOf(m)>=0||i.internal.acroformPlugin.xForms.push(m)}}else typeof(m=d)=="function"&&(m=m.call(i,o)),f+="/"+s+" "+m,i.internal.acroformPlugin.xForms.indexOf(m)>=0||i.internal.acroformPlugin.xForms.push(m);f+=">>"}l.push({key:"AP",value:`<<
`+f+">>"})}i.internal.putStream({additionalKeyValues:l,objectId:o.objId}),i.internal.out("endobj")}a&&Cre(i.internal.acroformPlugin.xForms,i)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},XT=sn.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(s){return s};if(Array.isArray(e)){for(var i="[",a=0;a<e.length;a++)switch(a!==0&&(i+=" "),_r(e[a])){case"boolean":case"number":case"object":i+=e[a].toString();break;case"string":e[a].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),i+="("+xc(n(e[a].toString()))+")"):i+=e[a].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Ux=function(e,t,r){var n=function(i){return i};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),e="("+xc(n(e))+")"},to=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};to.prototype.toString=function(){return this.objId+" 0 R"},to.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},to.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],i=this[n];i&&(Array.isArray(i)?e.push({key:n,value:XT(i,this.objId,this.scope)}):i instanceof to?(i.scope=this.scope,e.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&e.push({key:n,value:i}))}return e};var YT=function(){to.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};la(YT,to);var JT=function(){to.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+xc(r(e))+")"}},set:function(r){e=r}})};la(JT,to);var Os=function e(){to.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(p){if(isNaN(p))throw new Error('Invalid value "'+p+'" for attribute F supplied.');t=p}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!xn(t,3)},set:function(p){p?this.F=yn(t,3):this.F=wn(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(p){if(isNaN(p))throw new Error('Invalid value "'+p+'" for attribute Ff supplied.');r=p}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(p){n=p!==void 0?p:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(p){n[0]=p}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(p){n[1]=p}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(p){n[2]=p}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(p){n[3]=p}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(p){switch(p){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=p;break;default:throw new Error('Invalid value "'+p+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof Cm)return;a="FieldObject"+e.FieldNum++}var p=function(v){return v};return this.scope&&(p=this.scope.internal.getEncryptor(this.objId)),"("+xc(p(a))+")"},set:function(p){a=p.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(p){a=p}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(p){s=p}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(p){o=p}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(p){l=p}});var A=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return A===void 0?50/d5:A},set:function(p){A=p}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(p){u=p}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof Cm||this instanceof Wl))return Ux(f,this.objId,this.scope)},set:function(p){p=p.toString(),f=p}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Un?h:Ux(h,this.objId,this.scope)},set:function(p){p=p.toString(),h=this instanceof Un?p:p.substr(0,1)==="("?eu(p.substr(1,p.length-2)):eu(p)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Un?eu(h.substr(1,h.length-1)):h},set:function(p){p=p.toString(),h=this instanceof Un?"/"+p:p}});var d=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(d)return d},set:function(p){this.V=p}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof Un?d:Ux(d,this.objId,this.scope)},set:function(p){p=p.toString(),d=this instanceof Un?p:p.substr(0,1)==="("?eu(p.substr(1,p.length-2)):eu(p)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Un?eu(d.substr(1,d.length-1)):d},set:function(p){p=p.toString(),d=this instanceof Un?"/"+p:p}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(p){p=!!p,g=p}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(p){m=p}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!xn(this.Ff,1)},set:function(p){p?this.Ff=yn(this.Ff,1):this.Ff=wn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!xn(this.Ff,2)},set:function(p){p?this.Ff=yn(this.Ff,2):this.Ff=wn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!xn(this.Ff,3)},set:function(p){p?this.Ff=yn(this.Ff,3):this.Ff=wn(this.Ff,3)}});var x=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(x!==null)return x},set:function(p){if([0,1,2].indexOf(p)===-1)throw new Error('Invalid value "'+p+'" for attribute Q supplied.');x=p}}),Object.defineProperty(this,"textAlign",{get:function(){var p;switch(x){case 0:default:p="left";break;case 1:p="center";break;case 2:p="right"}return p},configurable:!0,enumerable:!0,set:function(p){switch(p){case"right":case 2:x=2;break;case"center":case 1:x=1;break;case"left":case 0:default:x=0}}})};la(Os,to);var WA=function(){Os.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return XT(t,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=function(a,s,o){o||(o=1);for(var l,A=[];l=s.exec(a);)A.push(l[o]);return A}(n,/\((.*?)\)/g)),t=i}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!xn(this.Ff,18)},set:function(r){r?this.Ff=yn(this.Ff,18):this.Ff=wn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!xn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=yn(this.Ff,19):this.Ff=wn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!xn(this.Ff,20)},set:function(r){r?(this.Ff=yn(this.Ff,20),t.sort()):this.Ff=wn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!xn(this.Ff,22)},set:function(r){r?this.Ff=yn(this.Ff,22):this.Ff=wn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!xn(this.Ff,23)},set:function(r){r?this.Ff=yn(this.Ff,23):this.Ff=wn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!xn(this.Ff,27)},set:function(r){r?this.Ff=yn(this.Ff,27):this.Ff=wn(this.Ff,27)}}),this.hasAppearanceStream=!1};la(WA,Os);var $A=function(){WA.call(this),this.fontName="helvetica",this.combo=!1};la($A,WA);var qA=function(){$A.call(this),this.combo=!0};la(qA,$A);var td=function(){qA.call(this),this.edit=!0};la(td,qA);var Un=function(){Os.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!xn(this.Ff,15)},set:function(r){r?this.Ff=yn(this.Ff,15):this.Ff=wn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!xn(this.Ff,16)},set:function(r){r?this.Ff=yn(this.Ff,16):this.Ff=wn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!xn(this.Ff,17)},set:function(r){r?this.Ff=yn(this.Ff,17):this.Ff=wn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!xn(this.Ff,26)},set:function(r){r?this.Ff=yn(this.Ff,26):this.Ff=wn(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,i=[];for(n in i.push("<<"),t)i.push("/"+n+" ("+xc(r(t[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){_r(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};la(Un,Os);var rd=function(){Un.call(this),this.pushButton=!0};la(rd,Un);var zA=function(){Un.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};la(zA,Un);var Cm=function(){var e,t;Os.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(i){t=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(o){return o};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var a,s=[];for(a in s.push("<<"),n)s.push("/"+a+" ("+xc(i(n[a]))+")");return s.push(">>"),s.join(`
`)},set:function(i){_r(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Bt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};la(Cm,Os),zA.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},zA.prototype.createOption=function(e){var t=new Cm;return t.Parent=this,t.optionName=e,this.Kids.push(t),Ere.call(this.scope,t),t};var nd=function(){Un.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Bt.CheckBox.createAppearanceStream()};la(nd,Un);var Wl=function(){Os.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!xn(this.Ff,13)},set:function(t){t?this.Ff=yn(this.Ff,13):this.Ff=wn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!xn(this.Ff,21)},set:function(t){t?this.Ff=yn(this.Ff,21):this.Ff=wn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!xn(this.Ff,23)},set:function(t){t?this.Ff=yn(this.Ff,23):this.Ff=wn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!xn(this.Ff,24)},set:function(t){t?this.Ff=yn(this.Ff,24):this.Ff=wn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!xn(this.Ff,25)},set:function(t){t?this.Ff=yn(this.Ff,25):this.Ff=wn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!xn(this.Ff,26)},set:function(t){t?this.Ff=yn(this.Ff,26):this.Ff=wn(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};la(Wl,Os);var id=function(){Wl.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!xn(this.Ff,14)},set:function(e){e?this.Ff=yn(this.Ff,14):this.Ff=wn(this.Ff,14)}}),this.password=!0};la(id,Wl);var Bt={CheckBox:{createAppearanceStream:function(){return{N:{On:Bt.CheckBox.YesNormal},D:{On:Bt.CheckBox.YesPushDown,Off:Bt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Xs(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),a=Qy(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Kt(Bt.internal.getWidth(e))+" "+Kt(Bt.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Kt(a.fontSize)+" Tf "+i),r.push("BT"),r.push(a.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=Xs(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),i=[],a=Bt.internal.getHeight(e),s=Bt.internal.getWidth(e),o=Qy(e,e.caption);return i.push("1 g"),i.push("0 0 "+Kt(s)+" "+Kt(a)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Kt(s-1)+" "+Kt(a-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+Kt(o.fontSize)+" Tf "+n),i.push(o.text),i.push("ET"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(e){var t=Xs(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Kt(Bt.internal.getWidth(e))+" "+Kt(Bt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:Bt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=Bt.RadioButton.Circle.YesNormal,t.D[e]=Bt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Xs(e);t.scope=e.scope;var r=[],n=Bt.internal.getWidth(e)<=Bt.internal.getHeight(e)?Bt.internal.getWidth(e)/4:Bt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Bt.internal.Bezier_C,a=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+hl(Bt.internal.getWidth(e)/2)+" "+hl(Bt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Xs(e);t.scope=e.scope;var r=[],n=Bt.internal.getWidth(e)<=Bt.internal.getHeight(e)?Bt.internal.getWidth(e)/4:Bt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*Bt.internal.Bezier_C).toFixed(5)),s=Number((n*Bt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+hl(Bt.internal.getWidth(e)/2)+" "+hl(Bt.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+hl(Bt.internal.getWidth(e)/2)+" "+hl(Bt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Xs(e);t.scope=e.scope;var r=[],n=Bt.internal.getWidth(e)<=Bt.internal.getHeight(e)?Bt.internal.getWidth(e)/4:Bt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*Bt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+hl(Bt.internal.getWidth(e)/2)+" "+hl(Bt.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:Bt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=Bt.RadioButton.Cross.YesNormal,t.D[e]=Bt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Xs(e);t.scope=e.scope;var r=[],n=Bt.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Kt(Bt.internal.getWidth(e)-2)+" "+Kt(Bt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Kt(n.x1.x)+" "+Kt(n.x1.y)+" m"),r.push(Kt(n.x2.x)+" "+Kt(n.x2.y)+" l"),r.push(Kt(n.x4.x)+" "+Kt(n.x4.y)+" m"),r.push(Kt(n.x3.x)+" "+Kt(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Xs(e);t.scope=e.scope;var r=Bt.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Kt(Bt.internal.getWidth(e))+" "+Kt(Bt.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Kt(Bt.internal.getWidth(e)-2)+" "+Kt(Bt.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Kt(r.x1.x)+" "+Kt(r.x1.y)+" m"),n.push(Kt(r.x2.x)+" "+Kt(r.x2.y)+" l"),n.push(Kt(r.x4.x)+" "+Kt(r.x4.y)+" m"),n.push(Kt(r.x3.x)+" "+Kt(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Xs(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Kt(Bt.internal.getWidth(e))+" "+Kt(Bt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};Bt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=Bt.internal.getWidth(e),r=Bt.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},Bt.internal.getWidth=function(e){var t=0;return _r(e)==="object"&&(t=OC(e.Rect[2])),t},Bt.internal.getHeight=function(e){var t=0;return _r(e)==="object"&&(t=OC(e.Rect[3])),t};var Ere=sn.addField=function(e){if(Sre(this,e),!(e instanceof Os))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};sn.AcroFormChoiceField=WA,sn.AcroFormListBox=$A,sn.AcroFormComboBox=qA,sn.AcroFormEditBox=td,sn.AcroFormButton=Un,sn.AcroFormPushButton=rd,sn.AcroFormRadioButton=zA,sn.AcroFormCheckBox=nd,sn.AcroFormTextField=Wl,sn.AcroFormPasswordField=id,sn.AcroFormAppearance=Bt,sn.AcroForm={ChoiceField:WA,ListBox:$A,ComboBox:qA,EditBox:td,Button:Un,PushButton:rd,RadioButton:zA,CheckBox:nd,TextField:Wl,PasswordField:id,Appearance:Bt},Ut.AcroForm={ChoiceField:WA,ListBox:$A,ComboBox:qA,EditBox:td,Button:Un,PushButton:rd,RadioButton:zA,CheckBox:nd,TextField:Wl,PasswordField:id,Appearance:Bt};var kre=Ut.AcroForm;function ZT(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=e.__addimage__.getImageFileTypeByImageData=function(S,C){var L,R,W,G,V,X=t;if((C=C||t)==="RGBA"||S.data!==void 0&&S.data instanceof Uint8ClampedArray&&"height"in S&&"width"in S)return"RGBA";if(E(S))for(V in r)for(W=r[V],L=0;L<W.length;L+=1){for(G=!0,R=0;R<W[L].length;R+=1)if(W[L][R]!==void 0&&W[L][R]!==S[R]){G=!1;break}if(G===!0){X=V;break}}else for(V in r)for(W=r[V],L=0;L<W.length;L+=1){for(G=!0,R=0;R<W[L].length;R+=1)if(W[L][R]!==void 0&&W[L][R]!==S.charCodeAt(R)){G=!1;break}if(G===!0){X=V;break}}return X===t&&C!==t&&(X=C),X},i=function S(C){for(var L=this.internal.write,R=this.internal.putStream,W=(0,this.internal.getFilters)();W.indexOf("FlateEncode")!==-1;)W.splice(W.indexOf("FlateEncode"),1);C.objectId=this.internal.newObject();var G=[];if(G.push({key:"Type",value:"/XObject"}),G.push({key:"Subtype",value:"/Image"}),G.push({key:"Width",value:C.width}),G.push({key:"Height",value:C.height}),C.colorSpace===x.INDEXED?G.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(C.palette.length/3-1)+" "+("sMask"in C&&C.sMask!==void 0?C.objectId+2:C.objectId+1)+" 0 R]"}):(G.push({key:"ColorSpace",value:"/"+C.colorSpace}),C.colorSpace===x.DEVICE_CMYK&&G.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),G.push({key:"BitsPerComponent",value:C.bitsPerComponent}),"decodeParameters"in C&&C.decodeParameters!==void 0&&G.push({key:"DecodeParms",value:"<<"+C.decodeParameters+">>"}),"transparency"in C&&Array.isArray(C.transparency)){for(var V="",X=0,Q=C.transparency.length;X<Q;X++)V+=C.transparency[X]+" "+C.transparency[X]+" ";G.push({key:"Mask",value:"["+V+"]"})}C.sMask!==void 0&&G.push({key:"SMask",value:C.objectId+1+" 0 R"});var K=C.filter!==void 0?["/"+C.filter]:void 0;if(R({data:C.data,additionalKeyValues:G,alreadyAppliedFilters:K,objectId:C.objectId}),L("endobj"),"sMask"in C&&C.sMask!==void 0){var H="/Predictor "+C.predictor+" /Colors 1 /BitsPerComponent "+C.bitsPerComponent+" /Columns "+C.width,k={width:C.width,height:C.height,colorSpace:"DeviceGray",bitsPerComponent:C.bitsPerComponent,decodeParameters:H,data:C.sMask};"filter"in C&&(k.filter=C.filter),S.call(this,k)}if(C.colorSpace===x.INDEXED){var U=this.internal.newObject();R({data:F(new Uint8Array(C.palette)),objectId:U}),L("endobj")}},a=function(){var S=this.internal.collections.addImage_images;for(var C in S)i.call(this,S[C])},s=function(){var S,C=this.internal.collections.addImage_images,L=this.internal.write;for(var R in C)L("/I"+(S=C[R]).index,S.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",a),this.internal.events.subscribe("putXobjectDict",s))},l=function(){var S=this.internal.collections.addImage_images;return o.call(this),S},A=function(){return Object.keys(this.internal.collections.addImage_images).length},u=function(S){return typeof e["process"+S.toUpperCase()]=="function"},f=function(S){return _r(S)==="object"&&S.nodeType===1},h=function(S,C){if(S.nodeName==="IMG"&&S.hasAttribute("src")){var L=""+S.getAttribute("src");if(L.indexOf("data:image/")===0)return ed(unescape(L).split("base64,").pop());var R=e.loadFile(L,!0);if(R!==void 0)return R}if(S.nodeName==="CANVAS"){if(S.width===0||S.height===0)throw new Error("Given canvas must have data. Canvas width: "+S.width+", height: "+S.height);var W;switch(C){case"PNG":W="image/png";break;case"WEBP":W="image/webp";break;case"JPEG":case"JPG":default:W="image/jpeg"}return ed(S.toDataURL(W,1).split("base64,").pop())}},d=function(S){var C=this.internal.collections.addImage_images;if(C){for(var L in C)if(S===C[L].alias)return C[L]}},m=function(S,C,L){return S||C||(S=-96,C=-96),S<0&&(S=-1*L.width*72/S/this.internal.scaleFactor),C<0&&(C=-1*L.height*72/C/this.internal.scaleFactor),S===0&&(S=C*L.width/L.height),C===0&&(C=S*L.height/L.width),[S,C]},g=function(S,C,L,R,W,G){var V=m.call(this,L,R,W),X=this.internal.getCoordinateString,Q=this.internal.getVerticalCoordinateString,K=l.call(this);if(L=V[0],R=V[1],K[W.index]=W,G){G*=Math.PI/180;var H=Math.cos(G),k=Math.sin(G),U=function(D){return D.toFixed(4)},P=[U(H),U(k),U(-1*k),U(H),0,0,"cm"]}this.internal.write("q"),G?(this.internal.write([1,"0","0",1,X(S),Q(C+R),"cm"].join(" ")),this.internal.write(P.join(" ")),this.internal.write([X(L),"0","0",X(R),"0","0","cm"].join(" "))):this.internal.write([X(L),"0","0",X(R),X(S),Q(C+R),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+W.index+" Do"),this.internal.write("Q")},x=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var p=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},v=e.__addimage__.sHashCode=function(S){var C,L,R=0;if(typeof S=="string")for(L=S.length,C=0;C<L;C++)R=(R<<5)-R+S.charCodeAt(C),R|=0;else if(E(S))for(L=S.byteLength/2,C=0;C<L;C++)R=(R<<5)-R+S[C],R|=0;return R},y=e.__addimage__.validateStringAsBase64=function(S){(S=S||"").toString().trim();var C=!0;return S.length===0&&(C=!1),S.length%4!=0&&(C=!1),/^[A-Za-z0-9+/]+$/.test(S.substr(0,S.length-2))===!1&&(C=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(S.substr(-2))===!1&&(C=!1),C},w=e.__addimage__.extractImageFromDataUrl=function(S){var C=(S=S||"").split("base64,"),L=null;if(C.length===2){var R=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(C[0]);Array.isArray(R)&&(L={mimeType:R[1],charset:R[2],data:C[1]})}return L},B=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(S){return B()&&S instanceof ArrayBuffer};var E=e.__addimage__.isArrayBufferView=function(S){return B()&&typeof Uint32Array<"u"&&(S instanceof Int8Array||S instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&S instanceof Uint8ClampedArray||S instanceof Int16Array||S instanceof Uint16Array||S instanceof Int32Array||S instanceof Uint32Array||S instanceof Float32Array||S instanceof Float64Array)},_=e.__addimage__.binaryStringToUint8Array=function(S){for(var C=S.length,L=new Uint8Array(C),R=0;R<C;R++)L[R]=S.charCodeAt(R);return L},F=e.__addimage__.arrayBufferToBinaryString=function(S){for(var C="",L=E(S)?S:new Uint8Array(S),R=0;R<L.length;R+=8192)C+=String.fromCharCode.apply(null,L.subarray(R,R+8192));return C};e.addImage=function(){var S,C,L,R,W,G,V,X,Q;if(typeof arguments[1]=="number"?(C=t,L=arguments[1],R=arguments[2],W=arguments[3],G=arguments[4],V=arguments[5],X=arguments[6],Q=arguments[7]):(C=arguments[1],L=arguments[2],R=arguments[3],W=arguments[4],G=arguments[5],V=arguments[6],X=arguments[7],Q=arguments[8]),_r(S=arguments[0])==="object"&&!f(S)&&"imageData"in S){var K=S;S=K.imageData,C=K.format||C||t,L=K.x||L||0,R=K.y||R||0,W=K.w||K.width||W,G=K.h||K.height||G,V=K.alias||V,X=K.compression||X,Q=K.rotation||K.angle||Q}var H=this.internal.getFilters();if(X===void 0&&H.indexOf("FlateEncode")!==-1&&(X="SLOW"),isNaN(L)||isNaN(R))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var k=T.call(this,S,C,V,X);return g.call(this,L,R,W,G,k,Q),this};var T=function(S,C,L,R){var W,G,V;if(typeof S=="string"&&n(S)===t){S=unescape(S);var X=I(S,!1);(X!==""||(X=e.loadFile(S,!0))!==void 0)&&(S=X)}if(f(S)&&(S=h(S,C)),C=n(S,C),!u(C))throw new Error("addImage does not support files of type '"+C+"', please ensure that a plugin for '"+C+"' support is added.");if(((V=L)==null||V.length===0)&&(L=function(Q){return typeof Q=="string"||E(Q)?v(Q):E(Q.data)?v(Q.data):null}(S)),(W=d.call(this,L))||(B()&&(S instanceof Uint8Array||C==="RGBA"||(G=S,S=_(S))),W=this["process"+C.toUpperCase()](S,A.call(this),L,function(Q){return Q&&typeof Q=="string"&&(Q=Q.toUpperCase()),Q in e.image_compression?Q:p.NONE}(R),G)),!W)throw new Error("An unknown error occurred whilst processing the image.");return W},I=e.__addimage__.convertBase64ToBinaryString=function(S,C){var L;C=typeof C!="boolean"||C;var R,W="";if(typeof S=="string"){R=(L=w(S))!==null?L.data:S;try{W=ed(R)}catch(G){if(C)throw y(R)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+G.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return W};e.getImageProperties=function(S){var C,L,R="";if(f(S)&&(S=h(S)),typeof S=="string"&&n(S)===t&&((R=I(S,!1))===""&&(R=e.loadFile(S)||""),S=R),L=n(S),!u(L))throw new Error("addImage does not support files of type '"+L+"', please ensure that a plugin for '"+L+"' support is added.");if(!B()||S instanceof Uint8Array||(S=_(S)),!(C=this["process"+L.toUpperCase()](S)))throw new Error("An unknown error occurred whilst processing the image");return C.fileType=L,C}})(Ut.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Ut.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,i,a,s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(r.objId),A=r.pageContext.annotations,u=!1,f=0;f<A.length&&!u;f++)switch((n=A[f]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var h=0;h<A.length;h++){n=A[h];var d=this.internal.pdfEscape,m=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),x=this.internal.newAdditionalObject(),p=this.internal.getEncryptor(g.objId),v=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(i="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+d(p(n.contents))+")",a+=" /Popup "+x.objId+" 0 R",a+=" /P "+l.objId+" 0 R",a+=" /T ("+d(p(v))+") >>",g.content=a;var y=g.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+s(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+y,n.open&&(a+=" /Open true"),a+=" >>",x.content=a,this.internal.write(g.objId,"0 R",x.objId,"0 R");break;case"freetext":i="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var w=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+d(m(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+w+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var B=this.annotations._nameMap[n.options.name];n.options.pageNumber=B.page,n.options.top=B.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+d(m(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var E=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+E+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,i,a,s){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,A=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(r),y:A(n),w:l(r+i),h:A(n+a)},options:s,type:"link"})},e.textWithLink=function(r,n,i,a){var s,o,l=this.getTextWidth(r),A=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){o=a.maxWidth;var u=this.splitTextToSize(r,o).length;s=Math.ceil(A*u)}else o=l,s=A;return this.text(r,n,i,a),i+=.2*A,a.align==="center"&&(n-=l/2),a.align==="right"&&(n-=l),this.link(n,i-A,o,s,a),l},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(Ut.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];e.__arabicParser__={};var a=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},s=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},o=e.__arabicParser__.isArabicEndLetter=function(g){return s(g)&&a(g)&&t[g.charCodeAt(0)].length<=2},l=e.__arabicParser__.isArabicAlfLetter=function(g){return s(g)&&i.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return s(g)&&a(g)&&t[g.charCodeAt(0)].length>=1};var A=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return s(g)&&a(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return s(g)&&a(g)&&t[g.charCodeAt(0)].length>=3};var u=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return s(g)&&a(g)&&t[g.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(g){var x=0,p=r,v="",y=0;for(x=0;x<g.length;x+=1)p[g.charCodeAt(x)]!==void 0?(y++,typeof(p=p[g.charCodeAt(x)])=="number"&&(v+=String.fromCharCode(p),p=r,y=0),x===g.length-1&&(p=r,v+=g.charAt(x-(y-1)),x-=y-1,y=0)):(p=r,v+=g.charAt(x-y),x-=y,y=0);return v};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var h=e.__arabicParser__.getCorrectForm=function(g,x,p){return s(g)?a(g)===!1?-1:!A(g)||!s(x)&&!s(p)||!s(p)&&o(x)||o(g)&&!s(x)||o(g)&&l(x)||o(g)&&o(x)?0:u(g)&&s(x)&&!o(x)&&s(p)&&A(p)?3:o(g)||!s(p)?1:2:-1},d=function(g){var x=0,p=0,v=0,y="",w="",B="",E=(g=g||"").split("\\s+"),_=[];for(x=0;x<E.length;x+=1){for(_.push(""),p=0;p<E[x].length;p+=1)y=E[x][p],w=E[x][p-1],B=E[x][p+1],s(y)?(v=h(y,w,B),_[x]+=v!==-1?String.fromCharCode(t[y.charCodeAt(0)][v]):y):_[x]+=y;_[x]=f(_[x])}return _.join(" ")},m=e.__arabicParser__.processArabic=e.processArabic=function(){var g,x=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,p=[];if(Array.isArray(x)){var v=0;for(p=[],v=0;v<x.length;v+=1)Array.isArray(x[v])?p.push([d(x[v][0]),x[v][1],x[v][2]]):p.push([d(x[v])]);g=p}else g=d(x);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",m])}(Ut.API),Ut.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(o){i=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(o){a=o}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(o){s=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Ut.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(g){l=g}});var A=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return A},set:function(g){A=g}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var h=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var d=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(g){m=g}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(l){return n.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},e.getTextDimensions=function(l,A){n.call(this);var u=(A=A||{}).fontSize||this.getFontSize(),f=A.font||this.getFont(),h=A.scaleFactor||this.internal.scaleFactor,d=0,m=0,g=0,x=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var p=A.maxWidth;p>0?typeof l=="string"?l=this.splitTextToSize(l,p):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(y,w){return y.concat(x.splitTextToSize(w,p))},[])):l=Array.isArray(l)?l:[l];for(var v=0;v<l.length;v++)d<(g=this.getStringUnitWidth(l[v],{font:f})*u)&&(d=g);return d!==0&&(m=l.length),{w:d/=h,h:Math.max((m*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/h,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var l=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new a(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=e.cell=function(){var l;l=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var A=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,h=this.internal.__cell__.tableHeaderRow,d=this.internal.__cell__.printHeaders;return A.lineNumber!==void 0&&(A.lineNumber===l.lineNumber?(l.x=(A.x||0)+(A.width||0),l.y=A.y||0):A.y+A.height+l.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=f.top,d&&h&&(this.printHeaderRow(l.lineNumber,!0),l.y+=h[0].height)):l.y=A.y+A.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,r===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-u,l.y+u,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+u,{align:"center",baseline:"top",maxWidth:l.width-u-u}):this.text(l.text,l.x+u,l.y+u,{align:"left",baseline:"top",maxWidth:l.width-u-u})),this.internal.__cell__.lastCell=l,this};e.table=function(l,A,u,f,h){if(n.call(this),!u)throw new Error("No data for PDF table.");var d,m,g,x,p=[],v=[],y=[],w={},B={},E=[],_=[],F=(h=h||{}).autoSize||!1,T=h.printHeaders!==!1,I=h.css&&h.css["font-size"]!==void 0?16*h.css["font-size"]:h.fontSize||12,S=h.margins||Object.assign({width:this.getPageWidth()},t),C=typeof h.padding=="number"?h.padding:3,L=h.headerBackgroundColor||"#c8c8c8",R=h.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=T,this.internal.__cell__.margins=S,this.internal.__cell__.table_font_size=I,this.internal.__cell__.padding=C,this.internal.__cell__.headerBackgroundColor=L,this.internal.__cell__.headerTextColor=R,this.setFontSize(I),f==null)v=p=Object.keys(u[0]),y=p.map(function(){return"left"});else if(Array.isArray(f)&&_r(f[0])==="object")for(p=f.map(function(K){return K.name}),v=f.map(function(K){return K.prompt||K.name||""}),y=f.map(function(K){return K.align||"left"}),d=0;d<f.length;d+=1)B[f[d].name]=f[d].width*(19.049976/25.4);else Array.isArray(f)&&typeof f[0]=="string"&&(v=p=f,y=p.map(function(){return"left"}));if(F||Array.isArray(f)&&typeof f[0]=="string")for(d=0;d<p.length;d+=1){for(w[x=p[d]]=u.map(function(K){return K[x]}),this.setFont(void 0,"bold"),E.push(this.getTextDimensions(v[d],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=w[x],this.setFont(void 0,"normal"),g=0;g<m.length;g+=1)E.push(this.getTextDimensions(m[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);B[x]=Math.max.apply(null,E)+C+C,E=[]}if(T){var W={};for(d=0;d<p.length;d+=1)W[p[d]]={},W[p[d]].text=v[d],W[p[d]].align=y[d];var G=o.call(this,W,B);_=p.map(function(K){return new a(l,A,B[K],G,W[K].text,void 0,W[K].align)}),this.setTableHeaderRow(_),this.printHeaderRow(1,!1)}var V=f.reduce(function(K,H){return K[H.name]=H.align,K},{});for(d=0;d<u.length;d+=1){"rowStart"in h&&h.rowStart instanceof Function&&h.rowStart({row:d,data:u[d]},this);var X=o.call(this,u[d],B);for(g=0;g<p.length;g+=1){var Q=u[d][p[g]];"cellStart"in h&&h.cellStart instanceof Function&&h.cellStart({row:d,col:g,data:Q},this),s.call(this,new a(l,A,B[p[g]],X,Q,d+2,V[p[g]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=A,this};var o=function(l,A){var u=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,h=this.internal.scaleFactor;return Object.keys(l).map(function(d){var m=l[d];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,A[d]-u-u)},this).map(function(d){return this.getLineHeightFactor()*d.length*f/h+u+u},this).reduce(function(d,m){return Math.max(d,m)},0)};e.setTableHeaderRow=function(l){n.call(this),this.internal.__cell__.tableHeaderRow=l},e.printHeaderRow=function(l,A){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var h=[],d=0;d<this.internal.__cell__.tableHeaderRow.length;d+=1){u=this.internal.__cell__.tableHeaderRow[d].clone(),A&&(u.y=this.internal.__cell__.margins.top||0,h.push(u)),u.lineNumber=l;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,u),this.setTextColor(m)}h.length>0&&this.setTableHeaderRow(h),this.setFont(void 0,"normal"),r=!1}}(Ut.API);var e6={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},t6=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Ry=ZT(t6),r6=[100,200,300,400,500,600,700,800,900],Fre=ZT(r6);function My(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(a){return e6[a=a||"normal"]?a:"normal"}(e.style),n=function(a){if(!a)return 400;if(typeof a=="number")return a>=100&&a<=900&&a%100==0?a:400;if(/^\d00$/.test(a))return parseInt(a);switch(a){case"bold":return 700;case"normal":default:return 400}}(e.weight),i=function(a){return typeof Ry[a=a||"normal"]=="number"?a:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:i,src:e.src||[],ref:e.ref||{name:t,style:[i,r,n].join(" ")}}}function jC(e,t,r,n){var i;for(i=r;i>=0&&i<t.length;i+=n)if(e[t[i]])return e[t[i]];for(i=r;i>=0&&i<t.length;i-=n)if(e[t[i]])return e[t[i]]}var Nre={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},DC={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function PC(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function Tre(e,t,r){for(var n=(r=r||{}).defaultFontFamily||"times",i=Object.assign({},Nre,r.genericFontFamilies||{}),a=null,s=null,o=0;o<t.length;++o)if(i[(a=My(t[o])).family]&&(a.family=i[a.family]),e.hasOwnProperty(a.family)){s=e[a.family];break}if(!(s=s||e[n]))throw new Error("Could not find a font-family for the rule '"+PC(a)+"' and default family '"+n+"'.");if(s=function(l,A){if(A[l])return A[l];var u=Ry[l],f=u<=Ry.normal?-1:1,h=jC(A,t6,u,f);if(!h)throw new Error("Could not find a matching font-stretch value for "+l);return h}(a.stretch,s),s=function(l,A){if(A[l])return A[l];for(var u=e6[l],f=0;f<u.length;++f)if(A[u[f]])return A[u[f]];throw new Error("Could not find a matching font-style for "+l)}(a.style,s),!(s=function(l,A){if(A[l])return A[l];if(l===400&&A[500])return A[500];if(l===500&&A[400])return A[400];var u=Fre[l],f=jC(A,r6,u,l<400?-1:1);if(!f)throw new Error("Could not find a matching font-weight for value "+l);return f}(a.weight,s)))throw new Error("Failed to resolve a font for the rule '"+PC(a)+"'.");return s}function QC(e){return e.trimLeft()}function Lre(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function Ire(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var Hp,RC,MC,Ox=["times"];(function(e){var t,r,n,i,a,s,o,l,A,u=function(k){return k=k||{},this.isStrokeTransparent=k.isStrokeTransparent||!1,this.strokeOpacity=k.strokeOpacity||1,this.strokeStyle=k.strokeStyle||"#000000",this.fillStyle=k.fillStyle||"#000000",this.isFillTransparent=k.isFillTransparent||!1,this.fillOpacity=k.fillOpacity||1,this.font=k.font||"10px sans-serif",this.textBaseline=k.textBaseline||"alphabetic",this.textAlign=k.textAlign||"left",this.lineWidth=k.lineWidth||1,this.lineJoin=k.lineJoin||"miter",this.lineCap=k.lineCap||"butt",this.path=k.path||[],this.transform=k.transform!==void 0?k.transform.clone():new l,this.globalCompositeOperation=k.globalCompositeOperation||"normal",this.globalAlpha=k.globalAlpha||1,this.clip_path=k.clip_path||[],this.currentPoint=k.currentPoint||new s,this.miterLimit=k.miterLimit||10,this.lastPoint=k.lastPoint||new s,this.lineDashOffset=k.lineDashOffset||0,this.lineDash=k.lineDash||[],this.margin=k.margin||[0,0,0,0],this.prevPageLastElemOffset=k.prevPageLastElemOffset||0,this.ignoreClearRect=typeof k.ignoreClearRect!="boolean"||k.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,s=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,A=new u}]);var f=function(k){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var U=k;Object.defineProperty(this,"pdf",{get:function(){return U}});var P=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return P},set:function(Fe){P=!!Fe}});var D=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return D},set:function(Fe){D=!!Fe}});var O=0;Object.defineProperty(this,"posX",{get:function(){return O},set:function(Fe){isNaN(Fe)||(O=Fe)}});var z=0;Object.defineProperty(this,"posY",{get:function(){return z},set:function(Fe){isNaN(Fe)||(z=Fe)}}),Object.defineProperty(this,"margin",{get:function(){return A.margin},set:function(Fe){var he;typeof Fe=="number"?he=[Fe,Fe,Fe,Fe]:((he=new Array(4))[0]=Fe[0],he[1]=Fe.length>=2?Fe[1]:he[0],he[2]=Fe.length>=3?Fe[2]:he[0],he[3]=Fe.length>=4?Fe[3]:he[1]),A.margin=he}});var J=!1;Object.defineProperty(this,"autoPaging",{get:function(){return J},set:function(Fe){J=Fe}});var Y=0;Object.defineProperty(this,"lastBreak",{get:function(){return Y},set:function(Fe){Y=Fe}});var le=[];Object.defineProperty(this,"pageBreaks",{get:function(){return le},set:function(Fe){le=Fe}}),Object.defineProperty(this,"ctx",{get:function(){return A},set:function(Fe){Fe instanceof u&&(A=Fe)}}),Object.defineProperty(this,"path",{get:function(){return A.path},set:function(Fe){A.path=Fe}});var we=[];Object.defineProperty(this,"ctxStack",{get:function(){return we},set:function(Fe){we=Fe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Fe){var he;he=h(Fe),this.ctx.fillStyle=he.style,this.ctx.isFillTransparent=he.a===0,this.ctx.fillOpacity=he.a,this.pdf.setFillColor(he.r,he.g,he.b,{a:he.a}),this.pdf.setTextColor(he.r,he.g,he.b,{a:he.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Fe){var he=h(Fe);this.ctx.strokeStyle=he.style,this.ctx.isStrokeTransparent=he.a===0,this.ctx.strokeOpacity=he.a,he.a===0?this.pdf.setDrawColor(255,255,255):(he.a,this.pdf.setDrawColor(he.r,he.g,he.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Fe){["butt","round","square"].indexOf(Fe)!==-1&&(this.ctx.lineCap=Fe,this.pdf.setLineCap(Fe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Fe){isNaN(Fe)||(this.ctx.lineWidth=Fe,this.pdf.setLineWidth(Fe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Fe){["bevel","round","miter"].indexOf(Fe)!==-1&&(this.ctx.lineJoin=Fe,this.pdf.setLineJoin(Fe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Fe){isNaN(Fe)||(this.ctx.miterLimit=Fe,this.pdf.setMiterLimit(Fe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Fe){this.ctx.textBaseline=Fe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Fe){["right","end","center","left","start"].indexOf(Fe)!==-1&&(this.ctx.textAlign=Fe)}});var ne=null;function Me(Fe,he){if(ne===null){var Be=function(xe){var se=[];return Object.keys(xe).forEach(function(be){xe[be].forEach(function(Te){var pe=null;switch(Te){case"bold":pe={family:be,weight:"bold"};break;case"italic":pe={family:be,style:"italic"};break;case"bolditalic":pe={family:be,weight:"bold",style:"italic"};break;case"":case"normal":pe={family:be}}pe!==null&&(pe.ref={name:be,style:Te},se.push(pe))})}),se}(Fe.getFontList());ne=function(xe){for(var se={},be=0;be<xe.length;++be){var Te=My(xe[be]),pe=Te.family,je=Te.stretch,Ve=Te.style,We=Te.weight;se[pe]=se[pe]||{},se[pe][je]=se[pe][je]||{},se[pe][je][Ve]=se[pe][je][Ve]||{},se[pe][je][Ve][We]=Te}return se}(Be.concat(he))}return ne}var qe=null;Object.defineProperty(this,"fontFaces",{get:function(){return qe},set:function(Fe){ne=null,qe=Fe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Fe){var he;if(this.ctx.font=Fe,(he=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Fe))!==null){var Be=he[1],xe=(he[2],he[3]),se=he[4],be=(he[5],he[6]),Te=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(se)[2];se=Math.floor(Te==="px"?parseFloat(se)*this.pdf.internal.scaleFactor:Te==="em"?parseFloat(se)*this.pdf.getFontSize():parseFloat(se)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(se);var pe=function(wt){var at,et,ur=[],Ft=wt.trim();if(Ft==="")return Ox;if(Ft in DC)return[DC[Ft]];for(;Ft!=="";){switch(et=null,at=(Ft=QC(Ft)).charAt(0)){case'"':case"'":et=Lre(Ft.substring(1),at);break;default:et=Ire(Ft)}if(et===null||(ur.push(et[0]),(Ft=QC(et[1]))!==""&&Ft.charAt(0)!==","))return Ox;Ft=Ft.replace(/^,/,"")}return ur}(be);if(this.fontFaces){var je=Tre(Me(this.pdf,this.fontFaces),pe.map(function(wt){return{family:wt,stretch:"normal",weight:xe,style:Be}}));this.pdf.setFont(je.ref.name,je.ref.style)}else{var Ve="";(xe==="bold"||parseInt(xe,10)>=700||Be==="bold")&&(Ve="bold"),Be==="italic"&&(Ve+="italic"),Ve.length===0&&(Ve="normal");for(var We="",ft={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Et=0;Et<pe.length;Et++){if(this.pdf.internal.getFont(pe[Et],Ve,{noFallback:!0,disableWarning:!0})!==void 0){We=pe[Et];break}if(Ve==="bolditalic"&&this.pdf.internal.getFont(pe[Et],"bold",{noFallback:!0,disableWarning:!0})!==void 0)We=pe[Et],Ve="bold";else if(this.pdf.internal.getFont(pe[Et],"normal",{noFallback:!0,disableWarning:!0})!==void 0){We=pe[Et],Ve="normal";break}}if(We===""){for(var ut=0;ut<pe.length;ut++)if(ft[pe[ut]]){We=ft[pe[ut]];break}}We=We===""?"Times":We,this.pdf.setFont(We,Ve)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Fe){this.ctx.globalCompositeOperation=Fe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Fe){this.ctx.globalAlpha=Fe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Fe){this.ctx.lineDashOffset=Fe,H.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Fe){this.ctx.lineDash=Fe,H.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Fe){this.ctx.ignoreClearRect=!!Fe}})};f.prototype.setLineDash=function(k){this.lineDash=k},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){w.call(this,"fill",!1)},f.prototype.stroke=function(){w.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(k,U){if(isNaN(k)||isNaN(U))throw Lr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var P=this.ctx.transform.applyToPoint(new s(k,U));this.path.push({type:"mt",x:P.x,y:P.y}),this.ctx.lastPoint=new s(k,U)},f.prototype.closePath=function(){var k=new s(0,0),U=0;for(U=this.path.length-1;U!==-1;U--)if(this.path[U].type==="begin"&&_r(this.path[U+1])==="object"&&typeof this.path[U+1].x=="number"){k=new s(this.path[U+1].x,this.path[U+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(k.x,k.y)},f.prototype.lineTo=function(k,U){if(isNaN(k)||isNaN(U))throw Lr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var P=this.ctx.transform.applyToPoint(new s(k,U));this.path.push({type:"lt",x:P.x,y:P.y}),this.ctx.lastPoint=new s(P.x,P.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),w.call(this,null,!0)},f.prototype.quadraticCurveTo=function(k,U,P,D){if(isNaN(P)||isNaN(D)||isNaN(k)||isNaN(U))throw Lr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var O=this.ctx.transform.applyToPoint(new s(P,D)),z=this.ctx.transform.applyToPoint(new s(k,U));this.path.push({type:"qct",x1:z.x,y1:z.y,x:O.x,y:O.y}),this.ctx.lastPoint=new s(O.x,O.y)},f.prototype.bezierCurveTo=function(k,U,P,D,O,z){if(isNaN(O)||isNaN(z)||isNaN(k)||isNaN(U)||isNaN(P)||isNaN(D))throw Lr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var J=this.ctx.transform.applyToPoint(new s(O,z)),Y=this.ctx.transform.applyToPoint(new s(k,U)),le=this.ctx.transform.applyToPoint(new s(P,D));this.path.push({type:"bct",x1:Y.x,y1:Y.y,x2:le.x,y2:le.y,x:J.x,y:J.y}),this.ctx.lastPoint=new s(J.x,J.y)},f.prototype.arc=function(k,U,P,D,O,z){if(isNaN(k)||isNaN(U)||isNaN(P)||isNaN(D)||isNaN(O))throw Lr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(z=!!z,!this.ctx.transform.isIdentity){var J=this.ctx.transform.applyToPoint(new s(k,U));k=J.x,U=J.y;var Y=this.ctx.transform.applyToPoint(new s(0,P)),le=this.ctx.transform.applyToPoint(new s(0,0));P=Math.sqrt(Math.pow(Y.x-le.x,2)+Math.pow(Y.y-le.y,2))}Math.abs(O-D)>=2*Math.PI&&(D=0,O=2*Math.PI),this.path.push({type:"arc",x:k,y:U,radius:P,startAngle:D,endAngle:O,counterclockwise:z})},f.prototype.arcTo=function(k,U,P,D,O){throw new Error("arcTo not implemented.")},f.prototype.rect=function(k,U,P,D){if(isNaN(k)||isNaN(U)||isNaN(P)||isNaN(D))throw Lr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(k,U),this.lineTo(k+P,U),this.lineTo(k+P,U+D),this.lineTo(k,U+D),this.lineTo(k,U),this.lineTo(k+P,U),this.lineTo(k,U)},f.prototype.fillRect=function(k,U,P,D){if(isNaN(k)||isNaN(U)||isNaN(P)||isNaN(D))throw Lr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!d.call(this)){var O={};this.lineCap!=="butt"&&(O.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(O.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(k,U,P,D),this.fill(),O.hasOwnProperty("lineCap")&&(this.lineCap=O.lineCap),O.hasOwnProperty("lineJoin")&&(this.lineJoin=O.lineJoin)}},f.prototype.strokeRect=function(k,U,P,D){if(isNaN(k)||isNaN(U)||isNaN(P)||isNaN(D))throw Lr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(k,U,P,D),this.stroke())},f.prototype.clearRect=function(k,U,P,D){if(isNaN(k)||isNaN(U)||isNaN(P)||isNaN(D))throw Lr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(k,U,P,D))},f.prototype.save=function(k){k=typeof k!="boolean"||k;for(var U=this.pdf.internal.getCurrentPageInfo().pageNumber,P=0;P<this.pdf.internal.getNumberOfPages();P++)this.pdf.setPage(P+1),this.pdf.internal.out("q");if(this.pdf.setPage(U),k){this.ctx.fontSize=this.pdf.internal.getFontSize();var D=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=D}},f.prototype.restore=function(k){k=typeof k!="boolean"||k;for(var U=this.pdf.internal.getCurrentPageInfo().pageNumber,P=0;P<this.pdf.internal.getNumberOfPages();P++)this.pdf.setPage(P+1),this.pdf.internal.out("Q");this.pdf.setPage(U),k&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(k){var U,P,D,O;if(k.isCanvasGradient===!0&&(k=k.getColor()),!k)return{r:0,g:0,b:0,a:0,style:k};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(k))U=0,P=0,D=0,O=0;else{var z=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(k);if(z!==null)U=parseInt(z[1]),P=parseInt(z[2]),D=parseInt(z[3]),O=1;else if((z=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(k))!==null)U=parseInt(z[1]),P=parseInt(z[2]),D=parseInt(z[3]),O=parseFloat(z[4]);else{if(O=1,typeof k=="string"&&k.charAt(0)!=="#"){var J=new $T(k);k=J.ok?J.toHex():"#000000"}k.length===4?(U=k.substring(1,2),U+=U,P=k.substring(2,3),P+=P,D=k.substring(3,4),D+=D):(U=k.substring(1,3),P=k.substring(3,5),D=k.substring(5,7)),U=parseInt(U,16),P=parseInt(P,16),D=parseInt(D,16)}}return{r:U,g:P,b:D,a:O,style:k}},d=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(k,U,P,D){if(isNaN(U)||isNaN(P)||typeof k!="string")throw Lr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(D=isNaN(D)?void 0:D,!d.call(this)){var O=X(this.ctx.transform.rotation),z=this.ctx.transform.scaleX;C.call(this,{text:k,x:U,y:P,scale:z,angle:O,align:this.textAlign,maxWidth:D})}},f.prototype.strokeText=function(k,U,P,D){if(isNaN(U)||isNaN(P)||typeof k!="string")throw Lr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){D=isNaN(D)?void 0:D;var O=X(this.ctx.transform.rotation),z=this.ctx.transform.scaleX;C.call(this,{text:k,x:U,y:P,scale:z,renderingMode:"stroke",angle:O,align:this.textAlign,maxWidth:D})}},f.prototype.measureText=function(k){if(typeof k!="string")throw Lr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var U=this.pdf,P=this.pdf.internal.scaleFactor,D=U.internal.getFontSize(),O=U.getStringUnitWidth(k)*D/U.internal.scaleFactor,z=function(J){var Y=(J=J||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Y}}),this};return new z({width:O*=Math.round(96*P/72*1e4)/1e4})},f.prototype.scale=function(k,U){if(isNaN(k)||isNaN(U))throw Lr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var P=new l(k,0,0,U,0,0);this.ctx.transform=this.ctx.transform.multiply(P)},f.prototype.rotate=function(k){if(isNaN(k))throw Lr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var U=new l(Math.cos(k),Math.sin(k),-Math.sin(k),Math.cos(k),0,0);this.ctx.transform=this.ctx.transform.multiply(U)},f.prototype.translate=function(k,U){if(isNaN(k)||isNaN(U))throw Lr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var P=new l(1,0,0,1,k,U);this.ctx.transform=this.ctx.transform.multiply(P)},f.prototype.transform=function(k,U,P,D,O,z){if(isNaN(k)||isNaN(U)||isNaN(P)||isNaN(D)||isNaN(O)||isNaN(z))throw Lr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var J=new l(k,U,P,D,O,z);this.ctx.transform=this.ctx.transform.multiply(J)},f.prototype.setTransform=function(k,U,P,D,O,z){k=isNaN(k)?1:k,U=isNaN(U)?0:U,P=isNaN(P)?0:P,D=isNaN(D)?1:D,O=isNaN(O)?0:O,z=isNaN(z)?0:z,this.ctx.transform=new l(k,U,P,D,O,z)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(k,U,P,D,O,z,J,Y,le){var we=this.pdf.getImageProperties(k),ne=1,Me=1,qe=1,Fe=1;D!==void 0&&Y!==void 0&&(qe=Y/D,Fe=le/O,ne=we.width/D*Y/D,Me=we.height/O*le/O),z===void 0&&(z=U,J=P,U=0,P=0),D!==void 0&&Y===void 0&&(Y=D,le=O),D===void 0&&Y===void 0&&(Y=we.width,le=we.height);for(var he,Be=this.ctx.transform.decompose(),xe=X(Be.rotate.shx),se=new l,be=(se=(se=(se=se.multiply(Be.translate)).multiply(Be.skew)).multiply(Be.scale)).applyToRectangle(new o(z-U*qe,J-P*Fe,D*ne,O*Me)),Te=x.call(this,be),pe=[],je=0;je<Te.length;je+=1)pe.indexOf(Te[je])===-1&&pe.push(Te[je]);if(y(pe),this.autoPaging)for(var Ve=pe[0],We=pe[pe.length-1],ft=Ve;ft<We+1;ft++){this.pdf.setPage(ft);var Et=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ut=ft===1?this.posY+this.margin[0]:this.margin[0],wt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],at=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],et=ft===1?0:wt+(ft-2)*at;if(this.ctx.clip_path.length!==0){var ur=this.path;he=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(he,this.posX+this.margin[3],-et+ut+this.ctx.prevPageLastElemOffset),B.call(this,"fill",!0),this.path=ur}var Ft=JSON.parse(JSON.stringify(be));Ft=v([Ft],this.posX+this.margin[3],-et+ut+this.ctx.prevPageLastElemOffset)[0];var tn=(ft>Ve||ft<We)&&g.call(this);tn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Et,at,null).clip().discardPath()),this.pdf.addImage(k,"JPEG",Ft.x,Ft.y,Ft.w,Ft.h,null,null,xe),tn&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(k,"JPEG",be.x,be.y,be.w,be.h,null,null,xe)};var x=function(k,U,P){var D=[];U=U||this.pdf.internal.pageSize.width,P=P||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var O=this.posY+this.ctx.prevPageLastElemOffset;switch(k.type){default:case"mt":case"lt":D.push(Math.floor((k.y+O)/P)+1);break;case"arc":D.push(Math.floor((k.y+O-k.radius)/P)+1),D.push(Math.floor((k.y+O+k.radius)/P)+1);break;case"qct":var z=Q(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x,k.y);D.push(Math.floor((z.y+O)/P)+1),D.push(Math.floor((z.y+z.h+O)/P)+1);break;case"bct":var J=K(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x2,k.y2,k.x,k.y);D.push(Math.floor((J.y+O)/P)+1),D.push(Math.floor((J.y+J.h+O)/P)+1);break;case"rect":D.push(Math.floor((k.y+O)/P)+1),D.push(Math.floor((k.y+k.h+O)/P)+1)}for(var Y=0;Y<D.length;Y+=1)for(;this.pdf.internal.getNumberOfPages()<D[Y];)p.call(this);return D},p=function(){var k=this.fillStyle,U=this.strokeStyle,P=this.font,D=this.lineCap,O=this.lineWidth,z=this.lineJoin;this.pdf.addPage(),this.fillStyle=k,this.strokeStyle=U,this.font=P,this.lineCap=D,this.lineWidth=O,this.lineJoin=z},v=function(k,U,P){for(var D=0;D<k.length;D++)switch(k[D].type){case"bct":k[D].x2+=U,k[D].y2+=P;case"qct":k[D].x1+=U,k[D].y1+=P;case"mt":case"lt":case"arc":default:k[D].x+=U,k[D].y+=P}return k},y=function(k){return k.sort(function(U,P){return U-P})},w=function(k,U){for(var P,D,O=this.fillStyle,z=this.strokeStyle,J=this.lineCap,Y=this.lineWidth,le=Math.abs(Y*this.ctx.transform.scaleX),we=this.lineJoin,ne=JSON.parse(JSON.stringify(this.path)),Me=JSON.parse(JSON.stringify(this.path)),qe=[],Fe=0;Fe<Me.length;Fe++)if(Me[Fe].x!==void 0)for(var he=x.call(this,Me[Fe]),Be=0;Be<he.length;Be+=1)qe.indexOf(he[Be])===-1&&qe.push(he[Be]);for(var xe=0;xe<qe.length;xe++)for(;this.pdf.internal.getNumberOfPages()<qe[xe];)p.call(this);if(y(qe),this.autoPaging)for(var se=qe[0],be=qe[qe.length-1],Te=se;Te<be+1;Te++){this.pdf.setPage(Te),this.fillStyle=O,this.strokeStyle=z,this.lineCap=J,this.lineWidth=le,this.lineJoin=we;var pe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],je=Te===1?this.posY+this.margin[0]:this.margin[0],Ve=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],We=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ft=Te===1?0:Ve+(Te-2)*We;if(this.ctx.clip_path.length!==0){var Et=this.path;P=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(P,this.posX+this.margin[3],-ft+je+this.ctx.prevPageLastElemOffset),B.call(this,k,!0),this.path=Et}if(D=JSON.parse(JSON.stringify(ne)),this.path=v(D,this.posX+this.margin[3],-ft+je+this.ctx.prevPageLastElemOffset),U===!1||Te===0){var ut=(Te>se||Te<be)&&g.call(this);ut&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],pe,We,null).clip().discardPath()),B.call(this,k,U),ut&&this.pdf.restoreGraphicsState()}this.lineWidth=Y}else this.lineWidth=le,B.call(this,k,U),this.lineWidth=Y;this.path=ne},B=function(k,U){if((k!=="stroke"||U||!m.call(this))&&(k==="stroke"||U||!d.call(this))){for(var P,D,O=[],z=this.path,J=0;J<z.length;J++){var Y=z[J];switch(Y.type){case"begin":O.push({begin:!0});break;case"close":O.push({close:!0});break;case"mt":O.push({start:Y,deltas:[],abs:[]});break;case"lt":var le=O.length;if(z[J-1]&&!isNaN(z[J-1].x)&&(P=[Y.x-z[J-1].x,Y.y-z[J-1].y],le>0)){for(;le>=0;le--)if(O[le-1].close!==!0&&O[le-1].begin!==!0){O[le-1].deltas.push(P),O[le-1].abs.push(Y);break}}break;case"bct":P=[Y.x1-z[J-1].x,Y.y1-z[J-1].y,Y.x2-z[J-1].x,Y.y2-z[J-1].y,Y.x-z[J-1].x,Y.y-z[J-1].y],O[O.length-1].deltas.push(P);break;case"qct":var we=z[J-1].x+2/3*(Y.x1-z[J-1].x),ne=z[J-1].y+2/3*(Y.y1-z[J-1].y),Me=Y.x+2/3*(Y.x1-Y.x),qe=Y.y+2/3*(Y.y1-Y.y),Fe=Y.x,he=Y.y;P=[we-z[J-1].x,ne-z[J-1].y,Me-z[J-1].x,qe-z[J-1].y,Fe-z[J-1].x,he-z[J-1].y],O[O.length-1].deltas.push(P);break;case"arc":O.push({deltas:[],abs:[],arc:!0}),Array.isArray(O[O.length-1].abs)&&O[O.length-1].abs.push(Y)}}D=U?null:k==="stroke"?"stroke":"fill";for(var Be=!1,xe=0;xe<O.length;xe++)if(O[xe].arc)for(var se=O[xe].abs,be=0;be<se.length;be++){var Te=se[be];Te.type==="arc"?F.call(this,Te.x,Te.y,Te.radius,Te.startAngle,Te.endAngle,Te.counterclockwise,void 0,U,!Be):L.call(this,Te.x,Te.y),Be=!0}else if(O[xe].close===!0)this.pdf.internal.out("h"),Be=!1;else if(O[xe].begin!==!0){var pe=O[xe].start.x,je=O[xe].start.y;R.call(this,O[xe].deltas,pe,je),Be=!0}D&&T.call(this,D),U&&I.call(this)}},E=function(k){var U=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,P=U*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return k-P;case"top":return k+U-P;case"hanging":return k+U-2*P;case"middle":return k+U/2-P;case"ideographic":return k;case"alphabetic":default:return k}},_=function(k){return k+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var k=function(){};return k.colorStops=[],k.addColorStop=function(U,P){this.colorStops.push([U,P])},k.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},k.isCanvasGradient=!0,k},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var F=function(k,U,P,D,O,z,J,Y,le){for(var we=G.call(this,P,D,O,z),ne=0;ne<we.length;ne++){var Me=we[ne];ne===0&&(le?S.call(this,Me.x1+k,Me.y1+U):L.call(this,Me.x1+k,Me.y1+U)),W.call(this,k,U,Me.x2,Me.y2,Me.x3,Me.y3,Me.x4,Me.y4)}Y?I.call(this):T.call(this,J)},T=function(k){switch(k){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},I=function(){this.pdf.clip(),this.pdf.discardPath()},S=function(k,U){this.pdf.internal.out(r(k)+" "+n(U)+" m")},C=function(k){var U;switch(k.align){case"right":case"end":U="right";break;case"center":U="center";break;case"left":case"start":default:U="left"}var P=this.pdf.getTextDimensions(k.text),D=E.call(this,k.y),O=_.call(this,D)-P.h,z=this.ctx.transform.applyToPoint(new s(k.x,D)),J=this.ctx.transform.decompose(),Y=new l;Y=(Y=(Y=Y.multiply(J.translate)).multiply(J.skew)).multiply(J.scale);for(var le,we,ne,Me=this.ctx.transform.applyToRectangle(new o(k.x,D,P.w,P.h)),qe=Y.applyToRectangle(new o(k.x,O,P.w,P.h)),Fe=x.call(this,qe),he=[],Be=0;Be<Fe.length;Be+=1)he.indexOf(Fe[Be])===-1&&he.push(Fe[Be]);if(y(he),this.autoPaging)for(var xe=he[0],se=he[he.length-1],be=xe;be<se+1;be++){this.pdf.setPage(be);var Te=be===1?this.posY+this.margin[0]:this.margin[0],pe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],je=this.pdf.internal.pageSize.height-this.margin[2],Ve=je-this.margin[0],We=this.pdf.internal.pageSize.width-this.margin[1],ft=We-this.margin[3],Et=be===1?0:pe+(be-2)*Ve;if(this.ctx.clip_path.length!==0){var ut=this.path;le=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(le,this.posX+this.margin[3],-1*Et+Te),B.call(this,"fill",!0),this.path=ut}var wt=v([JSON.parse(JSON.stringify(qe))],this.posX+this.margin[3],-Et+Te+this.ctx.prevPageLastElemOffset)[0];k.scale>=.01&&(we=this.pdf.internal.getFontSize(),this.pdf.setFontSize(we*k.scale),ne=this.lineWidth,this.lineWidth=ne*k.scale);var at=this.autoPaging!=="text";if(at||wt.y+wt.h<=je){if(at||wt.y>=Te&&wt.x<=We){var et=at?k.text:this.pdf.splitTextToSize(k.text,k.maxWidth||We-wt.x)[0],ur=v([JSON.parse(JSON.stringify(Me))],this.posX+this.margin[3],-Et+Te+this.ctx.prevPageLastElemOffset)[0],Ft=at&&(be>xe||be<se)&&g.call(this);Ft&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ft,Ve,null).clip().discardPath()),this.pdf.text(et,ur.x,ur.y,{angle:k.angle,align:U,renderingMode:k.renderingMode}),Ft&&this.pdf.restoreGraphicsState()}}else wt.y<je&&(this.ctx.prevPageLastElemOffset+=je-wt.y);k.scale>=.01&&(this.pdf.setFontSize(we),this.lineWidth=ne)}else k.scale>=.01&&(we=this.pdf.internal.getFontSize(),this.pdf.setFontSize(we*k.scale),ne=this.lineWidth,this.lineWidth=ne*k.scale),this.pdf.text(k.text,z.x+this.posX,z.y+this.posY,{angle:k.angle,align:U,renderingMode:k.renderingMode,maxWidth:k.maxWidth}),k.scale>=.01&&(this.pdf.setFontSize(we),this.lineWidth=ne)},L=function(k,U,P,D){P=P||0,D=D||0,this.pdf.internal.out(r(k+P)+" "+n(U+D)+" l")},R=function(k,U,P){return this.pdf.lines(k,U,P,null,null)},W=function(k,U,P,D,O,z,J,Y){this.pdf.internal.out([t(i(P+k)),t(a(D+U)),t(i(O+k)),t(a(z+U)),t(i(J+k)),t(a(Y+U)),"c"].join(" "))},G=function(k,U,P,D){for(var O=2*Math.PI,z=Math.PI/2;U>P;)U-=O;var J=Math.abs(P-U);J<O&&D&&(J=O-J);for(var Y=[],le=D?-1:1,we=U;J>1e-5;){var ne=we+le*Math.min(J,z);Y.push(V.call(this,k,we,ne)),J-=Math.abs(ne-we),we=ne}return Y},V=function(k,U,P){var D=(P-U)/2,O=k*Math.cos(D),z=k*Math.sin(D),J=O,Y=-z,le=J*J+Y*Y,we=le+J*O+Y*z,ne=4/3*(Math.sqrt(2*le*we)-we)/(J*z-Y*O),Me=J-ne*Y,qe=Y+ne*J,Fe=Me,he=-qe,Be=D+U,xe=Math.cos(Be),se=Math.sin(Be);return{x1:k*Math.cos(U),y1:k*Math.sin(U),x2:Me*xe-qe*se,y2:Me*se+qe*xe,x3:Fe*xe-he*se,y3:Fe*se+he*xe,x4:k*Math.cos(P),y4:k*Math.sin(P)}},X=function(k){return 180*k/Math.PI},Q=function(k,U,P,D,O,z){var J=k+.5*(P-k),Y=U+.5*(D-U),le=O+.5*(P-O),we=z+.5*(D-z),ne=Math.min(k,O,J,le),Me=Math.max(k,O,J,le),qe=Math.min(U,z,Y,we),Fe=Math.max(U,z,Y,we);return new o(ne,qe,Me-ne,Fe-qe)},K=function(k,U,P,D,O,z,J,Y){var le,we,ne,Me,qe,Fe,he,Be,xe,se,be,Te,pe,je,Ve=P-k,We=D-U,ft=O-P,Et=z-D,ut=J-O,wt=Y-z;for(we=0;we<41;we++)xe=(he=(ne=k+(le=we/40)*Ve)+le*((qe=P+le*ft)-ne))+le*(qe+le*(O+le*ut-qe)-he),se=(Be=(Me=U+le*We)+le*((Fe=D+le*Et)-Me))+le*(Fe+le*(z+le*wt-Fe)-Be),we==0?(be=xe,Te=se,pe=xe,je=se):(be=Math.min(be,xe),Te=Math.min(Te,se),pe=Math.max(pe,xe),je=Math.max(je,se));return new o(Math.round(be),Math.round(Te),Math.round(pe-be),Math.round(je-Te))},H=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var k,U,P=(k=this.ctx.lineDash,U=this.ctx.lineDashOffset,JSON.stringify({lineDash:k,lineDashOffset:U}));this.prevLineDash!==P&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=P)}}})(Ut.API),function(e){var t=function(a){var s,o,l,A,u,f,h,d,m,g;for(o=[],l=0,A=(a+=s="\0\0\0\0".slice(a.length%4||4)).length;A>l;l+=4)(u=(a.charCodeAt(l)<<24)+(a.charCodeAt(l+1)<<16)+(a.charCodeAt(l+2)<<8)+a.charCodeAt(l+3))!==0?(f=(u=((u=((u=((u=(u-(g=u%85))/85)-(m=u%85))/85)-(d=u%85))/85)-(h=u%85))/85)%85,o.push(f+33,h+33,d+33,m+33,g+33)):o.push(122);return function(x,p){for(var v=p;v>0;v--)x.pop()}(o,s.length),String.fromCharCode.apply(String,o)+"~>"},r=function(a){var s,o,l,A,u,f=String,h="length",d=255,m="charCodeAt",g="slice",x="replace";for(a[g](-2),a=a[g](0,-2)[x](/\s/g,"")[x]("z","!!!!!"),l=[],A=0,u=(a+=s="uuuuu"[g](a[h]%5||5))[h];u>A;A+=5)o=52200625*(a[m](A)-33)+614125*(a[m](A+1)-33)+7225*(a[m](A+2)-33)+85*(a[m](A+3)-33)+(a[m](A+4)-33),l.push(d&o>>24,d&o>>16,d&o>>8,d&o);return function(p,v){for(var y=v;y>0;y--)p.pop()}(l,s[h]),f.fromCharCode.apply(f,l)},n=function(a){var s=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((a=a.replace(/\s/g,"")).indexOf(">")!==-1&&(a=a.substr(0,a.indexOf(">"))),a.length%2&&(a+="0"),s.test(a)===!1)return"";for(var o="",l=0;l<a.length;l+=2)o+=String.fromCharCode("0x"+(a[l]+a[l+1]));return o},i=function(a){for(var s=new Uint8Array(a.length),o=a.length;o--;)s[o]=a.charCodeAt(o);return a=(s=Oy(s)).reduce(function(l,A){return l+String.fromCharCode(A)},"")};e.processDataByFilters=function(a,s){var o=0,l=a||"",A=[];for(typeof(s=s||[])=="string"&&(s=[s]),o=0;o<s.length;o+=1)switch(s[o]){case"ASCII85Decode":case"/ASCII85Decode":l=r(l),A.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=t(l),A.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=n(l),A.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=l.split("").map(function(u){return("0"+u.charCodeAt().toString(16)).slice(-2)}).join("")+">",A.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=i(l),A.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[o]+'" is not implemented')}return{data:l,reverseChain:A.reverse().join(" ")}}}(Ut.API),function(e){e.loadFile=function(t,r,n){return function(i,a,s){a=a!==!1,s=typeof s=="function"?s:function(){};var o=void 0;try{o=function(l,A,u){var f=new XMLHttpRequest,h=0,d=function(m){var g=m.length,x=[],p=String.fromCharCode;for(h=0;h<g;h+=1)x.push(p(255&m.charCodeAt(h)));return x.join("")};if(f.open("GET",l,!A),f.overrideMimeType("text/plain; charset=x-user-defined"),A===!1&&(f.onload=function(){f.status===200?u(d(this.responseText)):u(void 0)}),f.send(null),A&&f.status===200)return d(f.responseText)}(i,a,s)}catch{}return o}(t,r,n)},e.loadImageFile=e.loadFile}(Ut.API),function(e){function t(){return(jt.html2canvas?Promise.resolve(jt.html2canvas):Yl(()=>Promise.resolve().then(()=>_le),void 0)).catch(function(s){return Promise.reject(new Error("Could not load html2canvas: "+s))}).then(function(s){return s.default?s.default:s})}function r(){return(jt.DOMPurify?Promise.resolve(jt.DOMPurify):Yl(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load dompurify: "+s))}).then(function(s){return s.default?s.default:s})}var n=function(s){var o=_r(s);return o==="undefined"?"undefined":o==="string"||s instanceof String?"string":o==="number"||s instanceof Number?"number":o==="function"||s instanceof Function?"function":s&&s.constructor===Array?"array":s&&s.nodeType===1?"element":o==="object"?"object":"unknown"},i=function(s,o){var l=document.createElement(s);for(var A in o.className&&(l.className=o.className),o.innerHTML&&o.dompurify&&(l.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)l.style[A]=o.style[A];return l},a=function s(o){var l=Object.assign(s.convert(Promise.resolve()),JSON.parse(JSON.stringify(s.template))),A=s.convert(Promise.resolve(),l);return A=(A=A.setProgress(1,s,1,[s])).set(o)};(a.prototype=Object.create(Promise.prototype)).constructor=a,a.convert=function(s,o){return s.__proto__=o||a.prototype,s},a.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},a.prototype.from=function(s,o){return this.then(function(){switch(o=o||function(l){switch(n(l)){case"string":return"string";case"element":return l.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(s)){case"string":return this.then(r).then(function(l){return this.set({src:i("div",{innerHTML:s,dompurify:l})})});case"element":return this.set({src:s});case"canvas":return this.set({canvas:s});case"img":return this.set({img:s});default:return this.error("Unknown source type.")}})},a.prototype.to=function(s){switch(s){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},a.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var s={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function l(A,u){for(var f=A.nodeType===3?document.createTextNode(A.nodeValue):A.cloneNode(!1),h=A.firstChild;h;h=h.nextSibling)u!==!0&&h.nodeType===1&&h.nodeName==="SCRIPT"||f.appendChild(l(h,u));return A.nodeType===1&&(A.nodeName==="CANVAS"?(f.width=A.width,f.height=A.height,f.getContext("2d").drawImage(A,0,0)):A.nodeName!=="TEXTAREA"&&A.nodeName!=="SELECT"||(f.value=A.value),f.addEventListener("load",function(){f.scrollTop=A.scrollTop,f.scrollLeft=A.scrollLeft},!0)),f}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(s.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:s}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},a.prototype.toCanvas=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(t).then(function(o){var l=Object.assign({},this.opt.html2canvas);return delete l.onrendered,o(this.prop.container,l)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},a.prototype.toContext2d=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(t).then(function(o){var l=this.opt.jsPDF,A=this.opt.fontFaces,u=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,f=Object.assign({async:!0,allowTaint:!0,scale:u,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete f.onrendered,l.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,l.context2d.posX=this.opt.x,l.context2d.posY=this.opt.y,l.context2d.margin=this.opt.margin,l.context2d.fontFaces=A,A)for(var h=0;h<A.length;++h){var d=A[h],m=d.src.find(function(g){return g.format==="truetype"});m&&l.addFont(m.url,d.ref.name,d.ref.style)}return f.windowHeight=f.windowHeight||0,f.windowHeight=f.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):f.windowHeight,l.context2d.save(!0),o(this.prop.container,f)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},a.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var s=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=s})},a.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},a.prototype.output=function(s,o,l){return(l=l||"pdf").toLowerCase()==="img"||l.toLowerCase()==="image"?this.outputImg(s,o):this.outputPdf(s,o)},a.prototype.outputPdf=function(s,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(s,o)})},a.prototype.outputImg=function(s){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(s){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+s+'" is not supported.'}})},a.prototype.save=function(s){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(s?{filename:s}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},a.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},a.prototype.set=function(s){if(n(s)!=="object")return this;var o=Object.keys(s||{}).map(function(l){if(l in a.template.prop)return function(){this.prop[l]=s[l]};switch(l){case"margin":return this.setMargin.bind(this,s.margin);case"jsPDF":return function(){return this.opt.jsPDF=s.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,s.pageSize);default:return function(){this.opt[l]=s[l]}}},this);return this.then(function(){return this.thenList(o)})},a.prototype.get=function(s,o){return this.then(function(){var l=s in a.template.prop?this.prop[s]:this.opt[s];return o?o(l):l})},a.prototype.setMargin=function(s){return this.then(function(){switch(n(s)){case"number":s=[s,s,s,s];case"array":if(s.length===2&&(s=[s[0],s[1],s[0],s[1]]),s.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=s}).then(this.setPageSize)},a.prototype.setPageSize=function(s){function o(l,A){return Math.floor(l*A/72*96)}return this.then(function(){(s=s||Ut.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(s.inner={width:s.width-this.opt.margin[1]-this.opt.margin[3],height:s.height-this.opt.margin[0]-this.opt.margin[2]},s.inner.px={width:o(s.inner.width,s.k),height:o(s.inner.height,s.k)},s.inner.ratio=s.inner.height/s.inner.width),this.prop.pageSize=s})},a.prototype.setProgress=function(s,o,l,A){return s!=null&&(this.progress.val=s),o!=null&&(this.progress.state=o),l!=null&&(this.progress.n=l),A!=null&&(this.progress.stack=A),this.progress.ratio=this.progress.val/this.progress.state,this},a.prototype.updateProgress=function(s,o,l,A){return this.setProgress(s?this.progress.val+s:null,o||null,l?this.progress.n+l:null,A?this.progress.stack.concat(A):null)},a.prototype.then=function(s,o){var l=this;return this.thenCore(s,o,function(A,u){return l.updateProgress(null,null,1,[A]),Promise.prototype.then.call(this,function(f){return l.updateProgress(null,A),f}).then(A,u).then(function(f){return l.updateProgress(1),f})})},a.prototype.thenCore=function(s,o,l){l=l||Promise.prototype.then,s&&(s=s.bind(this)),o&&(o=o.bind(this));var A=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:a.convert(Object.assign({},this),Promise.prototype),u=l.call(A,s,o);return a.convert(u,this.__proto__)},a.prototype.thenExternal=function(s,o){return Promise.prototype.then.call(this,s,o)},a.prototype.thenList=function(s){var o=this;return s.forEach(function(l){o=o.thenCore(l)}),o},a.prototype.catch=function(s){s&&(s=s.bind(this));var o=Promise.prototype.catch.call(this,s);return a.convert(o,this)},a.prototype.catchExternal=function(s){return Promise.prototype.catch.call(this,s)},a.prototype.error=function(s){return this.then(function(){throw new Error(s)})},a.prototype.using=a.prototype.set,a.prototype.saveAs=a.prototype.save,a.prototype.export=a.prototype.output,a.prototype.run=a.prototype.then,Ut.getPageSize=function(s,o,l){if(_r(s)==="object"){var A=s;s=A.orientation,o=A.unit||o,l=A.format||l}o=o||"mm",l=l||"a4",s=(""+(s||"P")).toLowerCase();var u,f=(""+l).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":u=1;break;case"mm":u=72/25.4;break;case"cm":u=72/2.54;break;case"in":u=72;break;case"px":u=.75;break;case"pc":case"em":u=12;break;case"ex":u=6;break;default:throw"Invalid unit: "+o}var d,m=0,g=0;if(h.hasOwnProperty(f))m=h[f][1]/u,g=h[f][0]/u;else try{m=l[1],g=l[0]}catch{throw new Error("Invalid format: "+l)}if(s==="p"||s==="portrait")s="p",g>m&&(d=g,g=m,m=d);else{if(s!=="l"&&s!=="landscape")throw"Invalid orientation: "+s;s="l",m>g&&(d=g,g=m,m=d)}return{width:g,height:m,unit:o,k:u,orientation:s}},e.html=function(s,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(My):null;var l=new a(o);return o.worker?l:l.from(s).doCallback()}}(Ut.API),Ut.API.addJS=function(e){return MC=e,this.internal.events.subscribe("postPutResources",function(){Hp=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Hp+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),RC=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+MC+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Hp!==void 0&&RC!==void 0&&this.internal.out("/Names <</JavaScript "+Hp+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),a=0;a<i.length;a++){var s=i[a],o=n.exec(s);if(o!=null){var l=o[1];r.internal.newObjectDeferredBegin(l,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var A=this.internal.pages.length,u=[];for(a=0;a<A;a++){var f=r.internal.newObject();u.push(f);var h=r.internal.getPageInfo(a+1);r.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var d=r.internal.newObject();for(r.internal.write("<< /Names [ "),a=0;a<u.length;a++)r.internal.write("(page_"+(a+1)+")"+u[a]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+d+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,a){var s={title:i,options:a,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var s=n.children[a];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var o=this.count=this.count_r({count:0},s);if(o>0&&this.line("/Count "+o),s.options&&s.options.pageNumber){var l=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var A=0;A<n.children.length;A++)this.renderItems(n.children[A])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var a=0;a<i.children.length;a++)n.count++,this.count_r(n,i.children[a]);return n.count}}])}(Ut.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,i,a,s,o){var l,A=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(l=function(f){for(var h,d=256*f.charCodeAt(4)+f.charCodeAt(5),m=f.length,g={width:0,height:0,numcomponents:1},x=4;x<m;x+=2){if(x+=d,t.indexOf(f.charCodeAt(x+1))!==-1){h=256*f.charCodeAt(x+5)+f.charCodeAt(x+6),g={width:256*f.charCodeAt(x+7)+f.charCodeAt(x+8),height:h,numcomponents:f.charCodeAt(x+9)};break}d=256*f.charCodeAt(x+2)+f.charCodeAt(x+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}u={data:r,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:A,index:n,alias:i}}return u}}(Ut.API);var tu,Kp,HC,KC,GC,Ure=function(){var e,t,r;function n(a){var s,o,l,A,u,f,h,d,m,g,x,p,v,y;for(this.data=a,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},f=null;;){switch(s=this.readUInt32(),m=(function(){var w,B;for(B=[],w=0;w<4;++w)B.push(String.fromCharCode(this.data[this.pos++]));return B}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(s);break;case"fcTL":f&&this.animation.frames.push(f),this.pos+=4,f={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},u=this.readUInt16(),A=this.readUInt16()||100,f.delay=1e3*u/A,f.disposeOp=this.data[this.pos++],f.blendOp=this.data[this.pos++],f.data=[];break;case"IDAT":case"fdAT":for(m==="fdAT"&&(this.pos+=4,s-=4),a=(f!=null?f.data:void 0)||this.imgData,p=0;0<=s?p<s:p>s;0<=s?++p:--p)a.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(l=this.palette.length/3,this.transparency.indexed=this.read(s),this.transparency.indexed.length>l)throw new Error("More transparent colors than palette size");if((g=l-this.transparency.indexed.length)>0)for(v=0;0<=g?v<g:v>g;0<=g?++v:--v)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(s)[0];break;case 2:this.transparency.rgb=this.read(s)}break;case"tEXt":h=(x=this.read(s)).indexOf(0),d=String.fromCharCode.apply(String,x.slice(0,h)),this.text[d]=String.fromCharCode.apply(String,x.slice(h+1));break;case"IEND":return f&&this.animation.frames.push(f),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(y=this.colorType)===4||y===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=s}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(a){var s,o;for(o=[],s=0;0<=a?s<a:s>a;0<=a?++s:--s)o.push(this.data[this.pos++]);return o},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(a){var s=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*s),l=0,A=this;if(a==null&&(a=this.imgData),a.length===0)return new Uint8Array(0);function u(f,h,d,m){var g,x,p,v,y,w,B,E,_,F,T,I,S,C,L,R,W,G,V,X,Q,K=Math.ceil((A.width-f)/d),H=Math.ceil((A.height-h)/m),k=A.width==K&&A.height==H;for(C=s*K,I=k?o:new Uint8Array(C*H),w=a.length,S=0,x=0;S<H&&l<w;){switch(a[l++]){case 0:for(v=W=0;W<C;v=W+=1)I[x++]=a[l++];break;case 1:for(v=G=0;G<C;v=G+=1)g=a[l++],y=v<s?0:I[x-s],I[x++]=(g+y)%256;break;case 2:for(v=V=0;V<C;v=V+=1)g=a[l++],p=(v-v%s)/s,L=S&&I[(S-1)*C+p*s+v%s],I[x++]=(L+g)%256;break;case 3:for(v=X=0;X<C;v=X+=1)g=a[l++],p=(v-v%s)/s,y=v<s?0:I[x-s],L=S&&I[(S-1)*C+p*s+v%s],I[x++]=(g+Math.floor((y+L)/2))%256;break;case 4:for(v=Q=0;Q<C;v=Q+=1)g=a[l++],p=(v-v%s)/s,y=v<s?0:I[x-s],S===0?L=R=0:(L=I[(S-1)*C+p*s+v%s],R=p&&I[(S-1)*C+(p-1)*s+v%s]),B=y+L-R,E=Math.abs(B-y),F=Math.abs(B-L),T=Math.abs(B-R),_=E<=F&&E<=T?y:F<=T?L:R,I[x++]=(g+_)%256;break;default:throw new Error("Invalid filter algorithm: "+a[l-1])}if(!k){var U=((h+S*m)*A.width+f)*s,P=S*C;for(v=0;v<K;v+=1){for(var D=0;D<s;D+=1)o[U++]=I[P++];U+=(d-1)*s}}S++}}return a=ure(a),A.interlaceMethod==1?(u(0,0,8,8),u(4,0,8,8),u(0,4,4,8),u(2,0,4,4),u(0,2,2,4),u(1,0,2,2),u(0,1,1,2)):u(0,0,1,1),o},n.prototype.decodePalette=function(){var a,s,o,l,A,u,f,h,d;for(o=this.palette,u=this.transparency.indexed||[],A=new Uint8Array((u.length||0)+o.length),l=0,a=0,s=f=0,h=o.length;f<h;s=f+=3)A[l++]=o[s],A[l++]=o[s+1],A[l++]=o[s+2],A[l++]=(d=u[a++])!=null?d:255;return A},n.prototype.copyToImageData=function(a,s){var o,l,A,u,f,h,d,m,g,x,p;if(l=this.colors,g=null,o=this.hasAlphaChannel,this.palette.length&&(g=(p=this._decodedPalette)!=null?p:this._decodedPalette=this.decodePalette(),l=4,o=!0),m=(A=a.data||a).length,f=g||s,u=h=0,l===1)for(;u<m;)d=g?4*s[u/4]:h,x=f[d++],A[u++]=x,A[u++]=x,A[u++]=x,A[u++]=o?f[d++]:255,h=d;else for(;u<m;)d=g?4*s[u/4]:h,A[u++]=f[d++],A[u++]=f[d++],A[u++]=f[d++],A[u++]=o?f[d++]:255,h=d},n.prototype.decode=function(){var a;return a=new Uint8Array(this.width*this.height*4),this.copyToImageData(a,this.decodePixels()),a};var i=function(){if(Object.prototype.toString.call(jt)==="[object Window]"){try{t=jt.document.createElement("canvas"),r=t.getContext("2d")}catch{return!1}return!0}return!1};return i(),e=function(a){var s;if(i()===!0)return r.width=a.width,r.height=a.height,r.clearRect(0,0,a.width,a.height),r.putImageData(a,0,0),(s=new Image).src=t.toDataURL(),s;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(a){var s,o,l,A,u,f,h,d;if(this.animation){for(d=[],o=u=0,f=(h=this.animation.frames).length;u<f;o=++u)s=h[o],l=a.createImageData(s.width,s.height),A=this.decodePixels(new Uint8Array(s.data)),this.copyToImageData(l,A),s.imageData=l,d.push(s.image=e(l));return d}},n.prototype.renderFrame=function(a,s){var o,l,A;return o=(l=this.animation.frames)[s],A=l[s-1],s===0&&a.clearRect(0,0,this.width,this.height),(A!=null?A.disposeOp:void 0)===1?a.clearRect(A.xOffset,A.yOffset,A.width,A.height):(A!=null?A.disposeOp:void 0)===2&&a.putImageData(A.imageData,A.xOffset,A.yOffset),o.blendOp===0&&a.clearRect(o.xOffset,o.yOffset,o.width,o.height),a.drawImage(o.image,o.xOffset,o.yOffset)},n.prototype.animate=function(a){var s,o,l,A,u,f,h=this;return o=0,f=this.animation,A=f.numFrames,l=f.frames,u=f.numPlays,(s=function(){var d,m;if(d=o++%A,m=l[d],h.renderFrame(a,d),A>1&&o/A<u)return h.animation._timeout=setTimeout(s,m.delay)})()},n.prototype.stopAnimation=function(){var a;return clearTimeout((a=this.animation)!=null?a._timeout:void 0)},n.prototype.render=function(a){var s,o;return a._png&&a._png.stopAnimation(),a._png=this,a.width=this.width,a.height=this.height,s=a.getContext("2d"),this.animation?(this.decodeFrames(s),this.animate(s)):(o=s.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),s.putImageData(o,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function Ore(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,i=e[t++],a=i>>7,s=1<<(7&i)+1;e[t++],e[t++];var o=null,l=null;a&&(o=t,l=s,t+=3*s);var A=!0,u=[],f=0,h=null,d=0,m=null;for(this.width=r,this.height=n;A&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,m=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((S=e[t++])>=0))throw Error("Invalid block size");if(S===0)break;t+=S}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];f=e[t++]|e[t++]<<8,h=e[t++],!(1&g)&&(h=null),d=g>>2&7,t++;break;case 254:for(;;){if(!((S=e[t++])>=0))throw Error("Invalid block size");if(S===0)break;t+=S}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var x=e[t++]|e[t++]<<8,p=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,w=e[t++],B=w>>6&1,E=1<<(7&w)+1,_=o,F=l,T=!1;w>>7&&(T=!0,_=t,F=E,t+=3*E);var I=t;for(t++;;){var S;if(!((S=e[t++])>=0))throw Error("Invalid block size");if(S===0)break;t+=S}u.push({x,y:p,width:v,height:y,has_local_palette:T,palette_offset:_,palette_size:F,data_offset:I,data_length:t-I,transparent_index:h,interlaced:!!B,delay:f,disposal:d});break;case 59:A=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return m},this.frameInfo=function(C){if(C<0||C>=u.length)throw new Error("Frame index out of range.");return u[C]},this.decodeAndBlitFrameBGRA=function(C,L){var R=this.frameInfo(C),W=R.width*R.height,G=new Uint8Array(W);VC(e,R.data_offset,G,W);var V=R.palette_offset,X=R.transparent_index;X===null&&(X=256);var Q=R.width,K=r-Q,H=Q,k=4*(R.y*r+R.x),U=4*((R.y+R.height)*r+R.x),P=k,D=4*K;R.interlaced===!0&&(D+=4*r*7);for(var O=8,z=0,J=G.length;z<J;++z){var Y=G[z];if(H===0&&(H=Q,(P+=D)>=U&&(D=4*K+4*r*(O-1),P=k+(Q+K)*(O<<1),O>>=1)),Y===X)P+=4;else{var le=e[V+3*Y],we=e[V+3*Y+1],ne=e[V+3*Y+2];L[P++]=ne,L[P++]=we,L[P++]=le,L[P++]=255}--H}},this.decodeAndBlitFrameRGBA=function(C,L){var R=this.frameInfo(C),W=R.width*R.height,G=new Uint8Array(W);VC(e,R.data_offset,G,W);var V=R.palette_offset,X=R.transparent_index;X===null&&(X=256);var Q=R.width,K=r-Q,H=Q,k=4*(R.y*r+R.x),U=4*((R.y+R.height)*r+R.x),P=k,D=4*K;R.interlaced===!0&&(D+=4*r*7);for(var O=8,z=0,J=G.length;z<J;++z){var Y=G[z];if(H===0&&(H=Q,(P+=D)>=U&&(D=4*K+4*r*(O-1),P=k+(Q+K)*(O<<1),O>>=1)),Y===X)P+=4;else{var le=e[V+3*Y],we=e[V+3*Y+1],ne=e[V+3*Y+2];L[P++]=le,L[P++]=we,L[P++]=ne,L[P++]=255}--H}}}function VC(e,t,r,n){for(var i=e[t++],a=1<<i,s=a+1,o=s+1,l=i+1,A=(1<<l)-1,u=0,f=0,h=0,d=e[t++],m=new Int32Array(4096),g=null;;){for(;u<16&&d!==0;)f|=e[t++]<<u,u+=8,d===1?d=e[t++]:--d;if(u<l)break;var x=f&A;if(f>>=l,u-=l,x!==a){if(x===s)break;for(var p=x<o?x:g,v=0,y=p;y>a;)y=m[y]>>8,++v;var w=y;if(h+v+(p!==x?1:0)>n)return void Lr.log("Warning, gif stream longer than expected.");r[h++]=w;var B=h+=v;for(p!==x&&(r[h++]=w),y=p;v--;)y=m[y],r[--B]=255&y,y>>=8;g!==null&&o<4096&&(m[o++]=g<<8|w,o>=A+1&&l<12&&(++l,A=A<<1|1)),g=x}else o=s+1,A=(1<<(l=i+1))-1,g=null}return h!==n&&Lr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function jx(e){var t,r,n,i,a,s=Math.floor,o=new Array(64),l=new Array(64),A=new Array(64),u=new Array(64),f=new Array(65535),h=new Array(65535),d=new Array(64),m=new Array(64),g=[],x=0,p=7,v=new Array(64),y=new Array(64),w=new Array(64),B=new Array(256),E=new Array(2048),_=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],F=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],I=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],S=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],C=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],L=[0,1,2,3,4,5,6,7,8,9,10,11],R=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],W=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function G(k,U){for(var P=0,D=0,O=new Array,z=1;z<=16;z++){for(var J=1;J<=k[z];J++)O[U[D]]=[],O[U[D]][0]=P,O[U[D]][1]=z,D++,P++;P*=2}return O}function V(k){for(var U=k[0],P=k[1]-1;P>=0;)U&1<<P&&(x|=1<<p),P--,--p<0&&(x==255?(X(255),X(0)):X(x),p=7,x=0)}function X(k){g.push(k)}function Q(k){X(k>>8&255),X(255&k)}function K(k,U,P,D,O){for(var z,J=O[0],Y=O[240],le=function(se,be){var Te,pe,je,Ve,We,ft,Et,ut,wt,at,et=0;for(wt=0;wt<8;++wt){Te=se[et],pe=se[et+1],je=se[et+2],Ve=se[et+3],We=se[et+4],ft=se[et+5],Et=se[et+6];var ur=Te+(ut=se[et+7]),Ft=Te-ut,tn=pe+Et,fr=pe-Et,dr=je+ft,Rn=je-ft,nr=Ve+We,Ta=Ve-We,Nr=ur+nr,Li=ur-nr,Aa=tn+dr,vr=tn-dr;se[et]=Nr+Aa,se[et+4]=Nr-Aa;var Pt=.707106781*(vr+Li);se[et+2]=Li+Pt,se[et+6]=Li-Pt;var ir=.382683433*((Nr=Ta+Rn)-(vr=fr+Ft)),ls=.5411961*Nr+ir,_e=1.306562965*vr+ir,Ce=.707106781*(Aa=Rn+fr),De=Ft+Ce,ye=Ft-Ce;se[et+5]=ye+ls,se[et+3]=ye-ls,se[et+1]=De+_e,se[et+7]=De-_e,et+=8}for(et=0,wt=0;wt<8;++wt){Te=se[et],pe=se[et+8],je=se[et+16],Ve=se[et+24],We=se[et+32],ft=se[et+40],Et=se[et+48];var rt=Te+(ut=se[et+56]),Ct=Te-ut,St=pe+Et,kt=pe-Et,Xt=je+ft,te=je-ft,ue=Ve+We,ae=Ve-We,Ae=rt+ue,fe=rt-ue,ge=St+Xt,Oe=St-Xt;se[et]=Ae+ge,se[et+32]=Ae-ge;var Ke=.707106781*(Oe+fe);se[et+16]=fe+Ke,se[et+48]=fe-Ke;var Ie=.382683433*((Ae=ae+te)-(Oe=kt+Ct)),Re=.5411961*Ae+Ie,He=1.306562965*Oe+Ie,nt=.707106781*(ge=te+kt),lt=Ct+nt,pt=Ct-nt;se[et+40]=pt+Re,se[et+24]=pt-Re,se[et+8]=lt+He,se[et+56]=lt-He,et++}for(wt=0;wt<64;++wt)at=se[wt]*be[wt],d[wt]=at>0?at+.5|0:at-.5|0;return d}(k,U),we=0;we<64;++we)m[_[we]]=le[we];var ne=m[0]-P;P=m[0],ne==0?V(D[0]):(V(D[h[z=32767+ne]]),V(f[z]));for(var Me=63;Me>0&&m[Me]==0;)Me--;if(Me==0)return V(J),P;for(var qe,Fe=1;Fe<=Me;){for(var he=Fe;m[Fe]==0&&Fe<=Me;)++Fe;var Be=Fe-he;if(Be>=16){qe=Be>>4;for(var xe=1;xe<=qe;++xe)V(Y);Be&=15}z=32767+m[Fe],V(O[(Be<<4)+h[z]]),V(f[z]),Fe++}return Me!=63&&V(J),P}function H(k){k=Math.min(Math.max(k,1),100),a!=k&&(function(U){for(var P=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],D=0;D<64;D++){var O=s((P[D]*U+50)/100);O=Math.min(Math.max(O,1),255),o[_[D]]=O}for(var z=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],J=0;J<64;J++){var Y=s((z[J]*U+50)/100);Y=Math.min(Math.max(Y,1),255),l[_[J]]=Y}for(var le=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],we=0,ne=0;ne<8;ne++)for(var Me=0;Me<8;Me++)A[we]=1/(o[_[we]]*le[ne]*le[Me]*8),u[we]=1/(l[_[we]]*le[ne]*le[Me]*8),we++}(k<50?Math.floor(5e3/k):Math.floor(200-2*k)),a=k)}this.encode=function(k,U){U&&H(U),g=new Array,x=0,p=7,Q(65496),Q(65504),Q(16),X(74),X(70),X(73),X(70),X(0),X(1),X(1),X(0),Q(1),Q(1),X(0),X(0),function(){Q(65499),Q(132),X(0);for(var pe=0;pe<64;pe++)X(o[pe]);X(1);for(var je=0;je<64;je++)X(l[je])}(),function(pe,je){Q(65472),Q(17),X(8),Q(je),Q(pe),X(3),X(1),X(17),X(0),X(2),X(17),X(1),X(3),X(17),X(1)}(k.width,k.height),function(){Q(65476),Q(418),X(0);for(var pe=0;pe<16;pe++)X(F[pe+1]);for(var je=0;je<=11;je++)X(T[je]);X(16);for(var Ve=0;Ve<16;Ve++)X(I[Ve+1]);for(var We=0;We<=161;We++)X(S[We]);X(1);for(var ft=0;ft<16;ft++)X(C[ft+1]);for(var Et=0;Et<=11;Et++)X(L[Et]);X(17);for(var ut=0;ut<16;ut++)X(R[ut+1]);for(var wt=0;wt<=161;wt++)X(W[wt])}(),Q(65498),Q(12),X(3),X(1),X(0),X(2),X(17),X(3),X(17),X(0),X(63),X(0);var P=0,D=0,O=0;x=0,p=7,this.encode.displayName="_encode_";for(var z,J,Y,le,we,ne,Me,qe,Fe,he=k.data,Be=k.width,xe=k.height,se=4*Be,be=0;be<xe;){for(z=0;z<se;){for(we=se*be+z,Me=-1,qe=0,Fe=0;Fe<64;Fe++)ne=we+(qe=Fe>>3)*se+(Me=4*(7&Fe)),be+qe>=xe&&(ne-=se*(be+1+qe-xe)),z+Me>=se&&(ne-=z+Me-se+4),J=he[ne++],Y=he[ne++],le=he[ne++],v[Fe]=(E[J]+E[Y+256>>0]+E[le+512>>0]>>16)-128,y[Fe]=(E[J+768>>0]+E[Y+1024>>0]+E[le+1280>>0]>>16)-128,w[Fe]=(E[J+1280>>0]+E[Y+1536>>0]+E[le+1792>>0]>>16)-128;P=K(v,A,P,t,n),D=K(y,u,D,r,i),O=K(w,u,O,r,i),z+=32}be+=8}if(p>=0){var Te=[];Te[1]=p+1,Te[0]=(1<<p+1)-1,V(Te)}return Q(65497),new Uint8Array(g)},e=e||50,function(){for(var k=String.fromCharCode,U=0;U<256;U++)B[U]=k(U)}(),t=G(F,T),r=G(C,L),n=G(I,S),i=G(R,W),function(){for(var k=1,U=2,P=1;P<=15;P++){for(var D=k;D<U;D++)h[32767+D]=P,f[32767+D]=[],f[32767+D][1]=P,f[32767+D][0]=D;for(var O=-(U-1);O<=-k;O++)h[32767+O]=P,f[32767+O]=[],f[32767+O][1]=P,f[32767+O][0]=U-1+O;k<<=1,U<<=1}}(),function(){for(var k=0;k<256;k++)E[k]=19595*k,E[k+256>>0]=38470*k,E[k+512>>0]=7471*k+32768,E[k+768>>0]=-11059*k,E[k+1024>>0]=-21709*k,E[k+1280>>0]=32768*k+8421375,E[k+1536>>0]=-27439*k,E[k+1792>>0]=-5329*k}(),H(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function vs(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function WC(e){function t(F){if(!F)throw Error("assert :P")}function r(F,T,I){for(var S=0;4>S;S++)if(F[T+S]!=I.charCodeAt(S))return!0;return!1}function n(F,T,I,S,C){for(var L=0;L<C;L++)F[T+L]=I[S+L]}function i(F,T,I,S){for(var C=0;C<S;C++)F[T+C]=I}function a(F){return new Int32Array(F)}function s(F,T){for(var I=[],S=0;S<F;S++)I.push(new T);return I}function o(F,T){var I=[];return function S(C,L,R){for(var W=R[L],G=0;G<W&&(C.push(R.length>L+1?[]:new T),!(R.length<L+1));G++)S(C[G],L+1,R)}(I,0,F),I}var l=function(){var F=this;function T(b,N){for(var M=1<<N-1>>>0;b&M;)M>>>=1;return M?(b&M-1)+M:b}function I(b,N,M,q,Z){t(!(q%M));do b[N+(q-=M)]=Z;while(0<q)}function S(b,N,M,q,Z){if(t(2328>=Z),512>=Z)var re=a(512);else if((re=a(Z))==null)return 0;return function(ie,oe,ce,de,Ee,Pe){var Qe,Le,Je=oe,Ge=1<<ce,ke=a(16),Ne=a(16);for(t(Ee!=0),t(de!=null),t(ie!=null),t(0<ce),Le=0;Le<Ee;++Le){if(15<de[Le])return 0;++ke[de[Le]]}if(ke[0]==Ee)return 0;for(Ne[1]=0,Qe=1;15>Qe;++Qe){if(ke[Qe]>1<<Qe)return 0;Ne[Qe+1]=Ne[Qe]+ke[Qe]}for(Le=0;Le<Ee;++Le)Qe=de[Le],0<de[Le]&&(Pe[Ne[Qe]++]=Le);if(Ne[15]==1)return(de=new C).g=0,de.value=Pe[0],I(ie,Je,1,Ge,de),Ge;var Xe,tt=-1,Ye=Ge-1,xt=0,ht=1,It=1,gt=1<<ce;for(Le=0,Qe=1,Ee=2;Qe<=ce;++Qe,Ee<<=1){if(ht+=It<<=1,0>(It-=ke[Qe]))return 0;for(;0<ke[Qe];--ke[Qe])(de=new C).g=Qe,de.value=Pe[Le++],I(ie,Je+xt,Ee,gt,de),xt=T(xt,Qe)}for(Qe=ce+1,Ee=2;15>=Qe;++Qe,Ee<<=1){if(ht+=It<<=1,0>(It-=ke[Qe]))return 0;for(;0<ke[Qe];--ke[Qe]){if(de=new C,(xt&Ye)!=tt){for(Je+=gt,Xe=1<<(tt=Qe)-ce;15>tt&&!(0>=(Xe-=ke[tt]));)++tt,Xe<<=1;Ge+=gt=1<<(Xe=tt-ce),ie[oe+(tt=xt&Ye)].g=Xe+ce,ie[oe+tt].value=Je-oe-tt}de.g=Qe-ce,de.value=Pe[Le++],I(ie,Je+(xt>>ce),Ee,gt,de),xt=T(xt,Qe)}}return ht!=2*Ne[15]-1?0:Ge}(b,N,M,q,Z,re)}function C(){this.value=this.g=0}function L(){this.value=this.g=0}function R(){this.G=s(5,C),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(Yn,L)}function W(b,N,M,q){t(b!=null),t(N!=null),t(2147483648>q),b.Ca=254,b.I=0,b.b=-8,b.Ka=0,b.oa=N,b.pa=M,b.Jd=N,b.Yc=M+q,b.Zc=4<=q?M+q-4+1:M,z(b)}function G(b,N){for(var M=0;0<N--;)M|=Y(b,128)<<N;return M}function V(b,N){var M=G(b,N);return J(b)?-M:M}function X(b,N,M,q){var Z,re=0;for(t(b!=null),t(N!=null),t(4294967288>q),b.Sb=q,b.Ra=0,b.u=0,b.h=0,4<q&&(q=4),Z=0;Z<q;++Z)re+=N[M+Z]<<8*Z;b.Ra=re,b.bb=q,b.oa=N,b.pa=M}function Q(b){for(;8<=b.u&&b.bb<b.Sb;)b.Ra>>>=8,b.Ra+=b.oa[b.pa+b.bb]<<Lc-8>>>0,++b.bb,b.u-=8;P(b)&&(b.h=1,b.u=0)}function K(b,N){if(t(0<=N),!b.h&&N<=Tc){var M=U(b)&Nc[N];return b.u+=N,Q(b),M}return b.h=1,b.u=0}function H(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function k(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function U(b){return b.Ra>>>(b.u&Lc-1)>>>0}function P(b){return t(b.bb<=b.Sb),b.h||b.bb==b.Sb&&b.u>Lc}function D(b,N){b.u=N,b.h=P(b)}function O(b){b.u>=jf&&(t(b.u>=jf),Q(b))}function z(b){t(b!=null&&b.oa!=null),b.pa<b.Zc?(b.I=(b.oa[b.pa++]|b.I<<8)>>>0,b.b+=8):(t(b!=null&&b.oa!=null),b.pa<b.Yc?(b.b+=8,b.I=b.oa[b.pa++]|b.I<<8):b.Ka?b.b=0:(b.I<<=8,b.b+=8,b.Ka=1))}function J(b){return G(b,1)}function Y(b,N){var M=b.Ca;0>b.b&&z(b);var q=b.b,Z=M*N>>>8,re=(b.I>>>q>Z)+0;for(re?(M-=Z,b.I-=Z+1<<q>>>0):M=Z+1,q=M,Z=0;256<=q;)Z+=8,q>>=8;return q=7^Z+$i[q],b.b-=q,b.Ca=(M<<q)-1,re}function le(b,N,M){b[N+0]=M>>24&255,b[N+1]=M>>16&255,b[N+2]=M>>8&255,b[N+3]=M>>0&255}function we(b,N){return b[N+0]<<0|b[N+1]<<8}function ne(b,N){return we(b,N)|b[N+2]<<16}function Me(b,N){return we(b,N)|we(b,N+2)<<16}function qe(b,N){var M=1<<N;return t(b!=null),t(0<N),b.X=a(M),b.X==null?0:(b.Mb=32-N,b.Xa=N,1)}function Fe(b,N){t(b!=null),t(N!=null),t(b.Xa==N.Xa),n(N.X,0,b.X,0,1<<N.Xa)}function he(){this.X=[],this.Xa=this.Mb=0}function Be(b,N,M,q){t(M!=null),t(q!=null);var Z=M[0],re=q[0];return Z==0&&(Z=(b*re+N/2)/N),re==0&&(re=(N*Z+b/2)/b),0>=Z||0>=re?0:(M[0]=Z,q[0]=re,1)}function xe(b,N){return b+(1<<N)-1>>>N}function se(b,N){return((4278255360&b)+(4278255360&N)>>>0&4278255360)+((16711935&b)+(16711935&N)>>>0&16711935)>>>0}function be(b,N){F[N]=function(M,q,Z,re,ie,oe,ce){var de;for(de=0;de<ie;++de){var Ee=F[b](oe[ce+de-1],Z,re+de);oe[ce+de]=se(M[q+de],Ee)}}}function Te(){this.ud=this.hd=this.jd=0}function pe(b,N){return((4278124286&(b^N))>>>1)+(b&N)>>>0}function je(b){return 0<=b&&256>b?b:0>b?0:255<b?255:void 0}function Ve(b,N){return je(b+(b-N+.5>>1))}function We(b,N,M){return Math.abs(N-M)-Math.abs(b-M)}function ft(b,N,M,q,Z,re,ie){for(q=re[ie-1],M=0;M<Z;++M)re[ie+M]=q=se(b[N+M],q)}function Et(b,N,M,q,Z){var re;for(re=0;re<M;++re){var ie=b[N+re],oe=ie>>8&255,ce=16711935&(ce=(ce=16711935&ie)+((oe<<16)+oe));q[Z+re]=(4278255360&ie)+ce>>>0}}function ut(b,N){N.jd=b>>0&255,N.hd=b>>8&255,N.ud=b>>16&255}function wt(b,N,M,q,Z,re){var ie;for(ie=0;ie<q;++ie){var oe=N[M+ie],ce=oe>>>8,de=oe,Ee=255&(Ee=(Ee=oe>>>16)+((b.jd<<24>>24)*(ce<<24>>24)>>>5));de=255&(de=(de=de+((b.hd<<24>>24)*(ce<<24>>24)>>>5))+((b.ud<<24>>24)*(Ee<<24>>24)>>>5)),Z[re+ie]=(4278255360&oe)+(Ee<<16)+de}}function at(b,N,M,q,Z){F[N]=function(re,ie,oe,ce,de,Ee,Pe,Qe,Le){for(ce=Pe;ce<Qe;++ce)for(Pe=0;Pe<Le;++Pe)de[Ee++]=Z(oe[q(re[ie++])])},F[b]=function(re,ie,oe,ce,de,Ee,Pe){var Qe=8>>re.b,Le=re.Ea,Je=re.K[0],Ge=re.w;if(8>Qe)for(re=(1<<re.b)-1,Ge=(1<<Qe)-1;ie<oe;++ie){var ke,Ne=0;for(ke=0;ke<Le;++ke)ke&re||(Ne=q(ce[de++])),Ee[Pe++]=Z(Je[Ne&Ge]),Ne>>=Qe}else F["VP8LMapColor"+M](ce,de,Je,Ge,Ee,Pe,ie,oe,Le)}}function et(b,N,M,q,Z){for(M=N+M;N<M;){var re=b[N++];q[Z++]=re>>16&255,q[Z++]=re>>8&255,q[Z++]=re>>0&255}}function ur(b,N,M,q,Z){for(M=N+M;N<M;){var re=b[N++];q[Z++]=re>>16&255,q[Z++]=re>>8&255,q[Z++]=re>>0&255,q[Z++]=re>>24&255}}function Ft(b,N,M,q,Z){for(M=N+M;N<M;){var re=(ie=b[N++])>>16&240|ie>>12&15,ie=ie>>0&240|ie>>28&15;q[Z++]=re,q[Z++]=ie}}function tn(b,N,M,q,Z){for(M=N+M;N<M;){var re=(ie=b[N++])>>16&248|ie>>13&7,ie=ie>>5&224|ie>>3&31;q[Z++]=re,q[Z++]=ie}}function fr(b,N,M,q,Z){for(M=N+M;N<M;){var re=b[N++];q[Z++]=re>>0&255,q[Z++]=re>>8&255,q[Z++]=re>>16&255}}function dr(b,N,M,q,Z,re){if(re==0)for(M=N+M;N<M;)le(q,((re=b[N++])[0]>>24|re[1]>>8&65280|re[2]<<8&16711680|re[3]<<24)>>>0),Z+=32;else n(q,Z,b,N,M)}function Rn(b,N){F[N][0]=F[b+"0"],F[N][1]=F[b+"1"],F[N][2]=F[b+"2"],F[N][3]=F[b+"3"],F[N][4]=F[b+"4"],F[N][5]=F[b+"5"],F[N][6]=F[b+"6"],F[N][7]=F[b+"7"],F[N][8]=F[b+"8"],F[N][9]=F[b+"9"],F[N][10]=F[b+"10"],F[N][11]=F[b+"11"],F[N][12]=F[b+"12"],F[N][13]=F[b+"13"],F[N][14]=F[b+"0"],F[N][15]=F[b+"0"]}function nr(b){return b==Av||b==cv||b==K0||b==uv}function Ta(){this.eb=[],this.size=this.A=this.fb=0}function Nr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Li(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Ta,this.f.kb=new Nr,this.sd=null}function Aa(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function vr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Pt(b){return alert("todo:WebPSamplerProcessPlane"),b.T}function ir(b,N){var M=b.T,q=N.ba.f.RGBA,Z=q.eb,re=q.fb+b.ka*q.A,ie=Da[N.ba.S],oe=b.y,ce=b.O,de=b.f,Ee=b.N,Pe=b.ea,Qe=b.W,Le=N.cc,Je=N.dc,Ge=N.Mc,ke=N.Nc,Ne=b.ka,Xe=b.ka+b.T,tt=b.U,Ye=tt+1>>1;for(Ne==0?ie(oe,ce,null,null,de,Ee,Pe,Qe,de,Ee,Pe,Qe,Z,re,null,null,tt):(ie(N.ec,N.fc,oe,ce,Le,Je,Ge,ke,de,Ee,Pe,Qe,Z,re-q.A,Z,re,tt),++M);Ne+2<Xe;Ne+=2)Le=de,Je=Ee,Ge=Pe,ke=Qe,Ee+=b.Rc,Qe+=b.Rc,re+=2*q.A,ie(oe,(ce+=2*b.fa)-b.fa,oe,ce,Le,Je,Ge,ke,de,Ee,Pe,Qe,Z,re-q.A,Z,re,tt);return ce+=b.fa,b.j+Xe<b.o?(n(N.ec,N.fc,oe,ce,tt),n(N.cc,N.dc,de,Ee,Ye),n(N.Mc,N.Nc,Pe,Qe,Ye),M--):1&Xe||ie(oe,ce,null,null,de,Ee,Pe,Qe,de,Ee,Pe,Qe,Z,re+q.A,null,null,tt),M}function ls(b,N,M){var q=b.F,Z=[b.J];if(q!=null){var re=b.U,ie=N.ba.S,oe=ie==H0||ie==K0;N=N.ba.f.RGBA;var ce=[0],de=b.ka;ce[0]=b.T,b.Kb&&(de==0?--ce[0]:(--de,Z[0]-=b.width),b.j+b.ka+b.T==b.o&&(ce[0]=b.o-b.j-de));var Ee=N.eb;de=N.fb+de*N.A,b=Ur(q,Z[0],b.width,re,ce,Ee,de+(oe?0:3),N.A),t(M==ce),b&&nr(ie)&&Oa(Ee,de,oe,re,ce,N.A)}return 0}function _e(b){var N=b.ma,M=N.ba.S,q=11>M,Z=M==R0||M==M0||M==H0||M==lv||M==12||nr(M);if(N.memory=null,N.Ib=null,N.Jb=null,N.Nd=null,!Uf(N.Oa,b,Z?11:12))return 0;if(Z&&nr(M)&&it(),b.da)alert("todo:use_scaling");else{if(q){if(N.Ib=Pt,b.Kb){if(M=b.U+1>>1,N.memory=a(b.U+2*M),N.memory==null)return 0;N.ec=N.memory,N.fc=0,N.cc=N.ec,N.dc=N.fc+b.U,N.Mc=N.cc,N.Nc=N.dc+M,N.Ib=ir,it()}}else alert("todo:EmitYUV");Z&&(N.Jb=ls,q&&Ue())}if(q&&!L5){for(b=0;256>b;++b)kL[b]=89858*(b-128)+V0>>G0,TL[b]=-22014*(b-128)+V0,NL[b]=-45773*(b-128),FL[b]=113618*(b-128)+V0>>G0;for(b=Kf;b<dv;++b)N=76283*(b-16)+V0>>G0,LL[b-Kf]=ua(N,255),IL[b-Kf]=ua(N+8>>4,15);L5=1}return 1}function Ce(b){var N=b.ma,M=b.U,q=b.T;return t(!(1&b.ka)),0>=M||0>=q?0:(M=N.Ib(b,N),N.Jb!=null&&N.Jb(b,N,M),N.Dc+=M,1)}function De(b){b.ma.memory=null}function ye(b,N,M,q){return K(b,8)!=47?0:(N[0]=K(b,14)+1,M[0]=K(b,14)+1,q[0]=K(b,1),K(b,3)!=0?0:!b.h)}function rt(b,N){if(4>b)return b+1;var M=b-2>>1;return(2+(1&b)<<M)+K(N,M)+1}function Ct(b,N){return 120<N?N-120:1<=(M=((M=dL[N-1])>>4)*b+(8-(15&M)))?M:1;var M}function St(b,N,M){var q=U(M),Z=b[N+=255&q].g-8;return 0<Z&&(D(M,M.u+8),q=U(M),N+=b[N].value,N+=q&(1<<Z)-1),D(M,M.u+b[N].g),b[N].value}function kt(b,N,M){return M.g+=b.g,M.value+=b.value<<N>>>0,t(8>=M.g),b.g}function Xt(b,N,M){var q=b.xc;return t((N=q==0?0:b.vc[b.md*(M>>q)+(N>>q)])<b.Wb),b.Ya[N]}function te(b,N,M,q){var Z=b.ab,re=b.c*N,ie=b.C;N=ie+N;var oe=M,ce=q;for(q=b.Ta,M=b.Ua;0<Z--;){var de=b.gc[Z],Ee=ie,Pe=N,Qe=oe,Le=ce,Je=(ce=q,oe=M,de.Ea);switch(t(Ee<Pe),t(Pe<=de.nc),de.hc){case 2:I0(Qe,Le,(Pe-Ee)*Je,ce,oe);break;case 0:var Ge=Ee,ke=Pe,Ne=ce,Xe=oe,tt=(gt=de).Ea;Ge==0&&(sv(Qe,Le,null,null,1,Ne,Xe),ft(Qe,Le+1,0,0,tt-1,Ne,Xe+1),Le+=tt,Xe+=tt,++Ge);for(var Ye=1<<gt.b,xt=Ye-1,ht=xe(tt,gt.b),It=gt.K,gt=gt.w+(Ge>>gt.b)*ht;Ge<ke;){var gr=It,xr=gt,sr=1;for(Df(Qe,Le,Ne,Xe-tt,1,Ne,Xe);sr<tt;){var tr=(sr&~xt)+Ye;tr>tt&&(tr=tt),(0,Zo[gr[xr++]>>8&15])(Qe,Le+ +sr,Ne,Xe+sr-tt,tr-sr,Ne,Xe+sr),sr=tr}Le+=tt,Xe+=tt,++Ge&xt||(gt+=ht)}Pe!=de.nc&&n(ce,oe-Je,ce,oe+(Pe-Ee-1)*Je,Je);break;case 1:for(Je=Qe,ke=Le,tt=(Qe=de.Ea)-(Xe=Qe&~(Ne=(Le=1<<de.b)-1)),Ge=xe(Qe,de.b),Ye=de.K,de=de.w+(Ee>>de.b)*Ge;Ee<Pe;){for(xt=Ye,ht=de,It=new Te,gt=ke+Xe,gr=ke+Qe;ke<gt;)ut(xt[ht++],It),mA(It,Je,ke,Le,ce,oe),ke+=Le,oe+=Le;ke<gr&&(ut(xt[ht++],It),mA(It,Je,ke,tt,ce,oe),ke+=tt,oe+=tt),++Ee&Ne||(de+=Ge)}break;case 3:if(Qe==ce&&Le==oe&&0<de.b){for(ke=ce,Qe=Je=oe+(Pe-Ee)*Je-(Xe=(Pe-Ee)*xe(de.Ea,de.b)),Le=ce,Ne=oe,Ge=[],Xe=(tt=Xe)-1;0<=Xe;--Xe)Ge[Xe]=Le[Ne+Xe];for(Xe=tt-1;0<=Xe;--Xe)ke[Qe+Xe]=Ge[Xe];La(de,Ee,Pe,ce,Je,ce,oe)}else La(de,Ee,Pe,Qe,Le,ce,oe)}oe=q,ce=M}ce!=M&&n(q,M,oe,ce,re)}function ue(b,N){var M=b.V,q=b.Ba+b.c*b.C,Z=N-b.C;if(t(N<=b.l.o),t(16>=Z),0<Z){var re=b.l,ie=b.Ta,oe=b.Ua,ce=re.width;if(te(b,Z,M,q),Z=oe=[oe],t((M=b.C)<(q=N)),t(re.v<re.va),q>re.o&&(q=re.o),M<re.j){var de=re.j-M;M=re.j,Z[0]+=de*ce}if(M>=q?M=0:(Z[0]+=4*re.v,re.ka=M-re.j,re.U=re.va-re.v,re.T=q-M,M=1),M){if(oe=oe[0],11>(M=b.ca).S){var Ee=M.f.RGBA,Pe=(q=M.S,Z=re.U,re=re.T,de=Ee.eb,Ee.A),Qe=re;for(Ee=Ee.fb+b.Ma*Ee.A;0<Qe--;){var Le=ie,Je=oe,Ge=Z,ke=de,Ne=Ee;switch(q){case Q0:qi(Le,Je,Ge,ke,Ne);break;case R0:Ii(Le,Je,Ge,ke,Ne);break;case Av:Ii(Le,Je,Ge,ke,Ne),Oa(ke,Ne,0,Ge,1,0);break;case b5:go(Le,Je,Ge,ke,Ne);break;case M0:dr(Le,Je,Ge,ke,Ne,1);break;case cv:dr(Le,Je,Ge,ke,Ne,1),Oa(ke,Ne,0,Ge,1,0);break;case H0:dr(Le,Je,Ge,ke,Ne,0);break;case K0:dr(Le,Je,Ge,ke,Ne,0),Oa(ke,Ne,1,Ge,1,0);break;case lv:el(Le,Je,Ge,ke,Ne);break;case uv:el(Le,Je,Ge,ke,Ne),Ir(ke,Ne,Ge,1,0);break;case B5:po(Le,Je,Ge,ke,Ne);break;default:t(0)}oe+=ce,Ee+=Pe}b.Ma+=re}else alert("todo:EmitRescaledRowsYUVA");t(b.Ma<=M.height)}}b.C=N,t(b.C<=b.i)}function ae(b){var N;if(0<b.ua)return 0;for(N=0;N<b.Wb;++N){var M=b.Ya[N].G,q=b.Ya[N].H;if(0<M[1][q[1]+0].g||0<M[2][q[2]+0].g||0<M[3][q[3]+0].g)return 0}return 1}function Ae(b,N,M,q,Z,re){if(b.Z!=0){var ie=b.qd,oe=b.rd;for(t(il[b.Z]!=null);N<M;++N)il[b.Z](ie,oe,q,Z,q,Z,re),ie=q,oe=Z,Z+=re;b.qd=ie,b.rd=oe}}function fe(b,N){var M=b.l.ma,q=M.Z==0||M.Z==1?b.l.j:b.C;if(q=b.C<q?q:b.C,t(N<=b.l.o),N>q){var Z=b.l.width,re=M.ca,ie=M.tb+Z*q,oe=b.V,ce=b.Ba+b.c*q,de=b.gc;t(b.ab==1),t(de[0].hc==3),U0(de[0],q,N,oe,ce,re,ie),Ae(M,q,N,re,ie,Z)}b.C=b.Ma=N}function ge(b,N,M,q,Z,re,ie){var oe=b.$/q,ce=b.$%q,de=b.m,Ee=b.s,Pe=M+b.$,Qe=Pe;Z=M+q*Z;var Le=M+q*re,Je=280+Ee.ua,Ge=b.Pb?oe:16777216,ke=0<Ee.ua?Ee.Wa:null,Ne=Ee.wc,Xe=Pe<Le?Xt(Ee,ce,oe):null;t(b.C<re),t(Le<=Z);var tt=!1;e:for(;;){for(;tt||Pe<Le;){var Ye=0;if(oe>=Ge){var xt=Pe-M;t((Ge=b).Pb),Ge.wd=Ge.m,Ge.xd=xt,0<Ge.s.ua&&Fe(Ge.s.Wa,Ge.s.vb),Ge=oe+gL}if(ce&Ne||(Xe=Xt(Ee,ce,oe)),t(Xe!=null),Xe.Qb&&(N[Pe]=Xe.qb,tt=!0),!tt)if(O(de),Xe.jc){Ye=de,xt=N;var ht=Pe,It=Xe.pd[U(Ye)&Yn-1];t(Xe.jc),256>It.g?(D(Ye,Ye.u+It.g),xt[ht]=It.value,Ye=0):(D(Ye,Ye.u+It.g-256),t(256<=It.value),Ye=It.value),Ye==0&&(tt=!0)}else Ye=St(Xe.G[0],Xe.H[0],de);if(de.h)break;if(tt||256>Ye){if(!tt)if(Xe.nd)N[Pe]=(Xe.qb|Ye<<8)>>>0;else{if(O(de),tt=St(Xe.G[1],Xe.H[1],de),O(de),xt=St(Xe.G[2],Xe.H[2],de),ht=St(Xe.G[3],Xe.H[3],de),de.h)break;N[Pe]=(ht<<24|tt<<16|Ye<<8|xt)>>>0}if(tt=!1,++Pe,++ce>=q&&(ce=0,++oe,ie!=null&&oe<=re&&!(oe%16)&&ie(b,oe),ke!=null))for(;Qe<Pe;)Ye=N[Qe++],ke.X[(506832829*Ye&4294967295)>>>ke.Mb]=Ye}else if(280>Ye){if(Ye=rt(Ye-256,de),xt=St(Xe.G[4],Xe.H[4],de),O(de),xt=Ct(q,xt=rt(xt,de)),de.h)break;if(Pe-M<xt||Z-Pe<Ye)break e;for(ht=0;ht<Ye;++ht)N[Pe+ht]=N[Pe+ht-xt];for(Pe+=Ye,ce+=Ye;ce>=q;)ce-=q,++oe,ie!=null&&oe<=re&&!(oe%16)&&ie(b,oe);if(t(Pe<=Z),ce&Ne&&(Xe=Xt(Ee,ce,oe)),ke!=null)for(;Qe<Pe;)Ye=N[Qe++],ke.X[(506832829*Ye&4294967295)>>>ke.Mb]=Ye}else{if(!(Ye<Je))break e;for(tt=Ye-280,t(ke!=null);Qe<Pe;)Ye=N[Qe++],ke.X[(506832829*Ye&4294967295)>>>ke.Mb]=Ye;Ye=Pe,t(!(tt>>>(xt=ke).Xa)),N[Ye]=xt.X[tt],tt=!0}tt||t(de.h==P(de))}if(b.Pb&&de.h&&Pe<Z)t(b.m.h),b.a=5,b.m=b.wd,b.$=b.xd,0<b.s.ua&&Fe(b.s.vb,b.s.Wa);else{if(de.h)break e;ie!=null&&ie(b,oe>re?re:oe),b.a=0,b.$=Pe-M}return 1}return b.a=3,0}function Oe(b){t(b!=null),b.vc=null,b.yc=null,b.Ya=null;var N=b.Wa;N!=null&&(N.X=null),b.vb=null,t(b!=null)}function Ke(){var b=new av;return b==null?null:(b.a=0,b.xb=S5,Rn("Predictor","VP8LPredictors"),Rn("Predictor","VP8LPredictors_C"),Rn("PredictorAdd","VP8LPredictorsAdd"),Rn("PredictorAdd","VP8LPredictorsAdd_C"),I0=Et,mA=wt,qi=et,Ii=ur,el=Ft,po=tn,go=fr,F.VP8LMapColor32b=Ic,F.VP8LMapColor8b=O0,b)}function Ie(b,N,M,q,Z){var re=1,ie=[b],oe=[N],ce=q.m,de=q.s,Ee=null,Pe=0;e:for(;;){if(M)for(;re&&K(ce,1);){var Qe=ie,Le=oe,Je=q,Ge=1,ke=Je.m,Ne=Je.gc[Je.ab],Xe=K(ke,2);if(Je.Oc&1<<Xe)re=0;else{switch(Je.Oc|=1<<Xe,Ne.hc=Xe,Ne.Ea=Qe[0],Ne.nc=Le[0],Ne.K=[null],++Je.ab,t(4>=Je.ab),Xe){case 0:case 1:Ne.b=K(ke,3)+2,Ge=Ie(xe(Ne.Ea,Ne.b),xe(Ne.nc,Ne.b),0,Je,Ne.K),Ne.K=Ne.K[0];break;case 3:var tt,Ye=K(ke,8)+1,xt=16<Ye?0:4<Ye?1:2<Ye?2:3;if(Qe[0]=xe(Ne.Ea,xt),Ne.b=xt,tt=Ge=Ie(Ye,1,0,Je,Ne.K)){var ht,It=Ye,gt=Ne,gr=1<<(8>>gt.b),xr=a(gr);if(xr==null)tt=0;else{var sr=gt.K[0],tr=gt.w;for(xr[0]=gt.K[0][0],ht=1;ht<1*It;++ht)xr[ht]=se(sr[tr+ht],xr[ht-1]);for(;ht<4*gr;++ht)xr[ht]=0;gt.K[0]=null,gt.K[0]=xr,tt=1}}Ge=tt;break;case 2:break;default:t(0)}re=Ge}}if(ie=ie[0],oe=oe[0],re&&K(ce,1)&&!(re=1<=(Pe=K(ce,4))&&11>=Pe)){q.a=3;break e}var Tr;if(Tr=re)t:{var Sr,Vt,Cn,zi=q,Sn=ie,Xi=oe,yr=Pe,ha=M,da=zi.m,Hn=zi.s,Jn=[null],Oi=1,Pa=0,Ks=pL[yr];r:for(;;){if(ha&&K(da,1)){var Kn=K(da,3)+2,yo=xe(Sn,Kn),bA=xe(Xi,Kn),Pc=yo*bA;if(!Ie(yo,bA,0,zi,Jn))break r;for(Jn=Jn[0],Hn.xc=Kn,Sr=0;Sr<Pc;++Sr){var al=Jn[Sr]>>8&65535;Jn[Sr]=al,al>=Oi&&(Oi=al+1)}}if(da.h)break r;for(Vt=0;5>Vt;++Vt){var an=_5[Vt];!Vt&&0<yr&&(an+=1<<yr),Pa<an&&(Pa=an)}var pv=s(Oi*Ks,C),O5=Oi,j5=s(O5,R);if(j5==null)var $0=null;else t(65536>=O5),$0=j5;var Gf=a(Pa);if($0==null||Gf==null||pv==null){zi.a=1;break r}var q0=pv;for(Sr=Cn=0;Sr<Oi;++Sr){var ds=$0[Sr],Qc=ds.G,Rc=ds.H,D5=0,z0=1,P5=0;for(Vt=0;5>Vt;++Vt){an=_5[Vt],Qc[Vt]=q0,Rc[Vt]=Cn,!Vt&&0<yr&&(an+=1<<yr);i:{var X0,gv=an,Y0=zi,Vf=Gf,jL=q0,DL=Cn,mv=0,sl=Y0.m,PL=K(sl,1);if(i(Vf,0,0,gv),PL){var QL=K(sl,1)+1,RL=K(sl,1),Q5=K(sl,RL==0?1:8);Vf[Q5]=1,QL==2&&(Vf[Q5=K(sl,8)]=1);var J0=1}else{var R5=a(19),M5=K(sl,4)+4;if(19<M5){Y0.a=3;var Z0=0;break i}for(X0=0;X0<M5;++X0)R5[hL[X0]]=K(sl,3);var vv=void 0,Wf=void 0,H5=Y0,ML=R5,ep=gv,K5=Vf,xv=0,ol=H5.m,G5=8,V5=s(128,C);n:for(;S(V5,0,7,ML,19);){if(K(ol,1)){var HL=2+2*K(ol,3);if((vv=2+K(ol,HL))>ep)break n}else vv=ep;for(Wf=0;Wf<ep&&vv--;){O(ol);var W5=V5[0+(127&U(ol))];D(ol,ol.u+W5.g);var Mc=W5.value;if(16>Mc)K5[Wf++]=Mc,Mc!=0&&(G5=Mc);else{var KL=Mc==16,$5=Mc-16,GL=uL[$5],q5=K(ol,cL[$5])+GL;if(Wf+q5>ep)break n;for(var VL=KL?G5:0;0<q5--;)K5[Wf++]=VL}}xv=1;break n}xv||(H5.a=3),J0=xv}(J0=J0&&!sl.h)&&(mv=S(jL,DL,8,Vf,gv)),J0&&mv!=0?Z0=mv:(Y0.a=3,Z0=0)}if(Z0==0)break r;if(z0&&fL[Vt]==1&&(z0=q0[Cn].g==0),D5+=q0[Cn].g,Cn+=Z0,3>=Vt){var $f,yv=Gf[0];for($f=1;$f<an;++$f)Gf[$f]>yv&&(yv=Gf[$f]);P5+=yv}}if(ds.nd=z0,ds.Qb=0,z0&&(ds.qb=(Qc[3][Rc[3]+0].value<<24|Qc[1][Rc[1]+0].value<<16|Qc[2][Rc[2]+0].value)>>>0,D5==0&&256>Qc[0][Rc[0]+0].value&&(ds.Qb=1,ds.qb+=Qc[0][Rc[0]+0].value<<8)),ds.jc=!ds.Qb&&6>P5,ds.jc){var tp,wo=ds;for(tp=0;tp<Yn;++tp){var ll=tp,Al=wo.pd[ll],rp=wo.G[0][wo.H[0]+ll];256<=rp.value?(Al.g=rp.g+256,Al.value=rp.value):(Al.g=0,Al.value=0,ll>>=kt(rp,8,Al),ll>>=kt(wo.G[1][wo.H[1]+ll],16,Al),ll>>=kt(wo.G[2][wo.H[2]+ll],0,Al),kt(wo.G[3][wo.H[3]+ll],24,Al))}}}Hn.vc=Jn,Hn.Wb=Oi,Hn.Ya=$0,Hn.yc=pv,Tr=1;break t}Tr=0}if(!(re=Tr)){q.a=3;break e}if(0<Pe){if(de.ua=1<<Pe,!qe(de.Wa,Pe)){q.a=1,re=0;break e}}else de.ua=0;var wv=q,z5=ie,WL=oe,bv=wv.s,Bv=bv.xc;if(wv.c=z5,wv.i=WL,bv.md=xe(z5,Bv),bv.wc=Bv==0?-1:(1<<Bv)-1,M){q.xb=BL;break e}if((Ee=a(ie*oe))==null){q.a=1,re=0;break e}re=(re=ge(q,Ee,0,ie,oe,oe,null))&&!ce.h;break e}return re?(Z!=null?Z[0]=Ee:(t(Ee==null),t(M)),q.$=0,M||Oe(de)):Oe(de),re}function Re(b,N){var M=b.c*b.i,q=M+N+16*N;return t(b.c<=N),b.V=a(q),b.V==null?(b.Ta=null,b.Ua=0,b.a=1,0):(b.Ta=b.V,b.Ua=b.Ba+M+N,1)}function He(b,N){var M=b.C,q=N-M,Z=b.V,re=b.Ba+b.c*M;for(t(N<=b.l.o);0<q;){var ie=16<q?16:q,oe=b.l.ma,ce=b.l.width,de=ce*ie,Ee=oe.ca,Pe=oe.tb+ce*M,Qe=b.Ta,Le=b.Ua;te(b,ie,Z,re),hn(Qe,Le,Ee,Pe,de),Ae(oe,M,M+ie,Ee,Pe,ce),q-=ie,Z+=ie*b.c,M+=ie}t(M==N),b.C=b.Ma=N}function nt(){this.ub=this.yd=this.td=this.Rb=0}function lt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function pt(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function st(){this.Yb=function(){var b=[];return function N(M,q,Z){for(var re=Z[q],ie=0;ie<re&&(M.push(Z.length>q+1?[]:0),!(Z.length<q+1));ie++)N(M[ie],q+1,Z)}(b,0,[3,11]),b}()}function dt(){this.jb=a(3),this.Wc=o([4,8],st),this.Xc=o([4,17],st)}function Nt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function pr(){this.ld=this.La=this.dd=this.tc=0}function Rt(){this.Na=this.la=0}function rn(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Vi(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function uo(){this.uc=this.M=this.Nb=0,this.wa=Array(new pr),this.Y=0,this.ya=Array(new Vi),this.aa=0,this.l=new Qs}function Ps(){this.y=a(16),this.f=a(8),this.ea=a(8)}function As(){this.cb=this.a=0,this.sc="",this.m=new H,this.Od=new nt,this.Kc=new lt,this.ed=new Nt,this.Qa=new pt,this.Ic=this.$c=this.Aa=0,this.D=new uo,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,H),this.ia=0,this.pb=s(4,rn),this.Pa=new dt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ps),this.Hd=0,this.rb=Array(new Rt),this.sb=0,this.wa=Array(new pr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Vi),this.L=this.aa=0,this.gd=o([4,2],pr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Qs(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function ca(){var b=new As;return b!=null&&(b.a=0,b.sc="OK",b.cb=0,b.Xb=0,Hf||(Hf=v0)),b}function un(b,N,M){return b.a==0&&(b.a=N,b.sc=M,b.cb=0),0}function g0(b,N,M){return 3<=M&&b[N+0]==157&&b[N+1]==1&&b[N+2]==42}function m0(b,N){if(b==null)return 0;if(b.a=0,b.sc="OK",N==null)return un(b,2,"null VP8Io passed to VP8GetHeaders()");var M=N.data,q=N.w,Z=N.ha;if(4>Z)return un(b,7,"Truncated header.");var re=M[q+0]|M[q+1]<<8|M[q+2]<<16,ie=b.Od;if(ie.Rb=!(1&re),ie.td=re>>1&7,ie.yd=re>>4&1,ie.ub=re>>5,3<ie.td)return un(b,3,"Incorrect keyframe parameters.");if(!ie.yd)return un(b,4,"Frame not displayable.");q+=3,Z-=3;var oe=b.Kc;if(ie.Rb){if(7>Z)return un(b,7,"cannot parse picture header");if(!g0(M,q,Z))return un(b,3,"Bad code word");oe.c=16383&(M[q+4]<<8|M[q+3]),oe.Td=M[q+4]>>6,oe.i=16383&(M[q+6]<<8|M[q+5]),oe.Ud=M[q+6]>>6,q+=7,Z-=7,b.za=oe.c+15>>4,b.Ub=oe.i+15>>4,N.width=oe.c,N.height=oe.i,N.Da=0,N.j=0,N.v=0,N.va=N.width,N.o=N.height,N.da=0,N.ib=N.width,N.hb=N.height,N.U=N.width,N.T=N.height,i((re=b.Pa).jb,0,255,re.jb.length),t((re=b.Qa)!=null),re.Cb=0,re.Bb=0,re.Fb=1,i(re.Zb,0,0,re.Zb.length),i(re.Lb,0,0,re.Lb)}if(ie.ub>Z)return un(b,7,"bad partition length");W(re=b.m,M,q,ie.ub),q+=ie.ub,Z-=ie.ub,ie.Rb&&(oe.Ld=J(re),oe.Kd=J(re)),oe=b.Qa;var ce,de=b.Pa;if(t(re!=null),t(oe!=null),oe.Cb=J(re),oe.Cb){if(oe.Bb=J(re),J(re)){for(oe.Fb=J(re),ce=0;4>ce;++ce)oe.Zb[ce]=J(re)?V(re,7):0;for(ce=0;4>ce;++ce)oe.Lb[ce]=J(re)?V(re,6):0}if(oe.Bb)for(ce=0;3>ce;++ce)de.jb[ce]=J(re)?G(re,8):255}else oe.Bb=0;if(re.Ka)return un(b,3,"cannot parse segment header");if((oe=b.ed).zd=J(re),oe.Tb=G(re,6),oe.wb=G(re,3),oe.Pc=J(re),oe.Pc&&J(re)){for(de=0;4>de;++de)J(re)&&(oe.vd[de]=V(re,6));for(de=0;4>de;++de)J(re)&&(oe.od[de]=V(re,6))}if(b.L=oe.Tb==0?0:oe.zd?1:2,re.Ka)return un(b,3,"cannot parse filter header");var Ee=Z;if(Z=ce=q,q=ce+Ee,oe=Ee,b.Xb=(1<<G(b.m,2))-1,Ee<3*(de=b.Xb))M=7;else{for(ce+=3*de,oe-=3*de,Ee=0;Ee<de;++Ee){var Pe=M[Z+0]|M[Z+1]<<8|M[Z+2]<<16;Pe>oe&&(Pe=oe),W(b.Jc[+Ee],M,ce,Pe),ce+=Pe,oe-=Pe,Z+=3}W(b.Jc[+de],M,ce,oe),M=ce<q?0:5}if(M!=0)return un(b,M,"cannot parse partitions");for(M=G(ce=b.m,7),Z=J(ce)?V(ce,4):0,q=J(ce)?V(ce,4):0,oe=J(ce)?V(ce,4):0,de=J(ce)?V(ce,4):0,ce=J(ce)?V(ce,4):0,Ee=b.Qa,Pe=0;4>Pe;++Pe){if(Ee.Cb){var Qe=Ee.Zb[Pe];Ee.Fb||(Qe+=M)}else{if(0<Pe){b.pb[Pe]=b.pb[0];continue}Qe=M}var Le=b.pb[Pe];Le.Sc[0]=fv[ua(Qe+Z,127)],Le.Sc[1]=hv[ua(Qe+0,127)],Le.Eb[0]=2*fv[ua(Qe+q,127)],Le.Eb[1]=101581*hv[ua(Qe+oe,127)]>>16,8>Le.Eb[1]&&(Le.Eb[1]=8),Le.Qc[0]=fv[ua(Qe+de,117)],Le.Qc[1]=hv[ua(Qe+ce,127)],Le.lc=Qe+ce}if(!ie.Rb)return un(b,4,"Not a key frame.");for(J(re),ie=b.Pa,M=0;4>M;++M){for(Z=0;8>Z;++Z)for(q=0;3>q;++q)for(oe=0;11>oe;++oe)de=Y(re,wL[M][Z][q][oe])?G(re,8):xL[M][Z][q][oe],ie.Wc[M][Z].Yb[q][oe]=de;for(Z=0;17>Z;++Z)ie.Xc[M][Z]=ie.Wc[M][bL[Z]]}return b.kc=J(re),b.kc&&(b.Bd=G(re,8)),b.cb=1}function v0(b,N,M,q,Z,re,ie){var oe=N[Z].Yb[M];for(M=0;16>Z;++Z){if(!Y(b,oe[M+0]))return Z;for(;!Y(b,oe[M+1]);)if(oe=N[++Z].Yb[0],M=0,Z==16)return 16;var ce=N[Z+1].Yb;if(Y(b,oe[M+2])){var de=b,Ee=0;if(Y(de,(Qe=oe)[(Pe=M)+3]))if(Y(de,Qe[Pe+6])){for(oe=0,Pe=2*(Ee=Y(de,Qe[Pe+8]))+(Qe=Y(de,Qe[Pe+9+Ee])),Ee=0,Qe=mL[Pe];Qe[oe];++oe)Ee+=Ee+Y(de,Qe[oe]);Ee+=3+(8<<Pe)}else Y(de,Qe[Pe+7])?(Ee=7+2*Y(de,165),Ee+=Y(de,145)):Ee=5+Y(de,159);else Ee=Y(de,Qe[Pe+4])?3+Y(de,Qe[Pe+5]):2;oe=ce[2]}else Ee=1,oe=ce[1];ce=ie+vL[Z],0>(de=b).b&&z(de);var Pe,Qe=de.b,Le=(Pe=de.Ca>>1)-(de.I>>Qe)>>31;--de.b,de.Ca+=Le,de.Ca|=1,de.I-=(Pe+1&Le)<<Qe,re[ce]=((Ee^Le)-Le)*q[(0<Z)+0]}return 16}function xf(b){var N=b.rb[b.sb-1];N.la=0,N.Na=0,i(b.zc,0,0,b.zc.length),b.ja=0}function H1(b,N){if(b==null)return 0;if(N==null)return un(b,2,"NULL VP8Io parameter in VP8Decode().");if(!b.cb&&!m0(b,N))return 0;if(t(b.cb),N.ac==null||N.ac(N)){N.ob&&(b.L=0);var M=W0[b.L];if(b.L==2?(b.yb=0,b.zb=0):(b.yb=N.v-M>>4,b.zb=N.j-M>>4,0>b.yb&&(b.yb=0),0>b.zb&&(b.zb=0)),b.Va=N.o+15+M>>4,b.Hb=N.va+15+M>>4,b.Hb>b.za&&(b.Hb=b.za),b.Va>b.Ub&&(b.Va=b.Ub),0<b.L){var q=b.ed;for(M=0;4>M;++M){var Z;if(b.Qa.Cb){var re=b.Qa.Lb[M];b.Qa.Fb||(re+=q.Tb)}else re=q.Tb;for(Z=0;1>=Z;++Z){var ie=b.gd[M][Z],oe=re;if(q.Pc&&(oe+=q.vd[0],Z&&(oe+=q.od[0])),0<(oe=0>oe?0:63<oe?63:oe)){var ce=oe;0<q.wb&&(ce=4<q.wb?ce>>2:ce>>1)>9-q.wb&&(ce=9-q.wb),1>ce&&(ce=1),ie.dd=ce,ie.tc=2*oe+ce,ie.ld=40<=oe?2:15<=oe?1:0}else ie.tc=0;ie.La=Z}}}M=0}else un(b,6,"Frame setup failed"),M=b.a;if(M=M==0){if(M){b.$c=0,0<b.Aa||(b.Ic=OL);e:{M=b.Ic,q=4*(ce=b.za);var de=32*ce,Ee=ce+1,Pe=0<b.L?ce*(0<b.Aa?2:1):0,Qe=(b.Aa==2?2:1)*ce;if((ie=q+832+(Z=3*(16*M+W0[b.L])/2*de)+(re=b.Fa!=null&&0<b.Fa.length?b.Kc.c*b.Kc.i:0))!=ie)M=0;else{if(ie>b.Vb){if(b.Vb=0,b.Ec=a(ie),b.Fc=0,b.Ec==null){M=un(b,1,"no memory during frame initialization.");break e}b.Vb=ie}ie=b.Ec,oe=b.Fc,b.Ac=ie,b.Bc=oe,oe+=q,b.Gd=s(de,Ps),b.Hd=0,b.rb=s(Ee+1,Rt),b.sb=1,b.wa=Pe?s(Pe,pr):null,b.Y=0,b.D.Nb=0,b.D.wa=b.wa,b.D.Y=b.Y,0<b.Aa&&(b.D.Y+=ce),t(!0),b.oc=ie,b.pc=oe,oe+=832,b.ya=s(Qe,Vi),b.aa=0,b.D.ya=b.ya,b.D.aa=b.aa,b.Aa==2&&(b.D.aa+=ce),b.R=16*ce,b.B=8*ce,ce=(de=W0[b.L])*b.R,de=de/2*b.B,b.sa=ie,b.ta=oe+ce,b.qa=b.sa,b.ra=b.ta+16*M*b.R+de,b.Ha=b.qa,b.Ia=b.ra+8*M*b.B+de,b.$c=0,oe+=Z,b.mb=re?ie:null,b.nb=re?oe:null,t(oe+re<=b.Fc+b.Vb),xf(b),i(b.Ac,b.Bc,0,q),M=1}}if(M){if(N.ka=0,N.y=b.sa,N.O=b.ta,N.f=b.qa,N.N=b.ra,N.ea=b.Ha,N.Vd=b.Ia,N.fa=b.R,N.Rc=b.B,N.F=null,N.J=0,!D0){for(M=-255;255>=M;++M)Ln[255+M]=0>M?-M:M;for(M=-1020;1020>=M;++M)vo[1020+M]=-128>M?-128:127<M?127:M;for(M=-112;112>=M;++M)Mf[112+M]=-16>M?-16:15<M?15:M;for(M=-255;510>=M;++M)Dc[255+M]=0>M?0:255<M?255:M;D0=1}Uc=V1,mo=K1,Pf=y0,Ui=G1,Ia=w0,fn=x0,Oc=Cf,j0=pA,Qf=iv,vA=Sf,xA=nv,tl=Cc,yA=Ef,jc=N0,wA=F0,rl=Ms,Rf=ho,Ua=rv,hs[0]=Rs,hs[1]=W1,hs[2]=X1,hs[3]=Y1,hs[4]=_0,hs[5]=Bc,hs[6]=C0,hs[7]=bf,hs[8]=Z1,hs[9]=J1,nl[0]=b0,nl[1]=q1,nl[2]=fo,nl[3]=wc,nl[4]=li,nl[5]=z1,nl[6]=B0,xo[0]=Xo,xo[1]=$1,xo[2]=ev,xo[3]=Bf,xo[4]=dA,xo[5]=tv,xo[6]=_f,M=1}else M=0}M&&(M=function(Le,Je){for(Le.M=0;Le.M<Le.Va;++Le.M){var Ge,ke=Le.Jc[Le.M&Le.Xb],Ne=Le.m,Xe=Le;for(Ge=0;Ge<Xe.za;++Ge){var tt=Ne,Ye=Xe,xt=Ye.Ac,ht=Ye.Bc+4*Ge,It=Ye.zc,gt=Ye.ya[Ye.aa+Ge];if(Ye.Qa.Bb?gt.$b=Y(tt,Ye.Pa.jb[0])?2+Y(tt,Ye.Pa.jb[2]):Y(tt,Ye.Pa.jb[1]):gt.$b=0,Ye.kc&&(gt.Ad=Y(tt,Ye.Bd)),gt.Za=!Y(tt,145)+0,gt.Za){var gr=gt.Ob,xr=0;for(Ye=0;4>Ye;++Ye){var sr,tr=It[0+Ye];for(sr=0;4>sr;++sr){tr=yL[xt[ht+sr]][tr];for(var Tr=C5[Y(tt,tr[0])];0<Tr;)Tr=C5[2*Tr+Y(tt,tr[Tr])];tr=-Tr,xt[ht+sr]=tr}n(gr,xr,xt,ht,4),xr+=4,It[0+Ye]=tr}}else tr=Y(tt,156)?Y(tt,128)?1:3:Y(tt,163)?2:0,gt.Ob[0]=tr,i(xt,ht,tr,4),i(It,0,tr,4);gt.Dd=Y(tt,142)?Y(tt,114)?Y(tt,183)?1:3:2:0}if(Xe.m.Ka)return un(Le,7,"Premature end-of-partition0 encountered.");for(;Le.ja<Le.za;++Le.ja){if(Xe=ke,tt=(Ne=Le).rb[Ne.sb-1],xt=Ne.rb[Ne.sb+Ne.ja],Ge=Ne.ya[Ne.aa+Ne.ja],ht=Ne.kc?Ge.Ad:0)tt.la=xt.la=0,Ge.Za||(tt.Na=xt.Na=0),Ge.Hc=0,Ge.Gc=0,Ge.ia=0;else{var Sr,Vt;if(tt=xt,xt=Xe,ht=Ne.Pa.Xc,It=Ne.ya[Ne.aa+Ne.ja],gt=Ne.pb[It.$b],Ye=It.ad,gr=0,xr=Ne.rb[Ne.sb-1],tr=sr=0,i(Ye,gr,0,384),It.Za)var Cn=0,zi=ht[3];else{Tr=a(16);var Sn=tt.Na+xr.Na;if(Sn=Hf(xt,ht[1],Sn,gt.Eb,0,Tr,0),tt.Na=xr.Na=(0<Sn)+0,1<Sn)Uc(Tr,0,Ye,gr);else{var Xi=Tr[0]+3>>3;for(Tr=0;256>Tr;Tr+=16)Ye[gr+Tr]=Xi}Cn=1,zi=ht[0]}var yr=15&tt.la,ha=15&xr.la;for(Tr=0;4>Tr;++Tr){var da=1&ha;for(Xi=Vt=0;4>Xi;++Xi)yr=yr>>1|(da=(Sn=Hf(xt,zi,Sn=da+(1&yr),gt.Sc,Cn,Ye,gr))>Cn)<<7,Vt=Vt<<2|(3<Sn?3:1<Sn?2:Ye[gr+0]!=0),gr+=16;yr>>=4,ha=ha>>1|da<<7,sr=(sr<<8|Vt)>>>0}for(zi=yr,Cn=ha>>4,Sr=0;4>Sr;Sr+=2){for(Vt=0,yr=tt.la>>4+Sr,ha=xr.la>>4+Sr,Tr=0;2>Tr;++Tr){for(da=1&ha,Xi=0;2>Xi;++Xi)Sn=da+(1&yr),yr=yr>>1|(da=0<(Sn=Hf(xt,ht[2],Sn,gt.Qc,0,Ye,gr)))<<3,Vt=Vt<<2|(3<Sn?3:1<Sn?2:Ye[gr+0]!=0),gr+=16;yr>>=2,ha=ha>>1|da<<5}tr|=Vt<<4*Sr,zi|=yr<<4<<Sr,Cn|=(240&ha)<<Sr}tt.la=zi,xr.la=Cn,It.Hc=sr,It.Gc=tr,It.ia=43690&tr?0:gt.ia,ht=!(sr|tr)}if(0<Ne.L&&(Ne.wa[Ne.Y+Ne.ja]=Ne.gd[Ge.$b][Ge.Za],Ne.wa[Ne.Y+Ne.ja].La|=!ht),Xe.Ka)return un(Le,7,"Premature end-of-file encountered.")}if(xf(Le),Ne=Je,Xe=1,Ge=(ke=Le).D,tt=0<ke.L&&ke.M>=ke.zb&&ke.M<=ke.Va,ke.Aa==0)e:{if(Ge.M=ke.M,Ge.uc=tt,If(ke,Ge),Xe=1,Ge=(Vt=ke.D).Nb,tt=(tr=W0[ke.L])*ke.R,xt=tr/2*ke.B,Tr=16*Ge*ke.R,Xi=8*Ge*ke.B,ht=ke.sa,It=ke.ta-tt+Tr,gt=ke.qa,Ye=ke.ra-xt+Xi,gr=ke.Ha,xr=ke.Ia-xt+Xi,ha=(yr=Vt.M)==0,sr=yr>=ke.Va-1,ke.Aa==2&&If(ke,Vt),Vt.uc)for(da=(Sn=ke).D.M,t(Sn.D.uc),Vt=Sn.yb;Vt<Sn.Hb;++Vt){Cn=Vt,zi=da;var Hn=(Jn=(an=Sn).D).Nb;Sr=an.R;var Jn=Jn.wa[Jn.Y+Cn],Oi=an.sa,Pa=an.ta+16*Hn*Sr+16*Cn,Ks=Jn.dd,Kn=Jn.tc;if(Kn!=0)if(t(3<=Kn),an.L==1)0<Cn&&rl(Oi,Pa,Sr,Kn+4),Jn.La&&Ua(Oi,Pa,Sr,Kn),0<zi&&wA(Oi,Pa,Sr,Kn+4),Jn.La&&Rf(Oi,Pa,Sr,Kn);else{var yo=an.B,bA=an.qa,Pc=an.ra+8*Hn*yo+8*Cn,al=an.Ha,an=an.Ia+8*Hn*yo+8*Cn;Hn=Jn.ld,0<Cn&&(j0(Oi,Pa,Sr,Kn+4,Ks,Hn),vA(bA,Pc,al,an,yo,Kn+4,Ks,Hn)),Jn.La&&(tl(Oi,Pa,Sr,Kn,Ks,Hn),jc(bA,Pc,al,an,yo,Kn,Ks,Hn)),0<zi&&(Oc(Oi,Pa,Sr,Kn+4,Ks,Hn),Qf(bA,Pc,al,an,yo,Kn+4,Ks,Hn)),Jn.La&&(xA(Oi,Pa,Sr,Kn,Ks,Hn),yA(bA,Pc,al,an,yo,Kn,Ks,Hn))}}if(ke.ia&&alert("todo:DitherRow"),Ne.put!=null){if(Vt=16*yr,yr=16*(yr+1),ha?(Ne.y=ke.sa,Ne.O=ke.ta+Tr,Ne.f=ke.qa,Ne.N=ke.ra+Xi,Ne.ea=ke.Ha,Ne.W=ke.Ia+Xi):(Vt-=tr,Ne.y=ht,Ne.O=It,Ne.f=gt,Ne.N=Ye,Ne.ea=gr,Ne.W=xr),sr||(yr-=tr),yr>Ne.o&&(yr=Ne.o),Ne.F=null,Ne.J=null,ke.Fa!=null&&0<ke.Fa.length&&Vt<yr&&(Ne.J=Tf(ke,Ne,Vt,yr-Vt),Ne.F=ke.mb,Ne.F==null&&Ne.F.length==0)){Xe=un(ke,3,"Could not decode alpha data.");break e}Vt<Ne.j&&(tr=Ne.j-Vt,Vt=Ne.j,t(!(1&tr)),Ne.O+=ke.R*tr,Ne.N+=ke.B*(tr>>1),Ne.W+=ke.B*(tr>>1),Ne.F!=null&&(Ne.J+=Ne.width*tr)),Vt<yr&&(Ne.O+=Ne.v,Ne.N+=Ne.v>>1,Ne.W+=Ne.v>>1,Ne.F!=null&&(Ne.J+=Ne.v),Ne.ka=Vt-Ne.j,Ne.U=Ne.va-Ne.v,Ne.T=yr-Vt,Xe=Ne.put(Ne))}Ge+1!=ke.Ic||sr||(n(ke.sa,ke.ta-tt,ht,It+16*ke.R,tt),n(ke.qa,ke.ra-xt,gt,Ye+8*ke.B,xt),n(ke.Ha,ke.Ia-xt,gr,xr+8*ke.B,xt))}if(!Xe)return un(Le,6,"Output aborted.")}return 1}(b,N)),N.bc!=null&&N.bc(N),M&=1}return M?(b.cb=0,M):0}function cs(b,N,M,q,Z){Z=b[N+M+32*q]+(Z>>3),b[N+M+32*q]=-256&Z?0>Z?0:255:Z}function yc(b,N,M,q,Z,re){cs(b,N,0,M,q+Z),cs(b,N,1,M,q+re),cs(b,N,2,M,q-re),cs(b,N,3,M,q-Z)}function Wi(b){return(20091*b>>16)+b}function yf(b,N,M,q){var Z,re=0,ie=a(16);for(Z=0;4>Z;++Z){var oe=b[N+0]+b[N+8],ce=b[N+0]-b[N+8],de=(35468*b[N+4]>>16)-Wi(b[N+12]),Ee=Wi(b[N+4])+(35468*b[N+12]>>16);ie[re+0]=oe+Ee,ie[re+1]=ce+de,ie[re+2]=ce-de,ie[re+3]=oe-Ee,re+=4,N++}for(Z=re=0;4>Z;++Z)oe=(b=ie[re+0]+4)+ie[re+8],ce=b-ie[re+8],de=(35468*ie[re+4]>>16)-Wi(ie[re+12]),cs(M,q,0,0,oe+(Ee=Wi(ie[re+4])+(35468*ie[re+12]>>16))),cs(M,q,1,0,ce+de),cs(M,q,2,0,ce-de),cs(M,q,3,0,oe-Ee),re++,q+=32}function x0(b,N,M,q){var Z=b[N+0]+4,re=35468*b[N+4]>>16,ie=Wi(b[N+4]),oe=35468*b[N+1]>>16;yc(M,q,0,Z+ie,b=Wi(b[N+1]),oe),yc(M,q,1,Z+re,b,oe),yc(M,q,2,Z-re,b,oe),yc(M,q,3,Z-ie,b,oe)}function K1(b,N,M,q,Z){yf(b,N,M,q),Z&&yf(b,N+16,M,q+4)}function y0(b,N,M,q){mo(b,N+0,M,q,1),mo(b,N+32,M,q+128,1)}function G1(b,N,M,q){var Z;for(b=b[N+0]+4,Z=0;4>Z;++Z)for(N=0;4>N;++N)cs(M,q,N,Z,b)}function w0(b,N,M,q){b[N+0]&&Ui(b,N+0,M,q),b[N+16]&&Ui(b,N+16,M,q+4),b[N+32]&&Ui(b,N+32,M,q+128),b[N+48]&&Ui(b,N+48,M,q+128+4)}function V1(b,N,M,q){var Z,re=a(16);for(Z=0;4>Z;++Z){var ie=b[N+0+Z]+b[N+12+Z],oe=b[N+4+Z]+b[N+8+Z],ce=b[N+4+Z]-b[N+8+Z],de=b[N+0+Z]-b[N+12+Z];re[0+Z]=ie+oe,re[8+Z]=ie-oe,re[4+Z]=de+ce,re[12+Z]=de-ce}for(Z=0;4>Z;++Z)ie=(b=re[0+4*Z]+3)+re[3+4*Z],oe=re[1+4*Z]+re[2+4*Z],ce=re[1+4*Z]-re[2+4*Z],de=b-re[3+4*Z],M[q+0]=ie+oe>>3,M[q+16]=de+ce>>3,M[q+32]=ie-oe>>3,M[q+48]=de-ce>>3,q+=64}function wf(b,N,M){var q,Z=N-32,re=fa,ie=255-b[Z-1];for(q=0;q<M;++q){var oe,ce=re,de=ie+b[N-1];for(oe=0;oe<M;++oe)b[N+oe]=ce[de+b[Z+oe]];N+=32}}function W1(b,N){wf(b,N,4)}function $1(b,N){wf(b,N,8)}function q1(b,N){wf(b,N,16)}function fo(b,N){var M;for(M=0;16>M;++M)n(b,N+32*M,b,N-32,16)}function wc(b,N){var M;for(M=16;0<M;--M)i(b,N,b[N-1],16),N+=32}function bc(b,N,M){var q;for(q=0;16>q;++q)i(N,M+32*q,b,16)}function b0(b,N){var M,q=16;for(M=0;16>M;++M)q+=b[N-1+32*M]+b[N+M-32];bc(q>>5,b,N)}function li(b,N){var M,q=8;for(M=0;16>M;++M)q+=b[N-1+32*M];bc(q>>4,b,N)}function z1(b,N){var M,q=8;for(M=0;16>M;++M)q+=b[N+M-32];bc(q>>4,b,N)}function B0(b,N){bc(128,b,N)}function Mt(b,N,M){return b+2*N+M+2>>2}function X1(b,N){var M,q=N-32;for(q=new Uint8Array([Mt(b[q-1],b[q+0],b[q+1]),Mt(b[q+0],b[q+1],b[q+2]),Mt(b[q+1],b[q+2],b[q+3]),Mt(b[q+2],b[q+3],b[q+4])]),M=0;4>M;++M)n(b,N+32*M,q,0,q.length)}function Y1(b,N){var M=b[N-1],q=b[N-1+32],Z=b[N-1+64],re=b[N-1+96];le(b,N+0,16843009*Mt(b[N-1-32],M,q)),le(b,N+32,16843009*Mt(M,q,Z)),le(b,N+64,16843009*Mt(q,Z,re)),le(b,N+96,16843009*Mt(Z,re,re))}function Rs(b,N){var M,q=4;for(M=0;4>M;++M)q+=b[N+M-32]+b[N-1+32*M];for(q>>=3,M=0;4>M;++M)i(b,N+32*M,q,4)}function _0(b,N){var M=b[N-1+0],q=b[N-1+32],Z=b[N-1+64],re=b[N-1-32],ie=b[N+0-32],oe=b[N+1-32],ce=b[N+2-32],de=b[N+3-32];b[N+0+96]=Mt(q,Z,b[N-1+96]),b[N+1+96]=b[N+0+64]=Mt(M,q,Z),b[N+2+96]=b[N+1+64]=b[N+0+32]=Mt(re,M,q),b[N+3+96]=b[N+2+64]=b[N+1+32]=b[N+0+0]=Mt(ie,re,M),b[N+3+64]=b[N+2+32]=b[N+1+0]=Mt(oe,ie,re),b[N+3+32]=b[N+2+0]=Mt(ce,oe,ie),b[N+3+0]=Mt(de,ce,oe)}function C0(b,N){var M=b[N+1-32],q=b[N+2-32],Z=b[N+3-32],re=b[N+4-32],ie=b[N+5-32],oe=b[N+6-32],ce=b[N+7-32];b[N+0+0]=Mt(b[N+0-32],M,q),b[N+1+0]=b[N+0+32]=Mt(M,q,Z),b[N+2+0]=b[N+1+32]=b[N+0+64]=Mt(q,Z,re),b[N+3+0]=b[N+2+32]=b[N+1+64]=b[N+0+96]=Mt(Z,re,ie),b[N+3+32]=b[N+2+64]=b[N+1+96]=Mt(re,ie,oe),b[N+3+64]=b[N+2+96]=Mt(ie,oe,ce),b[N+3+96]=Mt(oe,ce,ce)}function Bc(b,N){var M=b[N-1+0],q=b[N-1+32],Z=b[N-1+64],re=b[N-1-32],ie=b[N+0-32],oe=b[N+1-32],ce=b[N+2-32],de=b[N+3-32];b[N+0+0]=b[N+1+64]=re+ie+1>>1,b[N+1+0]=b[N+2+64]=ie+oe+1>>1,b[N+2+0]=b[N+3+64]=oe+ce+1>>1,b[N+3+0]=ce+de+1>>1,b[N+0+96]=Mt(Z,q,M),b[N+0+64]=Mt(q,M,re),b[N+0+32]=b[N+1+96]=Mt(M,re,ie),b[N+1+32]=b[N+2+96]=Mt(re,ie,oe),b[N+2+32]=b[N+3+96]=Mt(ie,oe,ce),b[N+3+32]=Mt(oe,ce,de)}function bf(b,N){var M=b[N+0-32],q=b[N+1-32],Z=b[N+2-32],re=b[N+3-32],ie=b[N+4-32],oe=b[N+5-32],ce=b[N+6-32],de=b[N+7-32];b[N+0+0]=M+q+1>>1,b[N+1+0]=b[N+0+64]=q+Z+1>>1,b[N+2+0]=b[N+1+64]=Z+re+1>>1,b[N+3+0]=b[N+2+64]=re+ie+1>>1,b[N+0+32]=Mt(M,q,Z),b[N+1+32]=b[N+0+96]=Mt(q,Z,re),b[N+2+32]=b[N+1+96]=Mt(Z,re,ie),b[N+3+32]=b[N+2+96]=Mt(re,ie,oe),b[N+3+64]=Mt(ie,oe,ce),b[N+3+96]=Mt(oe,ce,de)}function J1(b,N){var M=b[N-1+0],q=b[N-1+32],Z=b[N-1+64],re=b[N-1+96];b[N+0+0]=M+q+1>>1,b[N+2+0]=b[N+0+32]=q+Z+1>>1,b[N+2+32]=b[N+0+64]=Z+re+1>>1,b[N+1+0]=Mt(M,q,Z),b[N+3+0]=b[N+1+32]=Mt(q,Z,re),b[N+3+32]=b[N+1+64]=Mt(Z,re,re),b[N+3+64]=b[N+2+64]=b[N+0+96]=b[N+1+96]=b[N+2+96]=b[N+3+96]=re}function Z1(b,N){var M=b[N-1+0],q=b[N-1+32],Z=b[N-1+64],re=b[N-1+96],ie=b[N-1-32],oe=b[N+0-32],ce=b[N+1-32],de=b[N+2-32];b[N+0+0]=b[N+2+32]=M+ie+1>>1,b[N+0+32]=b[N+2+64]=q+M+1>>1,b[N+0+64]=b[N+2+96]=Z+q+1>>1,b[N+0+96]=re+Z+1>>1,b[N+3+0]=Mt(oe,ce,de),b[N+2+0]=Mt(ie,oe,ce),b[N+1+0]=b[N+3+32]=Mt(M,ie,oe),b[N+1+32]=b[N+3+64]=Mt(q,M,ie),b[N+1+64]=b[N+3+96]=Mt(Z,q,M),b[N+1+96]=Mt(re,Z,q)}function ev(b,N){var M;for(M=0;8>M;++M)n(b,N+32*M,b,N-32,8)}function Bf(b,N){var M;for(M=0;8>M;++M)i(b,N,b[N-1],8),N+=32}function hA(b,N,M){var q;for(q=0;8>q;++q)i(N,M+32*q,b,8)}function Xo(b,N){var M,q=8;for(M=0;8>M;++M)q+=b[N+M-32]+b[N-1+32*M];hA(q>>4,b,N)}function tv(b,N){var M,q=4;for(M=0;8>M;++M)q+=b[N+M-32];hA(q>>3,b,N)}function dA(b,N){var M,q=4;for(M=0;8>M;++M)q+=b[N-1+32*M];hA(q>>3,b,N)}function _f(b,N){hA(128,b,N)}function _c(b,N,M){var q=b[N-M],Z=b[N+0],re=3*(Z-q)+ov[1020+b[N-2*M]-b[N+M]],ie=P0[112+(re+4>>3)];b[N-M]=fa[255+q+P0[112+(re+3>>3)]],b[N+0]=fa[255+Z-ie]}function S0(b,N,M,q){var Z=b[N+0],re=b[N+M];return ja[255+b[N-2*M]-b[N-M]]>q||ja[255+re-Z]>q}function E0(b,N,M,q){return 4*ja[255+b[N-M]-b[N+0]]+ja[255+b[N-2*M]-b[N+M]]<=q}function k0(b,N,M,q,Z){var re=b[N-3*M],ie=b[N-2*M],oe=b[N-M],ce=b[N+0],de=b[N+M],Ee=b[N+2*M],Pe=b[N+3*M];return 4*ja[255+oe-ce]+ja[255+ie-de]>q?0:ja[255+b[N-4*M]-re]<=Z&&ja[255+re-ie]<=Z&&ja[255+ie-oe]<=Z&&ja[255+Pe-Ee]<=Z&&ja[255+Ee-de]<=Z&&ja[255+de-ce]<=Z}function F0(b,N,M,q){var Z=2*q+1;for(q=0;16>q;++q)E0(b,N+q,M,Z)&&_c(b,N+q,M)}function Ms(b,N,M,q){var Z=2*q+1;for(q=0;16>q;++q)E0(b,N+q*M,1,Z)&&_c(b,N+q*M,1)}function ho(b,N,M,q){var Z;for(Z=3;0<Z;--Z)F0(b,N+=4*M,M,q)}function rv(b,N,M,q){var Z;for(Z=3;0<Z;--Z)Ms(b,N+=4,M,q)}function Yo(b,N,M,q,Z,re,ie,oe){for(re=2*re+1;0<Z--;){if(k0(b,N,M,re,ie))if(S0(b,N,M,oe))_c(b,N,M);else{var ce=b,de=N,Ee=M,Pe=ce[de-2*Ee],Qe=ce[de-Ee],Le=ce[de+0],Je=ce[de+Ee],Ge=ce[de+2*Ee],ke=27*(Xe=ov[1020+3*(Le-Qe)+ov[1020+Pe-Je]])+63>>7,Ne=18*Xe+63>>7,Xe=9*Xe+63>>7;ce[de-3*Ee]=fa[255+ce[de-3*Ee]+Xe],ce[de-2*Ee]=fa[255+Pe+Ne],ce[de-Ee]=fa[255+Qe+ke],ce[de+0]=fa[255+Le-ke],ce[de+Ee]=fa[255+Je-Ne],ce[de+2*Ee]=fa[255+Ge-Xe]}N+=q}}function us(b,N,M,q,Z,re,ie,oe){for(re=2*re+1;0<Z--;){if(k0(b,N,M,re,ie))if(S0(b,N,M,oe))_c(b,N,M);else{var ce=b,de=N,Ee=M,Pe=ce[de-Ee],Qe=ce[de+0],Le=ce[de+Ee],Je=P0[112+((Ge=3*(Qe-Pe))+4>>3)],Ge=P0[112+(Ge+3>>3)],ke=Je+1>>1;ce[de-2*Ee]=fa[255+ce[de-2*Ee]+ke],ce[de-Ee]=fa[255+Pe+Ge],ce[de+0]=fa[255+Qe-Je],ce[de+Ee]=fa[255+Le-ke]}N+=q}}function Cf(b,N,M,q,Z,re){Yo(b,N,M,1,16,q,Z,re)}function pA(b,N,M,q,Z,re){Yo(b,N,1,M,16,q,Z,re)}function nv(b,N,M,q,Z,re){var ie;for(ie=3;0<ie;--ie)us(b,N+=4*M,M,1,16,q,Z,re)}function Cc(b,N,M,q,Z,re){var ie;for(ie=3;0<ie;--ie)us(b,N+=4,1,M,16,q,Z,re)}function iv(b,N,M,q,Z,re,ie,oe){Yo(b,N,Z,1,8,re,ie,oe),Yo(M,q,Z,1,8,re,ie,oe)}function Sf(b,N,M,q,Z,re,ie,oe){Yo(b,N,1,Z,8,re,ie,oe),Yo(M,q,1,Z,8,re,ie,oe)}function Ef(b,N,M,q,Z,re,ie,oe){us(b,N+4*Z,Z,1,8,re,ie,oe),us(M,q+4*Z,Z,1,8,re,ie,oe)}function N0(b,N,M,q,Z,re,ie,oe){us(b,N+4,1,Z,8,re,ie,oe),us(M,q+4,1,Z,8,re,ie,oe)}function Sc(){this.ba=new Li,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new vr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function kf(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ff(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function T0(){this.ua=0,this.Wa=new he,this.vb=new he,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new R,this.yc=new C}function av(){this.xb=this.a=0,this.l=new Qs,this.ca=new Li,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new k,this.Pb=0,this.wd=new k,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new T0,this.ab=0,this.gc=s(4,Ff),this.Oc=0}function Ec(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Qs,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function gA(b,N,M,q,Z,re,ie){for(b=b==null?0:b[N+0],N=0;N<ie;++N)Z[re+N]=b+M[q+N]&255,b=Z[re+N]}function Nf(b,N,M,q,Z,re,ie){var oe;if(b==null)gA(null,null,M,q,Z,re,ie);else for(oe=0;oe<ie;++oe)Z[re+oe]=b[N+oe]+M[q+oe]&255}function Jo(b,N,M,q,Z,re,ie){if(b==null)gA(null,null,M,q,Z,re,ie);else{var oe,ce=b[N+0],de=ce,Ee=ce;for(oe=0;oe<ie;++oe)de=Ee+(ce=b[N+oe])-de,Ee=M[q+oe]+(-256&de?0>de?0:255:de)&255,de=ce,Z[re+oe]=Ee}}function Tf(b,N,M,q){var Z=N.width,re=N.o;if(t(b!=null&&N!=null),0>M||0>=q||M+q>re)return null;if(!b.Cc){if(b.ga==null){var ie;if(b.ga=new Ec,(ie=b.ga==null)||(ie=N.width*N.o,t(b.Gb.length==0),b.Gb=a(ie),b.Uc=0,b.Gb==null?ie=0:(b.mb=b.Gb,b.nb=b.Uc,b.rc=null,ie=1),ie=!ie),!ie){ie=b.ga;var oe=b.Fa,ce=b.P,de=b.qc,Ee=b.mb,Pe=b.nb,Qe=ce+1,Le=de-1,Je=ie.l;if(t(oe!=null&&Ee!=null&&N!=null),il[0]=null,il[1]=gA,il[2]=Nf,il[3]=Jo,ie.ca=Ee,ie.tb=Pe,ie.c=N.width,ie.i=N.height,t(0<ie.c&&0<ie.i),1>=de)N=0;else if(ie.$a=oe[ce+0]>>0&3,ie.Z=oe[ce+0]>>2&3,ie.Lc=oe[ce+0]>>4&3,ce=oe[ce+0]>>6&3,0>ie.$a||1<ie.$a||4<=ie.Z||1<ie.Lc||ce)N=0;else if(Je.put=Ce,Je.ac=_e,Je.bc=De,Je.ma=ie,Je.width=N.width,Je.height=N.height,Je.Da=N.Da,Je.v=N.v,Je.va=N.va,Je.j=N.j,Je.o=N.o,ie.$a)e:{t(ie.$a==1),N=Ke();t:for(;;){if(N==null){N=0;break e}if(t(ie!=null),ie.mc=N,N.c=ie.c,N.i=ie.i,N.l=ie.l,N.l.ma=ie,N.l.width=ie.c,N.l.height=ie.i,N.a=0,X(N.m,oe,Qe,Le),!Ie(ie.c,ie.i,1,N,null)||(N.ab==1&&N.gc[0].hc==3&&ae(N.s)?(ie.ic=1,oe=N.c*N.i,N.Ta=null,N.Ua=0,N.V=a(oe),N.Ba=0,N.V==null?(N.a=1,N=0):N=1):(ie.ic=0,N=Re(N,ie.c)),!N))break t;N=1;break e}ie.mc=null,N=0}else N=Le>=ie.c*ie.i;ie=!N}if(ie)return null;b.ga.Lc!=1?b.Ga=0:q=re-M}t(b.ga!=null),t(M+q<=re);e:{if(N=(oe=b.ga).c,re=oe.l.o,oe.$a==0){if(Qe=b.rc,Le=b.Vc,Je=b.Fa,ce=b.P+1+M*N,de=b.mb,Ee=b.nb+M*N,t(ce<=b.P+b.qc),oe.Z!=0)for(t(il[oe.Z]!=null),ie=0;ie<q;++ie)il[oe.Z](Qe,Le,Je,ce,de,Ee,N),Qe=de,Le=Ee,Ee+=N,ce+=N;else for(ie=0;ie<q;++ie)n(de,Ee,Je,ce,N),Qe=de,Le=Ee,Ee+=N,ce+=N;b.rc=Qe,b.Vc=Le}else{if(t(oe.mc!=null),N=M+q,t((ie=oe.mc)!=null),t(N<=ie.i),ie.C>=N)N=1;else if(oe.ic||Ue(),oe.ic){oe=ie.V,Qe=ie.Ba,Le=ie.c;var Ge=ie.i,ke=(Je=1,ce=ie.$/Le,de=ie.$%Le,Ee=ie.m,Pe=ie.s,ie.$),Ne=Le*Ge,Xe=Le*N,tt=Pe.wc,Ye=ke<Xe?Xt(Pe,de,ce):null;t(ke<=Ne),t(N<=Ge),t(ae(Pe));t:for(;;){for(;!Ee.h&&ke<Xe;){if(de&tt||(Ye=Xt(Pe,de,ce)),t(Ye!=null),O(Ee),256>(Ge=St(Ye.G[0],Ye.H[0],Ee)))oe[Qe+ke]=Ge,++ke,++de>=Le&&(de=0,++ce<=N&&!(ce%16)&&fe(ie,ce));else{if(!(280>Ge)){Je=0;break t}Ge=rt(Ge-256,Ee);var xt,ht=St(Ye.G[4],Ye.H[4],Ee);if(O(Ee),!(ke>=(ht=Ct(Le,ht=rt(ht,Ee)))&&Ne-ke>=Ge)){Je=0;break t}for(xt=0;xt<Ge;++xt)oe[Qe+ke+xt]=oe[Qe+ke+xt-ht];for(ke+=Ge,de+=Ge;de>=Le;)de-=Le,++ce<=N&&!(ce%16)&&fe(ie,ce);ke<Xe&&de&tt&&(Ye=Xt(Pe,de,ce))}t(Ee.h==P(Ee))}fe(ie,ce>N?N:ce);break t}!Je||Ee.h&&ke<Ne?(Je=0,ie.a=Ee.h?5:3):ie.$=ke,N=Je}else N=ge(ie,ie.V,ie.Ba,ie.c,ie.i,N,He);if(!N){q=0;break e}}M+q>=re&&(b.Cc=1),q=1}if(!q)return null;if(b.Cc&&((q=b.ga)!=null&&(q.mc=null),b.ga=null,0<b.Ga))return alert("todo:WebPDequantizeLevels"),null}return b.nb+M*Z}function j(b,N,M,q,Z,re){for(;0<Z--;){var ie,oe=b,ce=N+(M?1:0),de=b,Ee=N+(M?0:3);for(ie=0;ie<q;++ie){var Pe=de[Ee+4*ie];Pe!=255&&(Pe*=32897,oe[ce+4*ie+0]=oe[ce+4*ie+0]*Pe>>23,oe[ce+4*ie+1]=oe[ce+4*ie+1]*Pe>>23,oe[ce+4*ie+2]=oe[ce+4*ie+2]*Pe>>23)}N+=re}}function ee(b,N,M,q,Z){for(;0<q--;){var re;for(re=0;re<M;++re){var ie=b[N+2*re+0],oe=15&(de=b[N+2*re+1]),ce=4369*oe,de=(240&de|de>>4)*ce>>16;b[N+2*re+0]=(240&ie|ie>>4)*ce>>16&240|(15&ie|ie<<4)*ce>>16>>4&15,b[N+2*re+1]=240&de|oe}N+=Z}}function me(b,N,M,q,Z,re,ie,oe){var ce,de,Ee=255;for(de=0;de<Z;++de){for(ce=0;ce<q;++ce){var Pe=b[N+ce];re[ie+4*ce]=Pe,Ee&=Pe}N+=M,ie+=oe}return Ee!=255}function Se(b,N,M,q,Z){var re;for(re=0;re<Z;++re)M[q+re]=b[N+re]>>8}function Ue(){Oa=j,Ir=ee,Ur=me,hn=Se}function $e(b,N,M){F[b]=function(q,Z,re,ie,oe,ce,de,Ee,Pe,Qe,Le,Je,Ge,ke,Ne,Xe,tt){var Ye,xt=tt-1>>1,ht=oe[ce+0]|de[Ee+0]<<16,It=Pe[Qe+0]|Le[Je+0]<<16;t(q!=null);var gt=3*ht+It+131074>>2;for(N(q[Z+0],255&gt,gt>>16,Ge,ke),re!=null&&(gt=3*It+ht+131074>>2,N(re[ie+0],255&gt,gt>>16,Ne,Xe)),Ye=1;Ye<=xt;++Ye){var gr=oe[ce+Ye]|de[Ee+Ye]<<16,xr=Pe[Qe+Ye]|Le[Je+Ye]<<16,sr=ht+gr+It+xr+524296,tr=sr+2*(gr+It)>>3;gt=tr+ht>>1,ht=(sr=sr+2*(ht+xr)>>3)+gr>>1,N(q[Z+2*Ye-1],255&gt,gt>>16,Ge,ke+(2*Ye-1)*M),N(q[Z+2*Ye-0],255&ht,ht>>16,Ge,ke+(2*Ye-0)*M),re!=null&&(gt=sr+It>>1,ht=tr+xr>>1,N(re[ie+2*Ye-1],255&gt,gt>>16,Ne,Xe+(2*Ye-1)*M),N(re[ie+2*Ye+0],255&ht,ht>>16,Ne,Xe+(2*Ye+0)*M)),ht=gr,It=xr}1&tt||(gt=3*ht+It+131074>>2,N(q[Z+tt-1],255&gt,gt>>16,Ge,ke+(tt-1)*M),re!=null&&(gt=3*It+ht+131074>>2,N(re[ie+tt-1],255&gt,gt>>16,Ne,Xe+(tt-1)*M)))}}function it(){Da[Q0]=_L,Da[R0]=E5,Da[b5]=CL,Da[M0]=k5,Da[H0]=F5,Da[lv]=N5,Da[B5]=SL,Da[Av]=E5,Da[cv]=k5,Da[K0]=F5,Da[uv]=N5}function vt(b){return b&~EL?0>b?0:255:b>>T5}function Tt(b,N){return vt((19077*b>>8)+(26149*N>>8)-14234)}function Gt(b,N,M){return vt((19077*b>>8)-(6419*N>>8)-(13320*M>>8)+8708)}function Ht(b,N){return vt((19077*b>>8)+(33050*N>>8)-17685)}function ar(b,N,M,q,Z){q[Z+0]=Tt(b,M),q[Z+1]=Gt(b,N,M),q[Z+2]=Ht(b,N)}function qr(b,N,M,q,Z){q[Z+0]=Ht(b,N),q[Z+1]=Gt(b,N,M),q[Z+2]=Tt(b,M)}function nn(b,N,M,q,Z){var re=Gt(b,N,M);N=re<<3&224|Ht(b,N)>>3,q[Z+0]=248&Tt(b,M)|re>>5,q[Z+1]=N}function _n(b,N,M,q,Z){var re=240&Ht(b,N)|15;q[Z+0]=240&Tt(b,M)|Gt(b,N,M)>>4,q[Z+1]=re}function Ai(b,N,M,q,Z){q[Z+0]=255,ar(b,N,M,q,Z+1)}function Mn(b,N,M,q,Z){qr(b,N,M,q,Z),q[Z+3]=255}function fs(b,N,M,q,Z){ar(b,N,M,q,Z),q[Z+3]=255}function ua(b,N){return 0>b?0:b>N?N:b}function Hs(b,N,M){F[b]=function(q,Z,re,ie,oe,ce,de,Ee,Pe){for(var Qe=Ee+(-2&Pe)*M;Ee!=Qe;)N(q[Z+0],re[ie+0],oe[ce+0],de,Ee),N(q[Z+1],re[ie+0],oe[ce+0],de,Ee+M),Z+=2,++ie,++ce,Ee+=2*M;1&Pe&&N(q[Z+0],re[ie+0],oe[ce+0],de,Ee)}}function L0(b,N,M){return M==0?b==0?N==0?6:5:N==0?4:0:M}function Lf(b,N,M,q,Z){switch(b>>>30){case 3:mo(N,M,q,Z,0);break;case 2:fn(N,M,q,Z);break;case 1:Ui(N,M,q,Z)}}function If(b,N){var M,q,Z=N.M,re=N.Nb,ie=b.oc,oe=b.pc+40,ce=b.oc,de=b.pc+584,Ee=b.oc,Pe=b.pc+600;for(M=0;16>M;++M)ie[oe+32*M-1]=129;for(M=0;8>M;++M)ce[de+32*M-1]=129,Ee[Pe+32*M-1]=129;for(0<Z?ie[oe-1-32]=ce[de-1-32]=Ee[Pe-1-32]=129:(i(ie,oe-32-1,127,21),i(ce,de-32-1,127,9),i(Ee,Pe-32-1,127,9)),q=0;q<b.za;++q){var Qe=N.ya[N.aa+q];if(0<q){for(M=-1;16>M;++M)n(ie,oe+32*M-4,ie,oe+32*M+12,4);for(M=-1;8>M;++M)n(ce,de+32*M-4,ce,de+32*M+4,4),n(Ee,Pe+32*M-4,Ee,Pe+32*M+4,4)}var Le=b.Gd,Je=b.Hd+q,Ge=Qe.ad,ke=Qe.Hc;if(0<Z&&(n(ie,oe-32,Le[Je].y,0,16),n(ce,de-32,Le[Je].f,0,8),n(Ee,Pe-32,Le[Je].ea,0,8)),Qe.Za){var Ne=ie,Xe=oe-32+16;for(0<Z&&(q>=b.za-1?i(Ne,Xe,Le[Je].y[15],4):n(Ne,Xe,Le[Je+1].y,0,4)),M=0;4>M;M++)Ne[Xe+128+M]=Ne[Xe+256+M]=Ne[Xe+384+M]=Ne[Xe+0+M];for(M=0;16>M;++M,ke<<=2)Ne=ie,Xe=oe+I5[M],hs[Qe.Ob[M]](Ne,Xe),Lf(ke,Ge,16*+M,Ne,Xe)}else if(Ne=L0(q,Z,Qe.Ob[0]),nl[Ne](ie,oe),ke!=0)for(M=0;16>M;++M,ke<<=2)Lf(ke,Ge,16*+M,ie,oe+I5[M]);for(M=Qe.Gc,Ne=L0(q,Z,Qe.Dd),xo[Ne](ce,de),xo[Ne](Ee,Pe),ke=Ge,Ne=ce,Xe=de,255&(Qe=M>>0)&&(170&Qe?Pf(ke,256,Ne,Xe):Ia(ke,256,Ne,Xe)),Qe=Ee,ke=Pe,255&(M>>=8)&&(170&M?Pf(Ge,320,Qe,ke):Ia(Ge,320,Qe,ke)),Z<b.Ub-1&&(n(Le[Je].y,0,ie,oe+480,16),n(Le[Je].f,0,ce,de+224,8),n(Le[Je].ea,0,Ee,Pe+224,8)),M=8*re*b.B,Le=b.sa,Je=b.ta+16*q+16*re*b.R,Ge=b.qa,Qe=b.ra+8*q+M,ke=b.Ha,Ne=b.Ia+8*q+M,M=0;16>M;++M)n(Le,Je+M*b.R,ie,oe+32*M,16);for(M=0;8>M;++M)n(Ge,Qe+M*b.B,ce,de+32*M,8),n(ke,Ne+M*b.B,Ee,Pe+32*M,8)}}function kc(b,N,M,q,Z,re,ie,oe,ce){var de=[0],Ee=[0],Pe=0,Qe=ce!=null?ce.kd:0,Le=ce??new kf;if(b==null||12>M)return 7;Le.data=b,Le.w=N,Le.ha=M,N=[N],M=[M],Le.gb=[Le.gb];e:{var Je=N,Ge=M,ke=Le.gb;if(t(b!=null),t(Ge!=null),t(ke!=null),ke[0]=0,12<=Ge[0]&&!r(b,Je[0],"RIFF")){if(r(b,Je[0]+8,"WEBP")){ke=3;break e}var Ne=Me(b,Je[0]+4);if(12>Ne||4294967286<Ne){ke=3;break e}if(Qe&&Ne>Ge[0]-8){ke=7;break e}ke[0]=Ne,Je[0]+=12,Ge[0]-=12}ke=0}if(ke!=0)return ke;for(Ne=0<Le.gb[0],M=M[0];;){e:{var Xe=b;Ge=N,ke=M;var tt=de,Ye=Ee,xt=Je=[0];if((gt=Pe=[Pe])[0]=0,8>ke[0])ke=7;else{if(!r(Xe,Ge[0],"VP8X")){if(Me(Xe,Ge[0]+4)!=10){ke=3;break e}if(18>ke[0]){ke=7;break e}var ht=Me(Xe,Ge[0]+8),It=1+ne(Xe,Ge[0]+12);if(2147483648<=It*(Xe=1+ne(Xe,Ge[0]+15))){ke=3;break e}xt!=null&&(xt[0]=ht),tt!=null&&(tt[0]=It),Ye!=null&&(Ye[0]=Xe),Ge[0]+=18,ke[0]-=18,gt[0]=1}ke=0}}if(Pe=Pe[0],Je=Je[0],ke!=0)return ke;if(Ge=!!(2&Je),!Ne&&Pe)return 3;if(re!=null&&(re[0]=!!(16&Je)),ie!=null&&(ie[0]=Ge),oe!=null&&(oe[0]=0),ie=de[0],Je=Ee[0],Pe&&Ge&&ce==null){ke=0;break}if(4>M){ke=7;break}if(Ne&&Pe||!Ne&&!Pe&&!r(b,N[0],"ALPH")){M=[M],Le.na=[Le.na],Le.P=[Le.P],Le.Sa=[Le.Sa];e:{ht=b,ke=N,Ne=M;var gt=Le.gb;tt=Le.na,Ye=Le.P,xt=Le.Sa,It=22,t(ht!=null),t(Ne!=null),Xe=ke[0];var gr=Ne[0];for(t(tt!=null),t(xt!=null),tt[0]=null,Ye[0]=null,xt[0]=0;;){if(ke[0]=Xe,Ne[0]=gr,8>gr){ke=7;break e}var xr=Me(ht,Xe+4);if(4294967286<xr){ke=3;break e}var sr=8+xr+1&-2;if(It+=sr,0<gt&&It>gt){ke=3;break e}if(!r(ht,Xe,"VP8 ")||!r(ht,Xe,"VP8L")){ke=0;break e}if(gr[0]<sr){ke=7;break e}r(ht,Xe,"ALPH")||(tt[0]=ht,Ye[0]=Xe+8,xt[0]=xr),Xe+=sr,gr-=sr}}if(M=M[0],Le.na=Le.na[0],Le.P=Le.P[0],Le.Sa=Le.Sa[0],ke!=0)break}M=[M],Le.Ja=[Le.Ja],Le.xa=[Le.xa];e:if(gt=b,ke=N,Ne=M,tt=Le.gb[0],Ye=Le.Ja,xt=Le.xa,ht=ke[0],Xe=!r(gt,ht,"VP8 "),It=!r(gt,ht,"VP8L"),t(gt!=null),t(Ne!=null),t(Ye!=null),t(xt!=null),8>Ne[0])ke=7;else{if(Xe||It){if(gt=Me(gt,ht+4),12<=tt&&gt>tt-12){ke=3;break e}if(Qe&&gt>Ne[0]-8){ke=7;break e}Ye[0]=gt,ke[0]+=8,Ne[0]-=8,xt[0]=It}else xt[0]=5<=Ne[0]&&gt[ht+0]==47&&!(gt[ht+4]>>5),Ye[0]=Ne[0];ke=0}if(M=M[0],Le.Ja=Le.Ja[0],Le.xa=Le.xa[0],N=N[0],ke!=0)break;if(4294967286<Le.Ja)return 3;if(oe==null||Ge||(oe[0]=Le.xa?2:1),ie=[ie],Je=[Je],Le.xa){if(5>M){ke=7;break}oe=ie,Qe=Je,Ge=re,b==null||5>M?b=0:5<=M&&b[N+0]==47&&!(b[N+4]>>5)?(Ne=[0],gt=[0],tt=[0],X(Ye=new k,b,N,M),ye(Ye,Ne,gt,tt)?(oe!=null&&(oe[0]=Ne[0]),Qe!=null&&(Qe[0]=gt[0]),Ge!=null&&(Ge[0]=tt[0]),b=1):b=0):b=0}else{if(10>M){ke=7;break}oe=Je,b==null||10>M||!g0(b,N+3,M-3)?b=0:(Qe=b[N+0]|b[N+1]<<8|b[N+2]<<16,Ge=16383&(b[N+7]<<8|b[N+6]),b=16383&(b[N+9]<<8|b[N+8]),1&Qe||3<(Qe>>1&7)||!(Qe>>4&1)||Qe>>5>=Le.Ja||!Ge||!b?b=0:(ie&&(ie[0]=Ge),oe&&(oe[0]=b),b=1))}if(!b||(ie=ie[0],Je=Je[0],Pe&&(de[0]!=ie||Ee[0]!=Je)))return 3;ce!=null&&(ce[0]=Le,ce.offset=N-ce.w,t(4294967286>N-ce.w),t(ce.offset==ce.ha-M));break}return ke==0||ke==7&&Pe&&ce==null?(re!=null&&(re[0]|=Le.na!=null&&0<Le.na.length),q!=null&&(q[0]=ie),Z!=null&&(Z[0]=Je),0):ke}function Uf(b,N,M){var q=N.width,Z=N.height,re=0,ie=0,oe=q,ce=Z;if(N.Da=b!=null&&0<b.Da,N.Da&&(oe=b.cd,ce=b.bd,re=b.v,ie=b.j,11>M||(re&=-2,ie&=-2),0>re||0>ie||0>=oe||0>=ce||re+oe>q||ie+ce>Z))return 0;if(N.v=re,N.j=ie,N.va=re+oe,N.o=ie+ce,N.U=oe,N.T=ce,N.da=b!=null&&0<b.da,N.da){if(!Be(oe,ce,M=[b.ib],re=[b.hb]))return 0;N.ib=M[0],N.hb=re[0]}return N.ob=b!=null&&b.ob,N.Kb=b==null||!b.Sd,N.da&&(N.ob=N.ib<3*q/4&&N.hb<3*Z/4,N.Kb=0),1}function Of(b){if(b==null)return 2;if(11>b.S){var N=b.f.RGBA;N.fb+=(b.height-1)*N.A,N.A=-N.A}else N=b.f.kb,b=b.height,N.O+=(b-1)*N.fa,N.fa=-N.fa,N.N+=(b-1>>1)*N.Ab,N.Ab=-N.Ab,N.W+=(b-1>>1)*N.Db,N.Db=-N.Db,N.F!=null&&(N.J+=(b-1)*N.lb,N.lb=-N.lb);return 0}function Fc(b,N,M,q){if(q==null||0>=b||0>=N)return 2;if(M!=null){if(M.Da){var Z=M.cd,re=M.bd,ie=-2&M.v,oe=-2&M.j;if(0>ie||0>oe||0>=Z||0>=re||ie+Z>b||oe+re>N)return 2;b=Z,N=re}if(M.da){if(!Be(b,N,Z=[M.ib],re=[M.hb]))return 2;b=Z[0],N=re[0]}}q.width=b,q.height=N;e:{var ce=q.width,de=q.height;if(b=q.S,0>=ce||0>=de||!(b>=Q0&&13>b))b=2;else{if(0>=q.Rd&&q.sd==null){ie=re=Z=N=0;var Ee=(oe=ce*U5[b])*de;if(11>b||(re=(de+1)/2*(N=(ce+1)/2),b==12&&(ie=(Z=ce)*de)),(de=a(Ee+2*re+ie))==null){b=1;break e}q.sd=de,11>b?((ce=q.f.RGBA).eb=de,ce.fb=0,ce.A=oe,ce.size=Ee):((ce=q.f.kb).y=de,ce.O=0,ce.fa=oe,ce.Fd=Ee,ce.f=de,ce.N=0+Ee,ce.Ab=N,ce.Cd=re,ce.ea=de,ce.W=0+Ee+re,ce.Db=N,ce.Ed=re,b==12&&(ce.F=de,ce.J=0+Ee+2*re),ce.Tc=ie,ce.lb=Z)}if(N=1,Z=q.S,re=q.width,ie=q.height,Z>=Q0&&13>Z)if(11>Z)b=q.f.RGBA,N&=(oe=Math.abs(b.A))*(ie-1)+re<=b.size,N&=oe>=re*U5[Z],N&=b.eb!=null;else{b=q.f.kb,oe=(re+1)/2,Ee=(ie+1)/2,ce=Math.abs(b.fa),de=Math.abs(b.Ab);var Pe=Math.abs(b.Db),Qe=Math.abs(b.lb),Le=Qe*(ie-1)+re;N&=ce*(ie-1)+re<=b.Fd,N&=de*(Ee-1)+oe<=b.Cd,N=(N&=Pe*(Ee-1)+oe<=b.Ed)&ce>=re&de>=oe&Pe>=oe,N&=b.y!=null,N&=b.f!=null,N&=b.ea!=null,Z==12&&(N&=Qe>=re,N&=Le<=b.Tc,N&=b.F!=null)}else N=0;b=N?0:2}}return b!=0||M!=null&&M.fd&&(b=Of(q)),b}var Yn=64,Nc=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Tc=24,Lc=32,jf=8,$i=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];be("Predictor0","PredictorAdd0"),F.Predictor0=function(){return 4278190080},F.Predictor1=function(b){return b},F.Predictor2=function(b,N,M){return N[M+0]},F.Predictor3=function(b,N,M){return N[M+1]},F.Predictor4=function(b,N,M){return N[M-1]},F.Predictor5=function(b,N,M){return pe(pe(b,N[M+1]),N[M+0])},F.Predictor6=function(b,N,M){return pe(b,N[M-1])},F.Predictor7=function(b,N,M){return pe(b,N[M+0])},F.Predictor8=function(b,N,M){return pe(N[M-1],N[M+0])},F.Predictor9=function(b,N,M){return pe(N[M+0],N[M+1])},F.Predictor10=function(b,N,M){return pe(pe(b,N[M-1]),pe(N[M+0],N[M+1]))},F.Predictor11=function(b,N,M){var q=N[M+0];return 0>=We(q>>24&255,b>>24&255,(N=N[M-1])>>24&255)+We(q>>16&255,b>>16&255,N>>16&255)+We(q>>8&255,b>>8&255,N>>8&255)+We(255&q,255&b,255&N)?q:b},F.Predictor12=function(b,N,M){var q=N[M+0];return(je((b>>24&255)+(q>>24&255)-((N=N[M-1])>>24&255))<<24|je((b>>16&255)+(q>>16&255)-(N>>16&255))<<16|je((b>>8&255)+(q>>8&255)-(N>>8&255))<<8|je((255&b)+(255&q)-(255&N)))>>>0},F.Predictor13=function(b,N,M){var q=N[M-1];return(Ve((b=pe(b,N[M+0]))>>24&255,q>>24&255)<<24|Ve(b>>16&255,q>>16&255)<<16|Ve(b>>8&255,q>>8&255)<<8|Ve(b>>0&255,q>>0&255))>>>0};var sv=F.PredictorAdd0;F.PredictorAdd1=ft,be("Predictor2","PredictorAdd2"),be("Predictor3","PredictorAdd3"),be("Predictor4","PredictorAdd4"),be("Predictor5","PredictorAdd5"),be("Predictor6","PredictorAdd6"),be("Predictor7","PredictorAdd7"),be("Predictor8","PredictorAdd8"),be("Predictor9","PredictorAdd9"),be("Predictor10","PredictorAdd10"),be("Predictor11","PredictorAdd11"),be("Predictor12","PredictorAdd12"),be("Predictor13","PredictorAdd13");var Df=F.PredictorAdd2;at("ColorIndexInverseTransform","MapARGB","32b",function(b){return b>>8&255},function(b){return b}),at("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(b){return b},function(b){return b>>8&255});var I0,La=F.ColorIndexInverseTransform,Ic=F.MapARGB,U0=F.VP8LColorIndexInverseTransformAlpha,O0=F.MapAlpha,Zo=F.VP8LPredictorsAdd=[];Zo.length=16,(F.VP8LPredictors=[]).length=16,(F.VP8LPredictorsAdd_C=[]).length=16,(F.VP8LPredictors_C=[]).length=16;var mA,qi,Ii,el,po,go,Uc,mo,fn,Pf,Ui,Ia,Oc,j0,Qf,vA,xA,tl,yA,jc,wA,rl,Rf,Ua,Oa,Ir,Ur,hn,Ln=a(511),vo=a(2041),Mf=a(225),Dc=a(767),D0=0,ov=vo,P0=Mf,fa=Dc,ja=Ln,Q0=0,R0=1,b5=2,M0=3,H0=4,lv=5,B5=6,Av=7,cv=8,K0=9,uv=10,cL=[2,3,7],uL=[3,3,11],_5=[280,256,256,256,40],fL=[0,1,1,1,0],hL=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],dL=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],pL=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],gL=8,fv=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],hv=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Hf=null,mL=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],vL=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],C5=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],xL=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],yL=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],wL=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],bL=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],nl=[],hs=[],xo=[],BL=1,S5=2,il=[],Da=[];$e("UpsampleRgbLinePair",ar,3),$e("UpsampleBgrLinePair",qr,3),$e("UpsampleRgbaLinePair",fs,4),$e("UpsampleBgraLinePair",Mn,4),$e("UpsampleArgbLinePair",Ai,4),$e("UpsampleRgba4444LinePair",_n,2),$e("UpsampleRgb565LinePair",nn,2);var _L=F.UpsampleRgbLinePair,CL=F.UpsampleBgrLinePair,E5=F.UpsampleRgbaLinePair,k5=F.UpsampleBgraLinePair,F5=F.UpsampleArgbLinePair,N5=F.UpsampleRgba4444LinePair,SL=F.UpsampleRgb565LinePair,G0=16,V0=1<<G0-1,Kf=-227,dv=482,T5=6,EL=(256<<T5)-1,L5=0,kL=a(256),FL=a(256),NL=a(256),TL=a(256),LL=a(dv-Kf),IL=a(dv-Kf);Hs("YuvToRgbRow",ar,3),Hs("YuvToBgrRow",qr,3),Hs("YuvToRgbaRow",fs,4),Hs("YuvToBgraRow",Mn,4),Hs("YuvToArgbRow",Ai,4),Hs("YuvToRgba4444Row",_n,2),Hs("YuvToRgb565Row",nn,2);var I5=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],W0=[0,2,8],UL=[8,7,6,4,4,2,2,2,1,1,1,1],OL=1;this.WebPDecodeRGBA=function(b,N,M,q,Z){var re=R0,ie=new Sc,oe=new Li;ie.ba=oe,oe.S=re,oe.width=[oe.width],oe.height=[oe.height];var ce=oe.width,de=oe.height,Ee=new Aa;if(Ee==null||b==null)var Pe=2;else t(Ee!=null),Pe=kc(b,N,M,Ee.width,Ee.height,Ee.Pd,Ee.Qd,Ee.format,null);if(Pe!=0?ce=0:(ce!=null&&(ce[0]=Ee.width[0]),de!=null&&(de[0]=Ee.height[0]),ce=1),ce){oe.width=oe.width[0],oe.height=oe.height[0],q!=null&&(q[0]=oe.width),Z!=null&&(Z[0]=oe.height);e:{if(q=new Qs,(Z=new kf).data=b,Z.w=N,Z.ha=M,Z.kd=1,N=[0],t(Z!=null),((b=kc(Z.data,Z.w,Z.ha,null,null,null,N,null,Z))==0||b==7)&&N[0]&&(b=4),(N=b)==0){if(t(ie!=null),q.data=Z.data,q.w=Z.w+Z.offset,q.ha=Z.ha-Z.offset,q.put=Ce,q.ac=_e,q.bc=De,q.ma=ie,Z.xa){if((b=Ke())==null){ie=1;break e}if(function(Qe,Le){var Je=[0],Ge=[0],ke=[0];t:for(;;){if(Qe==null)return 0;if(Le==null)return Qe.a=2,0;if(Qe.l=Le,Qe.a=0,X(Qe.m,Le.data,Le.w,Le.ha),!ye(Qe.m,Je,Ge,ke)){Qe.a=3;break t}if(Qe.xb=S5,Le.width=Je[0],Le.height=Ge[0],!Ie(Je[0],Ge[0],1,Qe,null))break t;return 1}return t(Qe.a!=0),0}(b,q)){if(q=(N=Fc(q.width,q.height,ie.Oa,ie.ba))==0){t:{q=b;r:for(;;){if(q==null){q=0;break t}if(t(q.s.yc!=null),t(q.s.Ya!=null),t(0<q.s.Wb),t((M=q.l)!=null),t((Z=M.ma)!=null),q.xb!=0){if(q.ca=Z.ba,q.tb=Z.tb,t(q.ca!=null),!Uf(Z.Oa,M,M0)){q.a=2;break r}if(!Re(q,M.width)||M.da)break r;if((M.da||nr(q.ca.S))&&Ue(),11>q.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),q.ca.f.kb.F!=null&&Ue()),q.Pb&&0<q.s.ua&&q.s.vb.X==null&&!qe(q.s.vb,q.s.Wa.Xa)){q.a=1;break r}q.xb=0}if(!ge(q,q.V,q.Ba,q.c,q.i,M.o,ue))break r;Z.Dc=q.Ma,q=1;break t}t(q.a!=0),q=0}q=!q}q&&(N=b.a)}else N=b.a}else{if((b=new ca)==null){ie=1;break e}if(b.Fa=Z.na,b.P=Z.P,b.qc=Z.Sa,m0(b,q)){if((N=Fc(q.width,q.height,ie.Oa,ie.ba))==0){if(b.Aa=0,M=ie.Oa,t((Z=b)!=null),M!=null){if(0<(ce=0>(ce=M.Md)?0:100<ce?255:255*ce/100)){for(de=Ee=0;4>de;++de)12>(Pe=Z.pb[de]).lc&&(Pe.ia=ce*UL[0>Pe.lc?0:Pe.lc]>>3),Ee|=Pe.ia;Ee&&(alert("todo:VP8InitRandom"),Z.ia=1)}Z.Ga=M.Id,100<Z.Ga?Z.Ga=100:0>Z.Ga&&(Z.Ga=0)}H1(b,q)||(N=b.a)}}else N=b.a}N==0&&ie.Oa!=null&&ie.Oa.fd&&(N=Of(ie.ba))}ie=N}re=ie!=0?null:11>re?oe.f.RGBA.eb:oe.f.kb.y}else re=null;return re};var U5=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function A(F,T){for(var I="",S=0;S<4;S++)I+=String.fromCharCode(F[T++]);return I}function u(F,T){return(F[T+0]<<0|F[T+1]<<8|F[T+2]<<16)>>>0}function f(F,T){return(F[T+0]<<0|F[T+1]<<8|F[T+2]<<16|F[T+3]<<24)>>>0}new l;var h=[0],d=[0],m=[],g=new l,x=e,p=function(F,T){var I={},S=0,C=!1,L=0,R=0;if(I.frames=[],!function(U,P,D,O){for(var z=0;z<O;z++)if(U[P+z]!=D.charCodeAt(z))return!0;return!1}(F,T,"RIFF",4)){var W,G;for(f(F,T+=4),T+=8;T<F.length;){var V=A(F,T),X=f(F,T+=4);T+=4;var Q=X+(1&X);switch(V){case"VP8 ":case"VP8L":I.frames[S]===void 0&&(I.frames[S]={}),(k=I.frames[S]).src_off=C?R:T-8,k.src_size=L+X+8,S++,C&&(C=!1,L=0,R=0);break;case"VP8X":(k=I.header={}).feature_flags=F[T];var K=T+4;k.canvas_width=1+u(F,K),K+=3,k.canvas_height=1+u(F,K),K+=3;break;case"ALPH":C=!0,L=Q+8,R=T-8;break;case"ANIM":(k=I.header).bgcolor=f(F,T),K=T+4,k.loop_count=(W=F)[(G=K)+0]<<0|W[G+1]<<8,K+=2;break;case"ANMF":var H,k;(k=I.frames[S]={}).offset_x=2*u(F,T),T+=3,k.offset_y=2*u(F,T),T+=3,k.width=1+u(F,T),T+=3,k.height=1+u(F,T),T+=3,k.duration=u(F,T),T+=3,H=F[T++],k.dispose=1&H,k.blend=H>>1&1}V!="ANMF"&&(T+=Q)}return I}}(x,0);p.response=x,p.rgbaoutput=!0,p.dataurl=!1;var v=p.header?p.header:null,y=p.frames?p.frames:null;if(v){v.loop_counter=v.loop_count,h=[v.canvas_height],d=[v.canvas_width];for(var w=0;w<y.length&&y[w].blend!=0;w++);}var B=y[0],E=g.WebPDecodeRGBA(x,B.src_off,B.src_size,d,h);B.rgba=E,B.imgwidth=d[0],B.imgheight=h[0];for(var _=0;_<d[0]*h[0]*4;_++)m[_]=E[_];return this.width=d,this.height=h,this.data=m,this}(function(e){var t=function(){return typeof Oy=="function"},r=function(h,d,m,g){var x=4,p=s;switch(g){case e.image_compression.FAST:x=1,p=a;break;case e.image_compression.MEDIUM:x=6,p=o;break;case e.image_compression.SLOW:x=9,p=l}h=n(h,d,m,p);var v=Oy(h,{level:x});return e.__addimage__.arrayBufferToBinaryString(v)},n=function(h,d,m,g){for(var x,p,v,y=h.length/d,w=new Uint8Array(h.length+y),B=u(),E=0;E<y;E+=1){if(v=E*d,x=h.subarray(v,v+d),g)w.set(g(x,m,p),v+E);else{for(var _,F=B.length,T=[];_<F;_+=1)T[_]=B[_](x,m,p);var I=f(T.concat());w.set(T[I],v+E)}p=x}return w},i=function(h){var d=Array.apply([],h);return d.unshift(0),d},a=function(h,d){var m,g=[],x=h.length;g[0]=1;for(var p=0;p<x;p+=1)m=h[p-d]||0,g[p+1]=h[p]-m+256&255;return g},s=function(h,d,m){var g,x=[],p=h.length;x[0]=2;for(var v=0;v<p;v+=1)g=m&&m[v]||0,x[v+1]=h[v]-g+256&255;return x},o=function(h,d,m){var g,x,p=[],v=h.length;p[0]=3;for(var y=0;y<v;y+=1)g=h[y-d]||0,x=m&&m[y]||0,p[y+1]=h[y]+256-(g+x>>>1)&255;return p},l=function(h,d,m){var g,x,p,v,y=[],w=h.length;y[0]=4;for(var B=0;B<w;B+=1)g=h[B-d]||0,x=m&&m[B]||0,p=m&&m[B-d]||0,v=A(g,x,p),y[B+1]=h[B]-v+256&255;return y},A=function(h,d,m){if(h===d&&d===m)return h;var g=Math.abs(d-m),x=Math.abs(h-m),p=Math.abs(h+d-m-m);return g<=x&&g<=p?h:x<=p?d:m},u=function(){return[i,a,s,o,l]},f=function(h){var d=h.map(function(m){return m.reduce(function(g,x){return g+Math.abs(x)},0)});return d.indexOf(Math.min.apply(null,d))};e.processPNG=function(h,d,m,g){var x,p,v,y,w,B,E,_,F,T,I,S,C,L,R,W=this.decode.FLATE_DECODE,G="";if(this.__addimage__.isArrayBuffer(h)&&(h=new Uint8Array(h)),this.__addimage__.isArrayBufferView(h)){if(h=(v=new Ure(h)).imgData,p=v.bits,x=v.colorSpace,w=v.colors,[4,6].indexOf(v.colorType)!==-1){if(v.bits===8){F=(_=v.pixelBitlength==32?new Uint32Array(v.decodePixels().buffer):v.pixelBitlength==16?new Uint16Array(v.decodePixels().buffer):new Uint8Array(v.decodePixels().buffer)).length,I=new Uint8Array(F*v.colors),T=new Uint8Array(F);var V,X=v.pixelBitlength-v.bits;for(L=0,R=0;L<F;L++){for(C=_[L],V=0;V<X;)I[R++]=C>>>V&255,V+=v.bits;T[L]=C>>>V&255}}if(v.bits===16){F=(_=new Uint32Array(v.decodePixels().buffer)).length,I=new Uint8Array(F*(32/v.pixelBitlength)*v.colors),T=new Uint8Array(F*(32/v.pixelBitlength)),S=v.colors>1,L=0,R=0;for(var Q=0;L<F;)C=_[L++],I[R++]=C>>>0&255,S&&(I[R++]=C>>>16&255,C=_[L++],I[R++]=C>>>0&255),T[Q++]=C>>>16&255;p=8}g!==e.image_compression.NONE&&t()?(h=r(I,v.width*v.colors,v.colors,g),E=r(T,v.width,1,g)):(h=I,E=T,W=void 0)}if(v.colorType===3&&(x=this.color_spaces.INDEXED,B=v.palette,v.transparency.indexed)){var K=v.transparency.indexed,H=0;for(L=0,F=K.length;L<F;++L)H+=K[L];if((H/=255)===F-1&&K.indexOf(0)!==-1)y=[K.indexOf(0)];else if(H!==F){for(_=v.decodePixels(),T=new Uint8Array(_.length),L=0,F=_.length;L<F;L++)T[L]=K[_[L]];E=r(T,v.width,1)}}var k=function(U){var P;switch(U){case e.image_compression.FAST:P=11;break;case e.image_compression.MEDIUM:P=13;break;case e.image_compression.SLOW:P=14;break;default:P=12}return P}(g);return W===this.decode.FLATE_DECODE&&(G="/Predictor "+k+" "),G+="/Colors "+w+" /BitsPerComponent "+p+" /Columns "+v.width,(this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),(E&&this.__addimage__.isArrayBuffer(E)||this.__addimage__.isArrayBufferView(E))&&(E=this.__addimage__.arrayBufferToBinaryString(E)),{alias:m,data:h,index:d,filter:W,decodeParameters:G,transparency:y,palette:B,sMask:E,predictor:k,width:v.width,height:v.height,bitsPerComponent:p,colorSpace:x}}}})(Ut.API),function(e){e.processGIF89A=function(t,r,n,i){var a=new Ore(t),s=a.width,o=a.height,l=[];a.decodeAndBlitFrameRGBA(0,l);var A={data:l,width:s,height:o},u=new jx(100).encode(A,100);return e.processJPEG.call(this,u,r,n,i)},e.processGIF87A=e.processGIF89A}(Ut.API),vs.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:i,green:n,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},vs.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){Lr.log("bit decode error:"+r)}},vs.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<t;i++)for(var a=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*i*4,o=0;o<8&&8*i+o<this.width;o++){var l=this.palette[a>>7-o&1];this.data[s+4*o]=l.blue,this.data[s+4*o+1]=l.green,this.data[s+4*o+2]=l.red,this.data[s+4*o+3]=255}r!==0&&(this.pos+=4-r)}},vs.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<e;i++){var a=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*i*4,o=a>>4,l=15&a,A=this.palette[o];if(this.data[s]=A.blue,this.data[s+1]=A.green,this.data[s+2]=A.red,this.data[s+3]=255,2*i+1>=this.width)break;A=this.palette[l],this.data[s+4]=A.blue,this.data[s+4+1]=A.green,this.data[s+4+2]=A.red,this.data[s+4+3]=255}t!==0&&(this.pos+=4-t)}},vs.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+4*n;if(i<this.palette.length){var s=this.palette[i];this.data[a]=s.red,this.data[a+1]=s.green,this.data[a+2]=s.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}e!==0&&(this.pos+=4-e)}},vs.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(a&t)/t*255|0,o=(a>>5&t)/t*255|0,l=(a>>10&t)/t*255|0,A=a>>15?255:0,u=n*this.width*4+4*i;this.data[u]=l,this.data[u+1]=o,this.data[u+2]=s,this.data[u+3]=A}this.pos+=e}},vs.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,l=(s>>5&r)/r*255|0,A=(s>>11)/t*255|0,u=i*this.width*4+4*a;this.data[u]=A,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=255}this.pos+=e}},vs.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*r;this.data[s]=a,this.data[s+1]=i,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},vs.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=a,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=s}},vs.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,i){var a=new vs(t,!1),s=a.width,o=a.height,l={data:a.getData(),width:s,height:o},A=new jx(100).encode(l,100);return e.processJPEG.call(this,A,r,n,i)}}(Ut.API),WC.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,i){var a=new WC(t),s=a.width,o=a.height,l={data:a.getData(),width:s,height:o},A=new jx(100).encode(l,100);return e.processJPEG.call(this,A,r,n,i)}}(Ut.API),Ut.API.processRGBA=function(e,t,r){for(var n=e.data,i=n.length,a=new Uint8Array(i/4*3),s=new Uint8Array(i/4),o=0,l=0,A=0;A<i;A+=4){var u=n[A],f=n[A+1],h=n[A+2],d=n[A+3];a[o++]=u,a[o++]=f,a[o++]=h,s[l++]=d}var m=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:m,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Ut.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},tu=Ut.API,Kp=tu.getCharWidthsArray=function(e,t){var r,n,i=(t=t||{}).font||this.internal.getFont(),a=t.fontSize||this.internal.getFontSize(),s=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:i.metadata.Unicode.widths,l=o.fof?o.fof:1,A=t.kerning?t.kerning:i.metadata.Unicode.kerning,u=A.fof?A.fof:1,f=t.doKerning!==!1,h=0,d=e.length,m=0,g=o[0]||l,x=[];for(r=0;r<d;r++)n=e.charCodeAt(r),typeof i.metadata.widthOfString=="function"?x.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+s*(1e3/a)||0)/1e3):(h=f&&_r(A[n])==="object"&&!isNaN(parseInt(A[n][m],10))?A[n][m]/u:0,x.push((o[n]||g)/l+h)),m=n;return x},HC=tu.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),i=t.charSpace||this.internal.getCharSpace();return tu.processArabic&&(e=tu.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,i)/r:Kp.apply(this,arguments).reduce(function(a,s){return a+s},0)},KC=function(e,t,r,n){for(var i=[],a=0,s=e.length,o=0;a!==s&&o+t[a]<r;)o+=t[a],a++;i.push(e.slice(0,a));var l=a;for(o=0;a!==s;)o+t[a]>n&&(i.push(e.slice(l,a)),o=0,l=a),o+=t[a],a++;return l!==a&&i.push(e.slice(l,a)),i},GC=function(e,t,r){r||(r={});var n,i,a,s,o,l,A,u=[],f=[u],h=r.textIndent||0,d=0,m=0,g=e.split(" "),x=Kp.apply(this,[" ",r])[0];if(l=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var p=Array(l).join(" "),v=[];g.map(function(w){(w=w.split(/\s*\n/)).length>1?v=v.concat(w.map(function(B,E){return(E&&B.length?`
`:"")+B})):v.push(w[0])}),g=v,l=HC.apply(this,[p,r])}for(a=0,s=g.length;a<s;a++){var y=0;if(n=g[a],l&&n[0]==`
`&&(n=n.substr(1),y=1),h+d+(m=(i=Kp.apply(this,[n,r])).reduce(function(w,B){return w+B},0))>t||y){if(m>t){for(o=KC.apply(this,[n,i,t-(h+d),t]),u.push(o.shift()),u=[o.pop()];o.length;)f.push([o.shift()]);m=i.slice(n.length-(u[0]?u[0].length:0)).reduce(function(w,B){return w+B},0)}else u=[n];f.push(u),h=m+l,d=x}else u.push(n),h+=d+m,d=x}return A=l?function(w,B){return(B?p:"")+w.join(" ")}:function(w){return w.join(" ")},f.map(A)},tu.splitTextToSize=function(e,t,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),a=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var f=this.internal.getFont(u.fontName,u.fontStyle);return f.metadata.Unicode?{widths:f.metadata.Unicode.widths||{0:1},kerning:f.metadata.Unicode.kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var s=1*this.internal.scaleFactor*t/i;a.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,a.lineIndent=r.lineIndent;var o,l,A=[];for(o=0,l=n.length;o<l;o++)A=A.concat(GC.apply(this,[n[o],s,a]));return A},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",r={},n={},i=0;i<t.length;i++)r[t[i]]="0123456789abcdef"[i],n["0123456789abcdef"[i]]=t[i];var a=function(f){return"0x"+parseInt(f,10).toString(16)},s=e.__fontmetrics__.compress=function(f){var h,d,m,g,x=["{"];for(var p in f){if(h=f[p],isNaN(parseInt(p,10))?d="'"+p+"'":(p=parseInt(p,10),d=(d=a(p).slice(2)).slice(0,-1)+n[d.slice(-1)]),typeof h=="number")h<0?(m=a(h).slice(3),g="-"):(m=a(h).slice(2),g=""),m=g+m.slice(0,-1)+n[m.slice(-1)];else{if(_r(h)!=="object")throw new Error("Don't know what to do with value type "+_r(h)+".");m=s(h)}x.push(d+m)}return x.push("}"),x.join("")},o=e.__fontmetrics__.uncompress=function(f){if(typeof f!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,d,m,g,x={},p=1,v=x,y=[],w="",B="",E=f.length-1,_=1;_<E;_+=1)(g=f[_])=="'"?h?(m=h.join(""),h=void 0):h=[]:h?h.push(g):g=="{"?(y.push([v,m]),v={},m=void 0):g=="}"?((d=y.pop())[0][d[1]]=v,m=void 0,v=d[0]):g=="-"?p=-1:m===void 0?r.hasOwnProperty(g)?(w+=r[g],m=parseInt(w,16)*p,p=1,w=""):w+=g:r.hasOwnProperty(g)?(B+=r[g],v[m]=parseInt(B,16)*p,p=1,m=void 0,B=""):B+=g;return x},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},A={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},u={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(f){var h=f.font,d=u.Unicode[h.postScriptName];d&&(h.metadata.Unicode={},h.metadata.Unicode.widths=d.widths,h.metadata.Unicode.kerning=d.kerning);var m=A.Unicode[h.postScriptName];m&&(h.metadata.Unicode.encoding=m,h.encoding=m.codePages[0])}])}(Ut.API),function(e){var t=function(r){for(var n=r.length,i=new Uint8Array(n),a=0;a<n;a++)i[a]=r.charCodeAt(a);return i};e.API.events.push(["addFont",function(r){var n=void 0,i=r.font,a=r.instance;if(!i.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=a.existsFileInVFS(i.postScriptName)===!1?a.loadFile(i.postScriptName):a.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(s,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(ed(o)),s.metadata=e.API.TTFFont.open(o),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(i,n)}}])}(Ut),function(e){function t(){return(jt.canvg?Promise.resolve(jt.canvg):Yl(()=>import("./index.es-DcfM2Kw_.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}Ut.API.addSvgAsImage=function(r,n,i,a,s,o,l,A){if(isNaN(n)||isNaN(i))throw Lr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(s))throw Lr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=a,u.height=s;var f=u.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,u.width,u.height);var h={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},d=this;return t().then(function(m){return m.fromString(f,r,h)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(m){return m.render(h)}).then(function(){d.addImage(u.toDataURL("image/jpeg",1),n,i,a,s,l,A)})}}(),Ut.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(t,r);return this},Ut.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,i,a,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(s),l=[],A=0,u=0,f=0;function h(m,g){var x,p=!1;for(x=0;x<m.length;x+=1)m[x]===g&&(p=!0);return p}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var d=o.length;for(f=0;f<d;f+=1)r[o[f]].value=r[o[f]].defaultValue,r[o[f]].explicitSet=!1}if(_r(e)==="object"){for(i in e)if(a=e[i],h(o,i)&&a!==void 0){if(r[i].type==="boolean"&&typeof a=="boolean")r[i].value=a;else if(r[i].type==="name"&&h(r[i].valueSet,a))r[i].value=a;else if(r[i].type==="integer"&&Number.isInteger(a))r[i].value=a;else if(r[i].type==="array"){for(A=0;A<a.length;A+=1)if(n=!0,a[A].length===1&&typeof a[A][0]=="number")l.push(String(a[A]-1));else if(a[A].length>1){for(u=0;u<a[A].length;u+=1)typeof a[A][u]!="number"&&(n=!1);n===!0&&l.push([a[A][0]-1,a[A][1]-1].join(" "))}r[i].value="["+l.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var m,g=[];for(m in r)r[m].explicitSet===!0&&(r[m].type==="name"?g.push("/"+m+" /"+r[m].value):g.push("/"+m+" "+r[m].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),A=a.length+s.length+o.length+i.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+A+" >>"),this.internal.write("stream"),this.internal.write(i+a+s+o+l),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(Ut.API),function(e){var t=e.API,r=t.pdfEscape16=function(a,s){for(var o,l=s.metadata.Unicode.widths,A=["","0","00","000","0000"],u=[""],f=0,h=a.length;f<h;++f){if(o=s.metadata.characterToGlyph(a.charCodeAt(f)),s.metadata.glyIdsUsed.push(o),s.metadata.toUnicode[o]=a.charCodeAt(f),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(s.metadata.widthOfGlyph(o),10)])),o=="0")return u.join("");o=o.toString(16),u.push(A[4-o.length],o)}return u.join("")},n=function(a){var s,o,l,A,u,f,h;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],f=0,h=(o=Object.keys(a).sort(function(d,m){return d-m})).length;f<h;f++)s=o[f],l.length>=100&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),a[s]!==void 0&&a[s]!==null&&typeof a[s].toString=="function"&&(A=("0000"+a[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),l.push("<"+s+"><"+A+">"));return l.length&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),u+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(a){(function(s){var o=s.font,l=s.out,A=s.newObject,u=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var f=o.metadata.Unicode.widths,h=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),d="",m=0;m<h.length;m++)d+=String.fromCharCode(h[m]);var g=A();u({data:d,addLength1:!0,objectId:g}),l("endobj");var x=A();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:x}),l("endobj");var p=A();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+fu(o.fontName)),l("/FontFile2 "+g+" 0 R"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var v=A();l("<<"),l("/Type /Font"),l("/BaseFont /"+fu(o.fontName)),l("/FontDescriptor "+p+" 0 R"),l("/W "+e.API.PDFObject.convert(f)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=A(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+x+" 0 R"),l("/BaseFont /"+fu(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+v+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(a)}]),t.events.push(["putFont",function(a){(function(s){var o=s.font,l=s.out,A=s.newObject,u=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var f=o.metadata.rawData,h="",d=0;d<f.length;d++)h+=String.fromCharCode(f[d]);var m=A();u({data:h,addLength1:!0,objectId:m}),l("endobj");var g=A();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:g}),l("endobj");var x=A();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+m+" 0 R"),l("/Flags 96"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+fu(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=A();for(var p=0;p<o.metadata.hmtx.widths.length;p++)o.metadata.hmtx.widths[p]=parseInt(o.metadata.hmtx.widths[p]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+fu(o.fontName)+"/FontDescriptor "+x+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(a)}]);var i=function(a){var s,o=a.text||"",l=a.x,A=a.y,u=a.options||{},f=a.mutex||{},h=f.pdfEscape,d=f.activeFontKey,m=f.fonts,g=d,x="",p=0,v="",y=m[g].encoding;if(m[g].encoding!=="Identity-H")return{text:o,x:l,y:A,options:u,mutex:f};for(v=o,g=d,Array.isArray(o)&&(v=o[0]),p=0;p<v.length;p+=1)m[g].metadata.hasOwnProperty("cmap")&&(s=m[g].metadata.cmap.unicode.codeMap[v[p].charCodeAt(0)]),s||v[p].charCodeAt(0)<256&&m[g].metadata.hasOwnProperty("Unicode")?x+=v[p]:x+="";var w="";return parseInt(g.slice(1))<14||y==="WinAnsiEncoding"?w=h(x,g).split("").map(function(B){return B.charCodeAt(0).toString(16)}).join(""):y==="Identity-H"&&(w=r(x,m[g])),f.isHex=!0,{text:w,x:l,y:A,options:u,mutex:f}};t.events.push(["postProcessText",function(a){var s=a.text||"",o=[],l={text:s,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(s)){var A=0;for(A=0;A<s.length;A+=1)Array.isArray(s[A])&&s[A].length===3?o.push([i(Object.assign({},l,{text:s[A][0]})).text,s[A][1],s[A][2]]):o.push(i(Object.assign({},l,{text:s[A]})).text);a.text=o}else a.text=i(Object.assign({},l,{text:s})).text}])}(Ut),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Ut.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var i,a,s,o,l,A,u,f=t,h=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],d=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},x=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],p=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),v=!1,y=0;this.__bidiEngine__={};var w=function(S){var C=S.charCodeAt(),L=C>>8,R=g[L];return R!==void 0?f[256*R+(255&C)]:L===252||L===253?"AL":p.test(L)?"L":L===8?"R":"N"},B=function(S){for(var C,L=0;L<S.length;L++){if((C=w(S.charAt(L)))==="L")return!1;if(C==="R")return!0}return!1},E=function(S,C,L,R){var W,G,V,X,Q=C[R];switch(Q){case"L":case"R":v=!1;break;case"N":case"AN":break;case"EN":v&&(Q="AN");break;case"AL":v=!0,Q="R";break;case"WS":Q="N";break;case"CS":R<1||R+1>=C.length||(W=L[R-1])!=="EN"&&W!=="AN"||(G=C[R+1])!=="EN"&&G!=="AN"?Q="N":v&&(G="AN"),Q=G===W?G:"N";break;case"ES":Q=(W=R>0?L[R-1]:"B")==="EN"&&R+1<C.length&&C[R+1]==="EN"?"EN":"N";break;case"ET":if(R>0&&L[R-1]==="EN"){Q="EN";break}if(v){Q="N";break}for(V=R+1,X=C.length;V<X&&C[V]==="ET";)V++;Q=V<X&&C[V]==="EN"?"EN":"N";break;case"NSM":if(s&&!o){for(X=C.length,V=R+1;V<X&&C[V]==="NSM";)V++;if(V<X){var K=S[R],H=K>=1425&&K<=2303||K===64286;if(W=C[V],H&&(W==="R"||W==="AL")){Q="R";break}}}Q=R<1||(W=C[R-1])==="B"?"N":L[R-1];break;case"B":v=!1,i=!0,Q=y;break;case"S":a=!0,Q="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":v=!1;break;case"BN":Q="N"}return Q},_=function(S,C,L){var R=S.split("");return L&&F(R,L,{hiLevel:y}),R.reverse(),C&&C.reverse(),R.join("")},F=function(S,C,L){var R,W,G,V,X,Q=-1,K=S.length,H=0,k=[],U=y?d:h,P=[];for(v=!1,i=!1,a=!1,W=0;W<K;W++)P[W]=w(S[W]);for(G=0;G<K;G++){if(X=H,k[G]=E(S,P,k,G),R=240&(H=U[X][m[k[G]]]),H&=15,C[G]=V=U[H][5],R>0)if(R===16){for(W=Q;W<G;W++)C[W]=1;Q=-1}else Q=-1;if(U[H][6])Q===-1&&(Q=G);else if(Q>-1){for(W=Q;W<G;W++)C[W]=V;Q=-1}P[G]==="B"&&(C[G]=0),L.hiLevel|=V}a&&function(D,O,z){for(var J=0;J<z;J++)if(D[J]==="S"){O[J]=y;for(var Y=J-1;Y>=0&&D[Y]==="WS";Y--)O[Y]=y}}(P,C,K)},T=function(S,C,L,R,W){if(!(W.hiLevel<S)){if(S===1&&y===1&&!i)return C.reverse(),void(L&&L.reverse());for(var G,V,X,Q,K=C.length,H=0;H<K;){if(R[H]>=S){for(X=H+1;X<K&&R[X]>=S;)X++;for(Q=H,V=X-1;Q<V;Q++,V--)G=C[Q],C[Q]=C[V],C[V]=G,L&&(G=L[Q],L[Q]=L[V],L[V]=G);H=X}H++}}},I=function(S,C,L){var R=S.split(""),W={hiLevel:y};return L||(L=[]),F(R,L,W),function(G,V,X){if(X.hiLevel!==0&&u)for(var Q,K=0;K<G.length;K++)V[K]===1&&(Q=x.indexOf(G[K]))>=0&&(G[K]=x[Q+1])}(R,L,W),T(2,R,C,L,W),T(1,R,C,L,W),R.join("")};return this.__bidiEngine__.doBidiReorder=function(S,C,L){if(function(W,G){if(G)for(var V=0;V<W.length;V++)G[V]=V;o===void 0&&(o=B(W)),A===void 0&&(A=B(W))}(S,C),s||!l||A)if(s&&l&&o^A)y=o?1:0,S=_(S,C,L);else if(!s&&l&&A)y=o?1:0,S=I(S,C,L),S=_(S,C);else if(!s||o||l||A){if(s&&!l&&o^A)S=_(S,C),o?(y=0,S=I(S,C,L)):(y=1,S=I(S,C,L),S=_(S,C));else if(s&&o&&!l&&A)y=1,S=I(S,C,L),S=_(S,C);else if(!s&&!l&&o^A){var R=u;o?(y=1,S=I(S,C,L),y=0,u=!1,S=I(S,C,L),u=R):(y=0,S=I(S,C,L),S=_(S,C),y=1,u=!1,S=I(S,C,L),u=R,S=_(S,C))}}else y=0,S=I(S,C,L);else y=o?1:0,S=I(S,C,L);return S},this.__bidiEngine__.setOptions=function(S){S&&(s=S.isInputVisual,l=S.isOutputVisual,o=S.isInputRtl,A=S.isOutputRtl,u=S.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var i=n.text,a=(n.x,n.y,n.options||{}),s=(n.mutex,a.lang,[]);if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,r.setOptions(a),Object.prototype.toString.call(i)==="[object Array]"){var o=0;for(s=[],o=0;o<i.length;o+=1)Object.prototype.toString.call(i[o])==="[object Array]"?s.push([r.doBidiReorder(i[o][0]),i[o][1],i[o][2]]):s.push([r.doBidiReorder(i[o])]);n.text=s}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])}(Ut),Ut.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new iA(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new Xre(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new jre(this.contents),this.head=new Pre(this),this.name=new Kre(this),this.cmap=new n6(this),this.toUnicode={},this.hhea=new Qre(this),this.maxp=new Gre(this),this.hmtx=new Vre(this),this.post=new Mre(this),this.os2=new Rre(this),this.loca=new zre(this),this.glyf=new Wre(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,i,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,o,l,A;for(A=[],s=0,o=(l=this.bbox).length;s<o;s++)t=l[s],A.push(Math.round(t*this.scaleFactor));return A}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(r=i>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var i,a,s,o;for(s=0,a=0,o=(t=""+t).length;0<=o?a<o:a>o;a=0<=o?++a:--a)i=t.charCodeAt(a),s+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return s*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var js,iA=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,i;for(i=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(t.charCodeAt(r)));return i},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,i,a,s,o,l;return t=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),a=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^a)+65536*(255^s)+256*(255^o)+(255^l)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*i+16777216*a+65536*s+256*o+l},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,i,a;for(a=[],n=0,i=t.length;n<i;n++)r=t[n],a.push(this.writeByte(r));return a},e}(),jre=function(){var e;function t(r){var n,i,a;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,a=this.tableCount;0<=a?i<a:i>a;i=0<=a?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,i,a,s,o,l,A,u,f,h,d,m,g;for(g in d=Object.keys(r).length,l=Math.log(2),f=16*Math.floor(Math.log(d)/l),s=Math.floor(f/l),u=16*d-f,(i=new iA).writeInt(this.scalarType),i.writeShort(d),i.writeShort(f),i.writeShort(s),i.writeShort(u),a=16*d,A=i.pos+a,o=null,m=[],r)for(h=r[g],i.writeString(g),i.writeInt(e(h)),i.writeInt(A),i.writeInt(h.length),m=m.concat(h),g==="head"&&(o=A),A+=h.length;A%4;)m.push(0),A++;return i.write(m),n=2981146554-e(i.data),i.pos=o+8,i.writeUInt32(n),i.data},e=function(r){var n,i,a,s;for(r=i6.call(r);r.length%4;)r.push(0);for(a=new iA(r),i=0,n=0,s=r.length;n<s;n=n+=4)i+=a.readUInt32();return 4294967295&i},t}(),Dre={}.hasOwnProperty,lo=function(e,t){for(var r in t)Dre.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};js=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var Pre=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return lo(t,js),t.prototype.tag="head",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},t.prototype.encode=function(r){var n;return(n=new iA).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},t}(),$C=function(){function e(t,r){var n,i,a,s,o,l,A,u,f,h,d,m,g,x,p,v,y;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=t.readByte();break;case 4:for(d=t.readUInt16(),h=d/2,t.pos+=6,a=function(){var w,B;for(B=[],l=w=0;0<=h?w<h:w>h;l=0<=h?++w:--w)B.push(t.readUInt16());return B}(),t.pos+=2,g=function(){var w,B;for(B=[],l=w=0;0<=h?w<h:w>h;l=0<=h?++w:--w)B.push(t.readUInt16());return B}(),A=function(){var w,B;for(B=[],l=w=0;0<=h?w<h:w>h;l=0<=h?++w:--w)B.push(t.readUInt16());return B}(),u=function(){var w,B;for(B=[],l=w=0;0<=h?w<h:w>h;l=0<=h?++w:--w)B.push(t.readUInt16());return B}(),i=(this.length-t.pos+this.offset)/2,o=function(){var w,B;for(B=[],l=w=0;0<=i?w<i:w>i;l=0<=i?++w:--w)B.push(t.readUInt16());return B}(),l=p=0,y=a.length;p<y;l=++p)for(x=a[l],n=v=m=g[l];m<=x?v<=x:v>=x;n=m<=x?++v:--v)u[l]===0?s=n+A[l]:(s=o[u[l]/2+(n-m)-(h-l)]||0)!==0&&(s+=A[l]),this.codeMap[n]=65535&s}t.pos=f}return e.encode=function(t,r){var n,i,a,s,o,l,A,u,f,h,d,m,g,x,p,v,y,w,B,E,_,F,T,I,S,C,L,R,W,G,V,X,Q,K,H,k,U,P,D,O,z,J,Y,le,we,ne;switch(R=new iA,s=Object.keys(t).sort(function(Me,qe){return Me-qe}),r){case"macroman":for(g=0,x=function(){var Me=[];for(m=0;m<256;++m)Me.push(0);return Me}(),v={0:0},a={},W=0,Q=s.length;W<Q;W++)v[Y=t[i=s[W]]]==null&&(v[Y]=++g),a[i]={old:t[i],new:v[t[i]]},x[i]=v[t[i]];return R.writeUInt16(1),R.writeUInt16(0),R.writeUInt32(12),R.writeUInt16(0),R.writeUInt16(262),R.writeUInt16(0),R.write(x),{charMap:a,subtable:R.data,maxGlyphID:g+1};case"unicode":for(C=[],f=[],y=0,v={},n={},p=A=null,G=0,K=s.length;G<K;G++)v[B=t[i=s[G]]]==null&&(v[B]=++y),n[i]={old:B,new:v[B]},o=v[B]-i,p!=null&&o===A||(p&&f.push(p),C.push(i),A=o),p=i;for(p&&f.push(p),f.push(65535),C.push(65535),I=2*(T=C.length),F=2*Math.pow(Math.log(T)/Math.LN2,2),h=Math.log(F/2)/Math.LN2,_=2*T-F,l=[],E=[],d=[],m=V=0,H=C.length;V<H;m=++V){if(S=C[m],u=f[m],S===65535){l.push(0),E.push(0);break}if(S-(L=n[S].new)>=32768)for(l.push(0),E.push(2*(d.length+T-m)),i=X=S;S<=u?X<=u:X>=u;i=S<=u?++X:--X)d.push(n[i].new);else l.push(L-S),E.push(0)}for(R.writeUInt16(3),R.writeUInt16(1),R.writeUInt32(12),R.writeUInt16(4),R.writeUInt16(16+8*T+2*d.length),R.writeUInt16(0),R.writeUInt16(I),R.writeUInt16(F),R.writeUInt16(h),R.writeUInt16(_),z=0,k=f.length;z<k;z++)i=f[z],R.writeUInt16(i);for(R.writeUInt16(0),J=0,U=C.length;J<U;J++)i=C[J],R.writeUInt16(i);for(le=0,P=l.length;le<P;le++)o=l[le],R.writeUInt16(o);for(we=0,D=E.length;we<D;we++)w=E[we],R.writeUInt16(w);for(ne=0,O=d.length;ne<O;ne++)g=d[ne],R.writeUInt16(g);return{charMap:n,subtable:R.data,maxGlyphID:y+1}}},e}(),n6=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return lo(t,js),t.prototype.tag="cmap",t.prototype.parse=function(r){var n,i,a;for(r.pos=this.offset,this.version=r.readUInt16(),a=r.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=a?i<a:i>a;i=0<=a?++i:--i)n=new $C(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(r,n){var i,a;return n==null&&(n="macroman"),i=$C.encode(r,n),(a=new iA).writeUInt16(0),a.writeUInt16(1),i.table=a.data.concat(i.subtable),i},t}(),Qre=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return lo(t,js),t.prototype.tag="hhea",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},t}(),Rre=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return lo(t,js),t.prototype.tag="OS/2",t.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var n,i;for(i=[],n=0;n<10;++n)i.push(r.readByte());return i}(),this.charRange=function(){var n,i;for(i=[],n=0;n<4;++n)i.push(r.readInt());return i}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var n,i;for(i=[],n=0;n<2;n=++n)i.push(r.readInt());return i}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},t}(),Mre=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return lo(t,js),t.prototype.tag="post",t.prototype.parse=function(r){var n,i,a;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var s;for(i=r.readUInt16(),this.glyphNameIndex=[],s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],a=[];r.pos<this.offset+this.length;)n=r.readByte(),a.push(this.names.push(r.readString(n)));return a;case 151552:return i=r.readUInt16(),this.offsets=r.read(i);case 196608:break;case 262144:return this.map=(function(){var o,l,A;for(A=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)A.push(r.readUInt32());return A}).call(this)}},t}(),Hre=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},Kre=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return lo(t,js),t.prototype.tag="name",t.prototype.parse=function(r){var n,i,a,s,o,l,A,u,f,h,d;for(r.pos=this.offset,r.readShort(),n=r.readShort(),l=r.readShort(),i=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)i.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+l+r.readShort()});for(A={},s=f=0,h=i.length;f<h;s=++f)a=i[s],r.pos=a.offset,u=r.readString(a.length),o=new Hre(u,a),A[d=a.nameID]==null&&(A[d]=[]),A[a.nameID].push(o);this.strings=A,this.copyright=A[0],this.fontFamily=A[1],this.fontSubfamily=A[2],this.uniqueSubfamily=A[3],this.fontName=A[4],this.version=A[5];try{this.postscriptName=A[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=A[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=A[7],this.manufacturer=A[8],this.designer=A[9],this.description=A[10],this.vendorUrl=A[11],this.designerUrl=A[12],this.license=A[13],this.licenseUrl=A[14],this.preferredFamily=A[15],this.preferredSubfamily=A[17],this.compatibleFull=A[18],this.sampleText=A[19]},t}(),Gre=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return lo(t,js),t.prototype.tag="maxp",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},t}(),Vre=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return lo(t,js),t.prototype.tag="hmtx",t.prototype.parse=function(r){var n,i,a,s,o,l,A;for(r.pos=this.offset,this.metrics=[],n=0,l=this.file.hhea.numberOfMetrics;0<=l?n<l:n>l;n=0<=l?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,f;for(f=[],n=u=0;0<=a?u<a:u>a;n=0<=a?++u:--u)f.push(r.readInt16());return f}(),this.widths=(function(){var u,f,h,d;for(d=[],u=0,f=(h=this.metrics).length;u<f;u++)s=h[u],d.push(s.advance);return d}).call(this),i=this.widths[this.widths.length-1],A=[],n=o=0;0<=a?o<a:o>a;n=0<=a?++o:--o)A.push(this.widths.push(i));return A},t.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},t}(),i6=[].slice,Wre=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return lo(t,js),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(r){var n,i,a,s,o,l,A,u,f,h;return r in this.cache?this.cache[r]:(s=this.file.loca,n=this.file.contents,i=s.indexOf(r),(a=s.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+i,o=(l=new iA(n.read(a))).readShort(),u=l.readShort(),h=l.readShort(),A=l.readShort(),f=l.readShort(),this.cache[r]=o===-1?new qre(l,u,h,A,f):new $re(l,o,u,h,A,f),this.cache[r]))},t.prototype.encode=function(r,n,i){var a,s,o,l,A;for(o=[],s=[],l=0,A=n.length;l<A;l++)a=r[n[l]],s.push(o.length),a&&(o=o.concat(a.encode(i)));return s.push(o.length),{table:o,offsets:s}},t}(),$re=function(){function e(t,r,n,i,a,s){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=a,this.yMax=s,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),qre=function(){function e(t,r,n,i,a){var s,o;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;o=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&o;)s.pos+=1&o?4:2,128&o?s.pos+=8:64&o?s.pos+=4:8&o&&(s.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new iA(i6.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),zre=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return lo(t,js),t.prototype.tag="loca",t.prototype.parse=function(r){var n,i;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var a,s;for(s=[],i=0,a=this.length;i<a;i+=2)s.push(2*r.readUInt16());return s}).call(this):(function(){var a,s;for(s=[],i=0,a=this.length;i<a;i+=4)s.push(r.readUInt32());return s}).call(this)},t.prototype.indexOf=function(r){return this.offsets[r]},t.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},t.prototype.encode=function(r,n){for(var i=new Uint32Array(this.offsets.length),a=0,s=0,o=0;o<i.length;++o)if(i[o]=a,s<n.length&&n[s]==o){++s,i[o]=a;var l=this.offsets[o],A=this.offsets[o+1]-l;A>0&&(a+=A)}for(var u=new Array(4*i.length),f=0;f<i.length;++f)u[4*f+3]=255&i[f],u[4*f+2]=(65280&i[f])>>8,u[4*f+1]=(16711680&i[f])>>16,u[4*f]=(4278190080&i[f])>>24;return u},t}(),Xre=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,i,a;for(r in i=this.font.cmap.tables[0].codeMap,t={},a=this.subset)n=a[r],t[r]=i[n];return t},e.prototype.glyphsFor=function(t){var r,n,i,a,s,o,l;for(i={},s=0,o=t.length;s<o;s++)i[a=t[s]]=this.font.glyf.glyphFor(a);for(a in r=[],i)(n=i[a])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(a in l=this.glyphsFor(r))n=l[a],i[a]=n;return i},e.prototype.encode=function(t,r){var n,i,a,s,o,l,A,u,f,h,d,m,g,x,p;for(i in n=n6.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(t),d={0:0},p=n.charMap)d[(l=p[i]).old]=l.new;for(m in h=n.maxGlyphID,s)m in d||(d[m]=h++);return u=function(v){var y,w;for(y in w={},v)w[v[y]]=y;return w}(d),f=Object.keys(u).sort(function(v,y){return v-y}),g=function(){var v,y,w;for(w=[],v=0,y=f.length;v<y;v++)o=f[v],w.push(u[o]);return w}(),a=this.font.glyf.encode(s,g,d),A=this.font.loca.encode(a.offsets,g),x={cmap:this.font.cmap.raw(),glyf:a.table,loca:A,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(x["OS/2"]=this.font.os2.raw()),this.font.directory.encode(x)},e}();Ut.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,i,a,s;if(Array.isArray(r))return"["+function(){var o,l,A;for(A=[],o=0,l=r.length;o<l;o++)n=r[o],A.push(t.convert(n));return A}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in a=["<<"],r)s=r[i],a.push("/"+i+" "+t.convert(s));return a.push(">>"),a.join(`
`)}return""+r},t}();const Yre=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:kre,AcroFormAppearance:Bt,AcroFormButton:Un,AcroFormCheckBox:nd,AcroFormChoiceField:WA,AcroFormComboBox:qA,AcroFormEditBox:td,AcroFormListBox:$A,AcroFormPasswordField:id,AcroFormPushButton:rd,AcroFormRadioButton:zA,AcroFormTextField:Wl,GState:$d,ShadingPattern:Sl,TilingPattern:PA,default:Ut,jsPDF:Ut},Symbol.toStringTag,{value:"Module"}));var Jre={exports:{}};const Zre=YS(Yre);/*!
 * 
 *               jsPDF AutoTable plugin v3.8.4
 *
 *               Copyright (c) 2024 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */(function(e,t){(function(n,i){e.exports=i(function(){try{return Zre}catch{}}())})(typeof globalThis<"u"?globalThis:typeof kr<"u"?kr:typeof window<"u"?window:typeof self<"u"?self:kr,function(r){return function(){var n={172:function(o,l){var A=this&&this.__extends||function(){var h=function(d,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,x){g.__proto__=x}||function(g,x){for(var p in x)Object.prototype.hasOwnProperty.call(x,p)&&(g[p]=x[p])},h(d,m)};return function(d,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(d,m);function g(){this.constructor=d}d.prototype=m===null?Object.create(m):(g.prototype=m.prototype,new g)}}();Object.defineProperty(l,"__esModule",{value:!0}),l.CellHookData=l.HookData=void 0;var u=function(){function h(d,m,g){this.table=m,this.pageNumber=m.pageNumber,this.pageCount=this.pageNumber,this.settings=m.settings,this.cursor=g,this.doc=d.getDocument()}return h}();l.HookData=u;var f=function(h){A(d,h);function d(m,g,x,p,v,y){var w=h.call(this,m,g,y)||this;return w.cell=x,w.row=p,w.column=v,w.section=p.section,w}return d}(u);l.CellHookData=f},340:function(o,l,A){Object.defineProperty(l,"__esModule",{value:!0});var u=A(4),f=A(136),h=A(744),d=A(776),m=A(664),g=A(972);function x(p){p.API.autoTable=function(){for(var v=[],y=0;y<arguments.length;y++)v[y]=arguments[y];var w;v.length===1?w=v[0]:(console.error("Use of deprecated autoTable initiation"),w=v[2]||{},w.columns=v[0],w.body=v[1]);var B=(0,d.parseInput)(this,w),E=(0,g.createTable)(this,B);return(0,m.drawTable)(this,E),this},p.API.lastAutoTable=!1,p.API.previousAutoTable=!1,p.API.autoTable.previous=!1,p.API.autoTableText=function(v,y,w,B){(0,f.default)(v,y,w,B,this)},p.API.autoTableSetDefaults=function(v){return h.DocHandler.setDefaults(v,this),this},p.autoTableSetDefaults=function(v,y){h.DocHandler.setDefaults(v,y)},p.API.autoTableHtmlToJson=function(v,y){var w;if(y===void 0&&(y=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var B=new h.DocHandler(this),E=(0,u.parseHtml)(B,v,window,y,!1),_=E.head,F=E.body,T=((w=_[0])===null||w===void 0?void 0:w.map(function(I){return I.content}))||[];return{columns:T,rows:F,data:F}},p.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var v=this.lastAutoTable;return v&&v.finalY?v.finalY:0},p.API.autoTableAddPageContent=function(v){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),p.API.autoTable.globalDefaults||(p.API.autoTable.globalDefaults={}),p.API.autoTable.globalDefaults.addPageContent=v,this},p.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}l.default=x},136:function(o,l){Object.defineProperty(l,"__esModule",{value:!0});function A(u,f,h,d,m){d=d||{};var g=1.15,x=m.internal.scaleFactor,p=m.internal.getFontSize()/x,v=m.getLineHeightFactor?m.getLineHeightFactor():g,y=p*v,w=/\r\n|\r|\n/g,B="",E=1;if((d.valign==="middle"||d.valign==="bottom"||d.halign==="center"||d.halign==="right")&&(B=typeof u=="string"?u.split(w):u,E=B.length||1),h+=p*(2-g),d.valign==="middle"?h-=E/2*y:d.valign==="bottom"&&(h-=E*y),d.halign==="center"||d.halign==="right"){var _=p;if(d.halign==="center"&&(_*=.5),B&&E>=1){for(var F=0;F<B.length;F++)m.text(B[F],f-m.getStringUnitWidth(B[F])*_,h),h+=y;return m}f-=m.getStringUnitWidth(u)*_}return d.halign==="justify"?m.text(u,f,h,{maxWidth:d.maxWidth||100,align:"justify"}):m.text(u,f,h),m}l.default=A},420:function(o,l){Object.defineProperty(l,"__esModule",{value:!0}),l.getPageAvailableWidth=l.parseSpacing=l.getFillStyle=l.addTableBorder=l.getStringWidth=void 0;function A(m,g,x){x.applyStyles(g,!0);var p=Array.isArray(m)?m:[m],v=p.map(function(y){return x.getTextWidth(y)}).reduce(function(y,w){return Math.max(y,w)},0);return v}l.getStringWidth=A;function u(m,g,x,p){var v=g.settings.tableLineWidth,y=g.settings.tableLineColor;m.applyStyles({lineWidth:v,lineColor:y});var w=f(v,!1);w&&m.rect(x.x,x.y,g.getWidth(m.pageSize().width),p.y-x.y,w)}l.addTableBorder=u;function f(m,g){var x=m>0,p=g||g===0;return x&&p?"DF":x?"S":p?"F":null}l.getFillStyle=f;function h(m,g){var x,p,v,y;if(m=m||g,Array.isArray(m)){if(m.length>=4)return{top:m[0],right:m[1],bottom:m[2],left:m[3]};if(m.length===3)return{top:m[0],right:m[1],bottom:m[2],left:m[1]};if(m.length===2)return{top:m[0],right:m[1],bottom:m[0],left:m[1]};m.length===1?m=m[0]:m=g}return typeof m=="object"?(typeof m.vertical=="number"&&(m.top=m.vertical,m.bottom=m.vertical),typeof m.horizontal=="number"&&(m.right=m.horizontal,m.left=m.horizontal),{left:(x=m.left)!==null&&x!==void 0?x:g,top:(p=m.top)!==null&&p!==void 0?p:g,right:(v=m.right)!==null&&v!==void 0?v:g,bottom:(y=m.bottom)!==null&&y!==void 0?y:g}):(typeof m!="number"&&(m=g),{top:m,right:m,bottom:m,left:m})}l.parseSpacing=h;function d(m,g){var x=h(g.settings.margin,0);return m.pageSize().width-(x.left+x.right)}l.getPageAvailableWidth=d},796:function(o,l){var A=this&&this.__extends||function(){var d=function(m,g){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,p){x.__proto__=p}||function(x,p){for(var v in p)Object.prototype.hasOwnProperty.call(p,v)&&(x[v]=p[v])},d(m,g)};return function(m,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");d(m,g);function x(){this.constructor=m}m.prototype=g===null?Object.create(g):(x.prototype=g.prototype,new x)}}();Object.defineProperty(l,"__esModule",{value:!0}),l.getTheme=l.defaultStyles=l.HtmlRowInput=void 0;var u=function(d){A(m,d);function m(g){var x=d.call(this)||this;return x._element=g,x}return m}(Array);l.HtmlRowInput=u;function f(d){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/d,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}l.defaultStyles=f;function h(d){var m={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return m[d]}l.getTheme=h},903:function(o,l,A){Object.defineProperty(l,"__esModule",{value:!0}),l.parseCss=void 0;var u=A(420);function f(x,p,v,y,w){var B={},E=1.3333333333333333,_=d(p,function(Q){return w.getComputedStyle(Q).backgroundColor});_!=null&&(B.fillColor=_);var F=d(p,function(Q){return w.getComputedStyle(Q).color});F!=null&&(B.textColor=F);var T=g(y,v);T&&(B.cellPadding=T);var I="borderTopColor",S=E*v,C=y.borderTopWidth;if(y.borderBottomWidth===C&&y.borderRightWidth===C&&y.borderLeftWidth===C){var L=(parseFloat(C)||0)/S;L&&(B.lineWidth=L)}else B.lineWidth={top:(parseFloat(y.borderTopWidth)||0)/S,right:(parseFloat(y.borderRightWidth)||0)/S,bottom:(parseFloat(y.borderBottomWidth)||0)/S,left:(parseFloat(y.borderLeftWidth)||0)/S},B.lineWidth.top||(B.lineWidth.right?I="borderRightColor":B.lineWidth.bottom?I="borderBottomColor":B.lineWidth.left&&(I="borderLeftColor"));var R=d(p,function(Q){return w.getComputedStyle(Q)[I]});R!=null&&(B.lineColor=R);var W=["left","right","center","justify"];W.indexOf(y.textAlign)!==-1&&(B.halign=y.textAlign),W=["middle","bottom","top"],W.indexOf(y.verticalAlign)!==-1&&(B.valign=y.verticalAlign);var G=parseInt(y.fontSize||"");isNaN(G)||(B.fontSize=G/E);var V=h(y);V&&(B.fontStyle=V);var X=(y.fontFamily||"").toLowerCase();return x.indexOf(X)!==-1&&(B.font=X),B}l.parseCss=f;function h(x){var p="";return(x.fontWeight==="bold"||x.fontWeight==="bolder"||parseInt(x.fontWeight)>=700)&&(p="bold"),(x.fontStyle==="italic"||x.fontStyle==="oblique")&&(p+="italic"),p}function d(x,p){var v=m(x,p);if(!v)return null;var y=v.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!y||!Array.isArray(y))return null;var w=[parseInt(y[1]),parseInt(y[2]),parseInt(y[3])],B=parseInt(y[4]);return B===0||isNaN(w[0])||isNaN(w[1])||isNaN(w[2])?null:w}function m(x,p){var v=p(x);return v==="rgba(0, 0, 0, 0)"||v==="transparent"||v==="initial"||v==="inherit"?x.parentElement==null?null:m(x.parentElement,p):v}function g(x,p){var v=[x.paddingTop,x.paddingRight,x.paddingBottom,x.paddingLeft],y=96/(72/p),w=(parseInt(x.lineHeight)-parseInt(x.fontSize))/p/2,B=v.map(function(_){return parseInt(_||"0")/y}),E=(0,u.parseSpacing)(B,0);return w>E.top&&(E.top=w),w>E.bottom&&(E.bottom=w),E}},744:function(o,l){Object.defineProperty(l,"__esModule",{value:!0}),l.DocHandler=void 0;var A={},u=function(){function f(h){this.jsPDFDocument=h,this.userStyles={textColor:h.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:h.internal.getFontSize(),fontStyle:h.internal.getFont().fontStyle,font:h.internal.getFont().fontName,lineWidth:h.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:h.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return f.setDefaults=function(h,d){d===void 0&&(d=null),d?d.__autoTableDocumentDefaults=h:A=h},f.unifyColor=function(h){return Array.isArray(h)?h:typeof h=="number"?[h,h,h]:typeof h=="string"?[h]:null},f.prototype.applyStyles=function(h,d){var m,g,x;d===void 0&&(d=!1),h.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(h.fontStyle);var p=this.jsPDFDocument.internal.getFont(),v=p.fontStyle,y=p.fontName;if(h.font&&(y=h.font),h.fontStyle){v=h.fontStyle;var w=this.getFontList()[y];w&&w.indexOf(v)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(w[0]),v=w[0])}if(this.jsPDFDocument.setFont(y,v),h.fontSize&&this.jsPDFDocument.setFontSize(h.fontSize),!d){var B=f.unifyColor(h.fillColor);B&&(m=this.jsPDFDocument).setFillColor.apply(m,B),B=f.unifyColor(h.textColor),B&&(g=this.jsPDFDocument).setTextColor.apply(g,B),B=f.unifyColor(h.lineColor),B&&(x=this.jsPDFDocument).setDrawColor.apply(x,B),typeof h.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(h.lineWidth)}},f.prototype.splitTextToSize=function(h,d,m){return this.jsPDFDocument.splitTextToSize(h,d,m)},f.prototype.rect=function(h,d,m,g,x){return this.jsPDFDocument.rect(h,d,m,g,x)},f.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},f.prototype.getTextWidth=function(h){return this.jsPDFDocument.getTextWidth(h)},f.prototype.getDocument=function(){return this.jsPDFDocument},f.prototype.setPage=function(h){this.jsPDFDocument.setPage(h)},f.prototype.addPage=function(){return this.jsPDFDocument.addPage()},f.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},f.prototype.getGlobalOptions=function(){return A||{}},f.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},f.prototype.pageSize=function(){var h=this.jsPDFDocument.internal.pageSize;return h.width==null&&(h={width:h.getWidth(),height:h.getHeight()}),h},f.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},f.prototype.getLineHeightFactor=function(){var h=this.jsPDFDocument;return h.getLineHeightFactor?h.getLineHeightFactor():1.15},f.prototype.getLineHeight=function(h){return h/this.scaleFactor()*this.getLineHeightFactor()},f.prototype.pageNumber=function(){var h=this.jsPDFDocument.internal.getCurrentPageInfo();return h?h.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},f}();l.DocHandler=u},4:function(o,l,A){Object.defineProperty(l,"__esModule",{value:!0}),l.parseHtml=void 0;var u=A(903),f=A(796);function h(g,x,p,v,y){var w,B;v===void 0&&(v=!1),y===void 0&&(y=!1);var E;typeof x=="string"?E=p.document.querySelector(x):E=x;var _=Object.keys(g.getFontList()),F=g.scaleFactor(),T=[],I=[],S=[];if(!E)return console.error("Html table could not be found with input: ",x),{head:T,body:I,foot:S};for(var C=0;C<E.rows.length;C++){var L=E.rows[C],R=(B=(w=L==null?void 0:L.parentElement)===null||w===void 0?void 0:w.tagName)===null||B===void 0?void 0:B.toLowerCase(),W=d(_,F,p,L,v,y);W&&(R==="thead"?T.push(W):R==="tfoot"?S.push(W):I.push(W))}return{head:T,body:I,foot:S}}l.parseHtml=h;function d(g,x,p,v,y,w){for(var B=new f.HtmlRowInput(v),E=0;E<v.cells.length;E++){var _=v.cells[E],F=p.getComputedStyle(_);if(y||F.display!=="none"){var T=void 0;w&&(T=(0,u.parseCss)(g,_,x,F,p)),B.push({rowSpan:_.rowSpan,colSpan:_.colSpan,styles:T,_element:_,content:m(_)})}}var I=p.getComputedStyle(v);if(B.length>0&&(y||I.display!=="none"))return B}function m(g){var x=g.cloneNode(!0);return x.innerHTML=x.innerHTML.replace(/\n/g,"").replace(/ +/g," "),x.innerHTML=x.innerHTML.split(/<br.*?>/).map(function(p){return p.trim()}).join(`
`),x.innerText||x.textContent||""}},776:function(o,l,A){Object.defineProperty(l,"__esModule",{value:!0}),l.parseInput=void 0;var u=A(4),f=A(356),h=A(420),d=A(744),m=A(792);function g(E,_){var F=new d.DocHandler(E),T=F.getDocumentOptions(),I=F.getGlobalOptions();(0,m.default)(F,I,T,_);var S=(0,f.assign)({},I,T,_),C;typeof window<"u"&&(C=window);var L=x(I,T,_),R=p(I,T,_),W=v(F,S),G=w(F,S,C);return{id:_.tableId,content:G,hooks:R,styles:L,settings:W}}l.parseInput=g;function x(E,_,F){for(var T={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},I=function(R){if(R==="columnStyles"){var W=E[R],G=_[R],V=F[R];T.columnStyles=(0,f.assign)({},W,G,V)}else{var X=[E,_,F],Q=X.map(function(K){return K[R]||{}});T[R]=(0,f.assign)({},Q[0],Q[1],Q[2])}},S=0,C=Object.keys(T);S<C.length;S++){var L=C[S];I(L)}return T}function p(E,_,F){for(var T=[E,_,F],I={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},S=0,C=T;S<C.length;S++){var L=C[S];L.didParseCell&&I.didParseCell.push(L.didParseCell),L.willDrawCell&&I.willDrawCell.push(L.willDrawCell),L.didDrawCell&&I.didDrawCell.push(L.didDrawCell),L.willDrawPage&&I.willDrawPage.push(L.willDrawPage),L.didDrawPage&&I.didDrawPage.push(L.didDrawPage)}return I}function v(E,_){var F,T,I,S,C,L,R,W,G,V,X,Q,K=(0,h.parseSpacing)(_.margin,40/E.scaleFactor()),H=(F=y(E,_.startY))!==null&&F!==void 0?F:K.top,k;_.showFoot===!0?k="everyPage":_.showFoot===!1?k="never":k=(T=_.showFoot)!==null&&T!==void 0?T:"everyPage";var U;_.showHead===!0?U="everyPage":_.showHead===!1?U="never":U=(I=_.showHead)!==null&&I!==void 0?I:"everyPage";var P=(S=_.useCss)!==null&&S!==void 0?S:!1,D=_.theme||(P?"plain":"striped"),O=!!_.horizontalPageBreak,z=(C=_.horizontalPageBreakRepeat)!==null&&C!==void 0?C:null;return{includeHiddenHtml:(L=_.includeHiddenHtml)!==null&&L!==void 0?L:!1,useCss:P,theme:D,startY:H,margin:K,pageBreak:(R=_.pageBreak)!==null&&R!==void 0?R:"auto",rowPageBreak:(W=_.rowPageBreak)!==null&&W!==void 0?W:"auto",tableWidth:(G=_.tableWidth)!==null&&G!==void 0?G:"auto",showHead:U,showFoot:k,tableLineWidth:(V=_.tableLineWidth)!==null&&V!==void 0?V:0,tableLineColor:(X=_.tableLineColor)!==null&&X!==void 0?X:200,horizontalPageBreak:O,horizontalPageBreakRepeat:z,horizontalPageBreakBehaviour:(Q=_.horizontalPageBreakBehaviour)!==null&&Q!==void 0?Q:"afterAllRows"}}function y(E,_){var F=E.getLastAutoTable(),T=E.scaleFactor(),I=E.pageNumber(),S=!1;if(F&&F.startPageNumber){var C=F.startPageNumber+F.pageNumber-1;S=C===I}return typeof _=="number"?_:(_==null||_===!1)&&S&&(F==null?void 0:F.finalY)!=null?F.finalY+20/T:null}function w(E,_,F){var T=_.head||[],I=_.body||[],S=_.foot||[];if(_.html){var C=_.includeHiddenHtml;if(F){var L=(0,u.parseHtml)(E,_.html,F,C,_.useCss)||{};T=L.head||T,I=L.body||T,S=L.foot||T}else console.error("Cannot parse html in non browser environment")}var R=_.columns||B(T,I,S);return{columns:R,head:T,body:I,foot:S}}function B(E,_,F){var T=E[0]||_[0]||F[0]||[],I=[];return Object.keys(T).filter(function(S){return S!=="_element"}).forEach(function(S){var C=1,L;Array.isArray(T)?L=T[parseInt(S)]:L=T[S],typeof L=="object"&&!Array.isArray(L)&&(C=(L==null?void 0:L.colSpan)||1);for(var R=0;R<C;R++){var W=void 0;Array.isArray(T)?W=I.length:W=S+(R>0?"_".concat(R):"");var G={dataKey:W};I.push(G)}}),I}},792:function(o,l){Object.defineProperty(l,"__esModule",{value:!0});function A(f,h,d,m){for(var g=function(y){y&&typeof y!="object"&&console.error("The options parameter should be of type object, is: "+typeof y),typeof y.extendWidth<"u"&&(y.tableWidth=y.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof y.margins<"u"&&(typeof y.margin>"u"&&(y.margin=y.margins),console.error("Use of deprecated option: margins, use margin instead.")),y.startY&&typeof y.startY!="number"&&(console.error("Invalid value for startY option",y.startY),delete y.startY),!y.didDrawPage&&(y.afterPageContent||y.beforePageContent||y.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),y.didDrawPage=function(S){f.applyStyles(f.userStyles),y.beforePageContent&&y.beforePageContent(S),f.applyStyles(f.userStyles),y.afterPageContent&&y.afterPageContent(S),f.applyStyles(f.userStyles),y.afterPageAdd&&S.pageNumber>1&&S.afterPageAdd(S),f.applyStyles(f.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(S){y[S]&&console.error('The "'.concat(S,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(S){var C=S[0],L=S[1];y[L]&&(console.error("Use of deprecated option ".concat(L,". Use ").concat(C," instead")),y[C]=y[L])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(S){var C=typeof S=="string"?S:S[0],L=typeof S=="string"?S:S[1];typeof y[C]<"u"&&(typeof y.styles[L]>"u"&&(y.styles[L]=y[C]),console.error("Use of deprecated option: "+C+", use the style "+L+" instead."))});for(var w=0,B=["styles","bodyStyles","headStyles","footStyles"];w<B.length;w++){var E=B[w];u(y[E]||{})}for(var _=y.columnStyles||{},F=0,T=Object.keys(_);F<T.length;F++){var I=T[F];u(_[I]||{})}},x=0,p=[h,d,m];x<p.length;x++){var v=p[x];g(v)}}l.default=A;function u(f){f.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),f.minCellHeight||(f.minCellHeight=f.rowHeight)):f.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),f.cellWidth||(f.cellWidth=f.columnWidth))}},260:function(o,l,A){Object.defineProperty(l,"__esModule",{value:!0}),l.Column=l.Cell=l.Row=l.Table=void 0;var u=A(796),f=A(172),h=A(420),d=function(){function p(v,y){this.pageNumber=1,this.pageCount=1,this.id=v.id,this.settings=v.settings,this.styles=v.styles,this.hooks=v.hooks,this.columns=y.columns,this.head=y.head,this.body=y.body,this.foot=y.foot}return p.prototype.getHeadHeight=function(v){return this.head.reduce(function(y,w){return y+w.getMaxCellHeight(v)},0)},p.prototype.getFootHeight=function(v){return this.foot.reduce(function(y,w){return y+w.getMaxCellHeight(v)},0)},p.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},p.prototype.callCellHooks=function(v,y,w,B,E,_){for(var F=0,T=y;F<T.length;F++){var I=T[F],S=new f.CellHookData(v,this,w,B,E,_),C=I(S)===!1;if(w.text=Array.isArray(w.text)?w.text:[w.text],C)return!1}return!0},p.prototype.callEndPageHooks=function(v,y){v.applyStyles(v.userStyles);for(var w=0,B=this.hooks.didDrawPage;w<B.length;w++){var E=B[w];E(new f.HookData(v,this,y))}},p.prototype.callWillDrawPageHooks=function(v,y){for(var w=0,B=this.hooks.willDrawPage;w<B.length;w++){var E=B[w];E(new f.HookData(v,this,y))}},p.prototype.getWidth=function(v){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var y=this.columns.reduce(function(B,E){return B+E.wrappedWidth},0);return y}else{var w=this.settings.margin;return v-w.left-w.right}},p}();l.Table=d;var m=function(){function p(v,y,w,B,E){E===void 0&&(E=!1),this.height=0,this.raw=v,v instanceof u.HtmlRowInput&&(this.raw=v._element,this.element=v._element),this.index=y,this.section=w,this.cells=B,this.spansMultiplePages=E}return p.prototype.getMaxCellHeight=function(v){var y=this;return v.reduce(function(w,B){var E;return Math.max(w,((E=y.cells[B.index])===null||E===void 0?void 0:E.height)||0)},0)},p.prototype.hasRowSpan=function(v){var y=this;return v.filter(function(w){var B=y.cells[w.index];return B?B.rowSpan>1:!1}).length>0},p.prototype.canEntireRowFit=function(v,y){return this.getMaxCellHeight(y)<=v},p.prototype.getMinimumRowHeight=function(v,y){var w=this;return v.reduce(function(B,E){var _=w.cells[E.index];if(!_)return 0;var F=y.getLineHeight(_.styles.fontSize),T=_.padding("vertical"),I=T+F;return I>B?I:B},0)},p}();l.Row=m;var g=function(){function p(v,y,w){var B,E;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=y,this.section=w,this.raw=v;var _=v;v!=null&&typeof v=="object"&&!Array.isArray(v)?(this.rowSpan=v.rowSpan||1,this.colSpan=v.colSpan||1,_=(E=(B=v.content)!==null&&B!==void 0?B:v.title)!==null&&E!==void 0?E:v,v._element&&(this.raw=v._element)):(this.rowSpan=1,this.colSpan=1);var F=_!=null?""+_:"",T=/\r\n|\r|\n/g;this.text=F.split(T)}return p.prototype.getTextPos=function(){var v;if(this.styles.valign==="top")v=this.y+this.padding("top");else if(this.styles.valign==="bottom")v=this.y+this.height-this.padding("bottom");else{var y=this.height-this.padding("vertical");v=this.y+y/2+this.padding("top")}var w;if(this.styles.halign==="right")w=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var B=this.width-this.padding("horizontal");w=this.x+B/2+this.padding("left")}else w=this.x+this.padding("left");return{x:w,y:v}},p.prototype.getContentHeight=function(v,y){y===void 0&&(y=1.15);var w=Array.isArray(this.text)?this.text.length:1,B=this.styles.fontSize/v*y,E=w*B+this.padding("vertical");return Math.max(E,this.styles.minCellHeight)},p.prototype.padding=function(v){var y=(0,h.parseSpacing)(this.styles.cellPadding,0);return v==="vertical"?y.top+y.bottom:v==="horizontal"?y.left+y.right:y[v]},p}();l.Cell=g;var x=function(){function p(v,y,w){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=v,this.raw=y,this.index=w}return p.prototype.getMaxCustomCellWidth=function(v){for(var y=0,w=0,B=v.allRows();w<B.length;w++){var E=B[w],_=E.cells[this.index];_&&typeof _.styles.cellWidth=="number"&&(y=Math.max(y,_.styles.cellWidth))}return y},p}();l.Column=x},356:function(o,l){Object.defineProperty(l,"__esModule",{value:!0}),l.assign=void 0;function A(u,f,h,d,m){if(u==null)throw new TypeError("Cannot convert undefined or null to object");for(var g=Object(u),x=1;x<arguments.length;x++){var p=arguments[x];if(p!=null)for(var v in p)Object.prototype.hasOwnProperty.call(p,v)&&(g[v]=p[v])}return g}l.assign=A},972:function(o,l,A){Object.defineProperty(l,"__esModule",{value:!0}),l.createTable=void 0;var u=A(744),f=A(260),h=A(324),d=A(796),m=A(356);function g(E,_){var F=new u.DocHandler(E),T=x(_,F.scaleFactor()),I=new f.Table(_,T);return(0,h.calculateWidths)(F,I),F.applyStyles(F.userStyles),I}l.createTable=g;function x(E,_){var F=E.content,T=w(F.columns);if(F.head.length===0){var I=v(T,"head");I&&F.head.push(I)}if(F.foot.length===0){var I=v(T,"foot");I&&F.foot.push(I)}var S=E.settings.theme,C=E.styles;return{columns:T,head:p("head",F.head,T,C,S,_),body:p("body",F.body,T,C,S,_),foot:p("foot",F.foot,T,C,S,_)}}function p(E,_,F,T,I,S){var C={},L=_.map(function(R,W){for(var G=0,V={},X=0,Q=0,K=0,H=F;K<H.length;K++){var k=H[K];if(C[k.index]==null||C[k.index].left===0)if(Q===0){var U=void 0;Array.isArray(R)?U=R[k.index-X-G]:U=R[k.dataKey];var P={};typeof U=="object"&&!Array.isArray(U)&&(P=(U==null?void 0:U.styles)||{});var D=B(E,k,W,I,T,S,P),O=new f.Cell(U,D,E);V[k.dataKey]=O,V[k.index]=O,Q=O.colSpan-1,C[k.index]={left:O.rowSpan-1,times:Q}}else Q--,X++;else C[k.index].left--,Q=C[k.index].times,G++}return new f.Row(R,W,E,V)});return L}function v(E,_){var F={};return E.forEach(function(T){if(T.raw!=null){var I=y(_,T.raw);I!=null&&(F[T.dataKey]=I)}}),Object.keys(F).length>0?F:null}function y(E,_){if(E==="head"){if(typeof _=="object")return _.header||_.title||null;if(typeof _=="string"||typeof _=="number")return _}else if(E==="foot"&&typeof _=="object")return _.footer;return null}function w(E){return E.map(function(_,F){var T,I,S;return typeof _=="object"?S=(I=(T=_.dataKey)!==null&&T!==void 0?T:_.key)!==null&&I!==void 0?I:F:S=F,new f.Column(S,_,F)})}function B(E,_,F,T,I,S,C){var L=(0,d.getTheme)(T),R;E==="head"?R=I.headStyles:E==="body"?R=I.bodyStyles:E==="foot"&&(R=I.footStyles);var W=(0,m.assign)({},L.table,L[E],I.styles,R),G=I.columnStyles[_.dataKey]||I.columnStyles[_.index]||{},V=E==="body"?G:{},X=E==="body"&&F%2===0?(0,m.assign)({},L.alternateRow,I.alternateRowStyles):{},Q=(0,d.defaultStyles)(S),K=(0,m.assign)({},Q,W,X,V);return(0,m.assign)(K,C)}},664:function(o,l,A){Object.defineProperty(l,"__esModule",{value:!0}),l.addPage=l.drawTable=void 0;var u=A(420),f=A(260),h=A(744),d=A(356),m=A(136),g=A(224);function x(G,V){var X=V.settings,Q=X.startY,K=X.margin,H={x:K.left,y:Q},k=V.getHeadHeight(V.columns)+V.getFootHeight(V.columns),U=Q+K.bottom+k;if(X.pageBreak==="avoid"){var P=V.body,D=P.reduce(function(J,Y){return J+Y.height},0);U+=D}var O=new h.DocHandler(G);(X.pageBreak==="always"||X.startY!=null&&U>O.pageSize().height)&&(W(O),H.y=K.top),V.callWillDrawPageHooks(O,H);var z=(0,d.assign)({},H);V.startPageNumber=O.pageNumber(),X.horizontalPageBreak?p(O,V,z,H):(O.applyStyles(O.userStyles),(X.showHead==="firstPage"||X.showHead==="everyPage")&&V.head.forEach(function(J){return I(O,V,J,H,V.columns)}),O.applyStyles(O.userStyles),V.body.forEach(function(J,Y){var le=Y===V.body.length-1;T(O,V,J,le,z,H,V.columns)}),O.applyStyles(O.userStyles),(X.showFoot==="lastPage"||X.showFoot==="everyPage")&&V.foot.forEach(function(J){return I(O,V,J,H,V.columns)})),(0,u.addTableBorder)(O,V,z,H),V.callEndPageHooks(O,H),V.finalY=H.y,G.lastAutoTable=V,G.previousAutoTable=V,G.autoTable&&(G.autoTable.previous=V),O.applyStyles(O.userStyles)}l.drawTable=x;function p(G,V,X,Q){var K=(0,g.calculateAllColumnsCanFitInPage)(G,V),H=V.settings;if(H.horizontalPageBreakBehaviour==="afterAllRows")K.forEach(function(D,O){G.applyStyles(G.userStyles),O>0?R(G,V,X,Q,D.columns,!0):v(G,V,Q,D.columns),y(G,V,X,Q,D.columns),B(G,V,Q,D.columns)});else for(var k=-1,U=K[0],P=function(){var D=k;if(U){G.applyStyles(G.userStyles);var O=U.columns;k>=0?R(G,V,X,Q,O,!0):v(G,V,Q,O),D=w(G,V,k+1,Q,O),B(G,V,Q,O)}var z=D-k;K.slice(1).forEach(function(J){G.applyStyles(G.userStyles),R(G,V,X,Q,J.columns,!0),w(G,V,k+1,Q,J.columns,z),B(G,V,Q,J.columns)}),k=D};k<V.body.length-1;)P()}function v(G,V,X,Q){var K=V.settings;G.applyStyles(G.userStyles),(K.showHead==="firstPage"||K.showHead==="everyPage")&&V.head.forEach(function(H){return I(G,V,H,X,Q)})}function y(G,V,X,Q,K){G.applyStyles(G.userStyles),V.body.forEach(function(H,k){var U=k===V.body.length-1;T(G,V,H,U,X,Q,K)})}function w(G,V,X,Q,K,H){G.applyStyles(G.userStyles),H=H??V.body.length;var k=Math.min(X+H,V.body.length),U=-1;return V.body.slice(X,k).forEach(function(P,D){var O=X+D===V.body.length-1,z=L(G,V,O,Q);P.canEntireRowFit(z,K)&&(I(G,V,P,Q,K),U=X+D)}),U}function B(G,V,X,Q){var K=V.settings;G.applyStyles(G.userStyles),(K.showFoot==="lastPage"||K.showFoot==="everyPage")&&V.foot.forEach(function(H){return I(G,V,H,X,Q)})}function E(G,V,X){var Q=X.getLineHeight(G.styles.fontSize),K=G.padding("vertical"),H=Math.floor((V-K)/Q);return Math.max(0,H)}function _(G,V,X,Q){var K={};G.spansMultiplePages=!0,G.height=0;for(var H=0,k=0,U=X.columns;k<U.length;k++){var P=U[k],D=G.cells[P.index];if(D){Array.isArray(D.text)||(D.text=[D.text]);var O=new f.Cell(D.raw,D.styles,D.section);O=(0,d.assign)(O,D),O.text=[];var z=E(D,V,Q);D.text.length>z&&(O.text=D.text.splice(z,D.text.length));var J=Q.scaleFactor(),Y=Q.getLineHeightFactor();D.contentHeight=D.getContentHeight(J,Y),D.contentHeight>=V&&(D.contentHeight=V,O.styles.minCellHeight-=V),D.contentHeight>G.height&&(G.height=D.contentHeight),O.contentHeight=O.getContentHeight(J,Y),O.contentHeight>H&&(H=O.contentHeight),K[P.index]=O}}var le=new f.Row(G.raw,-1,G.section,K,!0);le.height=H;for(var we=0,ne=X.columns;we<ne.length;we++){var P=ne[we],O=le.cells[P.index];O&&(O.height=le.height);var D=G.cells[P.index];D&&(D.height=G.height)}return le}function F(G,V,X,Q){var K=G.pageSize().height,H=Q.settings.margin,k=H.top+H.bottom,U=K-k;V.section==="body"&&(U-=Q.getHeadHeight(Q.columns)+Q.getFootHeight(Q.columns));var P=V.getMinimumRowHeight(Q.columns,G),D=P<X;if(P>U)return console.error("Will not be able to print row ".concat(V.index," correctly since it's minimum height is larger than page height")),!0;if(!D)return!1;var O=V.hasRowSpan(Q.columns),z=V.getMaxCellHeight(Q.columns)>U;return z?(O&&console.error("The content of row ".concat(V.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(O||Q.settings.rowPageBreak==="avoid")}function T(G,V,X,Q,K,H,k){var U=L(G,V,Q,H);if(X.canEntireRowFit(U,k))I(G,V,X,H,k);else if(F(G,X,U,V)){var P=_(X,U,V,G);I(G,V,X,H,k),R(G,V,K,H,k),T(G,V,P,Q,K,H,k)}else R(G,V,K,H,k),T(G,V,X,Q,K,H,k)}function I(G,V,X,Q,K){Q.x=V.settings.margin.left;for(var H=0,k=K;H<k.length;H++){var U=k[H],P=X.cells[U.index];if(!P){Q.x+=U.width;continue}G.applyStyles(P.styles),P.x=Q.x,P.y=Q.y;var D=V.callCellHooks(G,V.hooks.willDrawCell,P,X,U,Q);if(D===!1){Q.x+=U.width;continue}S(G,P,Q);var O=P.getTextPos();(0,m.default)(P.text,O.x,O.y,{halign:P.styles.halign,valign:P.styles.valign,maxWidth:Math.ceil(P.width-P.padding("left")-P.padding("right"))},G.getDocument()),V.callCellHooks(G,V.hooks.didDrawCell,P,X,U,Q),Q.x+=U.width}Q.y+=X.height}function S(G,V,X){var Q=V.styles;if(G.getDocument().setFillColor(G.getDocument().getFillColor()),typeof Q.lineWidth=="number"){var K=(0,u.getFillStyle)(Q.lineWidth,Q.fillColor);K&&G.rect(V.x,X.y,V.width,V.height,K)}else typeof Q.lineWidth=="object"&&(Q.fillColor&&G.rect(V.x,X.y,V.width,V.height,"F"),C(G,V,X,Q.lineWidth))}function C(G,V,X,Q){var K,H,k,U;Q.top&&(K=X.x,H=X.y,k=X.x+V.width,U=X.y,Q.right&&(k+=.5*Q.right),Q.left&&(K-=.5*Q.left),P(Q.top,K,H,k,U)),Q.bottom&&(K=X.x,H=X.y+V.height,k=X.x+V.width,U=X.y+V.height,Q.right&&(k+=.5*Q.right),Q.left&&(K-=.5*Q.left),P(Q.bottom,K,H,k,U)),Q.left&&(K=X.x,H=X.y,k=X.x,U=X.y+V.height,Q.top&&(H-=.5*Q.top),Q.bottom&&(U+=.5*Q.bottom),P(Q.left,K,H,k,U)),Q.right&&(K=X.x+V.width,H=X.y,k=X.x+V.width,U=X.y+V.height,Q.top&&(H-=.5*Q.top),Q.bottom&&(U+=.5*Q.bottom),P(Q.right,K,H,k,U));function P(D,O,z,J,Y){G.getDocument().setLineWidth(D),G.getDocument().line(O,z,J,Y,"S")}}function L(G,V,X,Q){var K=V.settings.margin.bottom,H=V.settings.showFoot;return(H==="everyPage"||H==="lastPage"&&X)&&(K+=V.getFootHeight(V.columns)),G.pageSize().height-Q.y-K}function R(G,V,X,Q,K,H){K===void 0&&(K=[]),H===void 0&&(H=!1),G.applyStyles(G.userStyles),V.settings.showFoot==="everyPage"&&!H&&V.foot.forEach(function(U){return I(G,V,U,Q,K)}),V.callEndPageHooks(G,Q);var k=V.settings.margin;(0,u.addTableBorder)(G,V,X,Q),W(G),V.pageNumber++,V.pageCount++,Q.x=k.left,Q.y=k.top,X.y=k.top,V.callWillDrawPageHooks(G,Q),V.settings.showHead==="everyPage"&&(V.head.forEach(function(U){return I(G,V,U,Q,K)}),G.applyStyles(G.userStyles))}l.addPage=R;function W(G){var V=G.pageNumber();G.setPage(V+1);var X=G.pageNumber();return X===V?(G.addPage(),!0):!1}},224:function(o,l,A){Object.defineProperty(l,"__esModule",{value:!0}),l.calculateAllColumnsCanFitInPage=void 0;var u=A(420);function f(d,m,g){var x;g===void 0&&(g={});var p=(0,u.getPageAvailableWidth)(d,m),v=new Map,y=[],w=[],B=[];m.settings.horizontalPageBreakRepeat,Array.isArray(m.settings.horizontalPageBreakRepeat)?B=m.settings.horizontalPageBreakRepeat:(typeof m.settings.horizontalPageBreakRepeat=="string"||typeof m.settings.horizontalPageBreakRepeat=="number")&&(B=[m.settings.horizontalPageBreakRepeat]),B.forEach(function(T){var I=m.columns.find(function(S){return S.dataKey===T||S.index===T});I&&!v.has(I.index)&&(v.set(I.index,!0),y.push(I.index),w.push(m.columns[I.index]),p-=I.wrappedWidth)});for(var E=!0,_=(x=g==null?void 0:g.start)!==null&&x!==void 0?x:0;_<m.columns.length;){if(v.has(_)){_++;continue}var F=m.columns[_].wrappedWidth;if(E||p>=F)E=!1,y.push(_),w.push(m.columns[_]),p-=F;else break;_++}return{colIndexes:y,columns:w,lastIndex:_-1}}function h(d,m){for(var g=[],x=0;x<m.columns.length;x++){var p=f(d,m,{start:x});p.columns.length&&(g.push(p),x=p.lastIndex)}return g}l.calculateAllColumnsCanFitInPage=h},324:function(o,l,A){Object.defineProperty(l,"__esModule",{value:!0}),l.ellipsize=l.resizeColumns=l.calculateWidths=void 0;var u=A(420);function f(y,w){h(y,w);var B=[],E=0;w.columns.forEach(function(F){var T=F.getMaxCustomCellWidth(w);T?F.width=T:(F.width=F.wrappedWidth,B.push(F)),E+=F.width});var _=w.getWidth(y.pageSize().width)-E;_&&(_=d(B,_,function(F){return Math.max(F.minReadableWidth,F.minWidth)})),_&&(_=d(B,_,function(F){return F.minWidth})),_=Math.abs(_),!w.settings.horizontalPageBreak&&_>.1/y.scaleFactor()&&(_=_<1?_:Math.round(_),console.warn("Of the table content, ".concat(_," units width could not fit page"))),g(w),x(w,y),m(w)}l.calculateWidths=f;function h(y,w){var B=y.scaleFactor(),E=w.settings.horizontalPageBreak,_=(0,u.getPageAvailableWidth)(y,w);w.allRows().forEach(function(F){for(var T=0,I=w.columns;T<I.length;T++){var S=I[T],C=F.cells[S.index];if(C){var L=w.hooks.didParseCell;w.callCellHooks(y,L,C,F,S,null);var R=C.padding("horizontal");C.contentWidth=(0,u.getStringWidth)(C.text,C.styles,y)+R;var W=(0,u.getStringWidth)(C.text.join(" ").split(/[^\S\u00A0]+/),C.styles,y);if(C.minReadableWidth=W+C.padding("horizontal"),typeof C.styles.cellWidth=="number")C.minWidth=C.styles.cellWidth,C.wrappedWidth=C.styles.cellWidth;else if(C.styles.cellWidth==="wrap"||E===!0)C.contentWidth>_?(C.minWidth=_,C.wrappedWidth=_):(C.minWidth=C.contentWidth,C.wrappedWidth=C.contentWidth);else{var G=10/B;C.minWidth=C.styles.minCellWidth||G,C.wrappedWidth=C.contentWidth,C.minWidth>C.wrappedWidth&&(C.wrappedWidth=C.minWidth)}}}}),w.allRows().forEach(function(F){for(var T=0,I=w.columns;T<I.length;T++){var S=I[T],C=F.cells[S.index];if(C&&C.colSpan===1)S.wrappedWidth=Math.max(S.wrappedWidth,C.wrappedWidth),S.minWidth=Math.max(S.minWidth,C.minWidth),S.minReadableWidth=Math.max(S.minReadableWidth,C.minReadableWidth);else{var L=w.styles.columnStyles[S.dataKey]||w.styles.columnStyles[S.index]||{},R=L.cellWidth||L.minCellWidth;R&&typeof R=="number"&&(S.minWidth=R,S.wrappedWidth=R)}C&&(C.colSpan>1&&!S.minWidth&&(S.minWidth=C.minWidth),C.colSpan>1&&!S.wrappedWidth&&(S.wrappedWidth=C.minWidth))}})}function d(y,w,B){for(var E=w,_=y.reduce(function(G,V){return G+V.wrappedWidth},0),F=0;F<y.length;F++){var T=y[F],I=T.wrappedWidth/_,S=E*I,C=T.width+S,L=B(T),R=C<L?L:C;w-=R-T.width,T.width=R}if(w=Math.round(w*1e10)/1e10,w){var W=y.filter(function(G){return w<0?G.width>B(G):!0});W.length&&(w=d(W,w,B))}return w}l.resizeColumns=d;function m(y){for(var w={},B=1,E=y.allRows(),_=0;_<E.length;_++)for(var F=E[_],T=0,I=y.columns;T<I.length;T++){var S=I[T],C=w[S.index];if(B>1)B--,delete F.cells[S.index];else if(C)C.cell.height+=F.height,B=C.cell.colSpan,delete F.cells[S.index],C.left--,C.left<=1&&delete w[S.index];else{var L=F.cells[S.index];if(!L)continue;if(L.height=F.height,L.rowSpan>1){var R=E.length-_,W=L.rowSpan>R?R:L.rowSpan;w[S.index]={cell:L,left:W,row:F}}}}}function g(y){for(var w=y.allRows(),B=0;B<w.length;B++)for(var E=w[B],_=null,F=0,T=0,I=0;I<y.columns.length;I++){var S=y.columns[I];if(T-=1,T>1&&y.columns[I+1])F+=S.width,delete E.cells[S.index];else if(_){var C=_;delete E.cells[S.index],_=null,C.width=S.width+F}else{var C=E.cells[S.index];if(!C)continue;if(T=C.colSpan,F=0,C.colSpan>1){_=C,F+=S.width;continue}C.width=S.width+F}}}function x(y,w){for(var B={count:0,height:0},E=0,_=y.allRows();E<_.length;E++){for(var F=_[E],T=0,I=y.columns;T<I.length;T++){var S=I[T],C=F.cells[S.index];if(C){w.applyStyles(C.styles,!0);var L=C.width-C.padding("horizontal");if(C.styles.overflow==="linebreak")C.text=w.splitTextToSize(C.text,L+1/w.scaleFactor(),{fontSize:C.styles.fontSize});else if(C.styles.overflow==="ellipsize")C.text=p(C.text,L,C.styles,w,"...");else if(C.styles.overflow==="hidden")C.text=p(C.text,L,C.styles,w,"");else if(typeof C.styles.overflow=="function"){var R=C.styles.overflow(C.text,L);typeof R=="string"?C.text=[R]:C.text=R}C.contentHeight=C.getContentHeight(w.scaleFactor(),w.getLineHeightFactor());var W=C.contentHeight/C.rowSpan;C.rowSpan>1&&B.count*B.height<W*C.rowSpan?B={height:W,count:C.rowSpan}:B&&B.count>0&&B.height>W&&(W=B.height),W>F.height&&(F.height=W)}}B.count--}}function p(y,w,B,E,_){return y.map(function(F){return v(F,w,B,E,_)})}l.ellipsize=p;function v(y,w,B,E,_){var F=1e4*E.scaleFactor();if(w=Math.ceil(w*F)/F,w>=(0,u.getStringWidth)(y,B,E))return y;for(;w<(0,u.getStringWidth)(y+_,B,E)&&!(y.length<=1);)y=y.substring(0,y.length-1);return y.trim()+_}},964:function(o){if(typeof r>"u"){var l=new Error("Cannot find module 'undefined'");throw l.code="MODULE_NOT_FOUND",l}o.exports=r}},i={};function a(o){var l=i[o];if(l!==void 0)return l.exports;var A=i[o]={exports:{}};return n[o].call(A.exports,A,A.exports,a),A.exports}var s={};return function(){var o=s;Object.defineProperty(o,"__esModule",{value:!0}),o.Cell=o.Column=o.Row=o.Table=o.CellHookData=o.__drawTable=o.__createTable=o.applyPlugin=void 0;var l=a(340),A=a(776),u=a(664),f=a(972),h=a(260);Object.defineProperty(o,"Table",{enumerable:!0,get:function(){return h.Table}});var d=a(172);Object.defineProperty(o,"CellHookData",{enumerable:!0,get:function(){return d.CellHookData}});var m=a(260);Object.defineProperty(o,"Cell",{enumerable:!0,get:function(){return m.Cell}}),Object.defineProperty(o,"Column",{enumerable:!0,get:function(){return m.Column}}),Object.defineProperty(o,"Row",{enumerable:!0,get:function(){return m.Row}});function g(w){(0,l.default)(w)}o.applyPlugin=g;function x(w,B){var E=(0,A.parseInput)(w,B),_=(0,f.createTable)(w,E);(0,u.drawTable)(w,_)}function p(w,B){var E=(0,A.parseInput)(w,B);return(0,f.createTable)(w,E)}o.__createTable=p;function v(w,B){(0,u.drawTable)(w,B)}o.__drawTable=v;try{var y=a(964);y.jsPDF&&(y=y.jsPDF),g(y)}catch{}o.default=x}(),s}()})})(Jre);/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Hy=function(e,t){return Hy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},Hy(e,t)};function Ds(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Hy(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Ky=function(){return Ky=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},Ky.apply(this,arguments)};function ji(e,t,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(u){try{A(n.next(u))}catch(f){s(f)}}function l(u){try{A(n.throw(u))}catch(f){s(f)}}function A(u){u.done?a(u.value):i(u.value).then(o,l)}A((n=n.apply(e,[])).next())})}function vi(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(A){return function(u){return l([A,u])}}function l(A){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=A[0]&2?i.return:A[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,A[1])).done)return a;switch(i=0,a&&(A=[A[0]&2,a.value]),A[0]){case 0:case 1:a=A;break;case 4:return r.label++,{value:A[1],done:!1};case 5:r.label++,i=A[1],A=[0];continue;case 7:A=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(A[0]===6||A[0]===2)){r=0;continue}if(A[0]===3&&(!a||A[1]>a[0]&&A[1]<a[3])){r.label=A[1];break}if(A[0]===6&&r.label<a[1]){r.label=a[1],a=A;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(A);break}a[2]&&r.ops.pop(),r.trys.pop();continue}A=t.call(e,r)}catch(u){A=[6,u],i=0}finally{n=a=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}}function Gp(e,t,r){if(arguments.length===2)for(var n=0,i=t.length,a;n<i;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||t)}var Go=function(){function e(t,r,n,i){this.left=t,this.top=r,this.width=n,this.height=i}return e.prototype.add=function(t,r,n,i){return new e(this.left+t,this.top+r,this.width+n,this.height+i)},e.fromClientRect=function(t,r){return new e(r.left+t.windowBounds.left,r.top+t.windowBounds.top,r.width,r.height)},e.fromDOMRectList=function(t,r){var n=Array.from(r).find(function(i){return i.width!==0});return n?new e(n.left+t.windowBounds.left,n.top+t.windowBounds.top,n.width,n.height):e.EMPTY},e.EMPTY=new e(0,0,0,0),e}(),L1=function(e,t){return Go.fromClientRect(e,t.getBoundingClientRect())},ene=function(e){var t=e.body,r=e.documentElement;if(!t||!r)throw new Error("Unable to get document size");var n=Math.max(Math.max(t.scrollWidth,r.scrollWidth),Math.max(t.offsetWidth,r.offsetWidth),Math.max(t.clientWidth,r.clientWidth)),i=Math.max(Math.max(t.scrollHeight,r.scrollHeight),Math.max(t.offsetHeight,r.offsetHeight),Math.max(t.clientHeight,r.clientHeight));return new Go(0,0,n,i)},I1=function(e){for(var t=[],r=0,n=e.length;r<n;){var i=e.charCodeAt(r++);if(i>=55296&&i<=56319&&r<n){var a=e.charCodeAt(r++);(a&64512)===56320?t.push(((i&1023)<<10)+(a&1023)+65536):(t.push(i),r--)}else t.push(i)}return t},gn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var n=[],i=-1,a="";++i<r;){var s=e[i];s<=65535?n.push(s):(s-=65536,n.push((s>>10)+55296,s%1024+56320)),(i+1===r||n.length>16384)&&(a+=String.fromCharCode.apply(String,n),n.length=0)}return a},qC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",tne=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Vp=0;Vp<qC.length;Vp++)tne[qC.charCodeAt(Vp)]=Vp;var zC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Bh=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Wp=0;Wp<zC.length;Wp++)Bh[zC.charCodeAt(Wp)]=Wp;var rne=function(e){var t=e.length*.75,r=e.length,n,i=0,a,s,o,l;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var A=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),u=Array.isArray(A)?A:new Uint8Array(A);for(n=0;n<r;n+=4)a=Bh[e.charCodeAt(n)],s=Bh[e.charCodeAt(n+1)],o=Bh[e.charCodeAt(n+2)],l=Bh[e.charCodeAt(n+3)],u[i++]=a<<2|s>>4,u[i++]=(s&15)<<4|o>>2,u[i++]=(o&3)<<6|l&63;return A},nne=function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r.push(e[n+1]<<8|e[n]);return r},ine=function(e){for(var t=e.length,r=[],n=0;n<t;n+=4)r.push(e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]);return r},XA=5,p5=11,Dx=2,ane=p5-XA,a6=65536>>XA,sne=1<<XA,Px=sne-1,one=1024>>XA,lne=a6+one,Ane=lne,cne=32,une=Ane+cne,fne=65536>>p5,hne=1<<ane,dne=hne-1,XC=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},pne=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},gne=function(e,t){var r=rne(e),n=Array.isArray(r)?ine(r):new Uint32Array(r),i=Array.isArray(r)?nne(r):new Uint16Array(r),a=24,s=XC(i,a/2,n[4]/2),o=n[5]===2?XC(i,(a+n[4])/2):pne(n,Math.ceil((a+n[4])/4));return new mne(n[0],n[1],n[2],n[3],s,o)},mne=function(){function e(t,r,n,i,a,s){this.initialValue=t,this.errorValue=r,this.highStart=n,this.highValueIndex=i,this.index=a,this.data=s}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>XA],r=(r<<Dx)+(t&Px),this.data[r];if(t<=65535)return r=this.index[a6+(t-55296>>XA)],r=(r<<Dx)+(t&Px),this.data[r];if(t<this.highStart)return r=une-fne+(t>>p5),r=this.index[r],r+=t>>XA&dne,r=this.index[r],r=(r<<Dx)+(t&Px),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),YC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",vne=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var $p=0;$p<YC.length;$p++)vne[YC.charCodeAt($p)]=$p;var xne="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",JC=50,yne=1,s6=2,o6=3,wne=4,bne=5,ZC=7,l6=8,eS=9,Il=10,Gy=11,tS=12,Vy=13,Bne=14,_h=15,Wy=16,qp=17,Ah=18,_ne=19,rS=20,$y=21,ch=22,Qx=23,ru=24,pa=25,Ch=26,Sh=27,nu=28,Cne=29,LA=30,Sne=31,zp=32,Xp=33,qy=34,zy=35,Xy=36,qd=37,Yy=38,Sg=39,Eg=40,Rx=41,A6=42,Ene=43,kne=[9001,65288],c6="!",rr="×",Yp="÷",Jy=gne(xne),Bo=[LA,Xy],Zy=[yne,s6,o6,bne],u6=[Il,l6],nS=[Sh,Ch],Fne=Zy.concat(u6),iS=[Yy,Sg,Eg,qy,zy],Nne=[_h,Vy],Tne=function(e,t){t===void 0&&(t="strict");var r=[],n=[],i=[];return e.forEach(function(a,s){var o=Jy.get(a);if(o>JC?(i.push(!0),o-=JC):i.push(!1),["normal","auto","loose"].indexOf(t)!==-1&&[8208,8211,12316,12448].indexOf(a)!==-1)return n.push(s),r.push(Wy);if(o===wne||o===Gy){if(s===0)return n.push(s),r.push(LA);var l=r[s-1];return Fne.indexOf(l)===-1?(n.push(n[s-1]),r.push(l)):(n.push(s),r.push(LA))}if(n.push(s),o===Sne)return r.push(t==="strict"?$y:qd);if(o===A6||o===Cne)return r.push(LA);if(o===Ene)return a>=131072&&a<=196605||a>=196608&&a<=262141?r.push(qd):r.push(LA);r.push(o)}),[n,r,i]},Mx=function(e,t,r,n){var i=n[r];if(Array.isArray(e)?e.indexOf(i)!==-1:e===i)for(var a=r;a<=n.length;){a++;var s=n[a];if(s===t)return!0;if(s!==Il)break}if(i===Il)for(var a=r;a>0;){a--;var o=n[a];if(Array.isArray(e)?e.indexOf(o)!==-1:e===o)for(var l=r;l<=n.length;){l++;var s=n[l];if(s===t)return!0;if(s!==Il)break}if(o!==Il)break}return!1},aS=function(e,t){for(var r=e;r>=0;){var n=t[r];if(n===Il)r--;else return n}return 0},Lne=function(e,t,r,n,i){if(r[n]===0)return rr;var a=n-1;if(Array.isArray(i)&&i[a]===!0)return rr;var s=a-1,o=a+1,l=t[a],A=s>=0?t[s]:0,u=t[o];if(l===s6&&u===o6)return rr;if(Zy.indexOf(l)!==-1)return c6;if(Zy.indexOf(u)!==-1||u6.indexOf(u)!==-1)return rr;if(aS(a,t)===l6)return Yp;if(Jy.get(e[a])===Gy||(l===zp||l===Xp)&&Jy.get(e[o])===Gy||l===ZC||u===ZC||l===eS||[Il,Vy,_h].indexOf(l)===-1&&u===eS||[qp,Ah,_ne,ru,nu].indexOf(u)!==-1||aS(a,t)===ch||Mx(Qx,ch,a,t)||Mx([qp,Ah],$y,a,t)||Mx(tS,tS,a,t))return rr;if(l===Il)return Yp;if(l===Qx||u===Qx)return rr;if(u===Wy||l===Wy)return Yp;if([Vy,_h,$y].indexOf(u)!==-1||l===Bne||A===Xy&&Nne.indexOf(l)!==-1||l===nu&&u===Xy||u===rS||Bo.indexOf(u)!==-1&&l===pa||Bo.indexOf(l)!==-1&&u===pa||l===Sh&&[qd,zp,Xp].indexOf(u)!==-1||[qd,zp,Xp].indexOf(l)!==-1&&u===Ch||Bo.indexOf(l)!==-1&&nS.indexOf(u)!==-1||nS.indexOf(l)!==-1&&Bo.indexOf(u)!==-1||[Sh,Ch].indexOf(l)!==-1&&(u===pa||[ch,_h].indexOf(u)!==-1&&t[o+1]===pa)||[ch,_h].indexOf(l)!==-1&&u===pa||l===pa&&[pa,nu,ru].indexOf(u)!==-1)return rr;if([pa,nu,ru,qp,Ah].indexOf(u)!==-1)for(var f=a;f>=0;){var h=t[f];if(h===pa)return rr;if([nu,ru].indexOf(h)!==-1)f--;else break}if([Sh,Ch].indexOf(u)!==-1)for(var f=[qp,Ah].indexOf(l)!==-1?s:a;f>=0;){var h=t[f];if(h===pa)return rr;if([nu,ru].indexOf(h)!==-1)f--;else break}if(Yy===l&&[Yy,Sg,qy,zy].indexOf(u)!==-1||[Sg,qy].indexOf(l)!==-1&&[Sg,Eg].indexOf(u)!==-1||[Eg,zy].indexOf(l)!==-1&&u===Eg||iS.indexOf(l)!==-1&&[rS,Ch].indexOf(u)!==-1||iS.indexOf(u)!==-1&&l===Sh||Bo.indexOf(l)!==-1&&Bo.indexOf(u)!==-1||l===ru&&Bo.indexOf(u)!==-1||Bo.concat(pa).indexOf(l)!==-1&&u===ch&&kne.indexOf(e[o])===-1||Bo.concat(pa).indexOf(u)!==-1&&l===Ah)return rr;if(l===Rx&&u===Rx){for(var d=r[a],m=1;d>0&&(d--,t[d]===Rx);)m++;if(m%2!==0)return rr}return l===zp&&u===Xp?rr:Yp},Ine=function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var r=Tne(e,t.lineBreak),n=r[0],i=r[1],a=r[2];(t.wordBreak==="break-all"||t.wordBreak==="break-word")&&(i=i.map(function(o){return[pa,LA,A6].indexOf(o)!==-1?qd:o}));var s=t.wordBreak==="keep-all"?a.map(function(o,l){return o&&e[l]>=19968&&e[l]<=40959}):void 0;return[n,i,s]},Une=function(){function e(t,r,n,i){this.codePoints=t,this.required=r===c6,this.start=n,this.end=i}return e.prototype.slice=function(){return gn.apply(void 0,this.codePoints.slice(this.start,this.end))},e}(),One=function(e,t){var r=I1(e),n=Ine(r,t),i=n[0],a=n[1],s=n[2],o=r.length,l=0,A=0;return{next:function(){if(A>=o)return{done:!0,value:null};for(var u=rr;A<o&&(u=Lne(r,a,i,++A,s))===rr;);if(u!==rr||A===o){var f=new Une(r,u,l,A);return l=A,{value:f,done:!1}}return{done:!0,value:null}}}},jne=1,Dne=2,d0=4,sS=8,Sm=10,oS=47,ad=92,Pne=9,Qne=32,Jp=34,uh=61,Rne=35,Mne=36,Hne=37,Zp=39,eg=40,fh=41,Kne=95,Zi=45,Gne=33,Vne=60,Wne=62,$ne=64,qne=91,zne=93,Xne=61,Yne=123,tg=63,Jne=125,lS=124,Zne=126,eie=128,AS=65533,Hx=42,QA=43,tie=44,rie=58,nie=59,zd=46,iie=0,aie=8,sie=11,oie=14,lie=31,Aie=127,$s=-1,f6=48,h6=97,d6=101,cie=102,uie=117,fie=122,p6=65,g6=69,m6=70,hie=85,die=90,wi=function(e){return e>=f6&&e<=57},pie=function(e){return e>=55296&&e<=57343},iu=function(e){return wi(e)||e>=p6&&e<=m6||e>=h6&&e<=cie},gie=function(e){return e>=h6&&e<=fie},mie=function(e){return e>=p6&&e<=die},vie=function(e){return gie(e)||mie(e)},xie=function(e){return e>=eie},rg=function(e){return e===Sm||e===Pne||e===Qne},Em=function(e){return vie(e)||xie(e)||e===Kne},cS=function(e){return Em(e)||wi(e)||e===Zi},yie=function(e){return e>=iie&&e<=aie||e===sie||e>=oie&&e<=lie||e===Aie},wl=function(e,t){return e!==ad?!1:t!==Sm},ng=function(e,t,r){return e===Zi?Em(t)||wl(t,r):Em(e)?!0:!!(e===ad&&wl(e,t))},Kx=function(e,t,r){return e===QA||e===Zi?wi(t)?!0:t===zd&&wi(r):wi(e===zd?t:e)},wie=function(e){var t=0,r=1;(e[t]===QA||e[t]===Zi)&&(e[t]===Zi&&(r=-1),t++);for(var n=[];wi(e[t]);)n.push(e[t++]);var i=n.length?parseInt(gn.apply(void 0,n),10):0;e[t]===zd&&t++;for(var a=[];wi(e[t]);)a.push(e[t++]);var s=a.length,o=s?parseInt(gn.apply(void 0,a),10):0;(e[t]===g6||e[t]===d6)&&t++;var l=1;(e[t]===QA||e[t]===Zi)&&(e[t]===Zi&&(l=-1),t++);for(var A=[];wi(e[t]);)A.push(e[t++]);var u=A.length?parseInt(gn.apply(void 0,A),10):0;return r*(i+o*Math.pow(10,-s))*Math.pow(10,l*u)},bie={type:2},Bie={type:3},_ie={type:4},Cie={type:13},Sie={type:8},Eie={type:21},kie={type:9},Fie={type:10},Nie={type:11},Tie={type:12},Lie={type:14},ig={type:23},Iie={type:1},Uie={type:25},Oie={type:24},jie={type:26},Die={type:27},Pie={type:28},Qie={type:29},Rie={type:31},ew={type:32},v6=function(){function e(){this._value=[]}return e.prototype.write=function(t){this._value=this._value.concat(I1(t))},e.prototype.read=function(){for(var t=[],r=this.consumeToken();r!==ew;)t.push(r),r=this.consumeToken();return t},e.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case Jp:return this.consumeStringToken(Jp);case Rne:var r=this.peekCodePoint(0),n=this.peekCodePoint(1),i=this.peekCodePoint(2);if(cS(r)||wl(n,i)){var a=ng(r,n,i)?Dne:jne,s=this.consumeName();return{type:5,value:s,flags:a}}break;case Mne:if(this.peekCodePoint(0)===uh)return this.consumeCodePoint(),Cie;break;case Zp:return this.consumeStringToken(Zp);case eg:return bie;case fh:return Bie;case Hx:if(this.peekCodePoint(0)===uh)return this.consumeCodePoint(),Lie;break;case QA:if(Kx(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case tie:return _ie;case Zi:var o=t,l=this.peekCodePoint(0),A=this.peekCodePoint(1);if(Kx(o,l,A))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(ng(o,l,A))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(l===Zi&&A===Wne)return this.consumeCodePoint(),this.consumeCodePoint(),Oie;break;case zd:if(Kx(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case oS:if(this.peekCodePoint(0)===Hx)for(this.consumeCodePoint();;){var u=this.consumeCodePoint();if(u===Hx&&(u=this.consumeCodePoint(),u===oS))return this.consumeToken();if(u===$s)return this.consumeToken()}break;case rie:return jie;case nie:return Die;case Vne:if(this.peekCodePoint(0)===Gne&&this.peekCodePoint(1)===Zi&&this.peekCodePoint(2)===Zi)return this.consumeCodePoint(),this.consumeCodePoint(),Uie;break;case $ne:var f=this.peekCodePoint(0),h=this.peekCodePoint(1),d=this.peekCodePoint(2);if(ng(f,h,d)){var s=this.consumeName();return{type:7,value:s}}break;case qne:return Pie;case ad:if(wl(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case zne:return Qie;case Xne:if(this.peekCodePoint(0)===uh)return this.consumeCodePoint(),Sie;break;case Yne:return Nie;case Jne:return Tie;case uie:case hie:var m=this.peekCodePoint(0),g=this.peekCodePoint(1);return m===QA&&(iu(g)||g===tg)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case lS:if(this.peekCodePoint(0)===uh)return this.consumeCodePoint(),kie;if(this.peekCodePoint(0)===lS)return this.consumeCodePoint(),Eie;break;case Zne:if(this.peekCodePoint(0)===uh)return this.consumeCodePoint(),Fie;break;case $s:return ew}return rg(t)?(this.consumeWhiteSpace(),Rie):wi(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):Em(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:gn(t)}},e.prototype.consumeCodePoint=function(){var t=this._value.shift();return typeof t>"u"?-1:t},e.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},e.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},e.prototype.consumeUnicodeRangeToken=function(){for(var t=[],r=this.consumeCodePoint();iu(r)&&t.length<6;)t.push(r),r=this.consumeCodePoint();for(var n=!1;r===tg&&t.length<6;)t.push(r),r=this.consumeCodePoint(),n=!0;if(n){var i=parseInt(gn.apply(void 0,t.map(function(l){return l===tg?f6:l})),16),a=parseInt(gn.apply(void 0,t.map(function(l){return l===tg?m6:l})),16);return{type:30,start:i,end:a}}var s=parseInt(gn.apply(void 0,t),16);if(this.peekCodePoint(0)===Zi&&iu(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var o=[];iu(r)&&o.length<6;)o.push(r),r=this.consumeCodePoint();var a=parseInt(gn.apply(void 0,o),16);return{type:30,start:s,end:a}}else return{type:30,start:s,end:s}},e.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return t.toLowerCase()==="url"&&this.peekCodePoint(0)===eg?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===eg?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},e.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===$s)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===Zp||r===Jp){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===$s||this.peekCodePoint(0)===fh)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),ig)}for(;;){var i=this.consumeCodePoint();if(i===$s||i===fh)return{type:22,value:gn.apply(void 0,t)};if(rg(i))return this.consumeWhiteSpace(),this.peekCodePoint(0)===$s||this.peekCodePoint(0)===fh?(this.consumeCodePoint(),{type:22,value:gn.apply(void 0,t)}):(this.consumeBadUrlRemnants(),ig);if(i===Jp||i===Zp||i===eg||yie(i))return this.consumeBadUrlRemnants(),ig;if(i===ad)if(wl(i,this.peekCodePoint(0)))t.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),ig;else t.push(i)}},e.prototype.consumeWhiteSpace=function(){for(;rg(this.peekCodePoint(0));)this.consumeCodePoint()},e.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(t===fh||t===$s)return;wl(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},e.prototype.consumeStringSlice=function(t){for(var r=5e4,n="";t>0;){var i=Math.min(r,t);n+=gn.apply(void 0,this._value.splice(0,i)),t-=i}return this._value.shift(),n},e.prototype.consumeStringToken=function(t){var r="",n=0;do{var i=this._value[n];if(i===$s||i===void 0||i===t)return r+=this.consumeStringSlice(n),{type:0,value:r};if(i===Sm)return this._value.splice(0,n),Iie;if(i===ad){var a=this._value[n+1];a!==$s&&a!==void 0&&(a===Sm?(r+=this.consumeStringSlice(n),n=-1,this._value.shift()):wl(i,a)&&(r+=this.consumeStringSlice(n),r+=gn(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},e.prototype.consumeNumber=function(){var t=[],r=d0,n=this.peekCodePoint(0);for((n===QA||n===Zi)&&t.push(this.consumeCodePoint());wi(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0);var i=this.peekCodePoint(1);if(n===zd&&wi(i))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=sS;wi(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0),i=this.peekCodePoint(1);var a=this.peekCodePoint(2);if((n===g6||n===d6)&&((i===QA||i===Zi)&&wi(a)||wi(i)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=sS;wi(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[wie(t),r]},e.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),r=t[0],n=t[1],i=this.peekCodePoint(0),a=this.peekCodePoint(1),s=this.peekCodePoint(2);if(ng(i,a,s)){var o=this.consumeName();return{type:15,number:r,flags:n,unit:o}}return i===Hne?(this.consumeCodePoint(),{type:16,number:r,flags:n}):{type:17,number:r,flags:n}},e.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(iu(t)){for(var r=gn(t);iu(this.peekCodePoint(0))&&r.length<6;)r+=gn(this.consumeCodePoint());rg(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(r,16);return n===0||pie(n)||n>1114111?AS:n}return t===$s?AS:t},e.prototype.consumeName=function(){for(var t="";;){var r=this.consumeCodePoint();if(cS(r))t+=gn(r);else if(wl(r,this.peekCodePoint(0)))t+=gn(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),t}},e}(),x6=function(){function e(t){this._tokens=t}return e.create=function(t){var r=new v6;return r.write(t),new e(r.read())},e.parseValue=function(t){return e.create(t).parseComponentValue()},e.parseValues=function(t){return e.create(t).parseComponentValues()},e.prototype.parseComponentValue=function(){for(var t=this.consumeToken();t.type===31;)t=this.consumeToken();if(t.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var r=this.consumeComponentValue();do t=this.consumeToken();while(t.type===31);if(t.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},e.prototype.parseComponentValues=function(){for(var t=[];;){var r=this.consumeComponentValue();if(r.type===32)return t;t.push(r),t.push()}},e.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},e.prototype.consumeSimpleBlock=function(t){for(var r={type:t,values:[]},n=this.consumeToken();;){if(n.type===32||Hie(n,t))return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue()),n=this.consumeToken()}},e.prototype.consumeFunction=function(t){for(var r={name:t.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return r;this.reconsumeToken(n),r.values.push(this.consumeComponentValue())}},e.prototype.consumeToken=function(){var t=this._tokens.shift();return typeof t>"u"?ew:t},e.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},e}(),p0=function(e){return e.type===15},vf=function(e){return e.type===17},Er=function(e){return e.type===20},Mie=function(e){return e.type===0},tw=function(e,t){return Er(e)&&e.value===t},y6=function(e){return e.type!==31},Zu=function(e){return e.type!==31&&e.type!==4},Ao=function(e){var t=[],r=[];return e.forEach(function(n){if(n.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");t.push(r),r=[];return}n.type!==31&&r.push(n)}),r.length&&t.push(r),t},Hie=function(e,t){return t===11&&e.type===12||t===28&&e.type===29?!0:t===2&&e.type===3},aA=function(e){return e.type===17||e.type===15},Nn=function(e){return e.type===16||aA(e)},w6=function(e){return e.length>1?[e[0],e[1]]:[e[0]]},ii={type:17,number:0,flags:d0},g5={type:16,number:50,flags:d0},Ul={type:16,number:100,flags:d0},Eh=function(e,t,r){var n=e[0],i=e[1];return[jr(n,t),jr(typeof i<"u"?i:n,r)]},jr=function(e,t){if(e.type===16)return e.number/100*t;if(p0(e))switch(e.unit){case"rem":case"em":return 16*e.number;case"px":default:return e.number}return e.number},b6="deg",B6="grad",_6="rad",C6="turn",U1={name:"angle",parse:function(e,t){if(t.type===15)switch(t.unit){case b6:return Math.PI*t.number/180;case B6:return Math.PI/200*t.number;case _6:return t.number;case C6:return Math.PI*2*t.number}throw new Error("Unsupported angle type")}},S6=function(e){return e.type===15&&(e.unit===b6||e.unit===B6||e.unit===_6||e.unit===C6)},E6=function(e){var t=e.filter(Er).map(function(r){return r.value}).join(" ");switch(t){case"to bottom right":case"to right bottom":case"left top":case"top left":return[ii,ii];case"to top":case"bottom":return Ja(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[ii,Ul];case"to right":case"left":return Ja(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Ul,Ul];case"to bottom":case"top":return Ja(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Ul,ii];case"to left":case"right":return Ja(270)}return 0},Ja=function(e){return Math.PI*e/180},$l={name:"color",parse:function(e,t){if(t.type===18){var r=Kie[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return r(e,t.values)}if(t.type===5){if(t.value.length===3){var n=t.value.substring(0,1),i=t.value.substring(1,2),a=t.value.substring(2,3);return Ol(parseInt(n+n,16),parseInt(i+i,16),parseInt(a+a,16),1)}if(t.value.length===4){var n=t.value.substring(0,1),i=t.value.substring(1,2),a=t.value.substring(2,3),s=t.value.substring(3,4);return Ol(parseInt(n+n,16),parseInt(i+i,16),parseInt(a+a,16),parseInt(s+s,16)/255)}if(t.value.length===6){var n=t.value.substring(0,2),i=t.value.substring(2,4),a=t.value.substring(4,6);return Ol(parseInt(n,16),parseInt(i,16),parseInt(a,16),1)}if(t.value.length===8){var n=t.value.substring(0,2),i=t.value.substring(2,4),a=t.value.substring(4,6),s=t.value.substring(6,8);return Ol(parseInt(n,16),parseInt(i,16),parseInt(a,16),parseInt(s,16)/255)}}if(t.type===20){var o=Po[t.value.toUpperCase()];if(typeof o<"u")return o}return Po.TRANSPARENT}},ql=function(e){return(255&e)===0},Gn=function(e){var t=255&e,r=255&e>>8,n=255&e>>16,i=255&e>>24;return t<255?"rgba("+i+","+n+","+r+","+t/255+")":"rgb("+i+","+n+","+r+")"},Ol=function(e,t,r,n){return(e<<24|t<<16|r<<8|Math.round(n*255)<<0)>>>0},uS=function(e,t){if(e.type===17)return e.number;if(e.type===16){var r=t===3?1:255;return t===3?e.number/100*r:Math.round(e.number/100*r)}return 0},fS=function(e,t){var r=t.filter(Zu);if(r.length===3){var n=r.map(uS),i=n[0],a=n[1],s=n[2];return Ol(i,a,s,1)}if(r.length===4){var o=r.map(uS),i=o[0],a=o[1],s=o[2],l=o[3];return Ol(i,a,s,l)}return 0};function Gx(e,t,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(t-e)*r*6+e:r<1/2?t:r<2/3?(t-e)*6*(2/3-r)+e:e}var hS=function(e,t){var r=t.filter(Zu),n=r[0],i=r[1],a=r[2],s=r[3],o=(n.type===17?Ja(n.number):U1.parse(e,n))/(Math.PI*2),l=Nn(i)?i.number/100:0,A=Nn(a)?a.number/100:0,u=typeof s<"u"&&Nn(s)?jr(s,1):1;if(l===0)return Ol(A*255,A*255,A*255,1);var f=A<=.5?A*(l+1):A+l-A*l,h=A*2-f,d=Gx(h,f,o+1/3),m=Gx(h,f,o),g=Gx(h,f,o-1/3);return Ol(d*255,m*255,g*255,u)},Kie={hsl:hS,hsla:hS,rgb:fS,rgba:fS},sd=function(e,t){return $l.parse(e,x6.create(t).parseComponentValue())},Po={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},Gie={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(Er(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Vie={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},O1=function(e,t){var r=$l.parse(e,t[0]),n=t[1];return n&&Nn(n)?{color:r,stop:n}:{color:r,stop:null}},dS=function(e,t){var r=e[0],n=e[e.length-1];r.stop===null&&(r.stop=ii),n.stop===null&&(n.stop=Ul);for(var i=[],a=0,s=0;s<e.length;s++){var o=e[s].stop;if(o!==null){var l=jr(o,t);l>a?i.push(l):i.push(a),a=l}else i.push(null)}for(var A=null,s=0;s<i.length;s++){var u=i[s];if(u===null)A===null&&(A=s);else if(A!==null){for(var f=s-A,h=i[A-1],d=(u-h)/(f+1),m=1;m<=f;m++)i[A+m-1]=d*m;A=null}}return e.map(function(g,x){var p=g.color;return{color:p,stop:Math.max(Math.min(1,i[x]/t),0)}})},Wie=function(e,t,r){var n=t/2,i=r/2,a=jr(e[0],t)-n,s=i-jr(e[1],r);return(Math.atan2(s,a)+Math.PI*2)%(Math.PI*2)},$ie=function(e,t,r){var n=typeof e=="number"?e:Wie(e,t,r),i=Math.abs(t*Math.sin(n))+Math.abs(r*Math.cos(n)),a=t/2,s=r/2,o=i/2,l=Math.sin(n-Math.PI/2)*o,A=Math.cos(n-Math.PI/2)*o;return[i,a-A,a+A,s-l,s+l]},ys=function(e,t){return Math.sqrt(e*e+t*t)},pS=function(e,t,r,n,i){var a=[[0,0],[0,t],[e,0],[e,t]];return a.reduce(function(s,o){var l=o[0],A=o[1],u=ys(r-l,n-A);return(i?u<s.optimumDistance:u>s.optimumDistance)?{optimumCorner:o,optimumDistance:u}:s},{optimumDistance:i?1/0:-1/0,optimumCorner:null}).optimumCorner},qie=function(e,t,r,n,i){var a=0,s=0;switch(e.size){case 0:e.shape===0?a=s=Math.min(Math.abs(t),Math.abs(t-n),Math.abs(r),Math.abs(r-i)):e.shape===1&&(a=Math.min(Math.abs(t),Math.abs(t-n)),s=Math.min(Math.abs(r),Math.abs(r-i)));break;case 2:if(e.shape===0)a=s=Math.min(ys(t,r),ys(t,r-i),ys(t-n,r),ys(t-n,r-i));else if(e.shape===1){var o=Math.min(Math.abs(r),Math.abs(r-i))/Math.min(Math.abs(t),Math.abs(t-n)),l=pS(n,i,t,r,!0),A=l[0],u=l[1];a=ys(A-t,(u-r)/o),s=o*a}break;case 1:e.shape===0?a=s=Math.max(Math.abs(t),Math.abs(t-n),Math.abs(r),Math.abs(r-i)):e.shape===1&&(a=Math.max(Math.abs(t),Math.abs(t-n)),s=Math.max(Math.abs(r),Math.abs(r-i)));break;case 3:if(e.shape===0)a=s=Math.max(ys(t,r),ys(t,r-i),ys(t-n,r),ys(t-n,r-i));else if(e.shape===1){var o=Math.max(Math.abs(r),Math.abs(r-i))/Math.max(Math.abs(t),Math.abs(t-n)),f=pS(n,i,t,r,!1),A=f[0],u=f[1];a=ys(A-t,(u-r)/o),s=o*a}break}return Array.isArray(e.size)&&(a=jr(e.size[0],n),s=e.size.length===2?jr(e.size[1],i):a),[a,s]},zie=function(e,t){var r=Ja(180),n=[];return Ao(t).forEach(function(i,a){if(a===0){var s=i[0];if(s.type===20&&s.value==="to"){r=E6(i);return}else if(S6(s)){r=U1.parse(e,s);return}}var o=O1(e,i);n.push(o)}),{angle:r,stops:n,type:1}},ag=function(e,t){var r=Ja(180),n=[];return Ao(t).forEach(function(i,a){if(a===0){var s=i[0];if(s.type===20&&["top","left","right","bottom"].indexOf(s.value)!==-1){r=E6(i);return}else if(S6(s)){r=(U1.parse(e,s)+Ja(270))%Ja(360);return}}var o=O1(e,i);n.push(o)}),{angle:r,stops:n,type:1}},Xie=function(e,t){var r=Ja(180),n=[],i=1,a=0,s=3,o=[];return Ao(t).forEach(function(l,A){var u=l[0];if(A===0){if(Er(u)&&u.value==="linear"){i=1;return}else if(Er(u)&&u.value==="radial"){i=2;return}}if(u.type===18){if(u.name==="from"){var f=$l.parse(e,u.values[0]);n.push({stop:ii,color:f})}else if(u.name==="to"){var f=$l.parse(e,u.values[0]);n.push({stop:Ul,color:f})}else if(u.name==="color-stop"){var h=u.values.filter(Zu);if(h.length===2){var f=$l.parse(e,h[1]),d=h[0];vf(d)&&n.push({stop:{type:16,number:d.number*100,flags:d.flags},color:f})}}}}),i===1?{angle:(r+Ja(180))%Ja(360),stops:n,type:i}:{size:s,shape:a,stops:n,position:o,type:i}},k6="closest-side",F6="farthest-side",N6="closest-corner",T6="farthest-corner",L6="circle",I6="ellipse",U6="cover",O6="contain",Yie=function(e,t){var r=0,n=3,i=[],a=[];return Ao(t).forEach(function(s,o){var l=!0;if(o===0){var A=!1;l=s.reduce(function(f,h){if(A)if(Er(h))switch(h.value){case"center":return a.push(g5),f;case"top":case"left":return a.push(ii),f;case"right":case"bottom":return a.push(Ul),f}else(Nn(h)||aA(h))&&a.push(h);else if(Er(h))switch(h.value){case L6:return r=0,!1;case I6:return r=1,!1;case"at":return A=!0,!1;case k6:return n=0,!1;case U6:case F6:return n=1,!1;case O6:case N6:return n=2,!1;case T6:return n=3,!1}else if(aA(h)||Nn(h))return Array.isArray(n)||(n=[]),n.push(h),!1;return f},l)}if(l){var u=O1(e,s);i.push(u)}}),{size:n,shape:r,stops:i,position:a,type:2}},sg=function(e,t){var r=0,n=3,i=[],a=[];return Ao(t).forEach(function(s,o){var l=!0;if(o===0?l=s.reduce(function(u,f){if(Er(f))switch(f.value){case"center":return a.push(g5),!1;case"top":case"left":return a.push(ii),!1;case"right":case"bottom":return a.push(Ul),!1}else if(Nn(f)||aA(f))return a.push(f),!1;return u},l):o===1&&(l=s.reduce(function(u,f){if(Er(f))switch(f.value){case L6:return r=0,!1;case I6:return r=1,!1;case O6:case k6:return n=0,!1;case F6:return n=1,!1;case N6:return n=2,!1;case U6:case T6:return n=3,!1}else if(aA(f)||Nn(f))return Array.isArray(n)||(n=[]),n.push(f),!1;return u},l)),l){var A=O1(e,s);i.push(A)}}),{size:n,shape:r,stops:i,position:a,type:2}},Jie=function(e){return e.type===1},Zie=function(e){return e.type===2},m5={name:"image",parse:function(e,t){if(t.type===22){var r={url:t.value,type:0};return e.cache.addImage(t.value),r}if(t.type===18){var n=j6[t.name];if(typeof n>"u")throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return n(e,t.values)}throw new Error("Unsupported image type "+t.type)}};function eae(e){return!(e.type===20&&e.value==="none")&&(e.type!==18||!!j6[e.name])}var j6={"linear-gradient":zie,"-moz-linear-gradient":ag,"-ms-linear-gradient":ag,"-o-linear-gradient":ag,"-webkit-linear-gradient":ag,"radial-gradient":Yie,"-moz-radial-gradient":sg,"-ms-radial-gradient":sg,"-o-radial-gradient":sg,"-webkit-radial-gradient":sg,"-webkit-gradient":Xie},tae={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t.filter(function(n){return Zu(n)&&eae(n)}).map(function(n){return m5.parse(e,n)})}},rae={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(Er(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},nae={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(e,t){return Ao(t).map(function(r){return r.filter(Nn)}).map(w6)}},iae={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(e,t){return Ao(t).map(function(r){return r.filter(Er).map(function(n){return n.value}).join(" ")}).map(aae)}},aae=function(e){switch(e){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},Qu;(function(e){e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover"})(Qu||(Qu={}));var sae={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(e,t){return Ao(t).map(function(r){return r.filter(oae)})}},oae=function(e){return Er(e)||Nn(e)},j1=function(e){return{name:"border-"+e+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},lae=j1("top"),Aae=j1("right"),cae=j1("bottom"),uae=j1("left"),D1=function(e){return{name:"border-radius-"+e,initialValue:"0 0",prefix:!1,type:1,parse:function(t,r){return w6(r.filter(Nn))}}},fae=D1("top-left"),hae=D1("top-right"),dae=D1("bottom-right"),pae=D1("bottom-left"),P1=function(e){return{name:"border-"+e+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},gae=P1("top"),mae=P1("right"),vae=P1("bottom"),xae=P1("left"),Q1=function(e){return{name:"border-"+e+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,r){return p0(r)?r.number:0}}},yae=Q1("top"),wae=Q1("right"),bae=Q1("bottom"),Bae=Q1("left"),_ae={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Cae={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(e,t){switch(t){case"rtl":return 1;case"ltr":default:return 0}}},Sae={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(e,t){return t.filter(Er).reduce(function(r,n){return r|Eae(n.value)},0)}},Eae=function(e){switch(e){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},kae={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Fae={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(e,t){return t.type===20&&t.value==="normal"?0:t.type===17||t.type===15?t.number:0}},km;(function(e){e.NORMAL="normal",e.STRICT="strict"})(km||(km={}));var Nae={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"strict":return km.STRICT;case"normal":default:return km.NORMAL}}},Tae={name:"line-height",initialValue:"normal",prefix:!1,type:4},gS=function(e,t){return Er(e)&&e.value==="normal"?1.2*t:e.type===17?t*e.number:Nn(e)?jr(e,t):t},Lae={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(e,t){return t.type===20&&t.value==="none"?null:m5.parse(e,t)}},Iae={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(e,t){switch(t){case"inside":return 0;case"outside":default:return 1}}},rw={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},R1=function(e){return{name:"margin-"+e,initialValue:"0",prefix:!1,type:4}},Uae=R1("top"),Oae=R1("right"),jae=R1("bottom"),Dae=R1("left"),Pae={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(e,t){return t.filter(Er).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},Qae={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-word":return"break-word";case"normal":default:return"normal"}}},M1=function(e){return{name:"padding-"+e,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},Rae=M1("top"),Mae=M1("right"),Hae=M1("bottom"),Kae=M1("left"),Gae={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(e,t){switch(t){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},Vae={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(e,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},Wae={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&tw(t[0],"none")?[]:Ao(t).map(function(r){for(var n={color:Po.TRANSPARENT,offsetX:ii,offsetY:ii,blur:ii},i=0,a=0;a<r.length;a++){var s=r[a];aA(s)?(i===0?n.offsetX=s:i===1?n.offsetY=s:n.blur=s,i++):n.color=$l.parse(e,s)}return n})}},$ae={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},qae={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(e,t){if(t.type===20&&t.value==="none")return null;if(t.type===18){var r=Yae[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return r(t.values)}return null}},zae=function(e){var t=e.filter(function(r){return r.type===17}).map(function(r){return r.number});return t.length===6?t:null},Xae=function(e){var t=e.filter(function(l){return l.type===17}).map(function(l){return l.number}),r=t[0],n=t[1];t[2],t[3];var i=t[4],a=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var s=t[12],o=t[13];return t[14],t[15],t.length===16?[r,n,i,a,s,o]:null},Yae={matrix:zae,matrix3d:Xae},mS={type:16,number:50,flags:d0},Jae=[mS,mS],Zae={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(e,t){var r=t.filter(Nn);return r.length!==2?Jae:[r[0],r[1]]}},ese={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},od;(function(e){e.NORMAL="normal",e.BREAK_ALL="break-all",e.KEEP_ALL="keep-all"})(od||(od={}));var tse={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-all":return od.BREAK_ALL;case"keep-all":return od.KEEP_ALL;case"normal":default:return od.NORMAL}}},rse={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(e,t){if(t.type===20)return{auto:!0,order:0};if(vf(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},D6={name:"time",parse:function(e,t){if(t.type===15)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},nse={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(e,t){return vf(t)?t.number:1}},ise={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},ase={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(e,t){return t.filter(Er).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},sse={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(e,t){var r=[],n=[];return t.forEach(function(i){switch(i.type){case 20:case 0:r.push(i.value);break;case 17:r.push(i.number.toString());break;case 4:n.push(r.join(" ")),r.length=0;break}}),r.length&&n.push(r.join(" ")),n.map(function(i){return i.indexOf(" ")===-1?i:"'"+i+"'"})}},ose={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},lse={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(e,t){if(vf(t))return t.number;if(Er(t))switch(t.value){case"bold":return 700;case"normal":default:return 400}return 400}},Ase={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.filter(Er).map(function(r){return r.value})}},cse={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},On=function(e,t){return(e&t)!==0},use={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t}},fse={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;for(var n=[],i=t.filter(y6),a=0;a<i.length;a++){var s=i[a],o=i[a+1];if(s.type===20){var l=o&&vf(o)?o.number:1;n.push({counter:s.value,increment:l})}}return n}},hse={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return[];for(var r=[],n=t.filter(y6),i=0;i<n.length;i++){var a=n[i],s=n[i+1];if(Er(a)&&a.value!=="none"){var o=s&&vf(s)?s.number:0;r.push({counter:a.value,reset:o})}}return r}},dse={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(e,t){return t.filter(p0).map(function(r){return D6.parse(e,r)})}},pse={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;var n=[],i=t.filter(Mie);if(i.length%2!==0)return null;for(var a=0;a<i.length;a+=2){var s=i[a].value,o=i[a+1].value;n.push({open:s,close:o})}return n}},vS=function(e,t,r){if(!e)return"";var n=e[Math.min(t,e.length-1)];return n?r?n.open:n.close:""},gse={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&tw(t[0],"none")?[]:Ao(t).map(function(r){for(var n={color:255,offsetX:ii,offsetY:ii,blur:ii,spread:ii,inset:!1},i=0,a=0;a<r.length;a++){var s=r[a];tw(s,"inset")?n.inset=!0:aA(s)?(i===0?n.offsetX=s:i===1?n.offsetY=s:i===2?n.blur=s:n.spread=s,i++):n.color=$l.parse(e,s)}return n})}},mse={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(e,t){var r=[0,1,2],n=[];return t.filter(Er).forEach(function(i){switch(i.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),r.forEach(function(i){n.indexOf(i)===-1&&n.push(i)}),n}},vse={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},xse={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return p0(t)?t.number:0}},yse=function(){function e(t,r){var n,i;this.animationDuration=yt(t,dse,r.animationDuration),this.backgroundClip=yt(t,Gie,r.backgroundClip),this.backgroundColor=yt(t,Vie,r.backgroundColor),this.backgroundImage=yt(t,tae,r.backgroundImage),this.backgroundOrigin=yt(t,rae,r.backgroundOrigin),this.backgroundPosition=yt(t,nae,r.backgroundPosition),this.backgroundRepeat=yt(t,iae,r.backgroundRepeat),this.backgroundSize=yt(t,sae,r.backgroundSize),this.borderTopColor=yt(t,lae,r.borderTopColor),this.borderRightColor=yt(t,Aae,r.borderRightColor),this.borderBottomColor=yt(t,cae,r.borderBottomColor),this.borderLeftColor=yt(t,uae,r.borderLeftColor),this.borderTopLeftRadius=yt(t,fae,r.borderTopLeftRadius),this.borderTopRightRadius=yt(t,hae,r.borderTopRightRadius),this.borderBottomRightRadius=yt(t,dae,r.borderBottomRightRadius),this.borderBottomLeftRadius=yt(t,pae,r.borderBottomLeftRadius),this.borderTopStyle=yt(t,gae,r.borderTopStyle),this.borderRightStyle=yt(t,mae,r.borderRightStyle),this.borderBottomStyle=yt(t,vae,r.borderBottomStyle),this.borderLeftStyle=yt(t,xae,r.borderLeftStyle),this.borderTopWidth=yt(t,yae,r.borderTopWidth),this.borderRightWidth=yt(t,wae,r.borderRightWidth),this.borderBottomWidth=yt(t,bae,r.borderBottomWidth),this.borderLeftWidth=yt(t,Bae,r.borderLeftWidth),this.boxShadow=yt(t,gse,r.boxShadow),this.color=yt(t,_ae,r.color),this.direction=yt(t,Cae,r.direction),this.display=yt(t,Sae,r.display),this.float=yt(t,kae,r.cssFloat),this.fontFamily=yt(t,sse,r.fontFamily),this.fontSize=yt(t,ose,r.fontSize),this.fontStyle=yt(t,cse,r.fontStyle),this.fontVariant=yt(t,Ase,r.fontVariant),this.fontWeight=yt(t,lse,r.fontWeight),this.letterSpacing=yt(t,Fae,r.letterSpacing),this.lineBreak=yt(t,Nae,r.lineBreak),this.lineHeight=yt(t,Tae,r.lineHeight),this.listStyleImage=yt(t,Lae,r.listStyleImage),this.listStylePosition=yt(t,Iae,r.listStylePosition),this.listStyleType=yt(t,rw,r.listStyleType),this.marginTop=yt(t,Uae,r.marginTop),this.marginRight=yt(t,Oae,r.marginRight),this.marginBottom=yt(t,jae,r.marginBottom),this.marginLeft=yt(t,Dae,r.marginLeft),this.opacity=yt(t,nse,r.opacity);var a=yt(t,Pae,r.overflow);this.overflowX=a[0],this.overflowY=a[a.length>1?1:0],this.overflowWrap=yt(t,Qae,r.overflowWrap),this.paddingTop=yt(t,Rae,r.paddingTop),this.paddingRight=yt(t,Mae,r.paddingRight),this.paddingBottom=yt(t,Hae,r.paddingBottom),this.paddingLeft=yt(t,Kae,r.paddingLeft),this.paintOrder=yt(t,mse,r.paintOrder),this.position=yt(t,Vae,r.position),this.textAlign=yt(t,Gae,r.textAlign),this.textDecorationColor=yt(t,ise,(n=r.textDecorationColor)!==null&&n!==void 0?n:r.color),this.textDecorationLine=yt(t,ase,(i=r.textDecorationLine)!==null&&i!==void 0?i:r.textDecoration),this.textShadow=yt(t,Wae,r.textShadow),this.textTransform=yt(t,$ae,r.textTransform),this.transform=yt(t,qae,r.transform),this.transformOrigin=yt(t,Zae,r.transformOrigin),this.visibility=yt(t,ese,r.visibility),this.webkitTextStrokeColor=yt(t,vse,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=yt(t,xse,r.webkitTextStrokeWidth),this.wordBreak=yt(t,tse,r.wordBreak),this.zIndex=yt(t,rse,r.zIndex)}return e.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},e.prototype.isTransparent=function(){return ql(this.backgroundColor)},e.prototype.isTransformed=function(){return this.transform!==null},e.prototype.isPositioned=function(){return this.position!==0},e.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},e.prototype.isFloating=function(){return this.float!==0},e.prototype.isInlineLevel=function(){return On(this.display,4)||On(this.display,33554432)||On(this.display,268435456)||On(this.display,536870912)||On(this.display,67108864)||On(this.display,134217728)},e}(),wse=function(){function e(t,r){this.content=yt(t,use,r.content),this.quotes=yt(t,pse,r.quotes)}return e}(),xS=function(){function e(t,r){this.counterIncrement=yt(t,fse,r.counterIncrement),this.counterReset=yt(t,hse,r.counterReset)}return e}(),yt=function(e,t,r){var n=new v6,i=r!==null&&typeof r<"u"?r.toString():t.initialValue;n.write(i);var a=new x6(n.read());switch(t.type){case 2:var s=a.parseComponentValue();return t.parse(e,Er(s)?s.value:t.initialValue);case 0:return t.parse(e,a.parseComponentValue());case 1:return t.parse(e,a.parseComponentValues());case 4:return a.parseComponentValue();case 3:switch(t.format){case"angle":return U1.parse(e,a.parseComponentValue());case"color":return $l.parse(e,a.parseComponentValue());case"image":return m5.parse(e,a.parseComponentValue());case"length":var o=a.parseComponentValue();return aA(o)?o:ii;case"length-percentage":var l=a.parseComponentValue();return Nn(l)?l:ii;case"time":return D6.parse(e,a.parseComponentValue())}break}},bse="data-html2canvas-debug",Bse=function(e){var t=e.getAttribute(bse);switch(t){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},nw=function(e,t){var r=Bse(e);return r===1||t===r},co=function(){function e(t,r){if(this.context=t,this.textNodes=[],this.elements=[],this.flags=0,nw(r,3))debugger;this.styles=new yse(t,window.getComputedStyle(r,null)),sw(r)&&(this.styles.animationDuration.some(function(n){return n>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=L1(this.context,r),nw(r,4)&&(this.flags|=16)}return e}(),_se="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",yS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",kh=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var og=0;og<yS.length;og++)kh[yS.charCodeAt(og)]=og;var Cse=function(e){var t=e.length*.75,r=e.length,n,i=0,a,s,o,l;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var A=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),u=Array.isArray(A)?A:new Uint8Array(A);for(n=0;n<r;n+=4)a=kh[e.charCodeAt(n)],s=kh[e.charCodeAt(n+1)],o=kh[e.charCodeAt(n+2)],l=kh[e.charCodeAt(n+3)],u[i++]=a<<2|s>>4,u[i++]=(s&15)<<4|o>>2,u[i++]=(o&3)<<6|l&63;return A},Sse=function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r.push(e[n+1]<<8|e[n]);return r},Ese=function(e){for(var t=e.length,r=[],n=0;n<t;n+=4)r.push(e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]);return r},YA=5,v5=11,Vx=2,kse=v5-YA,P6=65536>>YA,Fse=1<<YA,Wx=Fse-1,Nse=1024>>YA,Tse=P6+Nse,Lse=Tse,Ise=32,Use=Lse+Ise,Ose=65536>>v5,jse=1<<kse,Dse=jse-1,wS=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},Pse=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},Qse=function(e,t){var r=Cse(e),n=Array.isArray(r)?Ese(r):new Uint32Array(r),i=Array.isArray(r)?Sse(r):new Uint16Array(r),a=24,s=wS(i,a/2,n[4]/2),o=n[5]===2?wS(i,(a+n[4])/2):Pse(n,Math.ceil((a+n[4])/4));return new Rse(n[0],n[1],n[2],n[3],s,o)},Rse=function(){function e(t,r,n,i,a,s){this.initialValue=t,this.errorValue=r,this.highStart=n,this.highValueIndex=i,this.index=a,this.data=s}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>YA],r=(r<<Vx)+(t&Wx),this.data[r];if(t<=65535)return r=this.index[P6+(t-55296>>YA)],r=(r<<Vx)+(t&Wx),this.data[r];if(t<this.highStart)return r=Use-Ose+(t>>v5),r=this.index[r],r+=t>>YA&Dse,r=this.index[r],r=(r<<Vx)+(t&Wx),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),bS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Mse=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var lg=0;lg<bS.length;lg++)Mse[bS.charCodeAt(lg)]=lg;var Hse=1,$x=2,qx=3,BS=4,_S=5,Kse=7,CS=8,zx=9,Xx=10,SS=11,ES=12,kS=13,FS=14,Yx=15,Gse=function(e){for(var t=[],r=0,n=e.length;r<n;){var i=e.charCodeAt(r++);if(i>=55296&&i<=56319&&r<n){var a=e.charCodeAt(r++);(a&64512)===56320?t.push(((i&1023)<<10)+(a&1023)+65536):(t.push(i),r--)}else t.push(i)}return t},Vse=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var n=[],i=-1,a="";++i<r;){var s=e[i];s<=65535?n.push(s):(s-=65536,n.push((s>>10)+55296,s%1024+56320)),(i+1===r||n.length>16384)&&(a+=String.fromCharCode.apply(String,n),n.length=0)}return a},Wse=Qse(_se),Va="×",Jx="÷",$se=function(e){return Wse.get(e)},qse=function(e,t,r){var n=r-2,i=t[n],a=t[r-1],s=t[r];if(a===$x&&s===qx)return Va;if(a===$x||a===qx||a===BS||s===$x||s===qx||s===BS)return Jx;if(a===CS&&[CS,zx,SS,ES].indexOf(s)!==-1||(a===SS||a===zx)&&(s===zx||s===Xx)||(a===ES||a===Xx)&&s===Xx||s===kS||s===_S||s===Kse||a===Hse)return Va;if(a===kS&&s===FS){for(;i===_S;)i=t[--n];if(i===FS)return Va}if(a===Yx&&s===Yx){for(var o=0;i===Yx;)o++,i=t[--n];if(o%2===0)return Va}return Jx},zse=function(e){var t=Gse(e),r=t.length,n=0,i=0,a=t.map($se);return{next:function(){if(n>=r)return{done:!0,value:null};for(var s=Va;n<r&&(s=qse(t,a,++n))===Va;);if(s!==Va||n===r){var o=Vse.apply(null,t.slice(i,n));return i=n,{value:o,done:!1}}return{done:!0,value:null}}}},Xse=function(e){for(var t=zse(e),r=[],n;!(n=t.next()).done;)n.value&&r.push(n.value.slice());return r},Yse=function(e){var t=123;if(e.createRange){var r=e.createRange();if(r.getBoundingClientRect){var n=e.createElement("boundtest");n.style.height=t+"px",n.style.display="block",e.body.appendChild(n),r.selectNode(n);var i=r.getBoundingClientRect(),a=Math.round(i.height);if(e.body.removeChild(n),a===t)return!0}}return!1},Jse=function(e){var t=e.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",e.body.appendChild(t);var r=e.createRange();t.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=t.firstChild,i=I1(n.data).map(function(l){return gn(l)}),a=0,s={},o=i.every(function(l,A){r.setStart(n,a),r.setEnd(n,a+l.length);var u=r.getBoundingClientRect();a+=l.length;var f=u.x>s.x||u.y>s.y;return s=u,A===0?!0:f});return e.body.removeChild(t),o},Zse=function(){return typeof new Image().crossOrigin<"u"},eoe=function(){return typeof new XMLHttpRequest().responseType=="string"},toe=function(e){var t=new Image,r=e.createElement("canvas"),n=r.getContext("2d");if(!n)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(t,0,0),r.toDataURL()}catch{return!1}return!0},NS=function(e){return e[0]===0&&e[1]===255&&e[2]===0&&e[3]===255},roe=function(e){var t=e.createElement("canvas"),r=100;t.width=r,t.height=r;var n=t.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,r,r);var i=new Image,a=t.toDataURL();i.src=a;var s=iw(r,r,0,0,i);return n.fillStyle="red",n.fillRect(0,0,r,r),TS(s).then(function(o){n.drawImage(o,0,0);var l=n.getImageData(0,0,r,r).data;n.fillStyle="red",n.fillRect(0,0,r,r);var A=e.createElement("div");return A.style.backgroundImage="url("+a+")",A.style.height=r+"px",NS(l)?TS(iw(r,r,0,0,A)):Promise.reject(!1)}).then(function(o){return n.drawImage(o,0,0),NS(n.getImageData(0,0,r,r).data)}).catch(function(){return!1})},iw=function(e,t,r,n,i){var a="http://www.w3.org/2000/svg",s=document.createElementNS(a,"svg"),o=document.createElementNS(a,"foreignObject");return s.setAttributeNS(null,"width",e.toString()),s.setAttributeNS(null,"height",t.toString()),o.setAttributeNS(null,"width","100%"),o.setAttributeNS(null,"height","100%"),o.setAttributeNS(null,"x",r.toString()),o.setAttributeNS(null,"y",n.toString()),o.setAttributeNS(null,"externalResourcesRequired","true"),s.appendChild(o),o.appendChild(i),s},TS=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){return t(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},ti={get SUPPORT_RANGE_BOUNDS(){var e=Yse(document);return Object.defineProperty(ti,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_WORD_BREAKING(){var e=ti.SUPPORT_RANGE_BOUNDS&&Jse(document);return Object.defineProperty(ti,"SUPPORT_WORD_BREAKING",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=toe(document);return Object.defineProperty(ti,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e=typeof Array.from=="function"&&typeof window.fetch=="function"?roe(document):Promise.resolve(!1);return Object.defineProperty(ti,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=Zse();return Object.defineProperty(ti,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e=eoe();return Object.defineProperty(ti,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty(ti,"SUPPORT_CORS_XHR",{value:e}),e},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var e=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(ti,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:e}),e}},ld=function(){function e(t,r){this.text=t,this.bounds=r}return e}(),noe=function(e,t,r,n){var i=soe(t,r),a=[],s=0;return i.forEach(function(o){if(r.textDecorationLine.length||o.trim().length>0)if(ti.SUPPORT_RANGE_BOUNDS){var l=LS(n,s,o.length).getClientRects();if(l.length>1){var A=x5(o),u=0;A.forEach(function(h){a.push(new ld(h,Go.fromDOMRectList(e,LS(n,u+s,h.length).getClientRects()))),u+=h.length})}else a.push(new ld(o,Go.fromDOMRectList(e,l)))}else{var f=n.splitText(o.length);a.push(new ld(o,ioe(e,n))),n=f}else ti.SUPPORT_RANGE_BOUNDS||(n=n.splitText(o.length));s+=o.length}),a},ioe=function(e,t){var r=t.ownerDocument;if(r){var n=r.createElement("html2canvaswrapper");n.appendChild(t.cloneNode(!0));var i=t.parentNode;if(i){i.replaceChild(n,t);var a=L1(e,n);return n.firstChild&&i.replaceChild(n.firstChild,n),a}}return Go.EMPTY},LS=function(e,t,r){var n=e.ownerDocument;if(!n)throw new Error("Node has no owner document");var i=n.createRange();return i.setStart(e,t),i.setEnd(e,t+r),i},x5=function(e){if(ti.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(e)).map(function(r){return r.segment})}return Xse(e)},aoe=function(e,t){if(ti.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(e)).map(function(n){return n.segment})}return loe(e,t)},soe=function(e,t){return t.letterSpacing!==0?x5(e):aoe(e,t)},ooe=[32,160,4961,65792,65793,4153,4241],loe=function(e,t){for(var r=One(e,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap==="break-word"?"break-word":t.wordBreak}),n=[],i,a=function(){if(i.value){var s=i.value.slice(),o=I1(s),l="";o.forEach(function(A){ooe.indexOf(A)===-1?l+=gn(A):(l.length&&n.push(l),n.push(gn(A)),l="")}),l.length&&n.push(l)}};!(i=r.next()).done;)a();return n},Aoe=function(){function e(t,r,n){this.text=coe(r.data,n.textTransform),this.textBounds=noe(t,this.text,n,r)}return e}(),coe=function(e,t){switch(t){case 1:return e.toLowerCase();case 3:return e.replace(uoe,foe);case 2:return e.toUpperCase();default:return e}},uoe=/(^|\s|:|-|\(|\))([a-z])/g,foe=function(e,t,r){return e.length>0?t+r.toUpperCase():e},Q6=function(e){Ds(t,e);function t(r,n){var i=e.call(this,r,n)||this;return i.src=n.currentSrc||n.src,i.intrinsicWidth=n.naturalWidth,i.intrinsicHeight=n.naturalHeight,i.context.cache.addImage(i.src),i}return t}(co),R6=function(e){Ds(t,e);function t(r,n){var i=e.call(this,r,n)||this;return i.canvas=n,i.intrinsicWidth=n.width,i.intrinsicHeight=n.height,i}return t}(co),M6=function(e){Ds(t,e);function t(r,n){var i=e.call(this,r,n)||this,a=new XMLSerializer,s=L1(r,n);return n.setAttribute("width",s.width+"px"),n.setAttribute("height",s.height+"px"),i.svg="data:image/svg+xml,"+encodeURIComponent(a.serializeToString(n)),i.intrinsicWidth=n.width.baseVal.value,i.intrinsicHeight=n.height.baseVal.value,i.context.cache.addImage(i.svg),i}return t}(co),H6=function(e){Ds(t,e);function t(r,n){var i=e.call(this,r,n)||this;return i.value=n.value,i}return t}(co),aw=function(e){Ds(t,e);function t(r,n){var i=e.call(this,r,n)||this;return i.start=n.start,i.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,i}return t}(co),hoe=[{type:15,flags:0,unit:"px",number:3}],doe=[{type:16,flags:0,number:50}],poe=function(e){return e.width>e.height?new Go(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new Go(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e},goe=function(e){var t=e.type===moe?new Array(e.value.length+1).join("•"):e.value;return t.length===0?e.placeholder||"":t},Fm="checkbox",Nm="radio",moe="password",IS=707406591,y5=function(e){Ds(t,e);function t(r,n){var i=e.call(this,r,n)||this;switch(i.type=n.type.toLowerCase(),i.checked=n.checked,i.value=goe(n),(i.type===Fm||i.type===Nm)&&(i.styles.backgroundColor=3739148031,i.styles.borderTopColor=i.styles.borderRightColor=i.styles.borderBottomColor=i.styles.borderLeftColor=2779096575,i.styles.borderTopWidth=i.styles.borderRightWidth=i.styles.borderBottomWidth=i.styles.borderLeftWidth=1,i.styles.borderTopStyle=i.styles.borderRightStyle=i.styles.borderBottomStyle=i.styles.borderLeftStyle=1,i.styles.backgroundClip=[0],i.styles.backgroundOrigin=[0],i.bounds=poe(i.bounds)),i.type){case Fm:i.styles.borderTopRightRadius=i.styles.borderTopLeftRadius=i.styles.borderBottomRightRadius=i.styles.borderBottomLeftRadius=hoe;break;case Nm:i.styles.borderTopRightRadius=i.styles.borderTopLeftRadius=i.styles.borderBottomRightRadius=i.styles.borderBottomLeftRadius=doe;break}return i}return t}(co),K6=function(e){Ds(t,e);function t(r,n){var i=e.call(this,r,n)||this,a=n.options[n.selectedIndex||0];return i.value=a&&a.text||"",i}return t}(co),G6=function(e){Ds(t,e);function t(r,n){var i=e.call(this,r,n)||this;return i.value=n.value,i}return t}(co),V6=function(e){Ds(t,e);function t(r,n){var i=e.call(this,r,n)||this;i.src=n.src,i.width=parseInt(n.width,10)||0,i.height=parseInt(n.height,10)||0,i.backgroundColor=i.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){i.tree=$6(r,n.contentWindow.document.documentElement);var a=n.contentWindow.document.documentElement?sd(r,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):Po.TRANSPARENT,s=n.contentWindow.document.body?sd(r,getComputedStyle(n.contentWindow.document.body).backgroundColor):Po.TRANSPARENT;i.backgroundColor=ql(a)?ql(s)?i.styles.backgroundColor:s:a}}catch{}return i}return t}(co),voe=["OL","UL","MENU"],kg=function(e,t,r,n){for(var i=t.firstChild,a=void 0;i;i=a)if(a=i.nextSibling,q6(i)&&i.data.trim().length>0)r.textNodes.push(new Aoe(e,i,r.styles));else if(ku(i))if(J6(i)&&i.assignedNodes)i.assignedNodes().forEach(function(o){return kg(e,o,r,n)});else{var s=W6(e,i);s.styles.isVisible()&&(xoe(i,s,n)?s.flags|=4:yoe(s.styles)&&(s.flags|=2),voe.indexOf(i.tagName)!==-1&&(s.flags|=8),r.elements.push(s),i.slot,i.shadowRoot?kg(e,i.shadowRoot,s,n):!Tm(i)&&!z6(i)&&!Lm(i)&&kg(e,i,s,n))}},W6=function(e,t){return ow(t)?new Q6(e,t):X6(t)?new R6(e,t):z6(t)?new M6(e,t):woe(t)?new H6(e,t):boe(t)?new aw(e,t):Boe(t)?new y5(e,t):Lm(t)?new K6(e,t):Tm(t)?new G6(e,t):Y6(t)?new V6(e,t):new co(e,t)},$6=function(e,t){var r=W6(e,t);return r.flags|=4,kg(e,t,r,r),r},xoe=function(e,t,r){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||w5(e)&&r.styles.isTransparent()},yoe=function(e){return e.isPositioned()||e.isFloating()},q6=function(e){return e.nodeType===Node.TEXT_NODE},ku=function(e){return e.nodeType===Node.ELEMENT_NODE},sw=function(e){return ku(e)&&typeof e.style<"u"&&!Fg(e)},Fg=function(e){return typeof e.className=="object"},woe=function(e){return e.tagName==="LI"},boe=function(e){return e.tagName==="OL"},Boe=function(e){return e.tagName==="INPUT"},_oe=function(e){return e.tagName==="HTML"},z6=function(e){return e.tagName==="svg"},w5=function(e){return e.tagName==="BODY"},X6=function(e){return e.tagName==="CANVAS"},US=function(e){return e.tagName==="VIDEO"},ow=function(e){return e.tagName==="IMG"},Y6=function(e){return e.tagName==="IFRAME"},OS=function(e){return e.tagName==="STYLE"},Coe=function(e){return e.tagName==="SCRIPT"},Tm=function(e){return e.tagName==="TEXTAREA"},Lm=function(e){return e.tagName==="SELECT"},J6=function(e){return e.tagName==="SLOT"},jS=function(e){return e.tagName.indexOf("-")>0},Soe=function(){function e(){this.counters={}}return e.prototype.getCounterValue=function(t){var r=this.counters[t];return r&&r.length?r[r.length-1]:1},e.prototype.getCounterValues=function(t){var r=this.counters[t];return r||[]},e.prototype.pop=function(t){var r=this;t.forEach(function(n){return r.counters[n].pop()})},e.prototype.parse=function(t){var r=this,n=t.counterIncrement,i=t.counterReset,a=!0;n!==null&&n.forEach(function(o){var l=r.counters[o.counter];l&&o.increment!==0&&(a=!1,l.length||l.push(1),l[Math.max(0,l.length-1)]+=o.increment)});var s=[];return a&&i.forEach(function(o){var l=r.counters[o.counter];s.push(o.counter),l||(l=r.counters[o.counter]=[]),l.push(o.reset)}),s},e}(),DS={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},PS={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Ք","Փ","Ւ","Ց","Ր","Տ","Վ","Ս","Ռ","Ջ","Պ","Չ","Ո","Շ","Ն","Յ","Մ","Ճ","Ղ","Ձ","Հ","Կ","Ծ","Խ","Լ","Ի","Ժ","Թ","Ը","Է","Զ","Ե","Դ","Գ","Բ","Ա"]},Eoe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["י׳","ט׳","ח׳","ז׳","ו׳","ה׳","ד׳","ג׳","ב׳","א׳","ת","ש","ר","ק","צ","פ","ע","ס","נ","מ","ל","כ","יט","יח","יז","טז","טו","י","ט","ח","ז","ו","ה","ד","ג","ב","א"]},koe={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["ჵ","ჰ","ჯ","ჴ","ხ","ჭ","წ","ძ","ც","ჩ","შ","ყ","ღ","ქ","ფ","ჳ","ტ","ს","რ","ჟ","პ","ო","ჲ","ნ","მ","ლ","კ","ი","თ","ჱ","ზ","ვ","ე","დ","გ","ბ","ა"]},au=function(e,t,r,n,i,a){return e<t||e>r?Xd(e,i,a.length>0):n.integers.reduce(function(s,o,l){for(;e>=o;)e-=o,s+=n.values[l];return s},"")+a},Z6=function(e,t,r,n){var i="";do r||e--,i=n(e)+i,e/=t;while(e*t>=t);return i},dn=function(e,t,r,n,i){var a=r-t+1;return(e<0?"-":"")+(Z6(Math.abs(e),a,n,function(s){return gn(Math.floor(s%a)+t)})+i)},_A=function(e,t,r){r===void 0&&(r=". ");var n=t.length;return Z6(Math.abs(e),n,!1,function(i){return t[Math.floor(i%n)]})+r},hu=1,gl=2,ml=4,Fh=8,_o=function(e,t,r,n,i,a){if(e<-9999||e>9999)return Xd(e,4,i.length>0);var s=Math.abs(e),o=i;if(s===0)return t[0]+o;for(var l=0;s>0&&l<=4;l++){var A=s%10;A===0&&On(a,hu)&&o!==""?o=t[A]+o:A>1||A===1&&l===0||A===1&&l===1&&On(a,gl)||A===1&&l===1&&On(a,ml)&&e>100||A===1&&l>1&&On(a,Fh)?o=t[A]+(l>0?r[l-1]:"")+o:A===1&&l>0&&(o=r[l-1]+o),s=Math.floor(s/10)}return(e<0?n:"")+o},QS="十百千萬",RS="拾佰仟萬",MS="マイナス",Zx="마이너스",Xd=function(e,t,r){var n=r?". ":"",i=r?"、":"",a=r?", ":"",s=r?" ":"";switch(t){case 0:return"•"+s;case 1:return"◦"+s;case 2:return"◾"+s;case 5:var o=dn(e,48,57,!0,n);return o.length<4?"0"+o:o;case 4:return _A(e,"〇一二三四五六七八九",i);case 6:return au(e,1,3999,DS,3,n).toLowerCase();case 7:return au(e,1,3999,DS,3,n);case 8:return dn(e,945,969,!1,n);case 9:return dn(e,97,122,!1,n);case 10:return dn(e,65,90,!1,n);case 11:return dn(e,1632,1641,!0,n);case 12:case 49:return au(e,1,9999,PS,3,n);case 35:return au(e,1,9999,PS,3,n).toLowerCase();case 13:return dn(e,2534,2543,!0,n);case 14:case 30:return dn(e,6112,6121,!0,n);case 15:return _A(e,"子丑寅卯辰巳午未申酉戌亥",i);case 16:return _A(e,"甲乙丙丁戊己庚辛壬癸",i);case 17:case 48:return _o(e,"零一二三四五六七八九",QS,"負",i,gl|ml|Fh);case 47:return _o(e,"零壹貳參肆伍陸柒捌玖",RS,"負",i,hu|gl|ml|Fh);case 42:return _o(e,"零一二三四五六七八九",QS,"负",i,gl|ml|Fh);case 41:return _o(e,"零壹贰叁肆伍陆柒捌玖",RS,"负",i,hu|gl|ml|Fh);case 26:return _o(e,"〇一二三四五六七八九","十百千万",MS,i,0);case 25:return _o(e,"零壱弐参四伍六七八九","拾百千万",MS,i,hu|gl|ml);case 31:return _o(e,"영일이삼사오육칠팔구","십백천만",Zx,a,hu|gl|ml);case 33:return _o(e,"零一二三四五六七八九","十百千萬",Zx,a,0);case 32:return _o(e,"零壹貳參四五六七八九","拾百千",Zx,a,hu|gl|ml);case 18:return dn(e,2406,2415,!0,n);case 20:return au(e,1,19999,koe,3,n);case 21:return dn(e,2790,2799,!0,n);case 22:return dn(e,2662,2671,!0,n);case 22:return au(e,1,10999,Eoe,3,n);case 23:return _A(e,"あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわゐゑをん");case 24:return _A(e,"いろはにほへとちりぬるをわかよたれそつねならむうゐのおくやまけふこえてあさきゆめみしゑひもせす");case 27:return dn(e,3302,3311,!0,n);case 28:return _A(e,"アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヰヱヲン",i);case 29:return _A(e,"イロハニホヘトチリヌルヲワカヨタレソツネナラムウヰノオクヤマケフコエテアサキユメミシヱヒモセス",i);case 34:return dn(e,3792,3801,!0,n);case 37:return dn(e,6160,6169,!0,n);case 38:return dn(e,4160,4169,!0,n);case 39:return dn(e,2918,2927,!0,n);case 40:return dn(e,1776,1785,!0,n);case 43:return dn(e,3046,3055,!0,n);case 44:return dn(e,3174,3183,!0,n);case 45:return dn(e,3664,3673,!0,n);case 46:return dn(e,3872,3881,!0,n);case 3:default:return dn(e,48,57,!0,n)}},eL="data-html2canvas-ignore",HS=function(){function e(t,r,n){if(this.context=t,this.options=n,this.scrolledElements=[],this.referenceElement=r,this.counters=new Soe,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return e.prototype.toIFrame=function(t,r){var n=this,i=Foe(t,r);if(!i.contentWindow)return Promise.reject("Unable to find iframe window");var a=t.defaultView.pageXOffset,s=t.defaultView.pageYOffset,o=i.contentWindow,l=o.document,A=Loe(i).then(function(){return ji(n,void 0,void 0,function(){var u,f;return vi(this,function(h){switch(h.label){case 0:return this.scrolledElements.forEach(joe),o&&(o.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(o.scrollY!==r.top||o.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(o.scrollX-r.left,o.scrollY-r.top,0,0))),u=this.options.onclone,f=this.clonedReferenceElement,typeof f>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:l.fonts&&l.fonts.ready?[4,l.fonts.ready]:[3,2];case 1:h.sent(),h.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,Toe(l)]:[3,4];case 3:h.sent(),h.label=4;case 4:return typeof u=="function"?[2,Promise.resolve().then(function(){return u(l,f)}).then(function(){return i})]:[2,i]}})})});return l.open(),l.write(Uoe(document.doctype)+"<html></html>"),Ooe(this.referenceElement.ownerDocument,a,s),l.replaceChild(l.adoptNode(this.documentElement),l.documentElement),l.close(),A},e.prototype.createElementClone=function(t){if(nw(t,2))debugger;if(X6(t))return this.createCanvasClone(t);if(US(t))return this.createVideoClone(t);if(OS(t))return this.createStyleClone(t);var r=t.cloneNode(!1);return ow(r)&&(ow(t)&&t.currentSrc&&t.currentSrc!==t.src&&(r.src=t.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),jS(r)?this.createCustomElementClone(r):r},e.prototype.createCustomElementClone=function(t){var r=document.createElement("html2canvascustomelement");return e2(t.style,r),r},e.prototype.createStyleClone=function(t){try{var r=t.sheet;if(r&&r.cssRules){var n=[].slice.call(r.cssRules,0).reduce(function(a,s){return s&&typeof s.cssText=="string"?a+s.cssText:a},""),i=t.cloneNode(!1);return i.textContent=n,i}}catch(a){if(this.context.logger.error("Unable to access cssRules property",a),a.name!=="SecurityError")throw a}return t.cloneNode(!1)},e.prototype.createCanvasClone=function(t){var r;if(this.options.inlineImages&&t.ownerDocument){var n=t.ownerDocument.createElement("img");try{return n.src=t.toDataURL(),n}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}var i=t.cloneNode(!1);try{i.width=t.width,i.height=t.height;var a=t.getContext("2d"),s=i.getContext("2d");if(s)if(!this.options.allowTaint&&a)s.putImageData(a.getImageData(0,0,t.width,t.height),0,0);else{var o=(r=t.getContext("webgl2"))!==null&&r!==void 0?r:t.getContext("webgl");if(o){var l=o.getContextAttributes();(l==null?void 0:l.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}s.drawImage(t,0,0)}return i}catch{this.context.logger.info("Unable to clone canvas as it is tainted",t)}return i},e.prototype.createVideoClone=function(t){var r=t.ownerDocument.createElement("canvas");r.width=t.offsetWidth,r.height=t.offsetHeight;var n=r.getContext("2d");try{return n&&(n.drawImage(t,0,0,r.width,r.height),this.options.allowTaint||n.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",t)}var i=t.ownerDocument.createElement("canvas");return i.width=t.offsetWidth,i.height=t.offsetHeight,i},e.prototype.appendChildNode=function(t,r,n){(!ku(r)||!Coe(r)&&!r.hasAttribute(eL)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!ku(r)||!OS(r))&&t.appendChild(this.cloneNode(r,n))},e.prototype.cloneChildNodes=function(t,r,n){for(var i=this,a=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;a;a=a.nextSibling)if(ku(a)&&J6(a)&&typeof a.assignedNodes=="function"){var s=a.assignedNodes();s.length&&s.forEach(function(o){return i.appendChildNode(r,o,n)})}else this.appendChildNode(r,a,n)},e.prototype.cloneNode=function(t,r){if(q6(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);var n=t.ownerDocument.defaultView;if(n&&ku(t)&&(sw(t)||Fg(t))){var i=this.createElementClone(t);i.style.transitionProperty="none";var a=n.getComputedStyle(t),s=n.getComputedStyle(t,":before"),o=n.getComputedStyle(t,":after");this.referenceElement===t&&sw(i)&&(this.clonedReferenceElement=i),w5(i)&&Qoe(i);var l=this.counters.parse(new xS(this.context,a)),A=this.resolvePseudoContent(t,i,s,Ad.BEFORE);jS(t)&&(r=!0),US(t)||this.cloneChildNodes(t,i,r),A&&i.insertBefore(A,i.firstChild);var u=this.resolvePseudoContent(t,i,o,Ad.AFTER);return u&&i.appendChild(u),this.counters.pop(l),(a&&(this.options.copyStyles||Fg(t))&&!Y6(t)||r)&&e2(a,i),(t.scrollTop!==0||t.scrollLeft!==0)&&this.scrolledElements.push([i,t.scrollLeft,t.scrollTop]),(Tm(t)||Lm(t))&&(Tm(i)||Lm(i))&&(i.value=t.value),i}return t.cloneNode(!1)},e.prototype.resolvePseudoContent=function(t,r,n,i){var a=this;if(n){var s=n.content,o=r.ownerDocument;if(!(!o||!s||s==="none"||s==="-moz-alt-content"||n.display==="none")){this.counters.parse(new xS(this.context,n));var l=new wse(this.context,n),A=o.createElement("html2canvaspseudoelement");e2(n,A),l.content.forEach(function(f){if(f.type===0)A.appendChild(o.createTextNode(f.value));else if(f.type===22){var h=o.createElement("img");h.src=f.value,h.style.opacity="1",A.appendChild(h)}else if(f.type===18){if(f.name==="attr"){var d=f.values.filter(Er);d.length&&A.appendChild(o.createTextNode(t.getAttribute(d[0].value)||""))}else if(f.name==="counter"){var m=f.values.filter(Zu),g=m[0],x=m[1];if(g&&Er(g)){var p=a.counters.getCounterValue(g.value),v=x&&Er(x)?rw.parse(a.context,x.value):3;A.appendChild(o.createTextNode(Xd(p,v,!1)))}}else if(f.name==="counters"){var y=f.values.filter(Zu),g=y[0],w=y[1],x=y[2];if(g&&Er(g)){var B=a.counters.getCounterValues(g.value),E=x&&Er(x)?rw.parse(a.context,x.value):3,_=w&&w.type===0?w.value:"",F=B.map(function(S){return Xd(S,E,!1)}).join(_);A.appendChild(o.createTextNode(F))}}}else if(f.type===20)switch(f.value){case"open-quote":A.appendChild(o.createTextNode(vS(l.quotes,a.quoteDepth++,!0)));break;case"close-quote":A.appendChild(o.createTextNode(vS(l.quotes,--a.quoteDepth,!1)));break;default:A.appendChild(o.createTextNode(f.value))}}),A.className=lw+" "+Aw;var u=i===Ad.BEFORE?" "+lw:" "+Aw;return Fg(r)?r.className.baseValue+=u:r.className+=u,A}}},e.destroy=function(t){return t.parentNode?(t.parentNode.removeChild(t),!0):!1},e}(),Ad;(function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER"})(Ad||(Ad={}));var Foe=function(e,t){var r=e.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=t.width.toString(),r.height=t.height.toString(),r.scrolling="no",r.setAttribute(eL,"true"),e.body.appendChild(r),r},Noe=function(e){return new Promise(function(t){if(e.complete){t();return}if(!e.src){t();return}e.onload=t,e.onerror=t})},Toe=function(e){return Promise.all([].slice.call(e.images,0).map(Noe))},Loe=function(e){return new Promise(function(t,r){var n=e.contentWindow;if(!n)return r("No window assigned for iframe");var i=n.document;n.onload=e.onload=function(){n.onload=e.onload=null;var a=setInterval(function(){i.body.childNodes.length>0&&i.readyState==="complete"&&(clearInterval(a),t(e))},50)}})},Ioe=["all","d","content"],e2=function(e,t){for(var r=e.length-1;r>=0;r--){var n=e.item(r);Ioe.indexOf(n)===-1&&t.style.setProperty(n,e.getPropertyValue(n))}return t},Uoe=function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t},Ooe=function(e,t,r){e&&e.defaultView&&(t!==e.defaultView.pageXOffset||r!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,r)},joe=function(e){var t=e[0],r=e[1],n=e[2];t.scrollLeft=r,t.scrollTop=n},Doe=":before",Poe=":after",lw="___html2canvas___pseudoelement_before",Aw="___html2canvas___pseudoelement_after",KS=`{
    content: "" !important;
    display: none !important;
}`,Qoe=function(e){Roe(e,"."+lw+Doe+KS+`
         .`+Aw+Poe+KS)},Roe=function(e,t){var r=e.ownerDocument;if(r){var n=r.createElement("style");n.textContent=t,e.appendChild(n)}},tL=function(){function e(){}return e.getOrigin=function(t){var r=e._link;return r?(r.href=t,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},e.isSameOrigin=function(t){return e.getOrigin(t)===e._origin},e.setContext=function(t){e._link=t.document.createElement("a"),e._origin=e.getOrigin(t.location.href)},e._origin="about:blank",e}(),Moe=function(){function e(t,r){this.context=t,this._options=r,this._cache={}}return e.prototype.addImage=function(t){var r=Promise.resolve();return this.has(t)||(r2(t)||Voe(t))&&(this._cache[t]=this.loadImage(t)).catch(function(){}),r},e.prototype.match=function(t){return this._cache[t]},e.prototype.loadImage=function(t){return ji(this,void 0,void 0,function(){var r,n,i,a,s=this;return vi(this,function(o){switch(o.label){case 0:return r=tL.isSameOrigin(t),n=!t2(t)&&this._options.useCORS===!0&&ti.SUPPORT_CORS_IMAGES&&!r,i=!t2(t)&&!r&&!r2(t)&&typeof this._options.proxy=="string"&&ti.SUPPORT_CORS_XHR&&!n,!r&&this._options.allowTaint===!1&&!t2(t)&&!r2(t)&&!i&&!n?[2]:(a=t,i?[4,this.proxy(a)]:[3,2]);case 1:a=o.sent(),o.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise(function(l,A){var u=new Image;u.onload=function(){return l(u)},u.onerror=A,(Woe(a)||n)&&(u.crossOrigin="anonymous"),u.src=a,u.complete===!0&&setTimeout(function(){return l(u)},500),s._options.imageTimeout>0&&setTimeout(function(){return A("Timed out ("+s._options.imageTimeout+"ms) loading image")},s._options.imageTimeout)})];case 3:return[2,o.sent()]}})})},e.prototype.has=function(t){return typeof this._cache[t]<"u"},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(t){var r=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var i=t.substring(0,256);return new Promise(function(a,s){var o=ti.SUPPORT_RESPONSE_TYPE?"blob":"text",l=new XMLHttpRequest;l.onload=function(){if(l.status===200)if(o==="text")a(l.response);else{var f=new FileReader;f.addEventListener("load",function(){return a(f.result)},!1),f.addEventListener("error",function(h){return s(h)},!1),f.readAsDataURL(l.response)}else s("Failed to proxy resource "+i+" with status code "+l.status)},l.onerror=s;var A=n.indexOf("?")>-1?"&":"?";if(l.open("GET",""+n+A+"url="+encodeURIComponent(t)+"&responseType="+o),o!=="text"&&l instanceof XMLHttpRequest&&(l.responseType=o),r._options.imageTimeout){var u=r._options.imageTimeout;l.timeout=u,l.ontimeout=function(){return s("Timed out ("+u+"ms) proxying "+i)}}l.send()})},e}(),Hoe=/^data:image\/svg\+xml/i,Koe=/^data:image\/.*;base64,/i,Goe=/^data:image\/.*/i,Voe=function(e){return ti.SUPPORT_SVG_DRAWING||!$oe(e)},t2=function(e){return Goe.test(e)},Woe=function(e){return Koe.test(e)},r2=function(e){return e.substr(0,4)==="blob"},$oe=function(e){return e.substr(-3).toLowerCase()==="svg"||Hoe.test(e)},mt=function(){function e(t,r){this.type=0,this.x=t,this.y=r}return e.prototype.add=function(t,r){return new e(this.x+t,this.y+r)},e}(),su=function(e,t,r){return new mt(e.x+(t.x-e.x)*r,e.y+(t.y-e.y)*r)},Ag=function(){function e(t,r,n,i){this.type=1,this.start=t,this.startControl=r,this.endControl=n,this.end=i}return e.prototype.subdivide=function(t,r){var n=su(this.start,this.startControl,t),i=su(this.startControl,this.endControl,t),a=su(this.endControl,this.end,t),s=su(n,i,t),o=su(i,a,t),l=su(s,o,t);return r?new e(this.start,n,s,l):new e(l,o,a,this.end)},e.prototype.add=function(t,r){return new e(this.start.add(t,r),this.startControl.add(t,r),this.endControl.add(t,r),this.end.add(t,r))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e}(),Xa=function(e){return e.type===1},qoe=function(){function e(t){var r=t.styles,n=t.bounds,i=Eh(r.borderTopLeftRadius,n.width,n.height),a=i[0],s=i[1],o=Eh(r.borderTopRightRadius,n.width,n.height),l=o[0],A=o[1],u=Eh(r.borderBottomRightRadius,n.width,n.height),f=u[0],h=u[1],d=Eh(r.borderBottomLeftRadius,n.width,n.height),m=d[0],g=d[1],x=[];x.push((a+l)/n.width),x.push((m+f)/n.width),x.push((s+g)/n.height),x.push((A+h)/n.height);var p=Math.max.apply(Math,x);p>1&&(a/=p,s/=p,l/=p,A/=p,f/=p,h/=p,m/=p,g/=p);var v=n.width-l,y=n.height-h,w=n.width-f,B=n.height-g,E=r.borderTopWidth,_=r.borderRightWidth,F=r.borderBottomWidth,T=r.borderLeftWidth,I=jr(r.paddingTop,t.bounds.width),S=jr(r.paddingRight,t.bounds.width),C=jr(r.paddingBottom,t.bounds.width),L=jr(r.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=a>0||s>0?Vr(n.left+T/3,n.top+E/3,a-T/3,s-E/3,mr.TOP_LEFT):new mt(n.left+T/3,n.top+E/3),this.topRightBorderDoubleOuterBox=a>0||s>0?Vr(n.left+v,n.top+E/3,l-_/3,A-E/3,mr.TOP_RIGHT):new mt(n.left+n.width-_/3,n.top+E/3),this.bottomRightBorderDoubleOuterBox=f>0||h>0?Vr(n.left+w,n.top+y,f-_/3,h-F/3,mr.BOTTOM_RIGHT):new mt(n.left+n.width-_/3,n.top+n.height-F/3),this.bottomLeftBorderDoubleOuterBox=m>0||g>0?Vr(n.left+T/3,n.top+B,m-T/3,g-F/3,mr.BOTTOM_LEFT):new mt(n.left+T/3,n.top+n.height-F/3),this.topLeftBorderDoubleInnerBox=a>0||s>0?Vr(n.left+T*2/3,n.top+E*2/3,a-T*2/3,s-E*2/3,mr.TOP_LEFT):new mt(n.left+T*2/3,n.top+E*2/3),this.topRightBorderDoubleInnerBox=a>0||s>0?Vr(n.left+v,n.top+E*2/3,l-_*2/3,A-E*2/3,mr.TOP_RIGHT):new mt(n.left+n.width-_*2/3,n.top+E*2/3),this.bottomRightBorderDoubleInnerBox=f>0||h>0?Vr(n.left+w,n.top+y,f-_*2/3,h-F*2/3,mr.BOTTOM_RIGHT):new mt(n.left+n.width-_*2/3,n.top+n.height-F*2/3),this.bottomLeftBorderDoubleInnerBox=m>0||g>0?Vr(n.left+T*2/3,n.top+B,m-T*2/3,g-F*2/3,mr.BOTTOM_LEFT):new mt(n.left+T*2/3,n.top+n.height-F*2/3),this.topLeftBorderStroke=a>0||s>0?Vr(n.left+T/2,n.top+E/2,a-T/2,s-E/2,mr.TOP_LEFT):new mt(n.left+T/2,n.top+E/2),this.topRightBorderStroke=a>0||s>0?Vr(n.left+v,n.top+E/2,l-_/2,A-E/2,mr.TOP_RIGHT):new mt(n.left+n.width-_/2,n.top+E/2),this.bottomRightBorderStroke=f>0||h>0?Vr(n.left+w,n.top+y,f-_/2,h-F/2,mr.BOTTOM_RIGHT):new mt(n.left+n.width-_/2,n.top+n.height-F/2),this.bottomLeftBorderStroke=m>0||g>0?Vr(n.left+T/2,n.top+B,m-T/2,g-F/2,mr.BOTTOM_LEFT):new mt(n.left+T/2,n.top+n.height-F/2),this.topLeftBorderBox=a>0||s>0?Vr(n.left,n.top,a,s,mr.TOP_LEFT):new mt(n.left,n.top),this.topRightBorderBox=l>0||A>0?Vr(n.left+v,n.top,l,A,mr.TOP_RIGHT):new mt(n.left+n.width,n.top),this.bottomRightBorderBox=f>0||h>0?Vr(n.left+w,n.top+y,f,h,mr.BOTTOM_RIGHT):new mt(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=m>0||g>0?Vr(n.left,n.top+B,m,g,mr.BOTTOM_LEFT):new mt(n.left,n.top+n.height),this.topLeftPaddingBox=a>0||s>0?Vr(n.left+T,n.top+E,Math.max(0,a-T),Math.max(0,s-E),mr.TOP_LEFT):new mt(n.left+T,n.top+E),this.topRightPaddingBox=l>0||A>0?Vr(n.left+Math.min(v,n.width-_),n.top+E,v>n.width+_?0:Math.max(0,l-_),Math.max(0,A-E),mr.TOP_RIGHT):new mt(n.left+n.width-_,n.top+E),this.bottomRightPaddingBox=f>0||h>0?Vr(n.left+Math.min(w,n.width-T),n.top+Math.min(y,n.height-F),Math.max(0,f-_),Math.max(0,h-F),mr.BOTTOM_RIGHT):new mt(n.left+n.width-_,n.top+n.height-F),this.bottomLeftPaddingBox=m>0||g>0?Vr(n.left+T,n.top+Math.min(B,n.height-F),Math.max(0,m-T),Math.max(0,g-F),mr.BOTTOM_LEFT):new mt(n.left+T,n.top+n.height-F),this.topLeftContentBox=a>0||s>0?Vr(n.left+T+L,n.top+E+I,Math.max(0,a-(T+L)),Math.max(0,s-(E+I)),mr.TOP_LEFT):new mt(n.left+T+L,n.top+E+I),this.topRightContentBox=l>0||A>0?Vr(n.left+Math.min(v,n.width+T+L),n.top+E+I,v>n.width+T+L?0:l-T+L,A-(E+I),mr.TOP_RIGHT):new mt(n.left+n.width-(_+S),n.top+E+I),this.bottomRightContentBox=f>0||h>0?Vr(n.left+Math.min(w,n.width-(T+L)),n.top+Math.min(y,n.height+E+I),Math.max(0,f-(_+S)),h-(F+C),mr.BOTTOM_RIGHT):new mt(n.left+n.width-(_+S),n.top+n.height-(F+C)),this.bottomLeftContentBox=m>0||g>0?Vr(n.left+T+L,n.top+B,Math.max(0,m-(T+L)),g-(F+C),mr.BOTTOM_LEFT):new mt(n.left+T+L,n.top+n.height-(F+C))}return e}(),mr;(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=1]="TOP_RIGHT",e[e.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",e[e.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(mr||(mr={}));var Vr=function(e,t,r,n,i){var a=4*((Math.sqrt(2)-1)/3),s=r*a,o=n*a,l=e+r,A=t+n;switch(i){case mr.TOP_LEFT:return new Ag(new mt(e,A),new mt(e,A-o),new mt(l-s,t),new mt(l,t));case mr.TOP_RIGHT:return new Ag(new mt(e,t),new mt(e+s,t),new mt(l,A-o),new mt(l,A));case mr.BOTTOM_RIGHT:return new Ag(new mt(l,t),new mt(l,t+o),new mt(e+s,A),new mt(e,A));case mr.BOTTOM_LEFT:default:return new Ag(new mt(l,A),new mt(l-s,A),new mt(e,t+o),new mt(e,t))}},Im=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},zoe=function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]},Um=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},Xoe=function(){function e(t,r,n){this.offsetX=t,this.offsetY=r,this.matrix=n,this.type=0,this.target=6}return e}(),cg=function(){function e(t,r){this.path=t,this.target=r,this.type=1}return e}(),Yoe=function(){function e(t){this.opacity=t,this.type=2,this.target=6}return e}(),Joe=function(e){return e.type===0},rL=function(e){return e.type===1},Zoe=function(e){return e.type===2},GS=function(e,t){return e.length===t.length?e.some(function(r,n){return r===t[n]}):!1},ele=function(e,t,r,n,i){return e.map(function(a,s){switch(s){case 0:return a.add(t,r);case 1:return a.add(t+n,r);case 2:return a.add(t+n,r+i);case 3:return a.add(t,r+i)}return a})},nL=function(){function e(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return e}(),iL=function(){function e(t,r){if(this.container=t,this.parent=r,this.effects=[],this.curves=new qoe(this.container),this.container.styles.opacity<1&&this.effects.push(new Yoe(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,i=this.container.bounds.top+this.container.styles.transformOrigin[1].number,a=this.container.styles.transform;this.effects.push(new Xoe(n,i,a))}if(this.container.styles.overflowX!==0){var s=Im(this.curves),o=Um(this.curves);GS(s,o)?this.effects.push(new cg(s,6)):(this.effects.push(new cg(s,2)),this.effects.push(new cg(o,4)))}}return e.prototype.getEffects=function(t){for(var r=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,i=this.effects.slice(0);n;){var a=n.effects.filter(function(l){return!rL(l)});if(r||n.container.styles.position!==0||!n.parent){if(i.unshift.apply(i,a),r=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var s=Im(n.curves),o=Um(n.curves);GS(s,o)||i.unshift(new cg(o,6))}}else i.unshift.apply(i,a);n=n.parent}return i.filter(function(l){return On(l.target,t)})},e}(),cw=function(e,t,r,n){e.container.elements.forEach(function(i){var a=On(i.flags,4),s=On(i.flags,2),o=new iL(i,e);On(i.styles.display,2048)&&n.push(o);var l=On(i.flags,8)?[]:n;if(a||s){var A=a||i.styles.isPositioned()?r:t,u=new nL(o);if(i.styles.isPositioned()||i.styles.opacity<1||i.styles.isTransformed()){var f=i.styles.zIndex.order;if(f<0){var h=0;A.negativeZIndex.some(function(m,g){return f>m.element.container.styles.zIndex.order?(h=g,!1):h>0}),A.negativeZIndex.splice(h,0,u)}else if(f>0){var d=0;A.positiveZIndex.some(function(m,g){return f>=m.element.container.styles.zIndex.order?(d=g+1,!1):d>0}),A.positiveZIndex.splice(d,0,u)}else A.zeroOrAutoZIndexOrTransformedOrOpacity.push(u)}else i.styles.isFloating()?A.nonPositionedFloats.push(u):A.nonPositionedInlineLevel.push(u);cw(o,u,a?u:r,l)}else i.styles.isInlineLevel()?t.inlineLevel.push(o):t.nonInlineLevel.push(o),cw(o,t,r,l);On(i.flags,8)&&aL(i,l)})},aL=function(e,t){for(var r=e instanceof aw?e.start:1,n=e instanceof aw?e.reversed:!1,i=0;i<t.length;i++){var a=t[i];a.container instanceof H6&&typeof a.container.value=="number"&&a.container.value!==0&&(r=a.container.value),a.listValue=Xd(r,a.container.styles.listStyleType,!0),r+=n?-1:1}},tle=function(e){var t=new iL(e,null),r=new nL(t),n=[];return cw(t,r,r,n),aL(t.container,n),r},VS=function(e,t){switch(t){case 0:return Za(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return Za(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return Za(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);case 3:default:return Za(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},rle=function(e,t){switch(t){case 0:return Za(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return Za(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return Za(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);case 3:default:return Za(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}},nle=function(e,t){switch(t){case 0:return Za(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return Za(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return Za(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);case 3:default:return Za(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}},ile=function(e,t){switch(t){case 0:return ug(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return ug(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return ug(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);case 3:default:return ug(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}},ug=function(e,t){var r=[];return Xa(e)?r.push(e.subdivide(.5,!1)):r.push(e),Xa(t)?r.push(t.subdivide(.5,!0)):r.push(t),r},Za=function(e,t,r,n){var i=[];return Xa(e)?i.push(e.subdivide(.5,!1)):i.push(e),Xa(r)?i.push(r.subdivide(.5,!0)):i.push(r),Xa(n)?i.push(n.subdivide(.5,!0).reverse()):i.push(n),Xa(t)?i.push(t.subdivide(.5,!1).reverse()):i.push(t),i},sL=function(e){var t=e.bounds,r=e.styles;return t.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},Om=function(e){var t=e.styles,r=e.bounds,n=jr(t.paddingLeft,r.width),i=jr(t.paddingRight,r.width),a=jr(t.paddingTop,r.width),s=jr(t.paddingBottom,r.width);return r.add(n+t.borderLeftWidth,a+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+n+i),-(t.borderTopWidth+t.borderBottomWidth+a+s))},ale=function(e,t){return e===0?t.bounds:e===2?Om(t):sL(t)},sle=function(e,t){return e===0?t.bounds:e===2?Om(t):sL(t)},n2=function(e,t,r){var n=ale(du(e.styles.backgroundOrigin,t),e),i=sle(du(e.styles.backgroundClip,t),e),a=ole(du(e.styles.backgroundSize,t),r,n),s=a[0],o=a[1],l=Eh(du(e.styles.backgroundPosition,t),n.width-s,n.height-o),A=lle(du(e.styles.backgroundRepeat,t),l,a,n,i),u=Math.round(n.left+l[0]),f=Math.round(n.top+l[1]);return[A,u,f,s,o]},ou=function(e){return Er(e)&&e.value===Qu.AUTO},fg=function(e){return typeof e=="number"},ole=function(e,t,r){var n=t[0],i=t[1],a=t[2],s=e[0],o=e[1];if(!s)return[0,0];if(Nn(s)&&o&&Nn(o))return[jr(s,r.width),jr(o,r.height)];var l=fg(a);if(Er(s)&&(s.value===Qu.CONTAIN||s.value===Qu.COVER)){if(fg(a)){var A=r.width/r.height;return A<a!=(s.value===Qu.COVER)?[r.width,r.width/a]:[r.height*a,r.height]}return[r.width,r.height]}var u=fg(n),f=fg(i),h=u||f;if(ou(s)&&(!o||ou(o))){if(u&&f)return[n,i];if(!l&&!h)return[r.width,r.height];if(h&&l){var d=u?n:i*a,m=f?i:n/a;return[d,m]}var g=u?n:r.width,x=f?i:r.height;return[g,x]}if(l){var p=0,v=0;return Nn(s)?p=jr(s,r.width):Nn(o)&&(v=jr(o,r.height)),ou(s)?p=v*a:(!o||ou(o))&&(v=p/a),[p,v]}var y=null,w=null;if(Nn(s)?y=jr(s,r.width):o&&Nn(o)&&(w=jr(o,r.height)),y!==null&&(!o||ou(o))&&(w=u&&f?y/n*i:r.height),w!==null&&ou(s)&&(y=u&&f?w/i*n:r.width),y!==null&&w!==null)return[y,w];throw new Error("Unable to calculate background-size for element")},du=function(e,t){var r=e[t];return typeof r>"u"?e[0]:r},lle=function(e,t,r,n,i){var a=t[0],s=t[1],o=r[0],l=r[1];switch(e){case 2:return[new mt(Math.round(n.left),Math.round(n.top+s)),new mt(Math.round(n.left+n.width),Math.round(n.top+s)),new mt(Math.round(n.left+n.width),Math.round(l+n.top+s)),new mt(Math.round(n.left),Math.round(l+n.top+s))];case 3:return[new mt(Math.round(n.left+a),Math.round(n.top)),new mt(Math.round(n.left+a+o),Math.round(n.top)),new mt(Math.round(n.left+a+o),Math.round(n.height+n.top)),new mt(Math.round(n.left+a),Math.round(n.height+n.top))];case 1:return[new mt(Math.round(n.left+a),Math.round(n.top+s)),new mt(Math.round(n.left+a+o),Math.round(n.top+s)),new mt(Math.round(n.left+a+o),Math.round(n.top+s+l)),new mt(Math.round(n.left+a),Math.round(n.top+s+l))];default:return[new mt(Math.round(i.left),Math.round(i.top)),new mt(Math.round(i.left+i.width),Math.round(i.top)),new mt(Math.round(i.left+i.width),Math.round(i.height+i.top)),new mt(Math.round(i.left),Math.round(i.height+i.top))]}},Ale="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",WS="Hidden Text",cle=function(){function e(t){this._data={},this._document=t}return e.prototype.parseMetrics=function(t,r){var n=this._document.createElement("div"),i=this._document.createElement("img"),a=this._document.createElement("span"),s=this._document.body;n.style.visibility="hidden",n.style.fontFamily=t,n.style.fontSize=r,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",s.appendChild(n),i.src=Ale,i.width=1,i.height=1,i.style.margin="0",i.style.padding="0",i.style.verticalAlign="baseline",a.style.fontFamily=t,a.style.fontSize=r,a.style.margin="0",a.style.padding="0",a.appendChild(this._document.createTextNode(WS)),n.appendChild(a),n.appendChild(i);var o=i.offsetTop-a.offsetTop+2;n.removeChild(a),n.appendChild(this._document.createTextNode(WS)),n.style.lineHeight="normal",i.style.verticalAlign="super";var l=i.offsetTop-n.offsetTop+2;return s.removeChild(n),{baseline:o,middle:l}},e.prototype.getMetrics=function(t,r){var n=t+" "+r;return typeof this._data[n]>"u"&&(this._data[n]=this.parseMetrics(t,r)),this._data[n]},e}(),oL=function(){function e(t,r){this.context=t,this.options=r}return e}(),ule=1e4,fle=function(e){Ds(t,e);function t(r,n){var i=e.call(this,r,n)||this;return i._activeEffects=[],i.canvas=n.canvas?n.canvas:document.createElement("canvas"),i.ctx=i.canvas.getContext("2d"),n.canvas||(i.canvas.width=Math.floor(n.width*n.scale),i.canvas.height=Math.floor(n.height*n.scale),i.canvas.style.width=n.width+"px",i.canvas.style.height=n.height+"px"),i.fontMetrics=new cle(document),i.ctx.scale(i.options.scale,i.options.scale),i.ctx.translate(-n.x,-n.y),i.ctx.textBaseline="bottom",i._activeEffects=[],i.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),i}return t.prototype.applyEffects=function(r){for(var n=this;this._activeEffects.length;)this.popEffect();r.forEach(function(i){return n.applyEffect(i)})},t.prototype.applyEffect=function(r){this.ctx.save(),Zoe(r)&&(this.ctx.globalAlpha=r.opacity),Joe(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),rL(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(r){return ji(this,void 0,void 0,function(){var n;return vi(this,function(i){switch(i.label){case 0:return n=r.element.container.styles,n.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})},t.prototype.renderNode=function(r){return ji(this,void 0,void 0,function(){return vi(this,function(n){switch(n.label){case 0:if(On(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(r)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},t.prototype.renderTextWithLetterSpacing=function(r,n,i){var a=this;if(n===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+i);else{var s=x5(r.text);s.reduce(function(o,l){return a.ctx.fillText(l,o,r.bounds.top+i),o+a.ctx.measureText(l).width},r.bounds.left)}},t.prototype.createFontStyle=function(r){var n=r.fontVariant.filter(function(s){return s==="normal"||s==="small-caps"}).join(""),i=mle(r.fontFamily).join(", "),a=p0(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,n,r.fontWeight,a,i].join(" "),i,a]},t.prototype.renderTextNode=function(r,n){return ji(this,void 0,void 0,function(){var i,a,s,o,l,A,u,f,h=this;return vi(this,function(d){return i=this.createFontStyle(n),a=i[0],s=i[1],o=i[2],this.ctx.font=a,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",l=this.fontMetrics.getMetrics(s,o),A=l.baseline,u=l.middle,f=n.paintOrder,r.textBounds.forEach(function(m){f.forEach(function(g){switch(g){case 0:h.ctx.fillStyle=Gn(n.color),h.renderTextWithLetterSpacing(m,n.letterSpacing,A);var x=n.textShadow;x.length&&m.text.trim().length&&(x.slice(0).reverse().forEach(function(p){h.ctx.shadowColor=Gn(p.color),h.ctx.shadowOffsetX=p.offsetX.number*h.options.scale,h.ctx.shadowOffsetY=p.offsetY.number*h.options.scale,h.ctx.shadowBlur=p.blur.number,h.renderTextWithLetterSpacing(m,n.letterSpacing,A)}),h.ctx.shadowColor="",h.ctx.shadowOffsetX=0,h.ctx.shadowOffsetY=0,h.ctx.shadowBlur=0),n.textDecorationLine.length&&(h.ctx.fillStyle=Gn(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(p){switch(p){case 1:h.ctx.fillRect(m.bounds.left,Math.round(m.bounds.top+A),m.bounds.width,1);break;case 2:h.ctx.fillRect(m.bounds.left,Math.round(m.bounds.top),m.bounds.width,1);break;case 3:h.ctx.fillRect(m.bounds.left,Math.ceil(m.bounds.top+u),m.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&m.text.trim().length&&(h.ctx.strokeStyle=Gn(n.webkitTextStrokeColor),h.ctx.lineWidth=n.webkitTextStrokeWidth,h.ctx.lineJoin=window.chrome?"miter":"round",h.ctx.strokeText(m.text,m.bounds.left,m.bounds.top+A)),h.ctx.strokeStyle="",h.ctx.lineWidth=0,h.ctx.lineJoin="miter";break}})}),[2]})})},t.prototype.renderReplacedElement=function(r,n,i){if(i&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var a=Om(r),s=Um(n);this.path(s),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(i,0,0,r.intrinsicWidth,r.intrinsicHeight,a.left,a.top,a.width,a.height),this.ctx.restore()}},t.prototype.renderNodeContent=function(r){return ji(this,void 0,void 0,function(){var n,i,a,s,o,l,v,v,A,u,f,h,w,d,m,B,g,x,p,v,y,w,B;return vi(this,function(E){switch(E.label){case 0:this.applyEffects(r.getEffects(4)),n=r.container,i=r.curves,a=n.styles,s=0,o=n.textNodes,E.label=1;case 1:return s<o.length?(l=o[s],[4,this.renderTextNode(l,a)]):[3,4];case 2:E.sent(),E.label=3;case 3:return s++,[3,1];case 4:if(!(n instanceof Q6))return[3,8];E.label=5;case 5:return E.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return v=E.sent(),this.renderReplacedElement(n,i,v),[3,8];case 7:return E.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof R6&&this.renderReplacedElement(n,i,n.canvas),!(n instanceof M6))return[3,12];E.label=9;case 9:return E.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return v=E.sent(),this.renderReplacedElement(n,i,v),[3,12];case 11:return E.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof V6&&n.tree?(A=new t(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,A.render(n.tree)]):[3,14];case 13:u=E.sent(),n.width&&n.height&&this.ctx.drawImage(u,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),E.label=14;case 14:if(n instanceof y5&&(f=Math.min(n.bounds.width,n.bounds.height),n.type===Fm?n.checked&&(this.ctx.save(),this.path([new mt(n.bounds.left+f*.39363,n.bounds.top+f*.79),new mt(n.bounds.left+f*.16,n.bounds.top+f*.5549),new mt(n.bounds.left+f*.27347,n.bounds.top+f*.44071),new mt(n.bounds.left+f*.39694,n.bounds.top+f*.5649),new mt(n.bounds.left+f*.72983,n.bounds.top+f*.23),new mt(n.bounds.left+f*.84,n.bounds.top+f*.34085),new mt(n.bounds.left+f*.39363,n.bounds.top+f*.79)]),this.ctx.fillStyle=Gn(IS),this.ctx.fill(),this.ctx.restore()):n.type===Nm&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+f/2,n.bounds.top+f/2,f/4,0,Math.PI*2,!0),this.ctx.fillStyle=Gn(IS),this.ctx.fill(),this.ctx.restore())),hle(n)&&n.value.length){switch(h=this.createFontStyle(a),w=h[0],d=h[1],m=this.fontMetrics.getMetrics(w,d).baseline,this.ctx.font=w,this.ctx.fillStyle=Gn(a.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=ple(n.styles.textAlign),B=Om(n),g=0,n.styles.textAlign){case 1:g+=B.width/2;break;case 2:g+=B.width;break}x=B.add(g,0,0,-B.height/2+1),this.ctx.save(),this.path([new mt(B.left,B.top),new mt(B.left+B.width,B.top),new mt(B.left+B.width,B.top+B.height),new mt(B.left,B.top+B.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new ld(n.value,x),a.letterSpacing,m),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!On(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(p=n.styles.listStyleImage,p.type!==0)return[3,18];v=void 0,y=p.url,E.label=15;case 15:return E.trys.push([15,17,,18]),[4,this.context.cache.match(y)];case 16:return v=E.sent(),this.ctx.drawImage(v,n.bounds.left-(v.width+10),n.bounds.top),[3,18];case 17:return E.sent(),this.context.logger.error("Error loading list-style-image "+y),[3,18];case 18:return[3,20];case 19:r.listValue&&n.styles.listStyleType!==-1&&(w=this.createFontStyle(a)[0],this.ctx.font=w,this.ctx.fillStyle=Gn(a.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",B=new Go(n.bounds.left,n.bounds.top+jr(n.styles.paddingTop,n.bounds.width),n.bounds.width,gS(a.lineHeight,a.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new ld(r.listValue,B),a.letterSpacing,gS(a.lineHeight,a.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),E.label=20;case 20:return[2]}})})},t.prototype.renderStackContent=function(r){return ji(this,void 0,void 0,function(){var n,i,p,a,s,p,o,l,p,A,u,p,f,h,p,d,m,p,g,x,p;return vi(this,function(v){switch(v.label){case 0:if(On(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:v.sent(),n=0,i=r.negativeZIndex,v.label=2;case 2:return n<i.length?(p=i[n],[4,this.renderStack(p)]):[3,5];case 3:v.sent(),v.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:v.sent(),a=0,s=r.nonInlineLevel,v.label=7;case 7:return a<s.length?(p=s[a],[4,this.renderNode(p)]):[3,10];case 8:v.sent(),v.label=9;case 9:return a++,[3,7];case 10:o=0,l=r.nonPositionedFloats,v.label=11;case 11:return o<l.length?(p=l[o],[4,this.renderStack(p)]):[3,14];case 12:v.sent(),v.label=13;case 13:return o++,[3,11];case 14:A=0,u=r.nonPositionedInlineLevel,v.label=15;case 15:return A<u.length?(p=u[A],[4,this.renderStack(p)]):[3,18];case 16:v.sent(),v.label=17;case 17:return A++,[3,15];case 18:f=0,h=r.inlineLevel,v.label=19;case 19:return f<h.length?(p=h[f],[4,this.renderNode(p)]):[3,22];case 20:v.sent(),v.label=21;case 21:return f++,[3,19];case 22:d=0,m=r.zeroOrAutoZIndexOrTransformedOrOpacity,v.label=23;case 23:return d<m.length?(p=m[d],[4,this.renderStack(p)]):[3,26];case 24:v.sent(),v.label=25;case 25:return d++,[3,23];case 26:g=0,x=r.positiveZIndex,v.label=27;case 27:return g<x.length?(p=x[g],[4,this.renderStack(p)]):[3,30];case 28:v.sent(),v.label=29;case 29:return g++,[3,27];case 30:return[2]}})})},t.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},t.prototype.formatPath=function(r){var n=this;r.forEach(function(i,a){var s=Xa(i)?i.start:i;a===0?n.ctx.moveTo(s.x,s.y):n.ctx.lineTo(s.x,s.y),Xa(i)&&n.ctx.bezierCurveTo(i.startControl.x,i.startControl.y,i.endControl.x,i.endControl.y,i.end.x,i.end.y)})},t.prototype.renderRepeat=function(r,n,i,a){this.path(r),this.ctx.fillStyle=n,this.ctx.translate(i,a),this.ctx.fill(),this.ctx.translate(-i,-a)},t.prototype.resizeImage=function(r,n,i){var a;if(r.width===n&&r.height===i)return r;var s=(a=this.canvas.ownerDocument)!==null&&a!==void 0?a:document,o=s.createElement("canvas");o.width=Math.max(1,n),o.height=Math.max(1,i);var l=o.getContext("2d");return l.drawImage(r,0,0,r.width,r.height,0,0,n,i),o},t.prototype.renderBackgroundImage=function(r){return ji(this,void 0,void 0,function(){var n,i,a,s,o,l;return vi(this,function(A){switch(A.label){case 0:n=r.styles.backgroundImage.length-1,i=function(u){var f,h,d,I,G,V,L,R,F,m,I,G,V,L,R,g,x,p,v,y,w,B,E,_,F,T,I,S,C,L,R,W,G,V,X,Q,K,H,k,U,P,D;return vi(this,function(O){switch(O.label){case 0:if(u.type!==0)return[3,5];f=void 0,h=u.url,O.label=1;case 1:return O.trys.push([1,3,,4]),[4,a.context.cache.match(h)];case 2:return f=O.sent(),[3,4];case 3:return O.sent(),a.context.logger.error("Error loading background-image "+h),[3,4];case 4:return f&&(d=n2(r,n,[f.width,f.height,f.width/f.height]),I=d[0],G=d[1],V=d[2],L=d[3],R=d[4],F=a.ctx.createPattern(a.resizeImage(f,L,R),"repeat"),a.renderRepeat(I,F,G,V)),[3,6];case 5:Jie(u)?(m=n2(r,n,[null,null,null]),I=m[0],G=m[1],V=m[2],L=m[3],R=m[4],g=$ie(u.angle,L,R),x=g[0],p=g[1],v=g[2],y=g[3],w=g[4],B=document.createElement("canvas"),B.width=L,B.height=R,E=B.getContext("2d"),_=E.createLinearGradient(p,y,v,w),dS(u.stops,x).forEach(function(z){return _.addColorStop(z.stop,Gn(z.color))}),E.fillStyle=_,E.fillRect(0,0,L,R),L>0&&R>0&&(F=a.ctx.createPattern(B,"repeat"),a.renderRepeat(I,F,G,V))):Zie(u)&&(T=n2(r,n,[null,null,null]),I=T[0],S=T[1],C=T[2],L=T[3],R=T[4],W=u.position.length===0?[g5]:u.position,G=jr(W[0],L),V=jr(W[W.length-1],R),X=qie(u,G,V,L,R),Q=X[0],K=X[1],Q>0&&K>0&&(H=a.ctx.createRadialGradient(S+G,C+V,0,S+G,C+V,Q),dS(u.stops,Q*2).forEach(function(z){return H.addColorStop(z.stop,Gn(z.color))}),a.path(I),a.ctx.fillStyle=H,Q!==K?(k=r.bounds.left+.5*r.bounds.width,U=r.bounds.top+.5*r.bounds.height,P=K/Q,D=1/P,a.ctx.save(),a.ctx.translate(k,U),a.ctx.transform(1,0,0,P,0,0),a.ctx.translate(-k,-U),a.ctx.fillRect(S,D*(C-U)+U,L,R*D),a.ctx.restore()):a.ctx.fill())),O.label=6;case 6:return n--,[2]}})},a=this,s=0,o=r.styles.backgroundImage.slice(0).reverse(),A.label=1;case 1:return s<o.length?(l=o[s],[5,i(l)]):[3,4];case 2:A.sent(),A.label=3;case 3:return s++,[3,1];case 4:return[2]}})})},t.prototype.renderSolidBorder=function(r,n,i){return ji(this,void 0,void 0,function(){return vi(this,function(a){return this.path(VS(i,n)),this.ctx.fillStyle=Gn(r),this.ctx.fill(),[2]})})},t.prototype.renderDoubleBorder=function(r,n,i,a){return ji(this,void 0,void 0,function(){var s,o;return vi(this,function(l){switch(l.label){case 0:return n<3?[4,this.renderSolidBorder(r,i,a)]:[3,2];case 1:return l.sent(),[2];case 2:return s=rle(a,i),this.path(s),this.ctx.fillStyle=Gn(r),this.ctx.fill(),o=nle(a,i),this.path(o),this.ctx.fill(),[2]}})})},t.prototype.renderNodeBackgroundAndBorders=function(r){return ji(this,void 0,void 0,function(){var n,i,a,s,o,l,A,u,f=this;return vi(this,function(h){switch(h.label){case 0:return this.applyEffects(r.getEffects(2)),n=r.container.styles,i=!ql(n.backgroundColor)||n.backgroundImage.length,a=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],s=dle(du(n.backgroundClip,0),r.curves),i||n.boxShadow.length?(this.ctx.save(),this.path(s),this.ctx.clip(),ql(n.backgroundColor)||(this.ctx.fillStyle=Gn(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:h.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(d){f.ctx.save();var m=Im(r.curves),g=d.inset?0:ule,x=ele(m,-g+(d.inset?1:-1)*d.spread.number,(d.inset?1:-1)*d.spread.number,d.spread.number*(d.inset?-2:2),d.spread.number*(d.inset?-2:2));d.inset?(f.path(m),f.ctx.clip(),f.mask(x)):(f.mask(m),f.ctx.clip(),f.path(x)),f.ctx.shadowOffsetX=d.offsetX.number+g,f.ctx.shadowOffsetY=d.offsetY.number,f.ctx.shadowColor=Gn(d.color),f.ctx.shadowBlur=d.blur.number,f.ctx.fillStyle=d.inset?Gn(d.color):"rgba(0,0,0,1)",f.ctx.fill(),f.ctx.restore()}),h.label=2;case 2:o=0,l=0,A=a,h.label=3;case 3:return l<A.length?(u=A[l],u.style!==0&&!ql(u.color)&&u.width>0?u.style!==2?[3,5]:[4,this.renderDashedDottedBorder(u.color,u.width,o,r.curves,2)]:[3,11]):[3,13];case 4:return h.sent(),[3,11];case 5:return u.style!==3?[3,7]:[4,this.renderDashedDottedBorder(u.color,u.width,o,r.curves,3)];case 6:return h.sent(),[3,11];case 7:return u.style!==4?[3,9]:[4,this.renderDoubleBorder(u.color,u.width,o,r.curves)];case 8:return h.sent(),[3,11];case 9:return[4,this.renderSolidBorder(u.color,o,r.curves)];case 10:h.sent(),h.label=11;case 11:o++,h.label=12;case 12:return l++,[3,3];case 13:return[2]}})})},t.prototype.renderDashedDottedBorder=function(r,n,i,a,s){return ji(this,void 0,void 0,function(){var o,l,A,u,f,h,d,m,g,x,p,v,y,w,B,E,B,E;return vi(this,function(_){return this.ctx.save(),o=ile(a,i),l=VS(a,i),s===2&&(this.path(l),this.ctx.clip()),Xa(l[0])?(A=l[0].start.x,u=l[0].start.y):(A=l[0].x,u=l[0].y),Xa(l[1])?(f=l[1].end.x,h=l[1].end.y):(f=l[1].x,h=l[1].y),i===0||i===2?d=Math.abs(A-f):d=Math.abs(u-h),this.ctx.beginPath(),s===3?this.formatPath(o):this.formatPath(l.slice(0,2)),m=n<3?n*3:n*2,g=n<3?n*2:n,s===3&&(m=n,g=n),x=!0,d<=m*2?x=!1:d<=m*2+g?(p=d/(2*m+g),m*=p,g*=p):(v=Math.floor((d+g)/(m+g)),y=(d-v*m)/(v-1),w=(d-(v+1)*m)/v,g=w<=0||Math.abs(g-y)<Math.abs(g-w)?y:w),x&&(s===3?this.ctx.setLineDash([0,m+g]):this.ctx.setLineDash([m,g])),s===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=Gn(r),this.ctx.stroke(),this.ctx.setLineDash([]),s===2&&(Xa(l[0])&&(B=l[3],E=l[0],this.ctx.beginPath(),this.formatPath([new mt(B.end.x,B.end.y),new mt(E.start.x,E.start.y)]),this.ctx.stroke()),Xa(l[1])&&(B=l[1],E=l[2],this.ctx.beginPath(),this.formatPath([new mt(B.end.x,B.end.y),new mt(E.start.x,E.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},t.prototype.render=function(r){return ji(this,void 0,void 0,function(){var n;return vi(this,function(i){switch(i.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Gn(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=tle(r),[4,this.renderStack(n)];case 1:return i.sent(),this.applyEffects([]),[2,this.canvas]}})})},t}(oL),hle=function(e){return e instanceof G6||e instanceof K6?!0:e instanceof y5&&e.type!==Nm&&e.type!==Fm},dle=function(e,t){switch(e){case 0:return Im(t);case 2:return zoe(t);case 1:default:return Um(t)}},ple=function(e){switch(e){case 1:return"center";case 2:return"right";case 0:default:return"left"}},gle=["-apple-system","system-ui"],mle=function(e){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter(function(t){return gle.indexOf(t)===-1}):e},vle=function(e){Ds(t,e);function t(r,n){var i=e.call(this,r,n)||this;return i.canvas=n.canvas?n.canvas:document.createElement("canvas"),i.ctx=i.canvas.getContext("2d"),i.options=n,i.canvas.width=Math.floor(n.width*n.scale),i.canvas.height=Math.floor(n.height*n.scale),i.canvas.style.width=n.width+"px",i.canvas.style.height=n.height+"px",i.ctx.scale(i.options.scale,i.options.scale),i.ctx.translate(-n.x,-n.y),i.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),i}return t.prototype.render=function(r){return ji(this,void 0,void 0,function(){var n,i;return vi(this,function(a){switch(a.label){case 0:return n=iw(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,xle(n)];case 1:return i=a.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Gn(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(i,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},t}(oL),xle=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){t(n)},n.onerror=r,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},yle=function(){function e(t){var r=t.id,n=t.enabled;this.id=r,this.enabled=n,this.start=Date.now()}return e.prototype.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,Gp([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.getTime=function(){return Date.now()-this.start},e.prototype.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,Gp([this.id,this.getTime()+"ms"],t))},e.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,Gp([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,Gp([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.instances={},e}(),wle=function(){function e(t,r){var n;this.windowBounds=r,this.instanceName="#"+e.instanceCount++,this.logger=new yle({id:this.instanceName,enabled:t.logging}),this.cache=(n=t.cache)!==null&&n!==void 0?n:new Moe(this,t)}return e.instanceCount=1,e}(),lL=function(e,t){return t===void 0&&(t={}),ble(e,t)};typeof window<"u"&&tL.setContext(window);var ble=function(e,t){return ji(void 0,void 0,void 0,function(){var r,n,i,a,s,o,l,A,u,f,h,d,m,g,x,p,v,y,w,B,_,E,_,F,T,I,S,C,L,R,W,G,V,X,Q,K,H,k,U,P;return vi(this,function(D){switch(D.label){case 0:if(!e||typeof e!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=e.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(n=r.defaultView,!n)throw new Error("Document is not attached to a Window");return i={allowTaint:(F=t.allowTaint)!==null&&F!==void 0?F:!1,imageTimeout:(T=t.imageTimeout)!==null&&T!==void 0?T:15e3,proxy:t.proxy,useCORS:(I=t.useCORS)!==null&&I!==void 0?I:!1},a=Ky({logging:(S=t.logging)!==null&&S!==void 0?S:!0,cache:t.cache},i),s={windowWidth:(C=t.windowWidth)!==null&&C!==void 0?C:n.innerWidth,windowHeight:(L=t.windowHeight)!==null&&L!==void 0?L:n.innerHeight,scrollX:(R=t.scrollX)!==null&&R!==void 0?R:n.pageXOffset,scrollY:(W=t.scrollY)!==null&&W!==void 0?W:n.pageYOffset},o=new Go(s.scrollX,s.scrollY,s.windowWidth,s.windowHeight),l=new wle(a,o),A=(G=t.foreignObjectRendering)!==null&&G!==void 0?G:!1,u={allowTaint:(V=t.allowTaint)!==null&&V!==void 0?V:!1,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:A,copyStyles:A},l.logger.debug("Starting document clone with size "+o.width+"x"+o.height+" scrolled to "+-o.left+","+-o.top),f=new HS(l,e,u),h=f.clonedReferenceElement,h?[4,f.toIFrame(r,o)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return d=D.sent(),m=w5(h)||_oe(h)?ene(h.ownerDocument):L1(l,h),g=m.width,x=m.height,p=m.left,v=m.top,y=Ble(l,h,t.backgroundColor),w={canvas:t.canvas,backgroundColor:y,scale:(Q=(X=t.scale)!==null&&X!==void 0?X:n.devicePixelRatio)!==null&&Q!==void 0?Q:1,x:((K=t.x)!==null&&K!==void 0?K:0)+p,y:((H=t.y)!==null&&H!==void 0?H:0)+v,width:(k=t.width)!==null&&k!==void 0?k:Math.ceil(g),height:(U=t.height)!==null&&U!==void 0?U:Math.ceil(x)},A?(l.logger.debug("Document cloned, using foreign object rendering"),_=new vle(l,w),[4,_.render(h)]):[3,3];case 2:return B=D.sent(),[3,5];case 3:return l.logger.debug("Document cloned, element located at "+p+","+v+" with size "+g+"x"+x+" using computed rendering"),l.logger.debug("Starting DOM parsing"),E=$6(l,h),y===E.styles.backgroundColor&&(E.styles.backgroundColor=Po.TRANSPARENT),l.logger.debug("Starting renderer for element at "+w.x+","+w.y+" with size "+w.width+"x"+w.height),_=new fle(l,w),[4,_.render(E)];case 4:B=D.sent(),D.label=5;case 5:return(!((P=t.removeContainer)!==null&&P!==void 0)||P)&&(HS.destroy(d)||l.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),l.logger.debug("Finished rendering"),[2,B]}})})},Ble=function(e,t,r){var n=t.ownerDocument,i=n.documentElement?sd(e,getComputedStyle(n.documentElement).backgroundColor):Po.TRANSPARENT,a=n.body?sd(e,getComputedStyle(n.body).backgroundColor):Po.TRANSPARENT,s=typeof r=="string"?sd(e,r):r===null?Po.TRANSPARENT:4294967295;return t===n.documentElement?ql(i)?ql(a)?s:a:i:s};const _le=Object.freeze(Object.defineProperty({__proto__:null,default:lL},Symbol.toStringTag,{value:"Module"}));function uw({lessonNumber:e,onClose:t}){const{allLessonsData:r,currentSheetInfo:n,eyfsStatements:i}=oi(),{getCategoryColor:a}=Gi(),[s,o]=ve.useState("preview"),[l,A]=ve.useState(!1),[u,f]=ve.useState(!1),[h,d]=ve.useState(!0),m=ve.useRef(null),g=r[e],x=i[e]||[];if(!g)return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 max-w-md w-full",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Error"}),c.jsxs("p",{className:"text-gray-600 mb-6",children:["Lesson data not found for lesson ",e,"."]}),c.jsx("div",{className:"flex justify-end",children:c.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg",children:"Close"})})]})});const p=g.totalTime,v={};x.forEach(B=>{const E=B.split(":"),_=E[0].trim(),F=E.length>1?E[1].trim():B;v[_]||(v[_]=[]),v[_].push(F)});const y=async()=>{A(!0);try{if(s==="pdf"&&m.current){const B=await lL(m.current,{scale:2,useCORS:!0,logging:!1,backgroundColor:"#ffffff"}),E=B.toDataURL("image/png"),_=new Ut({orientation:"portrait",unit:"mm",format:"a4"}),F=210,T=B.height*F/B.width;if(_.addImage(E,"PNG",0,0,F,T),T>297){let S=T,C=0;for(;S>0;)C+=297,S-=297,S>0&&(_.addPage(),_.addImage(E,"PNG",0,-C,F,T))}const I=g.title||`Lesson ${e}`;_.save(`${n.sheet}_${I.replace(/\s+/g,"_")}.pdf`)}f(!0),setTimeout(()=>f(!1),3e3)}catch(B){console.error("Export failed:",B),alert("Export failed. Please try again.")}finally{A(!1)}},w=()=>{window.print()};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-5xl max-h-[90vh] flex flex-col overflow-hidden",children:[c.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Export Lesson Plan"}),c.jsxs("p",{className:"text-sm text-gray-600",children:[g.title||`Lesson ${e}`," - ",n.display]})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsxs("div",{className:"flex items-center space-x-2 bg-gray-100 p-1 rounded-lg",children:[c.jsx("button",{onClick:()=>o("preview"),className:`px-3 py-1.5 rounded-md text-sm font-medium ${s==="preview"?"bg-white shadow-sm text-gray-900":"text-gray-600 hover:text-gray-900"}`,children:"Preview"}),c.jsx("button",{onClick:()=>o("pdf"),className:`px-3 py-1.5 rounded-md text-sm font-medium ${s==="pdf"?"bg-white shadow-sm text-gray-900":"text-gray-600 hover:text-gray-900"}`,children:"PDF"})]}),c.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:c.jsx(Zr,{className:"h-6 w-6"})})]})]}),c.jsx("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"flex items-center space-x-4",children:c.jsxs("label",{className:"flex items-center space-x-2 text-sm",children:[c.jsx("input",{type:"checkbox",checked:h,onChange:()=>d(!h),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),c.jsx("span",{children:"Include EYFS Standards"})]})}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsxs("button",{onClick:w,className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg transition-colors duration-200 flex items-center space-x-2",children:[c.jsx(yy,{className:"h-4 w-4"}),c.jsx("span",{children:"Print"})]}),c.jsx("button",{onClick:y,disabled:l,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200 flex items-center space-x-2 disabled:bg-blue-400",children:l?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),c.jsx("span",{children:"Exporting..."})]}):u?c.jsxs(c.Fragment,{children:[c.jsx(Ea,{className:"h-4 w-4"}),c.jsx("span",{children:"Exported!"})]}):c.jsxs(c.Fragment,{children:[c.jsx(Gl,{className:"h-4 w-4"}),c.jsxs("span",{children:["Export ",s.toUpperCase()]})]})})]})]})}),c.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-gray-100 print:bg-white print:p-0",children:c.jsx("div",{ref:m,className:"bg-white mx-auto shadow-md max-w-[210mm] print:shadow-none print:max-w-none",style:{minHeight:"297mm"},children:c.jsxs("div",{className:"p-8 print:p-4",children:[c.jsxs("div",{className:"text-center border-b-4 border-blue-500 pb-6 mb-6 relative print:pb-4 print:mb-4 bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-t-lg",children:[c.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-4 rounded-lg shadow-lg mb-4",children:[c.jsxs("h1",{className:"text-3xl font-bold mb-2 print:text-2xl",children:[n.display," Lesson Plan"]}),c.jsx("h2",{className:"text-2xl font-semibold mb-2 print:text-xl",children:g.title||`Lesson ${e}`}),c.jsxs("div",{className:"text-blue-100 font-medium text-lg",children:["Total Time: ",p," minutes"]})]}),c.jsxs("div",{className:"hidden print:block absolute top-0 right-0 text-xs text-gray-500",children:["Page ",c.jsx("span",{className:"pageNumber"})]})]}),h&&x.length>0&&c.jsxs("div",{className:"mb-8 print:mb-6 bg-gradient-to-r from-green-50 to-emerald-50 p-6 rounded-xl border-2 border-green-200 shadow-sm",children:[c.jsxs("h3",{className:"text-2xl font-bold text-green-800 mb-4 flex items-center space-x-3 print:text-xl print:mb-3",children:[c.jsx("div",{className:"bg-green-600 p-2 rounded-lg",children:c.jsx(Pn,{className:"h-6 w-6 text-white print:h-5 print:w-5"})}),c.jsx("span",{children:"Learning Goals"})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 print:gap-3",children:Object.entries(v).map(([B,E])=>c.jsxs("div",{className:"bg-white rounded-xl p-4 border-2 border-green-100 shadow-sm print:p-3",children:[c.jsx("h4",{className:"font-bold text-green-800 text-lg mb-3 print:text-base print:mb-2 border-b border-green-200 pb-2",children:B}),c.jsx("ul",{className:"space-y-2",children:E.map((_,F)=>c.jsxs("li",{className:"flex items-start space-x-3 text-base text-gray-700 print:text-sm",children:[c.jsx("span",{className:"text-green-600 font-bold text-lg",children:"✓"}),c.jsx("span",{className:"leading-relaxed",children:_})]},F))})]},B))})]}),g.categoryOrder.map(B=>{const E=g.grouped[B]||[];if(E.length===0)return null;const _=a(B);return c.jsxs("div",{className:"mb-10 print:mb-8",children:[c.jsx("div",{className:"text-white p-4 rounded-xl mb-6 shadow-lg print:mb-4 print:p-3",style:{background:`linear-gradient(135deg, ${_} 0%, ${_}dd 100%)`,borderLeft:`6px solid ${_}`},children:c.jsxs("h2",{className:"text-2xl font-bold print:text-xl flex items-center",children:[c.jsx("div",{className:"w-4 h-4 rounded-full mr-3 border-2 border-white",style:{backgroundColor:"rgba(255,255,255,0.3)"}}),B,c.jsxs("span",{className:"ml-auto bg-white bg-opacity-20 px-3 py-1 rounded-full text-sm font-medium",children:[E.length," ",E.length===1?"activity":"activities"]})]})}),c.jsx("div",{className:"space-y-6 print:space-y-4",children:E.map((F,T)=>c.jsxs("div",{className:"bg-white rounded-xl border-2 shadow-lg overflow-hidden print:border print:rounded-lg print:mb-4",style:{borderLeftWidth:"6px",borderLeftColor:_,borderColor:`${_}40`},children:[c.jsxs("div",{className:"p-4 border-b-2 flex justify-between items-center print:p-3",style:{backgroundColor:`${_}10`,borderBottomColor:`${_}30`},children:[c.jsx("h3",{className:"font-bold text-gray-900 text-lg print:text-base",children:F.activity}),F.time>0&&c.jsxs("div",{className:"text-white px-3 py-1 rounded-full text-sm font-bold shadow-sm print:text-xs",style:{backgroundColor:_},children:[F.time," min"]})]}),c.jsxs("div",{className:"p-4 print:p-3",children:[F.activityText&&c.jsx("div",{className:"mb-4 text-base text-gray-800 print:text-sm bg-blue-50 p-3 rounded-lg border border-blue-200",dangerouslySetInnerHTML:{__html:F.activityText}}),c.jsx("div",{className:"text-base text-gray-700 leading-relaxed print:text-sm",dangerouslySetInnerHTML:{__html:F.description.includes("<")?F.description:F.description.replace(/\n/g,"<br>")}}),(F.videoLink||F.musicLink||F.backingLink||F.resourceLink||F.link||F.vocalsLink||F.imageLink)&&c.jsxs("div",{className:"mt-4 pt-4 border-t-2 border-gray-100 print:mt-3 print:pt-3",children:[c.jsx("h4",{className:"text-sm font-semibold text-gray-600 mb-2 uppercase tracking-wide",children:"Resources:"}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[F.videoLink&&c.jsx("a",{href:F.videoLink,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-3 py-2 bg-red-500 text-white text-sm font-bold rounded-lg shadow-md print:text-xs print:py-1 print:px-2 hover:bg-red-600 transition-colors",children:"🎥 Video"}),F.musicLink&&c.jsx("a",{href:F.musicLink,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-3 py-2 bg-green-500 text-white text-sm font-bold rounded-lg shadow-md print:text-xs print:py-1 print:px-2 hover:bg-green-600 transition-colors",children:"🎵 Music"}),F.backingLink&&c.jsx("a",{href:F.backingLink,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-3 py-2 bg-blue-500 text-white text-sm font-bold rounded-lg shadow-md print:text-xs print:py-1 print:px-2 hover:bg-blue-600 transition-colors",children:"🎼 Backing"}),F.resourceLink&&c.jsx("a",{href:F.resourceLink,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-3 py-2 bg-purple-500 text-white text-sm font-bold rounded-lg shadow-md print:text-xs print:py-1 print:px-2 hover:bg-purple-600 transition-colors",children:"📁 Resource"}),F.link&&c.jsx("a",{href:F.link,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-3 py-2 bg-gray-500 text-white text-sm font-bold rounded-lg shadow-md print:text-xs print:py-1 print:px-2 hover:bg-gray-600 transition-colors",children:"🔗 Link"}),F.vocalsLink&&c.jsx("a",{href:F.vocalsLink,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-3 py-2 bg-orange-500 text-white text-sm font-bold rounded-lg shadow-md print:text-xs print:py-1 print:px-2 hover:bg-orange-600 transition-colors",children:"🎤 Vocals"}),F.imageLink&&c.jsx("a",{href:F.imageLink,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-3 py-2 bg-pink-500 text-white text-sm font-bold rounded-lg shadow-md print:text-xs print:py-1 print:px-2 hover:bg-pink-600 transition-colors",children:"🖼️ Image"})]})]})]})]},`${B}-${T}`))})]},B)}),g.notes&&c.jsxs("div",{className:"mt-10 pt-8 border-t-4 border-blue-500 print:mt-6 print:pt-4 bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl shadow-sm",children:[c.jsxs("h3",{className:"text-2xl font-bold text-blue-800 mb-4 print:text-xl print:mb-3 flex items-center",children:[c.jsx("div",{className:"bg-blue-600 p-2 rounded-lg mr-3",children:c.jsx(Is,{className:"h-6 w-6 text-white"})}),"Lesson Notes"]}),c.jsx("div",{className:"bg-white rounded-xl p-4 text-gray-700 border-2 border-blue-200 shadow-sm print:p-3 print:text-sm leading-relaxed",dangerouslySetInnerHTML:{__html:g.notes}})]}),c.jsx("div",{className:"mt-12 pt-8 border-t-4 border-gradient-to-r from-blue-500 to-indigo-500 print:mt-8 print:pt-4",children:c.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-6 rounded-xl shadow-lg text-center",children:[c.jsxs("div",{className:"flex items-center justify-center space-x-4 mb-3",children:[c.jsx("div",{className:"bg-white bg-opacity-20 p-2 rounded-lg",children:c.jsx(Is,{className:"h-6 w-6"})}),c.jsx("h4",{className:"text-xl font-bold",children:"EYFS Lesson Builder"})]}),c.jsx("p",{className:"text-blue-100 text-lg font-medium mb-2",children:n.display}),c.jsxs("p",{className:"text-blue-200 text-sm",children:["Generated on ",new Date().toLocaleDateString("en-GB",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]}),c.jsx("div",{className:"mt-4 pt-4 border-t border-blue-400 text-xs text-blue-200",children:"All resource links are clickable in this document"})]})})]})})})]})})}function Cle({id:e,name:t,months:r,color:n,lessonCount:i,onClick:a,isComplete:s}){return c.jsxs("div",{className:`bg-white rounded-xl shadow-lg border-2 transition-all duration-300 hover:shadow-xl overflow-hidden cursor-pointer ${s?"border-green-500":"border-gray-200 hover:border-gray-300"}`,onClick:a,children:[c.jsxs("div",{className:"p-6 text-white relative overflow-hidden",style:{background:`linear-gradient(135deg, ${n} 0%, ${n}99 100%)`},children:[c.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white bg-opacity-10 rounded-full -translate-y-16 translate-x-16"}),c.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-white bg-opacity-10 rounded-full translate-y-12 -translate-x-12"}),c.jsxs("div",{className:"relative z-10",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("h3",{className:"text-2xl font-bold",children:t}),c.jsx(Zb,{className:"h-6 w-6 transition-transform duration-300"})]}),c.jsx("p",{className:"text-white text-opacity-90 text-sm font-medium",children:r}),c.jsx("div",{className:"flex items-center space-x-6 text-white text-opacity-90 mt-2",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Ls,{className:"h-5 w-5"}),c.jsx("span",{className:"font-medium",children:i>0?`${i} lessons`:"No lessons assigned"})]})})]})]}),s&&c.jsx("div",{className:"p-4 border-t border-gray-200",children:c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("span",{className:"text-sm font-medium text-green-600 flex items-center space-x-1",children:[c.jsx(No,{className:"h-4 w-4"}),c.jsx("span",{children:"Half-term complete"})]})})})]})}function Sle({lessonNumber:e,className:t=""}){const{allEyfsStatements:r,eyfsStatements:n,addEyfsToLesson:i,removeEyfsFromLesson:a}=oi(),[s,o]=ve.useState(!1),[l,A]=ve.useState(""),u=n[e]||[],f=r.filter(m=>m.toLowerCase().includes(l.toLowerCase())),h={};f.forEach(m=>{const g=m.indexOf(":");if(g>0){const x=m.substring(0,g).trim();h[x]||(h[x]=[]),h[x].push(m)}else{const x="General";h[x]||(h[x]=[]),h[x].push(m)}});const d=m=>{u.includes(m)?a(e,m):i(e,m)};return c.jsxs("div",{className:`relative ${t}`,children:[c.jsxs("button",{onClick:()=>o(!s),className:"w-full flex items-center justify-between px-4 py-2 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 transition-colors duration-200",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Pn,{className:"h-4 w-4 text-blue-600"}),c.jsxs("span",{className:"text-sm font-medium text-blue-800",children:["EYFS Standards ",u.length>0&&`(${u.length})`]})]}),s?c.jsx(h0,{className:"h-4 w-4 text-blue-600"}):c.jsx(f0,{className:"h-4 w-4 text-blue-600"})]}),s&&c.jsxs("div",{className:"absolute z-40 mt-2 w-full bg-white rounded-lg shadow-xl border border-blue-200 overflow-hidden",children:[c.jsx("div",{className:"p-3 border-b border-blue-100",children:c.jsxs("div",{className:"relative",children:[c.jsx(rA,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsx("input",{type:"text",placeholder:"Search EYFS standards...",value:l,onChange:m=>A(m.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",dir:"ltr"})]})}),c.jsx("div",{className:"max-h-60 overflow-y-auto p-2",children:Object.keys(h).length===0?c.jsx("div",{className:"text-center py-4 text-gray-500",children:"No EYFS standards match your search"}):c.jsx("div",{className:"space-y-3",children:Object.entries(h).map(([m,g])=>c.jsxs("div",{className:"bg-gray-50 rounded-lg p-2",children:[c.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-1 px-2",children:m}),c.jsx("div",{className:"space-y-1",children:g.map(x=>{const p=x.includes(":")?x.split(":")[1].trim():x;return c.jsxs("div",{className:"flex items-center space-x-2 p-2 hover:bg-blue-50 rounded-lg cursor-pointer",onClick:()=>d(x),children:[c.jsx("div",{className:`w-5 h-5 flex-shrink-0 rounded border ${u.includes(x)?"bg-blue-600 border-blue-600 flex items-center justify-center":"border-gray-300"}`,children:u.includes(x)&&c.jsx(Ea,{className:"h-3 w-3 text-white"})}),c.jsx("span",{className:"text-sm text-gray-700",dir:"ltr",children:p})]},x)})})]},m))})}),c.jsx("div",{className:"p-3 border-t border-blue-100 bg-blue-50",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("span",{className:"text-xs text-blue-700",children:[u.length," standards selected"]}),c.jsx("button",{onClick:()=>o(!1),className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-lg",children:"Done"})]})})]}),u.length>0&&!s&&c.jsx("div",{className:"mt-2 p-2 bg-blue-50 rounded-lg border border-blue-100",children:c.jsx("div",{className:"flex flex-wrap gap-1",children:u.map(m=>{const g=m.includes(":")?m.split(":")[1].trim():m;return c.jsxs("div",{className:"inline-flex items-center space-x-1 px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:[c.jsx("span",{className:"truncate max-w-[200px]",dir:"ltr",children:g}),c.jsx("button",{onClick:x=>{x.stopPropagation(),a(e,m)},className:"hover:text-blue-900 p-0.5 hover:bg-blue-200 rounded-full transition-colors duration-200",children:c.jsx(Zr,{className:"h-3 w-3"})})]},m)})})})]})}function Ele({lessonNumber:e,className:t=""}){var A;const{eyfsStatements:r,allLessonsData:n}=oi(),[i,a]=ve.useState([]),s=r[e]||((A=n[e])==null?void 0:A.eyfsStatements)||[];if(s.length===0)return null;const o={};s.forEach(u=>{const f=u.indexOf(":");if(f>0){const h=u.substring(0,f).trim(),d=u.substring(f+1).trim();o[h]||(o[h]=[]),o[h].push(d)}else{const h="General";o[h]||(o[h]=[]),o[h].push(u)}});const l=u=>{a(f=>f.includes(u)?f.filter(h=>h!==u):[...f,u])};return c.jsxs("div",{className:`bg-blue-50 rounded-lg p-4 border border-blue-200 ${t}`,children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[c.jsx(Pn,{className:"h-5 w-5 text-blue-600"}),c.jsx("h3",{className:"font-medium text-blue-900",children:"EYFS Standards"})]}),c.jsx("div",{className:"space-y-3",children:Object.entries(o).map(([u,f])=>c.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-100",children:[c.jsxs("button",{className:"w-full flex items-center justify-between text-left font-medium text-blue-800 text-sm mb-2",onClick:()=>l(u),children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(qW,{className:"h-4 w-4 text-blue-600"}),c.jsx("span",{children:u})]}),i.includes(u)?c.jsx(h0,{className:"h-4 w-4 text-blue-600"}):c.jsx(f0,{className:"h-4 w-4 text-blue-600"})]}),i.includes(u)&&c.jsx("ul",{className:"space-y-1 mt-2 pl-6",children:f.map((h,d)=>c.jsxs("li",{className:"flex items-start space-x-2 text-sm text-gray-700",children:[c.jsx(Ea,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),c.jsx("span",{children:h})]},d))})]},u))})]})}const kle={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};function jm({lessonNumber:e,onClose:t,halfTermId:r,halfTermName:n,unitId:i,unitName:a,lessonNumbers:s,isUnitPrint:o=!1}){const{allLessonsData:l,currentSheetInfo:A,eyfsStatements:u,halfTerms:f}=oi(),{getCategoryColor:h}=Gi(),[d,m]=ve.useState(!1),[g,x]=ve.useState(!1),[p,v]=ve.useState(!0),[y,w]=ve.useState(o||i||r?"unit":"single");ve.useRef(null);const B="146bdd01-146f-43f8-92aa-26201c38aa11",E="https://api.pdfbolt.com/v1/direct";console.log("Environment check:",{apiKey:B,allEnvVars:kle});const _=es.useMemo(()=>{let C=[];if(y==="single"&&e)C=[e];else if(s&&s.length>0)C=[...s];else if(i){const R=JSON.parse(localStorage.getItem(`units-${A.sheet}`)||"[]").find(W=>W.id===i);C=(R==null?void 0:R.lessonNumbers)||[]}else if(r){const L=f.find(R=>R.id===r);C=(L==null?void 0:L.lessons)||[]}else e&&(C=[e]);return C.sort((L,R)=>{const W=parseInt(L,10),G=parseInt(R,10);return W-G})},[y,e,s,i,r,f,A.sheet]),F=es.useMemo(()=>{if(y==="single"&&e){const C=l[e];return(C==null?void 0:C.title)||`Lesson ${e}`}else{if(a)return`Unit: ${a}`;if(n)return`Half-Term: ${n}`}return"Lesson Plan"},[y,e,a,n,l]),T=()=>{let C,L=`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="UTF-8">
        <title>${F}</title>
        <script src="https://cdn.tailwindcss.com"><\/script>
        <style>  
          @media print {
            .page-header {
              display: none;
            }
            .lesson-page:not(:last-child) {
              page-break-after: always;
            }
          }
          .lesson-page:not(:last-child) {
            page-break-after: always;
          }
         
          /* Enhanced print styles for better visibility */
          @media print {
            * {
              -webkit-print-color-adjust: exact !important;
              color-adjust: exact !important;
            }
           
            .print-border {
              border: 2px solid #000000 !important;
            }
           
            .print-text-dark {
              color: #000000 !important;
            }
           
            .print-bg-light {
              background-color: #f8f9fa !important;
            }
           
            .print-border-dark {
              border-color: #333333 !important;
            }
          }
        </style>
      </head>
      <body>
        <div>
          <div>
    `;return _.forEach((R,W)=>{const G=l[R];if(!G)return;C=`<div
           style="width: 100%; text-align: center; font-size: 11px; color: #000000; font-weight: bold;">
        <p>${["Curriculum Designer",`Lesson ${W+1}`,A.display,n||a,"© Rhythmstix 2025"].filter(Boolean).join(" • ")}
        </p>
      </div>`;const V=u[R]||u[W+1]||u[(W+1).toString()]||[];console.log("Looking for EYFS data:",{lessonNum:R,lessonIndex:W+1,foundData:V,availableKeys:Object.keys(u)});const X={};V.forEach(Q=>{const K=Q.split(":"),H=K[0].trim(),k=K.length>1?K[1].trim():Q;X[H]||(X[H]=[]),X[H].push(k)}),L+=`
        <div class="lesson-page bg-white">
          <div class="page-header bg-blue-50 px-6 py-3 border-b border-gray-200">
            <div class="flex justify-between items-center">
              <span class="text-sm font-medium text-blue-800">
                Lesson ${W+1} Preview
              </span>
              <span class="text-xs text-blue-600">
                Page ${W+1} of ${_.length}
              </span>
            </div>
          </div>

          <!-- Lesson Content -->
          <div class="px-6 pt-3 pb-6">
            <!-- Lesson Title -->
            <div class="mb-3 border-b border-black pb-2">
              <h3 class="text-xl font-bold text-black">
                Lesson ${W+1}, ${n||a||"Autumn 1"} - ${A.display}, Music
              </h3>
            </div>
      `,p&&V.length>0&&(L+=`
          <div class="mb-4">
            <h3 class="text-base font-bold text-black mb-2 flex items-center space-x-2">
              <svg class="h-4 w-4 text-blue-800" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
              </svg>
              <span>Learning Goals</span>
            </h3>
            <div class="grid grid-cols-2 gap-2">
        `,Object.entries(X).forEach(([Q,K])=>{L+=`
            <div class="rounded-lg p-2 border border-gray-800" style="background-color: #fffbeb;">
              <h4 class="font-bold text-black text-xs mb-1">${Q}</h4>
              <ul class="space-y-0.5">
          `,K.forEach(H=>{L+=`
              <li class="flex items-start space-x-2 text-xs text-black">
                <span class="text-green-600 font-bold">✓</span>
                <span>${H}</span>
              </li>
            `}),L+="</ul></div>"}),L+="</div></div>"),G.categoryOrder.forEach(Q=>{const K=G.grouped[Q]||[];if(K.length===0)return;const H=h(Q),k=Q==="Welcome"?"#FDE68A":Q==="Kodaly Songs"?"#DDD6FE":Q==="Goodbye"?"#A7F3D0":`${H}60`,U=Q==="Welcome"?"color: #F59E0B;":Q==="Kodaly Songs"?"color: #8B5CF6;":Q==="Goodbye"?"color: #10B981;":`color: ${H};`,P=Q==="Welcome"?"border-left-color: #F59E0B;":Q==="Kodaly Songs"?"border-left-color: #8B5CF6;":Q==="Goodbye"?"border-left-color: #10B981;":`border-left-color: ${H};`,D=Q==="Welcome"?"background-color: #FEF3C7; border-bottom-color: #F59E0B;":Q==="Kodaly Songs"?"background-color: #EDE9FE; border-bottom-color: #8B5CF6;":Q==="Goodbye"?"background-color: #D1FAE5; border-bottom-color: #10B981;":`background-color: ${H}20; border-bottom-color: ${H};`;L+=`
          <div class="mb-4">
            <h2 class="text-sm font-bold mb-1 text-black border-b border-black pb-0.5" style="${U} page-break-after: avoid;">
              ${Q}
            </h2>
           
            <div class="space-y-2">
        `,K.forEach(O=>{L+=`
            <div class="bg-white rounded-lg border overflow-hidden" style="page-break-inside: avoid; border-left-width: 4px; ${P} border-color: ${k};">
              <!-- Activity Header -->
              <div class="px-2 py-0.5 border-b flex justify-between items-center" style="${D}">
                <h3 class="font-bold text-black text-xs">
                  ${O.activity}
                </h3>
                ${O.time>0?`
                  <div class="px-1 py-0.5 rounded-full text-xs font-bold" style="background-color: rgba(0,0,0,0.15); color: #374151;">
                    ${O.time}m
                  </div>
                `:""}
              </div>
             
              <div class="p-1.5">
                ${O.activityText?`
                  <div class="mb-1 text-xs text-black font-medium">
                    ${O.activityText}
                  </div>
                `:""}
                
                <div class="text-sm text-gray-700">
                    ${O.description.includes("<")?O.description:O.description.replace(/\n/g,"<br>")}
                </div>
          `;const z=[];O.videoLink&&z.push({label:"Video",url:O.videoLink,classes:"bg-red-100 text-red-800 border-red-300"}),O.musicLink&&z.push({label:"Music",url:O.musicLink,classes:"bg-green-100 text-green-800 border-green-300"}),O.backingLink&&z.push({label:"Backing",url:O.backingLink,classes:"bg-blue-100 text-blue-800 border-blue-300"}),O.resourceLink&&z.push({label:"Resource",url:O.resourceLink,classes:"bg-purple-100 text-purple-800 border-purple-300"}),O.link&&z.push({label:"Link",url:O.link,classes:"bg-gray-100 text-gray-800 border-gray-300"}),O.vocalsLink&&z.push({label:"Vocals",url:O.vocalsLink,classes:"bg-orange-100 text-orange-800 border-orange-300"}),O.imageLink&&z.push({label:"Image",url:O.imageLink,classes:"bg-pink-100 text-pink-800 border-pink-300"}),z.length>0&&(L+=`
              <div class="mt-1 pt-1 border-t border-gray-600">
                <p class="text-xs font-bold text-black mb-0.5">Resources:</p>
                <div class="flex flex-wrap gap-0.5">
            `,z.forEach(J=>{L+=`
                <a href="${J.url}"
                   class="inline-flex items-center px-1.5 py-0.5 text-xs rounded-full border font-bold ${J.classes}"
                   target="_blank"
                   rel="noopener noreferrer">
                  ${J.label}
                </a>
              `}),L+="</div></div>"),L+="</div></div>"}),L+="</div></div>"}),G.notes&&(L+=`
          <div class="mt-6 pt-4 border-t border-black">
            <h3 class="text-lg font-bold text-black mb-2">Lesson Notes</h3>
            <div class="bg-gray-200 rounded-lg p-3 text-black border border-gray-600">
              ${G.notes}
            </div>
          </div>
        `),L+=`
          </div>
        </div>
      `}),L+=`
        </div>
        </div>
      </body>
      </html>
    `,[L,C]};if(_.length===0)return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 max-w-md w-full",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Error"}),c.jsx("p",{className:"text-gray-600 mb-6",children:"No lessons found to print."}),c.jsx("div",{className:"flex justify-end",children:c.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg",children:"Close"})})]})});const I=function(C){const R=new TextEncoder().encode(C);let W="";for(let G=0;G<R.length;G++)W+=String.fromCharCode(R[G]);return btoa(W)},S=async()=>{m(!0);try{const C=I(T()[0]),L=I(T()[1]);console.log("Sending request to PDFBolt API..."),console.log("API Key:",B?"Set":"Not set"),console.log("HTML content length:",C.length);const R=await fetch(E,{method:"POST",headers:{"Content-Type":"application/json",API_KEY:B},body:JSON.stringify({html:C,printBackground:!0,waitUntil:"networkidle",format:"A4",margin:{top:"15px",right:"20px",left:"20px",bottom:"55px"},displayHeaderFooter:!0,footerTemplate:L,headerTemplate:I("<div></div>")})});if(console.log("Response status:",R.status),console.log("Response headers:",R.headers),!R.ok){const Q=await R.text();throw console.error("PDFBolt API Error Details:",Q),new Error(`PDFBolt API Error: ${R.status} - ${Q}`)}const W=await R.blob();console.log("PDF blob received, size:",W.size);const G=window.URL.createObjectURL(W),V=document.createElement("a");V.href=G;const X=y==="single"?`${A.sheet}_Lesson_${e}.pdf`:`${A.sheet}_${(a||n||"Unit").replace(/\s+/g,"_")}.pdf`;V.download=X,document.body.appendChild(V),V.click(),document.body.removeChild(V),window.URL.revokeObjectURL(G),x(!0),setTimeout(()=>x(!1),3e3)}catch(C){console.error("Export failed:",C),alert(`Export failed: ${C.message}`)}finally{m(!1)}};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-5xl max-h-[90vh] flex flex-col overflow-hidden",children:[c.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900",children:o?"Export Half-Term Plans":"Export Lesson Plan"}),c.jsxs("p",{className:"text-sm text-gray-600",children:[F," - ",A.display," (",_.length," lesson",_.length!==1?"s":"",")"]})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[!o&&(r||s&&s.length>1)&&c.jsxs("div",{className:"flex items-center space-x-2 bg-gray-100 p-1 rounded-lg",children:[c.jsx("button",{onClick:()=>w("single"),className:`px-3 py-1.5 rounded-md text-sm font-medium ${y==="single"?"bg-white shadow-sm text-gray-900":"text-gray-600 hover:text-gray-900"}`,children:"Single Lesson"}),c.jsx("button",{onClick:()=>w("unit"),className:`px-3 py-1.5 rounded-md text-sm font-medium ${y==="unit"?"bg-white shadow-sm text-gray-900":"text-gray-600 hover:text-gray-900"}`,children:n?"Entire Half-Term":"All Lessons"})]}),i&&a&&c.jsxs("div",{className:"text-sm text-gray-600 bg-blue-50 px-3 py-2 rounded-lg border border-blue-200",children:[c.jsx("span",{className:"font-medium text-blue-800",children:"Unit Print:"})," ",a]}),c.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:c.jsx(Zr,{className:"h-6 w-6"})})]})]}),c.jsx("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsxs("label",{className:"flex items-center space-x-2 text-sm",children:[c.jsx("input",{type:"checkbox",checked:p,onChange:()=>v(!p),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),c.jsx("span",{children:"Include EYFS Standards"})]}),c.jsxs("div",{className:"text-sm text-gray-600",children:["Lessons: ",_.map((C,L)=>L+1).join(", ")]})]}),c.jsx("div",{className:"flex space-x-3",children:c.jsx("button",{onClick:S,disabled:d,className:"px-4 py-2 bg-blue-900 hover:bg-blue-800 text-white font-medium rounded-lg transition-colors duration-200 flex items-center space-x-2 disabled:bg-blue-400",children:d?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),c.jsx("span",{children:"Exporting..."})]}):g?c.jsxs(c.Fragment,{children:[c.jsx(Ea,{className:"h-4 w-4"}),c.jsx("span",{children:"Exported!"})]}):c.jsxs(c.Fragment,{children:[c.jsx(Gl,{className:"h-4 w-4"}),c.jsx("span",{children:"Export PDF"})]})})})]})}),c.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-gray-100 print:bg-white print:p-0",children:c.jsx("div",{className:"space-y-6",children:_.map((C,L)=>{const R=l[C];if(!R)return null;console.log(`Lesson ${C} data:`,{title:R.title,lessonNum:C,lessonIndex:L,categoryOrder:R.categoryOrder,grouped:Object.keys(R.grouped||{})});const W=u[C]||u[L+1]||u[(L+1).toString()]||[],G={};return W.forEach(V=>{const X=V.split(":"),Q=X[0].trim(),K=X.length>1?X[1].trim():V;G[Q]||(G[Q]=[]),G[Q].push(K)}),c.jsxs("div",{className:"bg-white border border-gray-300 shadow-lg rounded-lg overflow-hidden relative",style:{minHeight:"297mm",width:"210mm",marginLeft:"auto",marginRight:"auto"},children:[c.jsx("div",{className:"bg-blue-50 px-6 py-3 border-b border-gray-200",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("span",{className:"text-sm font-medium text-blue-800",children:["Lesson ",L+1,", ",n||a||"Autumn 1"," - Lesson Preview"]}),c.jsxs("span",{className:"text-xs text-blue-600",children:["Page ",L+1," of ",_.length]})]})}),c.jsxs("div",{className:"px-6 pt-3 pb-16",children:[c.jsx("div",{className:"mb-3 border-b border-black pb-2",children:c.jsxs("h3",{className:"text-xl font-bold text-black",children:["Lesson ",L+1,", ",n||a||"Autumn 1"," - ",A.display,", Music"]})}),p&&W.length>0&&c.jsxs("div",{className:"mb-4",children:[c.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-2 flex items-center space-x-2",children:[c.jsx(Pn,{className:"h-4 w-4 text-blue-600"}),c.jsx("span",{children:"Learning Goals"})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:Object.entries(G).map(([V,X])=>c.jsxs("div",{className:"bg-gray-50 rounded-lg p-2 border border-gray-200",children:[c.jsx("h4",{className:"font-medium text-gray-800 text-xs mb-1",children:V}),c.jsx("ul",{className:"space-y-0.5",children:X.map((Q,K)=>c.jsxs("li",{className:"flex items-start space-x-2 text-sm text-gray-700",children:[c.jsx("span",{className:"text-green-500 font-bold",children:"✓"}),c.jsx("span",{children:Q})]},K))})]},V))})]}),R.categoryOrder.map(V=>{const X=R.grouped[V]||[];if(X.length===0)return null;const Q=h(V),K=k=>{switch(k){case"Welcome":return"#FEF3C7";case"Kodaly Songs":return"#EDE9FE";case"Goodbye":return"#D1FAE5";default:return`${Q}20`}},H=k=>{switch(k){case"Welcome":return"#FDE68A";case"Kodaly Songs":return"#DDD6FE";case"Goodbye":return"#A7F3D0";default:return`${Q}60`}};return c.jsxs("div",{className:"mb-4",children:[c.jsx("h2",{className:"text-sm font-bold mb-1 text-black border-b border-black pb-0.5",style:{color:V==="Welcome"?"#F59E0B":V==="Kodaly Songs"?"#8B5CF6":V==="Goodbye"?"#10B981":Q},children:V}),c.jsx("div",{className:"space-y-2",children:X.map((k,U)=>c.jsxs("div",{className:"bg-white rounded-lg border overflow-hidden",style:{borderLeftWidth:"4px",borderLeftColor:Q,borderColor:H(V)},children:[c.jsxs("div",{className:"px-2 py-0.5 border-b flex justify-between items-center",style:{backgroundColor:K(V),borderBottomColor:Q},children:[c.jsx("h3",{className:"text-xs font-bold text-black",children:k.activity}),k.time>0&&c.jsxs("div",{className:"px-1 py-0.5 rounded-full text-xs font-bold",style:{backgroundColor:"rgba(0,0,0,0.15)",color:"#374151"},children:[k.time,"m"]})]}),c.jsxs("div",{className:"p-1.5",children:[k.activityText&&c.jsx("div",{className:"mb-1 text-xs text-black font-medium",dangerouslySetInnerHTML:{__html:k.activityText}}),c.jsx("div",{className:"text-xs text-black",dangerouslySetInnerHTML:{__html:k.description.includes("<")?k.description:k.description.replace(/\n/g,"<br>")}}),(k.videoLink||k.musicLink||k.backingLink||k.resourceLink||k.link||k.vocalsLink||k.imageLink)&&c.jsxs("div",{className:"mt-1 pt-1 border-t border-gray-600",children:[c.jsx("p",{className:"text-xs font-bold text-black mb-0.5",children:"Resources:"}),c.jsxs("div",{className:"flex flex-wrap gap-0.5",children:[k.videoLink&&c.jsx("a",{href:k.videoLink,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-1.5 py-0.5 bg-red-100 text-red-800 text-xs rounded-full hover:bg-red-200 transition-colors",children:"Video"}),k.musicLink&&c.jsx("a",{href:k.musicLink,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-1.5 py-0.5 bg-green-100 text-green-800 text-xs rounded-full hover:bg-green-200 transition-colors",children:"Music"}),k.backingLink&&c.jsx("a",{href:k.backingLink,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-1.5 py-0.5 bg-blue-100 text-blue-800 text-xs rounded-full hover:bg-blue-200 transition-colors",children:"Backing"}),k.resourceLink&&c.jsx("a",{href:k.resourceLink,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-1.5 py-0.5 bg-purple-100 text-purple-800 text-xs rounded-full hover:bg-purple-200 transition-colors",children:"Resource"}),k.link&&c.jsx("a",{href:k.link,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-1.5 py-0.5 bg-gray-100 text-gray-800 text-xs rounded-full hover:bg-gray-200 transition-colors",children:"Link"}),k.vocalsLink&&c.jsx("a",{href:k.vocalsLink,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-1.5 py-0.5 bg-orange-100 text-orange-800 text-xs rounded-full hover:bg-orange-200 transition-colors",children:"Vocals"}),k.imageLink&&c.jsx("a",{href:k.imageLink,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-1.5 py-0.5 bg-pink-100 text-pink-800 text-xs rounded-full hover:bg-pink-200 transition-colors",children:"Image"})]})]})]})]},`${V}-${U}`))})]},V)}),R.notes&&c.jsxs("div",{className:"mt-6 pt-4 border-t border-black",children:[c.jsx("h3",{className:"text-lg font-bold text-black mb-2",children:"Lesson Notes"}),c.jsx("div",{className:"bg-gray-200 rounded-lg p-3 text-black border border-gray-600",dangerouslySetInnerHTML:{__html:R.notes}})]})]}),c.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gray-50 px-6 py-3 text-center text-xs text-gray-500 rounded-b-lg",children:c.jsx("p",{children:c.jsxs("strong",{children:["Curriculum Designer • ",A.display," • ",n||a||""," • © Rhythmstix 2025"]})})})]},C)})})})]})})}function Dm({lessonNumber:e,displayNumber:t,onClose:r,theme:n,onExport:i,unitId:a,unitName:s,halfTermId:o,halfTermName:l}){const{allLessonsData:A,updateLessonTitle:u,eyfsStatements:f,deleteLesson:h}=oi(),{getCategoryColor:d}=Gi(),[m,g]=ve.useState(null),[x,p]=ve.useState(null),[v,y]=ve.useState(!1),[w,B]=ve.useState(!1),[E,_]=ve.useState(""),[F,T]=ve.useState(!1),[I,S]=ve.useState(!1),[C,L]=ve.useState(!1),[R,W]=ve.useState({url:"",title:"",type:"link"}),G=A[e],V=(H,k,U)=>{W({url:H,title:k,type:U}),L(!0)};if(ve.useEffect(()=>{G!=null&&G.title?_(G.title):_(`Lesson ${e}`)},[G,e]),!G)return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 max-w-md w-full",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Error"}),c.jsxs("p",{className:"text-gray-600 mb-6",children:["Lesson data not found for lesson ",e,"."]}),c.jsx("div",{className:"flex justify-end",children:c.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg",children:"Close"})})]})});const X=()=>{E.trim()&&(u(e,E.trim()),B(!1))},Q=()=>{T(!0)},K=()=>{h(e),r()};return es.useMemo(()=>{try{return!G||!G.grouped?0:Object.values(G.grouped).reduce((H,k)=>H+(Array.isArray(k)?k.length:0),0)}catch(H){return console.error("Error calculating total activities:",H),0}},[G]),(f[e]||[]).length,c.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50",children:[c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-6xl max-h-[95vh] overflow-hidden flex flex-col",children:[c.jsx("div",{className:"p-4 text-white relative",style:{background:`linear-gradient(135deg, ${n.primary} 0%, ${n.secondary} 100%)`},children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[w?c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("input",{type:"text",value:E,onChange:H=>_(H.target.value),className:"text-xl font-bold bg-white bg-opacity-20 text-white border border-white border-opacity-30 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-white focus:ring-opacity-50",autoFocus:!0,onKeyDown:H=>{H.key==="Enter"&&X(),H.key==="Escape"&&B(!1)}}),c.jsx("button",{onClick:X,className:"p-1 bg-white bg-opacity-20 hover:bg-opacity-30 rounded text-white",children:c.jsx(Ea,{className:"h-5 w-5"})}),c.jsx("button",{onClick:()=>B(!1),className:"p-1 bg-white bg-opacity-20 hover:bg-opacity-30 rounded text-white",children:c.jsx(Zr,{className:"h-5 w-5"})})]}):c.jsxs("h1",{className:"text-xl font-bold mb-1 flex items-center space-x-2",children:[c.jsx("span",{children:G.title||`Lesson ${e}`}),c.jsx("button",{onClick:()=>B(!0),className:"p-1 bg-white bg-opacity-20 hover:bg-opacity-30 rounded text-white",title:"Edit lesson title",children:c.jsx(ki,{className:"h-4 w-4"})})]}),c.jsxs("p",{className:"text-white text-opacity-90 text-sm",children:[G.totalTime," minutes • ",G.categoryOrder.length," categories"]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsxs("button",{onClick:Q,className:"p-2 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-lg transition-all duration-200 group flex items-center space-x-2",title:"Delete Lesson",children:[c.jsx(_i,{className:"h-5 w-5 group-hover:scale-110 transition-transform duration-200"}),c.jsx("span",{className:"text-sm font-medium",children:"Delete"})]}),c.jsxs("button",{onClick:()=>y(!v),className:"p-2 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-lg transition-all duration-200 group flex items-center space-x-2",title:"Manage EYFS Standards",children:[c.jsx(Pn,{className:"h-5 w-5 group-hover:scale-110 transition-transform duration-200"}),c.jsx("span",{className:"text-sm font-medium",children:"EYFS Standards"})]}),c.jsxs("button",{onClick:()=>S(!0),className:"p-2 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-lg transition-all duration-200 group flex items-center space-x-2",title:"Export PDF",children:[c.jsx(Gl,{className:"h-5 w-5 group-hover:scale-110 transition-transform duration-200"}),c.jsx("span",{className:"text-sm font-medium",children:"Export PDF"})]}),c.jsx("button",{onClick:r,className:"p-2 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-lg transition-all duration-200 group",title:"Close lesson view",children:c.jsx(Zr,{className:"h-5 w-5 group-hover:scale-110 transition-transform duration-200"})})]})]})}),c.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-200px)]",children:[v&&c.jsx("div",{className:"mb-6",children:c.jsx(Sle,{lessonNumber:e})}),c.jsx("div",{className:"mb-6",children:c.jsx(Ele,{lessonNumber:e})}),c.jsx("div",{className:"space-y-8",children:G.categoryOrder.map(H=>{const k=G.grouped[H]||[];return c.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden",children:[c.jsx("div",{className:"p-4 border-b border-gray-200",style:{background:`linear-gradient(to right, ${d(H)}20, ${d(H)}05)`,borderLeft:`4px solid ${d(H)}`},children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h3",{className:"text-xl font-bold text-gray-900",children:H}),c.jsxs("span",{className:"bg-white px-3 py-1 rounded-full text-sm font-medium shadow-sm",style:{color:d(H)},children:[k.length," ",k.length===1?"activity":"activities"]})]})}),c.jsx("div",{className:"p-4 space-y-6",children:k.map((U,P)=>c.jsxs("button",{onClick:()=>g(U),className:"w-full text-left bg-gray-50 hover:bg-blue-50 rounded-xl border border-gray-200 hover:border-blue-300 transition-all duration-200 shadow-sm hover:shadow-md overflow-hidden cursor-pointer",children:[c.jsxs("div",{className:"p-4 border-b border-gray-200 bg-white",children:[c.jsxs("div",{className:"flex items-start justify-between mb-2",children:[c.jsx("h4",{className:"font-bold text-gray-900 text-base leading-tight",children:U.activity||"Untitled Activity"}),U.time>0&&c.jsxs("span",{className:"text-xs font-medium text-blue-800 bg-blue-100 px-2 py-1 rounded-full ml-3 flex-shrink-0",children:[U.time,"m"]})]}),U.level&&c.jsx("span",{className:"inline-block px-3 py-1 text-white text-xs font-medium rounded-full mb-2",style:{backgroundColor:n.primary},children:U.level})]}),c.jsxs("div",{className:"p-4",children:[U.activityText&&c.jsx("div",{className:"mb-3 prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:U.activityText}}),c.jsx("div",{className:"text-sm text-gray-700 leading-relaxed mb-3 prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:U.description.includes("<")?U.description:U.description.replace(/\n/g,"<br>")}}),U.unitName&&c.jsxs("div",{className:"mb-3",children:[c.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Unit:"}),c.jsx("p",{className:"text-sm text-gray-700 font-medium",children:U.unitName})]}),(U.videoLink||U.musicLink||U.backingLink||U.resourceLink||U.link||U.vocalsLink||U.imageLink)&&c.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg border border-blue-100",children:[c.jsxs("h5",{className:"text-sm font-medium text-blue-800 mb-2 flex items-center",children:[c.jsx(Is,{className:"h-4 w-4 mr-1"}),"Web Resources"]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[U.videoLink&&c.jsxs("button",{onClick:D=>{D.stopPropagation(),V(U.videoLink,`${U.activity} - Video`,"video")},className:"text-xs text-blue-600 hover:text-blue-800 hover:underline truncate flex items-center cursor-pointer",children:[c.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full mr-1"}),"Video Link",c.jsx(ko,{className:"h-3 w-3 ml-1 flex-shrink-0"})]}),U.musicLink&&c.jsxs("button",{onClick:D=>{D.stopPropagation(),V(U.musicLink,`${U.activity} - Music`,"music")},className:"text-xs text-blue-600 hover:text-blue-800 hover:underline truncate flex items-center cursor-pointer",children:[c.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-1"}),"Music Link",c.jsx(ko,{className:"h-3 w-3 ml-1 flex-shrink-0"})]}),U.backingLink&&c.jsxs("button",{onClick:D=>{D.stopPropagation(),V(U.backingLink,`${U.activity} - Backing Track`,"backing")},className:"text-xs text-blue-600 hover:text-blue-800 hover:underline truncate flex items-center cursor-pointer",children:[c.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full mr-1"}),"Backing Track",c.jsx(ko,{className:"h-3 w-3 ml-1 flex-shrink-0"})]}),U.resourceLink&&c.jsxs("button",{onClick:D=>{D.stopPropagation(),V(U.resourceLink,`${U.activity} - Resource`,"resource")},className:"text-xs text-blue-600 hover:text-blue-800 hover:underline truncate flex items-center cursor-pointer",children:[c.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full mr-1"}),"Resource",c.jsx(ko,{className:"h-3 w-3 ml-1 flex-shrink-0"})]}),U.link&&c.jsxs("button",{onClick:D=>{D.stopPropagation(),V(U.link,`${U.activity} - Additional Link`,"link")},className:"text-xs text-blue-600 hover:text-blue-800 hover:underline truncate flex items-center cursor-pointer",children:[c.jsx("span",{className:"w-2 h-2 bg-gray-500 rounded-full mr-1"}),"Additional Link",c.jsx(ko,{className:"h-3 w-3 ml-1 flex-shrink-0"})]}),U.vocalsLink&&c.jsxs("button",{onClick:D=>{D.stopPropagation(),V(U.vocalsLink,`${U.activity} - Vocals`,"vocals")},className:"text-xs text-blue-600 hover:text-blue-800 hover:underline truncate flex items-center cursor-pointer",children:[c.jsx("span",{className:"w-2 h-2 bg-orange-500 rounded-full mr-1"}),"Vocals",c.jsx(ko,{className:"h-3 w-3 ml-1 flex-shrink-0"})]}),U.imageLink&&c.jsxs("button",{onClick:D=>{D.stopPropagation(),V(U.imageLink,`${U.activity} - Image`,"image")},className:"text-xs text-blue-600 hover:text-blue-800 hover:underline truncate flex items-center cursor-pointer",children:[c.jsx("span",{className:"w-2 h-2 bg-pink-500 rounded-full mr-1"}),"Image",c.jsx(ko,{className:"h-3 w-3 ml-1 flex-shrink-0"})]})]})]}),c.jsx("div",{className:"text-xs text-blue-600 italic mt-2",children:"Click to view all details and resources"})]})]},`${H}-${P}`))})]},H)})})]}),c.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end",children:c.jsx("button",{onClick:r,className:"px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg transition-colors duration-200",children:"Close"})})]}),m&&c.jsx(Ju,{activity:m,onClose:()=>{g(null),p(null)},initialResource:x}),C&&c.jsx(DT,{url:R.url,title:R.title,type:R.type,onClose:()=>L(!1)}),F&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[c.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Delete Lesson"}),c.jsxs("p",{className:"text-gray-700 mb-6",children:["Are you sure you want to delete Lesson ",t||e,"? This action cannot be undone and will remove the lesson from all units."]}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx("button",{onClick:()=>T(!1),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg transition-colors",children:"Cancel"}),c.jsxs("button",{onClick:K,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors flex items-center space-x-2",children:[c.jsx(_i,{className:"h-4 w-4"}),c.jsx("span",{children:"Delete Lesson"})]})]})]})}),I&&c.jsx(jm,{lessonNumber:e,onClose:()=>S(!1),unitId:a,unitName:s,halfTermId:o,halfTermName:l})]})}function Fle({halfTermId:e,halfTermName:t,halfTermColor:r,orderedLessons:n,isComplete:i,onReorderLessons:a,onRemoveLesson:s,onViewLessonDetails:o,onPrintHalfTerm:l}){const{allLessonsData:A,currentSheetInfo:u}=oi(),{getThemeForClass:f,getCategoryColor:h}=Gi();return f("LKG"),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:`border rounded-lg p-4 mb-6 ${i?"bg-green-50 border-green-200":"bg-blue-50 border-blue-200"}`,children:[c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ns,{className:`h-5 w-5 ${i?"text-green-600":"text-blue-600"}`}),c.jsxs("h3",{className:"font-medium text-gray-900",children:[t," ",i?"Complete":"In Progress"]})]})}),c.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Drag and drop lessons to reorder them for this half-term"})]}),c.jsx("div",{className:"print-content",children:n.length===0?c.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-gray-200",children:[c.jsx(ns,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No lessons selected"}),c.jsx("p",{className:"text-gray-600",children:"Select lessons from the library to add to this half-term"})]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"hidden print:block text-center border-b border-gray-200 pb-4 mb-6",children:[c.jsxs("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:[u.display," Half-Term Plan"]}),c.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:t}),c.jsxs("div",{className:"text-gray-600 font-medium",children:[n.length," lessons"]}),c.jsxs("div",{className:"absolute top-0 right-0 text-xs text-gray-500",children:["Page ",c.jsx("span",{className:"pageNumber"})]})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 print:gap-2",children:n.map((d,m)=>{const g=A[d];return g?c.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-4 print-activity",draggable:!0,onDragStart:x=>{x.dataTransfer.setData("text/plain",m.toString())},onDragOver:x=>x.preventDefault(),onDrop:x=>{x.preventDefault();const p=parseInt(x.dataTransfer.getData("text/plain"));a(p,m)},children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsxs("h4",{className:"font-semibold text-gray-900",children:["Lesson ",m+1]}),c.jsx("div",{className:"flex items-center print:hidden",children:c.jsx("button",{onClick:x=>{x.stopPropagation(),s(d)},className:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-full",children:c.jsx(Zr,{className:"h-4 w-4"})})})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-2",children:g.title||`Lesson ${m+1}`}),c.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500 mb-2",children:[c.jsx(_a,{className:"h-3 w-3"}),c.jsxs("span",{children:[g.totalTime," mins"]})]}),c.jsxs("div",{className:"flex flex-wrap gap-1",children:[g.categoryOrder.slice(0,2).map(x=>c.jsx("span",{className:"px-1.5 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:x},x)),g.categoryOrder.length>2&&c.jsxs("span",{className:"px-1.5 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:["+",g.categoryOrder.length-2]})]}),c.jsx("div",{className:"mt-2 pt-2 border-t border-gray-100 print:hidden",children:c.jsxs("button",{onClick:x=>{x.stopPropagation(),o(d)},className:"text-xs text-blue-600 hover:text-blue-800 flex items-center space-x-1",children:[c.jsx(Yu,{className:"h-3 w-3"}),c.jsx("span",{children:"View Details"})]})}),c.jsxs("div",{className:"mt-auto pt-2 flex items-center justify-end space-x-1",children:[m>0&&c.jsx("button",{onClick:()=>a(m,m-1),className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full",children:c.jsx(MW,{className:"h-3 w-3"})}),m<n.length-1&&c.jsx("button",{onClick:()=>a(m,m+1),className:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full",children:c.jsx(HW,{className:"h-3 w-3"})})]})]},d):null})}),c.jsxs("div",{className:"hidden print:block mt-8 pt-4 border-t border-gray-200 text-center text-xs text-gray-500",children:[c.jsxs("p",{children:["Curriculum Designer - ",u.display," - ",t]}),c.jsx("p",{className:"pageNumber",children:"Page 1"})]})]})})]})}function Nle({isOpen:e,onClose:t,halfTermId:r,halfTermName:n,halfTermMonths:i,halfTermColor:a,selectedLessons:s,onSave:o}){const{lessonNumbers:l,allLessonsData:A,currentSheetInfo:u,halfTerms:f}=oi(),{getThemeForClass:h}=Gi(),[d,m]=ve.useState(s),[g,x]=ve.useState(""),[p,v]=ve.useState(!1),[y,w]=ve.useState(s),[B,E]=ve.useState(!1),[_,F]=ve.useState(null),[T,I]=ve.useState(!1),S=h(u.sheet);if(es.useEffect(()=>{const Q=localStorage.getItem(`half-terms-${u.sheet}`);if(Q)try{const H=JSON.parse(Q).find(k=>k.id===r);H&&E(H.isComplete||!1)}catch(K){console.error("Error parsing saved half-terms:",K)}},[r,u.sheet]),!e)return null;const C=l.filter(Q=>{const K=A[Q];if(!K)return!1;const H=f.find(U=>U.id===r);return!(!(H&&H.lessons.includes(Q))||g&&!(Q.includes(g)||K.title&&K.title.toLowerCase().includes(g.toLowerCase())||Object.values(K.grouped).some(P=>P.some(D=>D.activity.toLowerCase().includes(g.toLowerCase())||D.description.toLowerCase().includes(g.toLowerCase())||D.category.toLowerCase().includes(g.toLowerCase())))))}),L=Q=>{m(K=>K.includes(Q)?K.filter(H=>H!==Q):[...K,Q])},R=()=>{o(p?y:d,B),t()},W=()=>{E(!B)},G=(Q,K)=>{const H=y[Q],k=[...y];k.splice(Q,1),k.splice(K,0,H),w(k)},V=()=>{I(!0)},X=Q=>{F(Q)};return c.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:[c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-6xl max-h-[90vh] flex flex-col overflow-hidden",children:[c.jsx("div",{className:"p-6 text-white relative",style:{background:`linear-gradient(135deg, ${a} 0%, ${a}99 100%)`},children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsxs("h2",{className:"text-2xl font-bold mb-1",children:[n," - ",i]}),c.jsx("p",{className:"text-white text-opacity-90",children:p?`${y.length} lessons in this half-term`:"Manage lessons assigned to this half-term"})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsxs("div",{className:"flex items-center space-x-2 bg-white bg-opacity-20 px-3 py-2 rounded-lg",children:[c.jsx("span",{className:"text-sm font-medium",children:"Mark Complete"}),c.jsx("button",{onClick:W,className:`w-6 h-6 rounded-md flex items-center justify-center transition-colors ${B?"bg-green-500 text-white":"bg-white bg-opacity-50 text-transparent"}`,children:B&&c.jsx(No,{className:"h-4 w-4"})})]}),p&&y.length>0&&c.jsxs("button",{onClick:V,className:"px-4 py-2 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-lg transition-colors duration-200 flex items-center space-x-2",title:"Export PDF",children:[c.jsx(Gl,{className:"h-4 w-4"}),c.jsx("span",{className:"text-sm font-medium",children:"Export PDF"})]}),c.jsx("button",{onClick:()=>{p?v(!1):(v(!0),w([...d]))},className:"px-4 py-2 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-lg transition-colors duration-200 flex items-center space-x-2",children:p?c.jsxs(c.Fragment,{children:[c.jsx(Yu,{className:"h-4 w-4"}),c.jsx("span",{children:"View All Lessons"})]}):c.jsxs(c.Fragment,{children:[c.jsx(ns,{className:"h-4 w-4"}),c.jsx("span",{children:"Half-Term View"})]})}),c.jsx("button",{onClick:t,className:"p-2 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-lg transition-colors duration-200",children:c.jsx(Zr,{className:"h-5 w-5"})})]})]})}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[!p&&c.jsx("div",{className:"mb-4",children:c.jsxs("div",{className:"relative",children:[c.jsx(rA,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsx("input",{type:"text",placeholder:"Search lessons...",value:g,onChange:Q=>x(Q.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),p?c.jsx(Fle,{halfTermId:r,halfTermName:n,halfTermColor:a,orderedLessons:y,isComplete:B,onReorderLessons:G,onRemoveLesson:Q=>{const K=y.filter(H=>H!==Q);w(K),m(H=>H.filter(k=>k!==Q))},onViewLessonDetails:X,onPrintHalfTerm:()=>I(!0)}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Pn,{className:"h-5 w-5 text-blue-600"}),c.jsxs("h3",{className:"font-medium text-gray-900",children:["Manage Lessons for ",n]})]}),c.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["View and manage lessons assigned to this half-term. Click lessons to remove them from this half-term.",C.length===0?" No lessons assigned to this half-term yet.":""]})]}),C.length===0?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-gray-400 mb-4",children:c.jsx(Pn,{className:"h-16 w-16 mx-auto"})}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Lessons Assigned"}),c.jsx("p",{className:"text-gray-600",children:g?"No assigned lessons match your search criteria.":"No lessons have been assigned to this half-term yet. Use the Lesson Library to assign lessons to half-terms."}),g&&c.jsx("button",{onClick:()=>x(""),className:"mt-4 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm",children:"Clear Search"})]}):c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:C.map((Q,K)=>{const H=A[Q];if(!H)return null;const k=d.includes(Q);return c.jsxs("div",{className:`bg-white rounded-lg border p-4 cursor-pointer transition-all duration-200 relative ${k?"border-blue-500 bg-blue-50 shadow-md":"border-red-300 bg-red-50 hover:border-red-400"}`,onClick:()=>L(Q),children:[c.jsx("div",{className:"absolute top-2 right-2",children:c.jsx(r$,{className:`h-5 w-5 ${k?"text-blue-500 fill-blue-500":"text-red-400 fill-red-400"}`})}),c.jsxs("div",{className:"pr-6",children:[c.jsxs("h4",{className:"font-semibold text-gray-900 mb-1",children:["Lesson ",K+1]}),c.jsx("p",{className:"text-sm text-gray-600 mb-2",children:H.title||`Lesson ${K+1}`}),c.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500 mb-2",children:[c.jsx(_a,{className:"h-3 w-3"}),c.jsxs("span",{children:[H.totalTime," mins"]})]}),c.jsxs("div",{className:"flex flex-wrap gap-1",children:[H.categoryOrder.slice(0,3).map(U=>c.jsx("span",{className:"px-1.5 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:U},U)),H.categoryOrder.length>3&&c.jsxs("span",{className:"px-1.5 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:["+",H.categoryOrder.length-3]})]}),c.jsx("div",{className:"mt-2 pt-2 border-t border-gray-100",children:c.jsxs("button",{onClick:U=>{U.stopPropagation(),X(Q)},className:"text-xs text-blue-600 hover:text-blue-800 flex items-center space-x-1",children:[c.jsx(Yu,{className:"h-3 w-3"}),c.jsx("span",{children:"View Details"})]})})]})]},Q)})})]})]}),c.jsxs("div",{className:"p-4 border-t border-gray-200 bg-gray-50 flex justify-between items-center",children:[c.jsx("div",{children:c.jsx("span",{className:"text-sm text-gray-600",children:p?`${y.length} lessons in order`:`${d.length} lessons will remain assigned`})}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg transition-colors duration-200",children:"Cancel"}),c.jsxs("button",{onClick:R,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors duration-200 flex items-center space-x-2",children:[c.jsx(ao,{className:"h-4 w-4"}),c.jsxs("span",{children:["Save ",p?"Order":"Changes"]})]})]})]})]}),_&&c.jsx(Dm,{lessonNumber:_,onClose:()=>F(null),theme:S,halfTermId:r,halfTermName:n}),T&&c.jsx(jm,{lessonNumbers:y,onClose:()=>I(!1),halfTermId:r,halfTermName:n,isUnitPrint:!0})]})}const i2=[{id:"A1",name:"Autumn 1",months:"Sep-Oct"},{id:"A2",name:"Autumn 2",months:"Nov-Dec"},{id:"SP1",name:"Spring 1",months:"Jan-Feb"},{id:"SP2",name:"Spring 2",months:"Mar-Apr"},{id:"SM1",name:"Summer 1",months:"Apr-May"},{id:"SM2",name:"Summer 2",months:"Jun-Jul"}],a2={A1:"Autumn 1 (Sep-Oct)",A2:"Autumn 2 (Nov-Dec)",SP1:"Spring 1 (Jan-Feb)",SP2:"Spring 2 (Mar-Apr)",SM1:"Summer 1 (Apr-May)",SM2:"Summer 2 (Jun-Jul)"},$S={A1:"#F59E0B",A2:"#EA580C",SP1:"#10B981",SP2:"#059669",SM1:"#3B82F6",SM2:"#6366F1"};function Tle(){var O,z,J;const{currentSheetInfo:e,allLessonsData:t,halfTerms:r,updateHalfTerm:n,getLessonsForHalfTerm:i}=oi(),{getThemeForClass:a}=Gi(),[s,o]=ve.useState([]),[l,A]=ve.useState(null),[u,f]=ve.useState("");ve.useState("all"),ve.useState("grid");const[h,d]=ve.useState(null),[m,g]=ve.useState(null),[x,p]=ve.useState(null),[v,y]=ve.useState(null),[w,B]=ve.useState(!1),[E,_]=ve.useState(null),[F,T]=ve.useState(!1),[I,S]=ve.useState(null),[C,L]=ve.useState(null),[R,W]=ve.useState(null),[G,V]=ve.useState(null),X=a(e.sheet),Q=Y=>r.some(le=>le.lessons.includes(Y));ve.useEffect(()=>{const Y=localStorage.getItem(`units-${e.sheet}`);if(Y)try{const le=JSON.parse(Y).map(we=>({...we,createdAt:new Date(we.createdAt),updatedAt:new Date(we.updatedAt)}));o(le)}catch(le){console.error("Error parsing saved units:",le),o([])}else o([]),localStorage.setItem(`units-${e.sheet}`,JSON.stringify([]))},[e.sheet]),es.useMemo(()=>{const Y={};return Object.keys(a2).forEach(le=>{Y[le]=[]}),s.forEach(le=>{le.term?(Y[le.term]||(Y[le.term]=[]),Y[le.term].push(le)):(Y.A1||(Y.A1=[]),Y.A1.push(le))}),Y},[s]);const K=()=>{A(null)},H=Y=>{g(Y)},k=Y=>{y(Y),B(!0)},U=Y=>{const le=r.find(we=>we.id===Y);return le&&le.isComplete||!1},P=Y=>{_(Y)},D=Y=>{const le=s.find(we=>we.id===Y);le&&(W(Y),V(le.name),T(!0))};return l?c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-blue-50",children:[c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[c.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden mb-6",children:c.jsx("div",{className:"p-6 text-white relative",style:{background:`linear-gradient(135deg, ${l.color||X.primary} 0%, ${X.secondary} 100%)`},children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[c.jsx("button",{onClick:K,className:"p-2 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-lg transition-colors duration-200",title:"Back to all units",children:c.jsx(gm,{className:"h-5 w-5"})}),c.jsx("h1",{className:"text-2xl font-bold",children:l.name})]}),c.jsxs("div",{className:"flex items-center space-x-4 text-white text-opacity-90",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Ls,{className:"h-5 w-5"}),c.jsxs("span",{className:"font-medium",children:[l.lessonNumbers.length," lessons"]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ns,{className:"h-5 w-5"}),c.jsx("span",{className:"font-medium",children:a2[l.term||"A1"]||"Not assigned"})]})]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsxs("button",{onClick:()=>D(l.id),className:"p-2 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-lg transition-all duration-200 group flex items-center space-x-2",title:"Export Unit to PDF",children:[c.jsx(yy,{className:"h-5 w-5 group-hover:scale-110 transition-transform duration-200"}),c.jsx("span",{className:"text-sm font-medium",children:"Export PDF"})]}),c.jsxs("button",{className:"p-2 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-lg transition-all duration-200 group flex items-center space-x-2",title:"Edit Unit",children:[c.jsx(ki,{className:"h-5 w-5 group-hover:scale-110 transition-transform duration-200"}),c.jsx("span",{className:"text-sm font-medium",children:"Edit Unit"})]})]})]})})}),l.description&&c.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 p-6 mb-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Unit Description"}),c.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:l.description}})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Lessons in this Unit"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.lessonNumbers.map(Y=>{const le=t[Y];return!le||!Q(Y)?null:c.jsxs("div",{className:"relative group",children:[c.jsx(wT,{lessonNumber:Y,lessonData:le,viewMode:"grid",onClick:()=>P(Y),theme:X}),c.jsx("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:c.jsx("button",{onClick:we=>{we.stopPropagation(),H(Y)},className:"p-1.5 bg-white bg-opacity-90 hover:bg-opacity-100 rounded-lg shadow-sm text-gray-700 hover:text-gray-900",title:"Export Lesson",children:c.jsx(yy,{className:"h-4 w-4"})})})]},Y)})})]}),c.jsx("div",{className:"text-center",children:c.jsxs("button",{onClick:K,className:"inline-flex items-center space-x-2 px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-xl transition-colors duration-200 shadow-lg hover:shadow-xl",children:[c.jsx(gm,{className:"h-5 w-5"}),c.jsx("span",{children:"Back to All Units"})]})})]}),h&&c.jsx(Ju,{activity:h,onClose:()=>d(null)}),m&&c.jsx(uw,{lessonNumber:m,onClose:()=>g(null)}),E&&c.jsx(Dm,{lessonNumber:E,onClose:()=>_(null),theme:X,onExport:()=>{g(E),_(null)},unitId:l.id,unitName:l.name}),F&&c.jsx(jm,{lessonNumbers:l.lessonNumbers.filter(Y=>t[Y]&&Q(Y)),onClose:()=>{T(!1),S(null),L(null),W(null),V(null)},unitId:R||l.id,unitName:G||l.name,isUnitPrint:!0})]}):c.jsx(s5,{backend:o5,children:c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-blue-50",children:[c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[c.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden mb-6",children:c.jsx("div",{className:"p-4 border-b border-gray-200 bg-gradient-to-r from-indigo-600 to-purple-600 text-white",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(mm,{className:"h-6 w-6"}),c.jsx("h2",{className:"text-xl font-bold",children:"Half-Term Planner"})]}),c.jsx("div",{className:"flex items-center space-x-3",children:c.jsxs("div",{className:"relative",children:[c.jsx(rA,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-indigo-300"}),c.jsx("input",{type:"text",placeholder:"Search units...",value:u,onChange:Y=>f(Y.target.value),className:"w-64 pl-10 pr-4 py-2 bg-white bg-opacity-20 border border-white border-opacity-30 rounded-lg text-white placeholder-indigo-200 focus:ring-2 focus:ring-white focus:ring-opacity-50 focus:border-transparent",dir:"ltr"})]})})]})})}),x&&c.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4 mb-6 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(Yu,{className:"h-5 w-5 text-indigo-600"}),c.jsxs("div",{children:[c.jsxs("h3",{className:"font-medium text-gray-900",children:["Focused on ",a2[x]]}),c.jsx("p",{className:"text-sm text-gray-600",children:"Showing only units from this half-term"})]})]}),c.jsx("button",{onClick:()=>p(null),className:"px-3 py-1.5 bg-indigo-100 hover:bg-indigo-200 text-indigo-700 rounded-lg text-sm font-medium",children:"Show All Half-Terms"})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:i2.map(Y=>{const le=i(Y.id),we=U(Y.id);return c.jsx(Cle,{id:Y.id,name:Y.name,months:Y.months,color:$S[Y.id],lessonCount:le.length,onClick:()=>k(Y.id),isComplete:we},Y.id)})})]}),h&&c.jsx(Ju,{activity:h,onClose:()=>d(null)}),m&&c.jsx(uw,{lessonNumber:m,onClose:()=>g(null)}),w&&v&&c.jsx(Nle,{isOpen:w,onClose:()=>{B(!1),y(null)},halfTermId:v,halfTermName:((O=i2.find(Y=>Y.id===v))==null?void 0:O.name)||"",halfTermMonths:((z=i2.find(Y=>Y.id===v))==null?void 0:z.months)||"",halfTermColor:$S[v],selectedLessons:i(v),onSave:(Y,le)=>{n(v,Y,le),B(!1),y(null)}}),E&&c.jsx(Dm,{lessonNumber:E,onClose:()=>_(null),theme:X,onExport:()=>{g(E),_(null)}}),F&&c.jsx(jm,{lessonNumbers:R?((J=s.find(Y=>Y.id===R))==null?void 0:J.lessonNumbers.filter(Y=>t[Y]&&Q(Y)))||[]:I?i(I):[],onClose:()=>{T(!1),S(null),L(null),W(null),V(null)},halfTermId:I||void 0,halfTermName:C||void 0,unitId:R||void 0,unitName:G||void 0,isUnitPrint:!!R})]})})}function Lle({activity:e,index:t,onRemove:r,onReorder:n,isEditing:i,onActivityClick:a}){const s=ve.useRef(null),[o,l]=ve.useState(!1),[{handlerId:A},u]=fT({accept:"lesson-activity",collect(p){return{handlerId:p.getHandlerId()}},hover(p,v){var T;if(!s.current)return;const y=p.index,w=t;if(y===w)return;const B=(T=s.current)==null?void 0:T.getBoundingClientRect(),E=(B.bottom-B.top)/2,F=v.getClientOffset().y-B.top;y<w&&F<E||y>w&&F>E||(n(y,w),p.index=w)}}),[{isDragging:f},h]=uT({type:"lesson-activity",item:()=>(l(!0),{index:t}),end:()=>{setTimeout(()=>l(!1),100)},collect:p=>({isDragging:p.isDragging()})}),d=f?.4:1;h(u(s));const m=p=>{if(o){p.preventDefault(),p.stopPropagation();return}p.target.closest("button")||(p.stopPropagation(),a(e))},x={Welcome:"#F59E0B","Kodaly Songs":"#8B5CF6","Kodaly Action Songs":"#F97316","Action/Games Songs":"#F97316","Rhythm Sticks":"#D97706","Scarf Songs":"#10B981","General Game":"#3B82F6","Core Songs":"#84CC16","Parachute Games":"#EF4444","Percussion Games":"#06B6D4","Teaching Units":"#6366F1",Goodbye:"#14B8A6"}[e.category]||"#6B7280";return c.jsx("div",{ref:s,style:{opacity:d},"data-handler-id":A,className:"bg-white rounded-lg border-2 border-gray-200 p-4 transition-all duration-200 hover:shadow-md group cursor-pointer",onClick:m,children:c.jsxs("div",{className:"flex items-start space-x-3",children:[i&&c.jsx("div",{className:"flex flex-col space-y-1 pt-1",children:c.jsx("div",{className:"cursor-move text-gray-400 hover:text-gray-600",children:c.jsx(bh,{className:"h-5 w-5"})})}),c.jsx("div",{className:"w-1 h-full rounded-full flex-shrink-0",style:{backgroundColor:x,minHeight:"60px"}}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-start justify-between mb-2",children:[c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("h4",{className:"font-semibold text-gray-900 text-base leading-tight",children:e.activity}),c.jsxs("div",{className:"flex items-center space-x-3 mt-1",children:[c.jsx("span",{className:"text-sm text-gray-600",children:e.category}),e.level&&c.jsx("span",{className:"px-2 py-1 text-white text-xs font-medium rounded-full",style:{backgroundColor:x},children:e.level})]})]}),c.jsxs("div",{className:"flex items-center space-x-2 ml-3",children:[e.time>0&&c.jsxs("div",{className:"flex items-center space-x-1 text-gray-500",children:[c.jsx(_a,{className:"h-4 w-4"}),c.jsxs("span",{className:"text-sm font-medium",children:[e.time,"m"]})]}),i&&c.jsx("button",{onClick:p=>{p.stopPropagation(),r()},className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors duration-200 opacity-0 group-hover:opacity-100",title:"Remove Activity",children:c.jsx(_i,{className:"h-4 w-4"})})]})]}),e.description&&c.jsx("div",{className:"text-sm text-gray-600 leading-relaxed line-clamp-2",dangerouslySetInnerHTML:{__html:e.description}})]})]})})}function Ile({lessonPlan:e,onActivityAdd:t,onActivityRemove:r,onActivityReorder:n,onNotesUpdate:i,onLessonPlanFieldUpdate:a,isEditing:s,onSave:o}){const{updateActivity:l,deleteActivity:A}=oi(),[u,f]=ve.useState(null),[h,d]=ve.useState(null),[m,g]=ve.useState(null),[{isOver:x},p]=fT(()=>({accept:"activity",drop:B=>{t(B.activity)},collect:B=>({isOver:B.isOver()})})),v=(B,E)=>{f(B),g(E||null)},y=async B=>{try{B.level==="EYFS U"&&(B.level="UKG"),await l(B),d(null),f(null)}catch(E){console.error("Failed to update activity:",E),alert("Failed to update activity. Please try again.")}},w=()=>{if(u){const B={...u};B.level==="EYFS U"&&(B.level="UKG"),d(B)}};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:[c.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-green-600 to-emerald-600 text-white",children:c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("input",{type:"text",value:e.title||"",onChange:B=>a("title",B.target.value),placeholder:"Lesson Name",className:"w-full text-2xl font-bold text-white border-b border-white border-opacity-30 focus:border-opacity-100 focus:outline-none bg-transparent placeholder-green-100"}),c.jsxs("div",{className:"flex items-center flex-wrap gap-3 mt-2",children:[c.jsx("div",{className:"flex items-center space-x-2 text-green-100",children:c.jsx("span",{children:e.className})}),c.jsxs("div",{className:"flex items-center space-x-2 text-green-100",children:[c.jsx(_a,{className:"h-4 w-4"}),c.jsxs("span",{children:[e.duration," minutes"]})]}),c.jsxs("div",{className:"flex items-center space-x-2 text-green-100",children:[c.jsx(ym,{className:"h-4 w-4"}),c.jsxs("span",{children:[e.activities.length," activities"]})]})]})]}),o&&c.jsxs("button",{onClick:o,className:"px-4 py-2 bg-white bg-opacity-20 hover:bg-opacity-30 text-white text-sm font-medium rounded-lg transition-colors duration-200 flex items-center space-x-2 shadow-sm hover:shadow-md ml-4",children:[c.jsx(ao,{className:"h-4 w-4"}),c.jsx("span",{children:"Save Lesson"})]})]})}),c.jsx("div",{ref:p,className:`p-6 min-h-[400px] transition-colors duration-200 ${x?"bg-blue-50 border-blue-300":""}`,children:e.activities.length===0?c.jsxs("div",{className:"text-center py-16",children:[c.jsx("div",{className:`mx-auto w-24 h-24 rounded-full flex items-center justify-center mb-4 transition-colors duration-200 ${x?"bg-blue-200":"bg-gray-100"}`,children:c.jsx(ka,{className:`h-12 w-12 transition-colors duration-200 ${x?"text-blue-600":"text-gray-400"}`})}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:x?"Drop activity here":"No activities planned"}),c.jsx("p",{className:"text-gray-600",children:x?"Release to add this activity to your lesson plan":"Drag activities from the library to build your lesson plan"})]}):c.jsxs("div",{className:"space-y-4",children:[e.activities.map((B,E)=>c.jsx(Lle,{activity:B,index:E,onRemove:()=>r(E),onReorder:n,isEditing:s,onActivityClick:v},`${B.activity}-${E}`)),s&&c.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors duration-200 ${x?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,children:[c.jsx(ka,{className:`h-8 w-8 mx-auto mb-2 transition-colors duration-200 ${x?"text-blue-600":"text-gray-400"}`}),c.jsx("p",{className:`font-medium transition-colors duration-200 ${x?"text-blue-600":"text-gray-600"}`,children:x?"Drop to add activity":"Drag more activities here"})]})]})}),c.jsxs("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[c.jsx(Is,{className:"h-5 w-5 text-gray-600"}),c.jsx("h3",{className:"font-medium text-gray-900",children:"Lesson Notes"})]}),s?c.jsx("textarea",{value:e.notes,onChange:B=>i(B.target.value),className:"w-full h-24 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 resize-none",placeholder:"Add notes about this lesson plan..."}):c.jsx("div",{className:"text-gray-700",children:e.notes?c.jsx("p",{className:"whitespace-pre-wrap",children:e.notes}):c.jsx("p",{className:"text-gray-500 italic",children:"No notes added yet"})})]})]}),u&&c.jsx(Ju,{activity:u,onClose:()=>{f(null),d(null),g(null)},onAddToLesson:void 0,isEditing:h!==null&&u===h,onUpdate:y,onEdit:w,initialResource:m,onDelete:A})]})}function Ule({editingLessonNumber:e,onEditComplete:t}={}){const{currentSheetInfo:r,allLessonsData:n,addOrUpdateUserLessonPlan:i,userCreatedLessonPlans:a,allActivities:s}=oi(),{categories:o}=Gi(),[l,A]=ve.useState(()=>{if(e&&n[e]){const D=n[e],O=Object.values(D.grouped).flat().map(z=>({...z,_uniqueId:Date.now()+Math.random().toString(36).substring(2,9)}));return{id:crypto.randomUUID(),date:new Date,week:parseInt(e),className:r.sheet,activities:O,duration:D.totalTime,notes:"",status:"draft",title:D.title||`Lesson ${e}`,term:"",lessonNumber:e,createdAt:new Date,updatedAt:new Date,isEditingExisting:!0}}return{id:crypto.randomUUID(),date:new Date,week:1,className:r.sheet,activities:[],duration:0,notes:"",status:"draft",title:"",term:"",createdAt:new Date,updatedAt:new Date}}),[u,f]=ve.useState(""),[h,d]=ve.useState("all"),[m,g]=ve.useState("all"),[x,p]=ve.useState("category"),[v,y]=ve.useState("asc");ve.useState("grid");const[w,B]=ve.useState(null),[E,_]=ve.useState([]),[F,T]=ve.useState("idle");ve.useState(0);const[I,S]=ve.useState(!1),[C,L]=ve.useState("");ve.useEffect(()=>{e||R()},[n,r.sheet,e]);const R=()=>{const D=Object.keys(n).map(z=>parseInt(z));if(D.length===0){L("1");return}const O=Math.max(...D);L((O+1).toString()),A(z=>({...z,lessonNumber:(O+1).toString()}))},W=D=>{try{return D.title.trim()?(D.lessonNumber||(D.lessonNumber=C),i(D),A(D),T("success"),S(!1),setTimeout(()=>T("idle"),3e3),!0):(alert("Please provide a lesson title"),T("error"),setTimeout(()=>T("idle"),3e3),!1)}catch(O){return console.error("Failed to update lesson plan:",O),T("error"),setTimeout(()=>T("idle"),3e3),!1}},G=D=>{const z={...JSON.parse(JSON.stringify(D)),_uniqueId:Date.now()+Math.random().toString(36).substring(2,9)},J={...l,activities:[...l.activities,z],duration:l.duration+(z.time||0)};A(J),S(!0)},V=D=>{const O=l.activities[D],z={...l,activities:l.activities.filter((J,Y)=>Y!==D),duration:l.duration-(O.time||0)};A(z),S(!0)},X=(D,O)=>{const z=l.activities[D],J=[...l.activities];J.splice(D,1),J.splice(O,0,z);const Y={...l,activities:J};A(Y),S(!0)},Q=(D,O)=>{const z={...l,[D]:O};A(z),S(!0)},K=()=>{if(l.lessonNumber)W(l)&&(S(!1),l.isEditingExisting&&t&&t());else{const D={...l,lessonNumber:C};A(D),W(D)&&(S(!1),l.isEditingExisting&&t&&t())}},H=()=>{const D={...l,lessonNumber:l.lessonNumber||C};if(W(D)){const z=(parseInt(C)+1).toString();L(z);const J={id:crypto.randomUUID(),date:new Date,week:l.week+1,className:r.sheet,activities:[],duration:0,notes:"",status:"draft",title:"",term:"",lessonNumber:z,createdAt:new Date,updatedAt:new Date};A(J),S(!1),t&&t()}},k=es.useMemo(()=>{let D=s.filter(O=>{const z=O.activity.toLowerCase().includes(u.toLowerCase())||O.description.toLowerCase().includes(u.toLowerCase()),J=h==="all"||O.category===h,Y=m==="all"||O.level===m||O.level==="All";return z&&J&&Y});return D.sort((O,z)=>{let J=0;switch(x){case"name":J=O.activity.localeCompare(z.activity);break;case"category":J=O.category.localeCompare(z.category);break;case"time":J=O.time-z.time;break;case"level":J=O.level.localeCompare(z.level);break}return v==="asc"?J:-J}),D},[s,u,h,m,x,v]),U=D=>{E.includes(D)?_(O=>O.filter(z=>z!==D)):_(O=>[...O,D])},P=()=>{const D=s.filter(Y=>{const le=`${Y.activity}-${Y.category}`;return E.includes(le)});if(D.length===0)return;const O=D.map(Y=>({...JSON.parse(JSON.stringify(Y)),_uniqueId:Date.now()+Math.random().toString(36).substring(2,9)})),z=O.reduce((Y,le)=>Y+(le.time||0),0),J={...l,activities:[...l.activities,...O],duration:l.duration+z};A(J),S(!0),_([])};return c.jsxs(s5,{backend:o5,children:[c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-blue-50",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[l.isEditingExisting&&c.jsx("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(ki,{className:"h-5 w-5 text-blue-600"}),c.jsxs("div",{children:[c.jsxs("h3",{className:"font-medium text-blue-900",children:["Editing: ",l.title]}),c.jsx("p",{className:"text-sm text-blue-700",children:"Make changes to activities and lesson details"})]})]}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsx("button",{onClick:K,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200",children:"Save Changes"}),c.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-700 font-medium rounded-lg transition-colors duration-200",children:"Cancel"})]})]})}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsx("div",{className:"lg:col-span-2",children:c.jsx(Ile,{lessonPlan:l,onActivityAdd:G,onActivityRemove:V,onActivityReorder:X,onLessonPlanFieldUpdate:Q,isEditing:!0,onActivityClick:D=>B(D),onSave:K,onSaveAndCreate:H})}),c.jsx("div",{className:"lg:col-span-1",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden sticky top-8",children:[c.jsxs("div",{className:"p-4 border-b border-gray-200 bg-gradient-to-r from-indigo-500 to-blue-500 text-white",children:[c.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Activity Library"}),c.jsxs("div",{className:"relative mb-3",children:[c.jsx(rA,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-blue-300"}),c.jsx("input",{type:"text",placeholder:"Search activities...",value:u,onChange:D=>f(D.target.value),className:"w-full pl-10 pr-4 py-2 bg-white bg-opacity-20 border border-white border-opacity-30 rounded-lg text-white placeholder-blue-200 focus:ring-2 focus:ring-white focus:ring-opacity-50 focus:border-transparent text-sm"})]}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsxs("select",{value:h,onChange:D=>d(D.target.value),className:"w-full flex-1 px-3 py-1.5 bg-white bg-opacity-20 border border-white border-opacity-30 rounded-lg text-white focus:ring-2 focus:ring-white focus:ring-opacity-50 focus:border-transparent text-sm truncate",children:[c.jsx("option",{value:"all",className:"text-gray-900",children:"All Categories"}),o.map(D=>c.jsx("option",{value:D.name,className:"text-gray-900",children:D.name},D.name))]}),c.jsxs("select",{value:m,onChange:D=>g(D.target.value),className:"w-full flex-1 px-3 py-1.5 bg-white bg-opacity-20 border border-white border-opacity-30 rounded-lg text-white focus:ring-2 focus:ring-white focus:ring-opacity-50 focus:border-transparent text-sm truncate",children:[c.jsx("option",{value:"all",className:"text-gray-900",children:"All"}),c.jsx("option",{value:"LKG",className:"text-gray-900",children:"LKG"}),c.jsx("option",{value:"UKG",className:"text-gray-900",children:"UKG"}),c.jsx("option",{value:"Reception",className:"text-gray-900",children:"Reception"})]})]}),E.length>0&&c.jsx("div",{className:"mt-3",children:c.jsxs("button",{onClick:P,className:"w-full px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors duration-200 flex items-center justify-center space-x-2",children:[c.jsx(ka,{className:"h-4 w-4"}),c.jsxs("span",{children:["Add ",E.length," Selected ",E.length===1?"Activity":"Activities"]})]})})]}),c.jsx("div",{className:"p-3 max-h-[600px] overflow-y-auto",children:k.length===0?c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-gray-500",children:"No matching activities found"})}):c.jsx("div",{className:"space-y-2",children:k.map((D,O)=>{var Y;const z=`${D.activity}-${D.category}`,J=E.includes(z);return c.jsxs("div",{className:`relative bg-white rounded-lg border-2 p-3 transition-all duration-200 hover:shadow-md ${J?"border-blue-500 bg-blue-50":"border-gray-200"}`,onClick:()=>U(z),children:[c.jsx("div",{className:"absolute top-3 right-3 z-10",children:c.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center ${J?"bg-blue-600":"border-2 border-gray-300"}`,children:J&&c.jsx(Ea,{className:"h-3 w-3 text-white"})})}),c.jsx("div",{className:"pr-6",children:c.jsxs("div",{className:"flex items-start",children:[c.jsx("div",{className:"w-1 h-full rounded-full flex-shrink-0 mr-2",style:{backgroundColor:D.category&&((Y=o.find(le=>le.name===D.category))==null?void 0:Y.color)||"#6B7280",minHeight:"40px"}}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:D.activity}),c.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[c.jsx("span",{className:"text-xs text-gray-500",children:D.category}),D.level&&c.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full",children:D.level}),D.time>0&&c.jsxs("span",{className:"text-xs text-gray-500 flex items-center",children:[c.jsx(_a,{className:"h-3 w-3 mr-1"}),D.time,"m"]})]}),D.description&&c.jsx("div",{className:"text-xs text-gray-600 mt-1 line-clamp-2",dangerouslySetInnerHTML:{__html:D.description.length>100?D.description.substring(0,100)+"...":D.description}})]})]})})]},`${D._id||D.id||z}-${O}`)})})})]})})]})]})}),w&&c.jsx(Ju,{activity:w,onClose:()=>B(null),onAddToLesson:()=>{G(w),B(null)}}),F!=="idle"&&c.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 pointer-events-none",children:c.jsx("div",{className:`max-w-md w-full mx-auto px-6 py-4 rounded-lg shadow-xl transition-all duration-300 transform ${F==="success"?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:c.jsx("div",{className:"flex items-center space-x-3",children:F==="success"?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:c.jsx(Ea,{className:"h-6 w-6 text-green-600"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-medium text-green-800",children:"Lesson saved successfully!"}),c.jsx("p",{className:"text-sm text-green-600",children:"Your lesson plan has been saved."})]})]}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:c.jsx(DA,{className:"h-6 w-6 text-red-600"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-medium text-red-800",children:"Failed to save lesson"}),c.jsx("p",{className:"text-sm text-red-600",children:"Please provide a lesson title."})]})]})})})})]})}const hh=150;function Ole({activity:e,onUpdate:t,onDelete:r,onDuplicate:n,isEditing:i=!1,onEditToggle:a,categoryColor:s,viewMode:o="detailed",onResourceClick:l,onActivityClick:A,draggable:u=!1}){const{getCategoryColor:f}=Gi(),[h,d]=ve.useState(e),[m,g]=ve.useState(!1),[x,p]=ve.useState(!1),[{isDragging:v},y]=uT(()=>({type:"activity",item:{activity:e},collect:C=>({isDragging:!!C.isDragging()}),canDrag:()=>u}),[e,u]);ve.useEffect(()=>{d(e)},[e]);const w=()=>{t&&t(h),a&&a()},B=()=>{d(e),a&&a()},E=C=>C?C.includes("<")?C:C.replace(/\n/g,"<br>"):"",_=e.description&&(e.description.length>hh||e.description.includes(`
`)||e.description.includes("<br>")||e.description.includes("<li>")),F=()=>{if(!e.description)return"";if(e.description.includes("<")){const C=document.createElement("div");C.innerHTML=e.description;const L=C.textContent||C.innerText||"";return L.substring(0,hh)+(L.length>hh?"...":"")}return e.description.substring(0,hh)+(e.description.length>hh?"...":"")},T=[{label:"Video",url:e.videoLink,icon:Gd,color:"text-red-600 bg-red-50 border-red-200",type:"video"},{label:"Music",url:e.musicLink,icon:Kd,color:"text-green-600 bg-green-50 border-green-200",type:"music"},{label:"Backing",url:e.backingLink,icon:eo,color:"text-blue-600 bg-blue-50 border-blue-200",type:"backing"},{label:"Resource",url:e.resourceLink,icon:Is,color:"text-purple-600 bg-purple-50 border-purple-200",type:"resource"},{label:"Link",url:e.link,icon:Hd,color:"text-gray-600 bg-gray-50 border-gray-200",type:"link"},{label:"Vocals",url:e.vocalsLink,icon:eo,color:"text-orange-600 bg-orange-50 border-orange-200",type:"vocals"},{label:"Image",url:e.imageLink,icon:Md,color:"text-pink-600 bg-pink-50 border-pink-200",type:"image"}].filter(C=>C.url&&C.url.trim()),I=f(e.category)||s||"#6B7280",S=C=>{C.target.closest("button")||C.target.closest("a")||(A?A(e):_&&p(!x))};return o==="minimal"?c.jsx("div",{ref:u?y:void 0,className:`bg-white rounded-lg shadow-sm border-l-4 p-3 transition-all duration-200 hover:shadow-md ${u?"cursor-move":"cursor-pointer"} h-full ${v?"opacity-50":""}`,style:{borderLeftColor:I},onClick:S,children:c.jsxs("div",{className:"flex items-center justify-between h-full",children:[c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("h4",{className:"font-medium text-gray-900 text-sm truncate",dir:"ltr",children:e.activity}),c.jsx("p",{className:"text-xs text-gray-500",dir:"ltr",children:e.category})]}),e.time>0&&c.jsxs("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full ml-2",children:[e.time,"m"]})]})}):o==="compact"?c.jsx("div",{ref:u?y:void 0,className:`bg-white rounded-xl shadow-lg border-2 transition-all duration-300 hover:shadow-xl ${u?"cursor-move":"cursor-pointer"} ${i?"ring-4 ring-blue-300":"border-gray-200 hover:border-gray-300"} ${v?"opacity-50":""} h-full flex flex-col`,style:{borderLeftColor:I,borderLeftWidth:"6px"},onClick:S,children:c.jsxs("div",{className:"p-4 flex flex-col flex-grow",children:[c.jsxs("div",{className:"flex items-start justify-between mb-2",children:[c.jsx("h4",{className:"font-semibold text-gray-900 text-base leading-tight",dir:"ltr",children:e.activity}),c.jsx("div",{className:"flex items-center space-x-1 ml-2",children:e.time>0&&c.jsxs("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:[e.time,"m"]})})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-2",dir:"ltr",children:e.category}),e.level&&c.jsx("span",{className:"inline-block px-2 py-1 text-white text-xs font-medium rounded-full",style:{backgroundColor:I},children:e.level}),c.jsx("div",{className:"mt-auto",children:T.length>0&&c.jsxs("div",{className:"flex items-center space-x-1 mt-2",children:[T.slice(0,3).map((C,L)=>{const R=C.icon;return c.jsx("button",{onClick:W=>{W.stopPropagation(),l&&l(C.url,`${e.activity} - ${C.label}`,C.type)},className:"w-6 h-6 bg-gray-100 rounded-full flex items-center justify-center hover:bg-gray-200 transition-colors",children:c.jsx(R,{className:"h-3 w-3 text-gray-600"})},L)}),T.length>3&&c.jsxs("span",{className:"text-xs text-gray-500",children:["+",T.length-3]})]})})]})}):c.jsxs("div",{ref:u?y:void 0,className:`bg-white rounded-xl shadow-lg border-2 transition-all duration-300 hover:shadow-xl ${u?"cursor-move":"cursor-pointer"} overflow-hidden ${i?"ring-4 ring-blue-300":"border-gray-200 hover:border-gray-300"} ${v?"opacity-50":""} h-full flex flex-col`,style:{borderLeftColor:I,borderLeftWidth:"6px"},onClick:S,children:[c.jsxs("div",{className:"p-4 text-white relative overflow-hidden",style:{background:`linear-gradient(135deg, ${I} 0%, ${I}CC 100%)`},children:[c.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white bg-opacity-10 rounded-full -translate-y-10 translate-x-10"}),c.jsx("div",{className:"relative z-10",children:c.jsxs("div",{className:"flex items-start justify-between mb-3",children:[c.jsxs("div",{className:"flex-1 min-w-0",children:[i?c.jsx("input",{type:"text",value:h.activity,onChange:C=>d(L=>({...L,activity:C.target.value})),className:"w-full bg-white bg-opacity-20 text-white placeholder-white placeholder-opacity-70 border border-white border-opacity-30 rounded-lg px-3 py-2 text-lg font-bold",placeholder:"Activity name",onClick:C=>C.stopPropagation(),dir:"ltr"}):c.jsx("h3",{className:"text-lg font-bold leading-tight",dir:"ltr",children:e.activity}),c.jsxs("div",{className:"flex items-center space-x-3 mt-2",children:[c.jsx("span",{className:"text-sm opacity-90",dir:"ltr",children:e.category}),e.level&&c.jsx("span",{className:"px-2 py-1 bg-white bg-opacity-20 text-xs font-medium rounded-full",children:e.level})]})]}),c.jsx("div",{className:"flex items-center space-x-2 ml-3",children:e.time>0&&c.jsxs("div",{className:"flex items-center space-x-1 bg-white bg-opacity-20 px-2 py-1 rounded-full",children:[c.jsx(_a,{className:"h-4 w-4"}),c.jsxs("span",{className:"text-sm font-medium",children:[e.time,"m"]})]})})]})})]}),c.jsxs("div",{className:"p-4 flex-grow flex flex-col",children:[c.jsx("div",{className:"mb-4 flex-grow",children:i?c.jsx("div",{onClick:C=>C.stopPropagation(),children:c.jsx(Vd,{value:h.description,onChange:C=>d(L=>({...L,description:C})),placeholder:"Enter activity description...",minHeight:"100px"})}):c.jsx(c.Fragment,{children:_&&!x?c.jsxs("div",{children:[c.jsx("div",{className:"text-gray-700 leading-relaxed line-clamp-3",dir:"ltr",children:F()}),c.jsxs("button",{onClick:C=>{C.stopPropagation(),p(!0)},className:"mt-2 text-blue-600 hover:text-blue-800 text-sm flex items-center space-x-1",children:[c.jsx(f0,{className:"h-4 w-4"}),c.jsx("span",{children:"Show more"})]})]}):c.jsxs("div",{children:[c.jsx("div",{className:"text-gray-700 leading-relaxed prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:E(e.description)},dir:"ltr"}),_&&x&&c.jsxs("button",{onClick:C=>{C.stopPropagation(),p(!1)},className:"mt-2 text-blue-600 hover:text-blue-800 text-sm flex items-center space-x-1",children:[c.jsx(h0,{className:"h-4 w-4"}),c.jsx("span",{children:"Show less"})]})]})})}),(e.unitName||i)&&c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Unit"}),i?c.jsx("input",{type:"text",value:h.unitName,onChange:C=>d(L=>({...L,unitName:C.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Unit name",onClick:C=>C.stopPropagation(),dir:"ltr"}):c.jsx("p",{className:"text-sm text-gray-700 font-medium",dir:"ltr",children:e.unitName})]}),e.eyfsStandards&&e.eyfsStandards.length>0&&c.jsxs("div",{className:"mb-4",children:[c.jsxs("label",{className:"block text-xs font-medium text-gray-500 uppercase tracking-wide mb-1 flex items-center space-x-1",children:[c.jsx(Pn,{className:"h-3 w-3"}),c.jsx("span",{children:"EYFS"})]}),c.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.eyfsStandards.slice(0,2).map((C,L)=>c.jsx("span",{className:"inline-block px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",dir:"ltr",children:C.split(":")[1]||C},L)),e.eyfsStandards.length>2&&c.jsxs("span",{className:"inline-block px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded-full",children:["+",e.eyfsStandards.length-2," more"]})]})]}),(m||i||T.length>0)&&c.jsxs("div",{className:"space-y-3 mt-auto",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Resources"}),!i&&T.length>0&&c.jsx("button",{onClick:C=>{C.stopPropagation(),g(!m)},className:"text-xs text-blue-600 hover:text-blue-800",children:m?"Hide":"Show"})]}),i?c.jsx("div",{className:"space-y-3",onClick:C=>C.stopPropagation(),children:[{key:"videoLink",label:"Video",icon:Gd},{key:"musicLink",label:"Music",icon:Kd},{key:"backingLink",label:"Backing",icon:eo},{key:"resourceLink",label:"Resource",icon:Is},{key:"link",label:"Link",icon:Hd},{key:"vocalsLink",label:"Vocals",icon:eo},{key:"imageLink",label:"Image",icon:Md}].map(({key:C,label:L,icon:R})=>c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(R,{className:"h-4 w-4 text-gray-500 flex-shrink-0"}),c.jsx("input",{type:"url",value:h[C],onChange:W=>d(G=>({...G,[C]:W.target.value})),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:`${L} URL`,dir:"ltr"})]},C))}):m&&c.jsx("div",{className:"grid grid-cols-2 gap-2",children:T.map((C,L)=>{const R=C.icon;return c.jsxs("button",{onClick:W=>{W.stopPropagation(),l&&l(C.url,`${e.activity} - ${C.label}`,C.type)},className:`flex items-center space-x-2 p-2 rounded-lg border transition-all duration-200 hover:scale-105 hover:shadow-sm ${C.color}`,children:[c.jsx(R,{className:"h-4 w-4 flex-shrink-0"}),c.jsx("span",{className:"text-sm font-medium truncate",dir:"ltr",children:C.label}),c.jsx(ko,{className:"h-3 w-3 flex-shrink-0 opacity-60"})]},L)})})]}),i&&a&&c.jsxs("div",{className:"flex justify-end space-x-2 mt-4 pt-4 border-t border-gray-200",onClick:C=>C.stopPropagation(),children:[c.jsx("button",{onClick:C=>{C.stopPropagation(),B()},className:"px-4 py-2 text-gray-600 hover:text-gray-800 font-medium rounded-lg transition-colors duration-200",children:"Cancel"}),c.jsxs("button",{onClick:C=>{C.stopPropagation(),w()},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200 flex items-center space-x-2",children:[c.jsx(ao,{className:"h-4 w-4"}),c.jsx("span",{children:"Save"})]})]})]})]})}function jle({onImport:e,onClose:t}){const[r,n]=ve.useState("idle"),[i,a]=ve.useState(""),[s,o]=ve.useState([]),[l,A]=ve.useState([]),u=ve.useRef(null),f=async p=>{var y,w;const v=(y=p.target.files)==null?void 0:y[0];if(v)try{n("processing"),a("Processing file...");const B=(w=v.name.split(".").pop())==null?void 0:w.toLowerCase();if(!["xlsx","xls","csv"].includes(B||""))throw new Error("Invalid file type. Please upload an Excel (.xlsx, .xls) or CSV file.");const E=await h(v);if(!E||E.length===0)throw new Error("No data found in the file.");console.log("Raw imported data:",E);const _=d(E);if(_.length===0)throw new Error("No valid activities found in the file. Please check the format.");console.log("Transformed activities:",_),o(_),A(_.slice(0,5)),n("success"),a(`Successfully imported ${_.length} activities.`)}catch(B){console.error("Import error:",B),n("error"),a(B instanceof Error?B.message:"Failed to import file.")}},h=p=>new Promise((v,y)=>{const w=new FileReader;w.onload=B=>{var E;try{const _=(E=B.target)==null?void 0:E.result;if(!_){y(new Error("Failed to read file."));return}const F=dm(_,{type:"binary"}),T=F.SheetNames[0],I=F.Sheets[T],S=pl.sheet_to_json(I,{header:1});v(S)}catch(_){y(_)}},w.onerror=()=>{y(new Error("Error reading file."))},w.readAsBinaryString(p)}),d=p=>{if(p.length<2)throw new Error("File must contain at least a header row and one data row.");const v=p[0].map(Q=>String(Q).trim());console.log("Headers found:",v);const w=["Category","Activity Name"].filter(Q=>!v.some(K=>K.toLowerCase()===Q.toLowerCase()));if(w.length>0)throw new Error(`Missing required headers: ${w.join(", ")}`);const B=Q=>v.findIndex(H=>String(H).toLowerCase()===Q.toLowerCase()||String(H).toLowerCase().includes(Q.toLowerCase())),E=B("Lesson Number"),_=B("Category"),F=B("Activity Name"),T=B("Description"),I=B("Level"),S=B("Time"),C=B("Video"),L=B("Music"),R=B("Backing"),W=B("Resource"),G=B("Unit Name");console.log("Column indices:",{lessonNumber:E,category:_,activityName:F,description:T,level:I,time:S,video:C,music:L,backing:R,resource:W,unitName:G});const V=[];let X="";for(let Q=1;Q<p.length;Q++){const K=p[Q];if(!K||K.length===0||!K[_]||!K[F])continue;K[E]&&(X=String(K[E]).trim());let H=0;if(K[S]){const P=String(K[S]).trim(),D=parseInt(P);!isNaN(D)&&D>=0&&(H=D)}let k=String(K[T]||"").trim();k&&!k.includes("<")&&(k=k.replace(/\n/g,"<br>"));const U={id:`imported-${Date.now()}-${Q}`,activity:String(K[F]||"").trim(),description:k,time:H,videoLink:String(K[C]||"").trim(),musicLink:String(K[L]||"").trim(),backingLink:String(K[R]||"").trim(),resourceLink:String(K[W]||"").trim(),link:"",vocalsLink:"",imageLink:"",teachingUnit:String(K[_]||"").trim(),category:String(K[_]||"").trim(),level:String(K[I]||"").trim(),unitName:String(K[G]||"").trim(),lessonNumber:X||"1"};V.push(U)}return V},m=()=>{e(s),t()},g=()=>{const p=pl.book_new(),y=[["Category","Activity Name","Description","Level","Time (Mins)","Video","Music","Backing","Resource","Unit Name"],["Welcome","Hello Song",`A welcoming song to start the lesson
With multiple lines
And more details`,"All","3","https://example.com/video","https://example.com/music","","",""],["Rhythm","Clapping Game",`Students clap along to the beat
• First clap slowly
• Then speed up
• Finally, add a pattern`,"EYFS","5","","https://example.com/music2","","","Rhythm Unit"],["Singing","Echo Song",`Teacher sings a line, students repeat
1. Start with simple phrases
2. Increase complexity
3. Add movements`,"All","4","","","","",""]],w=pl.aoa_to_sheet(y);pl.book_append_sheet(p,w,"Activities"),L_(p,"activity_template.xlsx")},x=async()=>{try{n("processing"),a("Exporting activities...");const p=await Au.getAll(),v=pl.book_new(),w=[["Lesson Number","Category","Activity Name","Description","Level","Time (Mins)","Video","Music","Backing","Resource","Unit Name"]];p.forEach(E=>{w.push([E.lessonNumber||"",E.category||"",E.activity||"",E.description.replace(/<br\s*\/?>/g,`
`).replace(/<[^>]*>/g,"")||"",E.level||"",E.time.toString()||"0",E.videoLink||"",E.musicLink||"",E.backingLink||"",E.resourceLink||"",E.unitName||""])});const B=pl.aoa_to_sheet(w);pl.book_append_sheet(v,B,"Activities"),L_(v,"activities_export.xlsx"),n("success"),a("Activities exported successfully."),setTimeout(()=>n("idle"),3e3)}catch(p){console.error("Export failed:",p),n("error"),a("Failed to export activities."),setTimeout(()=>n("idle"),3e3)}};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 bg-gradient-to-r from-purple-600 to-indigo-600 text-white",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(Vl,{className:"h-6 w-6"}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold",children:"Import/Export Activities"}),c.jsx("p",{className:"text-purple-100 text-sm",children:"Upload an Excel file with your activity data or export existing activities"})]})]}),c.jsx("button",{onClick:t,className:"p-2 text-purple-100 hover:text-white hover:bg-purple-700 rounded-lg transition-colors duration-200",children:c.jsx(Zr,{className:"h-6 w-6"})})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[c.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6",children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[c.jsx(Gl,{className:"h-6 w-6 text-green-600"}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Export Activities"})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Export all activities to an Excel file for backup or sharing."}),c.jsx("button",{onClick:x,className:"w-full bg-green-600 hover:bg-green-700 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center space-x-2",disabled:r==="processing",children:r==="processing"&&i.includes("Exporting")?c.jsxs(c.Fragment,{children:[c.jsx(Tl,{className:"h-5 w-5 animate-spin"}),c.jsx("span",{children:"Exporting Activities..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(Gl,{className:"h-5 w-5"}),c.jsx("span",{children:"Export All Activities"})]})})]}),c.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"How to Import Activities"}),c.jsxs("ol",{className:"space-y-3 text-gray-700",children:[c.jsxs("li",{className:"flex items-start space-x-2",children:[c.jsx("span",{className:"bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:"1"}),c.jsx("span",{children:"Prepare an Excel file (.xlsx, .xls) or CSV file with your activity data"})]}),c.jsxs("li",{className:"flex items-start space-x-2",children:[c.jsx("span",{className:"bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:"2"}),c.jsxs("span",{children:["Ensure your file has the required columns: ",c.jsx("span",{className:"font-medium",children:"Category"})," and ",c.jsx("span",{className:"font-medium",children:"Activity Name"})]})]}),c.jsxs("li",{className:"flex items-start space-x-2",children:[c.jsx("span",{className:"bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:"3"}),c.jsx("span",{children:"For descriptions, use line breaks to format text. You can also use bullet points and numbered lists."})]}),c.jsxs("li",{className:"flex items-start space-x-2",children:[c.jsx("span",{className:"bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center flex-shrink-0 mt-0.5",children:"4"}),c.jsx("span",{children:'Click the "Choose File" button below and select your file'})]})]}),c.jsx("div",{className:"mt-4 flex justify-end",children:c.jsxs("button",{onClick:g,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors duration-200 text-sm",children:[c.jsx(Gl,{className:"h-4 w-4"}),c.jsx("span",{children:"Download Template"})]})})]}),c.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-6",children:[c.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[c.jsx(Is,{className:"h-6 w-6 text-gray-600"}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Upload File"})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("input",{ref:u,type:"file",accept:".xlsx,.xls,.csv",onChange:f,disabled:r==="processing",className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-medium file:bg-purple-50 file:text-purple-700 hover:file:bg-purple-100 transition-colors duration-200",dir:"ltr"}),r==="processing"&&!i.includes("Exporting")&&c.jsxs("div",{className:"flex items-center space-x-2 text-blue-600 p-3 bg-blue-50 rounded-lg",children:[c.jsx(Tl,{className:"h-5 w-5 animate-spin"}),c.jsx("span",{className:"text-sm font-medium",children:i})]}),r==="success"&&!i.includes("exported")&&c.jsxs("div",{className:"flex items-center space-x-2 text-green-600 p-3 bg-green-50 rounded-lg",children:[c.jsx(No,{className:"h-5 w-5"}),c.jsx("span",{className:"text-sm font-medium",children:i})]}),r==="error"&&c.jsxs("div",{className:"flex items-center space-x-2 text-red-600 p-3 bg-red-50 rounded-lg",children:[c.jsx(DA,{className:"h-5 w-5"}),c.jsx("span",{className:"text-sm font-medium",children:i})]})]})]}),l.length>0&&c.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Preview (First 5 Activities)"}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Activity"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Level"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map((p,v)=>c.jsxs("tr",{className:v%2===0?"bg-white":"bg-gray-50",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",dir:"ltr",children:p.category}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",dir:"ltr",children:p.activity}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",dir:"ltr",children:p.level}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[p.time," mins"]})]},v))})]})}),c.jsx("p",{className:"mt-4 text-sm text-gray-600",children:s.length>5&&`...and ${s.length-5} more activities`})]})]}),c.jsx("div",{className:"flex justify-end p-6 border-t border-gray-200 bg-gray-50",children:c.jsxs("div",{className:"flex space-x-3",children:[c.jsx("button",{onClick:t,className:"px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg transition-colors duration-200",children:"Cancel"}),c.jsxs("button",{onClick:m,disabled:r!=="success"||s.length===0,className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 disabled:bg-purple-400 text-white font-medium rounded-lg transition-colors duration-200 flex items-center space-x-2",children:[c.jsx(No,{className:"h-5 w-5"}),c.jsxs("span",{children:["Import ",s.length," Activities"]})]})]})})]})})}function Dle({onClose:e,onSave:t,categories:r,levels:n}){const{categories:i}=Gi(),[a,s]=ve.useState({activity:"",description:"",activityText:"",time:0,videoLink:"",musicLink:"",backingLink:"",resourceLink:"",link:"",vocalsLink:"",imageLink:"",category:"",level:"",unitName:"",lessonNumber:"",teachingUnit:""}),[o,l]=ve.useState({}),A=ve.useRef(null),u=["All","LKG","UKG","Reception"],f=x=>{const{name:p,value:v}=x.target;s(y=>({...y,[p]:v})),o[p]&&l(y=>{const w={...y};return delete w[p],w})},h=x=>{const p=parseInt(x.target.value);s(v=>({...v,time:isNaN(p)?0:p}))},d=x=>{var y;const p=(y=x.target.files)==null?void 0:y[0];if(!p)return;const v=new FileReader;v.onload=w=>{var E;const B=(E=w.target)==null?void 0:E.result;s(_=>({..._,imageLink:B}))},v.readAsDataURL(p)},m=()=>{const x={};return a.activity.trim()||(x.activity="Activity name is required"),a.category||(x.category="Category is required"),l(x),Object.keys(x).length===0},g=x=>{if(x.preventDefault(),m()){const p={...a,teachingUnit:a.teachingUnit||a.category};t(p),e()}};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-4xl max-h-[95vh] flex flex-col overflow-hidden",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 bg-gradient-to-r from-indigo-600 to-purple-600 text-white",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(Pn,{className:"h-6 w-6"}),c.jsx("h2",{className:"text-xl font-bold",children:"Create New Activity"})]}),c.jsx("button",{onClick:e,className:"p-2 text-white hover:bg-white hover:bg-opacity-20 rounded-lg transition-colors duration-200",children:c.jsx(Zr,{className:"h-6 w-6"})})]}),c.jsx("form",{onSubmit:g,className:"flex-1 overflow-y-auto p-6",children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"col-span-2",children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Activity Name ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",name:"activity",value:a.activity,onChange:f,className:`w-full px-4 py-3 border ${o.activity?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500`,placeholder:"Enter activity name",dir:"ltr"}),o.activity&&c.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.activity})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Category ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsxs("select",{name:"category",value:a.category,onChange:f,className:`w-full px-4 py-3 border ${o.category?"border-red-500":"border-gray-300"} rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500`,dir:"ltr",children:[c.jsx("option",{value:"",children:"Select a category"}),i.map(x=>c.jsx("option",{value:x.name,children:x.name},x.name))]}),o.category&&c.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.category})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Level"}),c.jsxs("select",{name:"level",value:a.level,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",dir:"ltr",children:[c.jsx("option",{value:"",children:"Select a level"}),c.jsx("option",{value:"All",children:"All"}),c.jsx("option",{value:"LKG",children:"LKG"}),c.jsx("option",{value:"UKG",children:"UKG"}),c.jsx("option",{value:"Reception",children:"Reception"}),u.filter(x=>!["All","LKG","UKG","Reception"].includes(x)).map(x=>c.jsx("option",{value:x,children:x},x))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duration (minutes)"}),c.jsx("input",{type:"number",name:"time",value:a.time,onChange:h,min:"0",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Enter duration in minutes",dir:"ltr"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Unit Name"}),c.jsx("input",{type:"text",name:"unitName",value:a.unitName,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Enter unit name (optional)",dir:"ltr"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Activity"}),c.jsx(Vd,{value:a.activityText,onChange:x=>s(p=>({...p,activityText:x})),placeholder:"Enter activity instructions...",minHeight:"100px"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),c.jsx(Vd,{value:a.description,onChange:x=>s(p=>({...p,description:x})),placeholder:"Enter activity description...",minHeight:"150px"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Activity Image"}),c.jsxs("div",{className:"flex items-center space-x-4",children:[a.imageLink?c.jsxs("div",{className:"relative",children:[c.jsx("img",{src:a.imageLink,alt:"Activity",className:"w-32 h-32 object-cover rounded-lg border border-gray-200"}),c.jsx("button",{type:"button",onClick:()=>s(x=>({...x,imageLink:""})),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1",children:c.jsx(Zr,{className:"h-4 w-4"})})]}):c.jsx("div",{className:"w-32 h-32 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center bg-gray-50",children:c.jsx(Md,{className:"h-8 w-8 text-gray-400"})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Upload an image for this activity or provide an image URL"}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsxs("button",{type:"button",onClick:()=>{var x;return(x=A.current)==null?void 0:x.click()},className:"px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg flex items-center space-x-1",children:[c.jsx(Vl,{className:"h-4 w-4"}),c.jsx("span",{children:"Upload"})]}),c.jsx("input",{ref:A,type:"file",accept:"image/*",className:"hidden",onChange:d}),c.jsx("input",{type:"url",name:"imageLink",value:a.imageLink,onChange:f,placeholder:"Or paste image URL",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",dir:"ltr"})]})]})]})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Resources"}),c.jsx("div",{className:"space-y-4",children:[{key:"videoLink",label:"Video URL",icon:Gd},{key:"musicLink",label:"Music URL",icon:Kd},{key:"backingLink",label:"Backing Track URL",icon:eo},{key:"resourceLink",label:"Resource URL",icon:Is},{key:"link",label:"Additional Link",icon:Hd},{key:"vocalsLink",label:"Vocals URL",icon:eo}].map(({key:x,label:p,icon:v})=>c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(v,{className:"h-5 w-5 text-gray-500 flex-shrink-0"}),c.jsx("input",{type:"url",name:x,value:a[x],onChange:f,className:"flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:p,dir:"ltr"})]},x))})]})]})}),c.jsx("div",{className:"flex justify-end p-6 border-t border-gray-200 bg-gray-50",children:c.jsxs("div",{className:"flex space-x-3",children:[c.jsx("button",{type:"button",onClick:e,className:"px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg transition-colors duration-200",children:"Cancel"}),c.jsxs("button",{type:"submit",onClick:g,className:"px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-medium rounded-lg transition-colors duration-200 flex items-center space-x-2",children:[c.jsx(ao,{className:"h-5 w-5"}),c.jsx("span",{children:"Create Activity"})]})]})})]})})}function Ple({onActivitySelect:e,selectedActivities:t,className:r,selectedCategory:n="all",onCategoryChange:i}){const{allActivities:a,addActivity:s,updateActivity:o,deleteActivity:l,loading:A}=oi(),{getCategoryColor:u,categories:f}=Gi(),[h,d]=ve.useState(""),[m,g]=ve.useState(n),[x,p]=ve.useState("all"),[v,y]=ve.useState("category"),[w,B]=ve.useState("asc"),[E,_]=ve.useState("grid"),[F,T]=ve.useState(null),[I,S]=ve.useState(null),[C,L]=ve.useState(null),[R,W]=ve.useState(!1),[G,V]=ve.useState(!1),[X,Q]=ve.useState(!1),[K,H]=ve.useState(null);es.useEffect(()=>{g(n)},[n]);const k=se=>{g(se),i&&i(se)},U=ve.useMemo(()=>{const se=new Set(a.map(be=>be.category));return Array.from(se).sort()},[a]),P=ve.useMemo(()=>{const se=new Set(a.map(be=>be.level).filter(Boolean));return Array.from(se).sort()},[a]),D=(se,be)=>se._id?`activity-${se._id}`:se.id?`activity-${se.id}`:`activity-${btoa(`${se.activity}${se.category}${se.description||""}${se.time}`).replace(/[^a-zA-Z0-9]/g,"").substring(0,16)}-${be}`,O=se=>se._id||se.id||`${se.activity}-${se.category}-${se.description||""}`,z=ve.useMemo(()=>{let se=a.filter(be=>{const Te=be.activity.toLowerCase().includes(h.toLowerCase())||be.description.toLowerCase().includes(h.toLowerCase()),pe=m==="all"||be.category===m,je=x==="all"||be.level===x;return Te&&pe&&je});return se.sort((be,Te)=>{let pe=0;switch(v){case"name":pe=be.activity.localeCompare(Te.activity);break;case"category":const je=f.find(Et=>Et.name===be.category),Ve=f.find(Et=>Et.name===Te.category),We=je?je.position:999,ft=Ve?Ve.position:999;pe=We-ft;break;case"time":pe=be.time-Te.time;break;case"level":pe=be.level.localeCompare(Te.level);break}return w==="asc"?pe:-pe}),se},[a,h,m,x,v,w,f]),J=se=>{v===se?B(w==="asc"?"desc":"asc"):(y(se),B("asc"))},Y=async se=>{try{se.level==="EYFS U"&&(se.level="UKG"),await o(se),T(null),S(null)}catch(be){console.error("Failed to update activity:",be),alert("Failed to update activity. Please try again.")}},le=async se=>{H(se)},we=async()=>{if(K)try{await l(K),H(null),I&&(I._id===K||I.id===K)&&S(null)}catch(se){console.error("Failed to delete activity:",se),alert("Failed to delete activity. Please try again."),H(null)}},ne=async se=>{const be={...se,_id:void 0,id:void 0,activity:`${se.activity} (Copy)`};be.level==="EYFS U"&&(be.level="UKG");try{await s(be)}catch(Te){console.error("Failed to duplicate activity:",Te),alert("Failed to duplicate activity. Please try again.")}},Me=(se,be)=>{se.level==="EYFS U"&&(se.level="UKG"),S(se),L(be||null)},qe=(se,be,Te)=>{if(I)L({url:se,title:be,type:Te});else{const pe=a.find(je=>je.videoLink===se||je.musicLink===se||je.backingLink===se||je.resourceLink===se||je.link===se||je.vocalsLink===se||je.imageLink===se);pe&&Me(pe,{url:se,title:be,type:Te})}},Fe=se=>{se.level==="EYFS U"&&(se.level="UKG"),T(se),S(se)},he=async se=>{try{Q(!0);const be=se.map(Te=>Te.level==="EYFS U"?{...Te,level:"UKG"}:Te);for(const Te of be)await s(Te);W(!1)}catch(be){console.error("Failed to import activities:",be),alert("Failed to import activities. Please try again.")}finally{Q(!1)}},Be=async se=>{try{Q(!0),se.level==="EYFS U"&&(se.level="UKG"),await s(se),V(!1)}catch(be){console.error("Failed to create activity:",be),alert("Failed to create activity. Please try again.")}finally{Q(!1)}},xe=se=>F?F._id&&se._id?F._id===se._id:F.id&&se.id?F.id===se.id:O(F)===O(se):!1;return c.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:[c.jsxs("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-purple-600 to-pink-600 text-white",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(Ls,{className:"h-6 w-6"}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold",children:"Activity Library"}),c.jsxs("p",{className:"text-purple-100 text-sm",children:[z.length," of ",a.length," activities"]})]})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsxs("button",{onClick:()=>V(!0),className:"px-4 py-2 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-lg transition-colors duration-200 flex items-center space-x-2",children:[c.jsx(ka,{className:"h-4 w-4"}),c.jsx("span",{children:"Create Activity"})]}),c.jsxs("button",{onClick:()=>W(!0),className:"px-4 py-2 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-lg transition-colors duration-200 flex items-center space-x-2",children:[c.jsx(Vl,{className:"h-4 w-4"}),c.jsx("span",{children:"Import/Export"})]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"relative",children:[c.jsx(rA,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-purple-300"}),c.jsx("input",{type:"text",placeholder:"Search activities...",value:h,onChange:se=>d(se.target.value),className:"w-full pl-10 pr-4 py-2 bg-white bg-opacity-20 border border-white border-opacity-30 rounded-lg text-white placeholder-purple-200 focus:ring-2 focus:ring-white focus:ring-opacity-50 focus:border-transparent",dir:"ltr"})]}),c.jsxs("select",{value:m,onChange:se=>k(se.target.value),className:"px-3 py-2 bg-white bg-opacity-20 border border-white border-opacity-30 rounded-lg text-white focus:ring-2 focus:ring-white focus:ring-opacity-50 focus:border-transparent",dir:"ltr",children:[c.jsx("option",{value:"all",className:"text-gray-900",children:"All Categories"}),f.map(se=>c.jsx("option",{value:se.name,className:"text-gray-900",children:se.name},se.name))]}),c.jsxs("select",{value:x,onChange:se=>p(se.target.value),className:"px-3 py-2 bg-white bg-opacity-20 border border-white border-opacity-30 rounded-lg text-white focus:ring-2 focus:ring-white focus:ring-opacity-50 focus:border-transparent",dir:"ltr",children:[c.jsx("option",{value:"all",className:"text-gray-900",children:"All Levels"}),c.jsx("option",{value:"All",className:"text-gray-900",children:"All"}),c.jsx("option",{value:"LKG",className:"text-gray-900",children:"LKG"}),c.jsx("option",{value:"UKG",className:"text-gray-900",children:"UKG"}),c.jsx("option",{value:"Reception",className:"text-gray-900",children:"Reception"}),P.filter(se=>!["All","LKG","UKG","Reception","EYFS U"].includes(se)).map(se=>c.jsx("option",{value:se,className:"text-gray-900",children:se},se))]}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsxs("button",{onClick:()=>J("category"),className:`flex items-center space-x-1 px-3 py-2 rounded-lg transition-colors duration-200 ${v==="category"?"bg-white bg-opacity-20":"hover:bg-white hover:bg-opacity-10"}`,children:[c.jsx(Pn,{className:"h-4 w-4"}),v==="category"&&(w==="asc"?c.jsx(Jh,{className:"h-4 w-4"}):c.jsx(Yh,{className:"h-4 w-4"}))]}),c.jsxs("button",{onClick:()=>J("time"),className:`flex items-center space-x-1 px-3 py-2 rounded-lg transition-colors duration-200 ${v==="time"?"bg-white bg-opacity-20":"hover:bg-white hover:bg-opacity-10"}`,children:[c.jsx(_a,{className:"h-4 w-4"}),v==="time"&&(w==="asc"?c.jsx(Jh,{className:"h-4 w-4"}):c.jsx(Yh,{className:"h-4 w-4"}))]}),c.jsxs("div",{className:"flex items-center space-x-2 ml-auto",children:[c.jsx("button",{onClick:()=>_("grid"),className:`p-2 rounded-lg transition-colors duration-200 ${E==="grid"?"bg-white bg-opacity-20":"hover:bg-white hover:bg-opacity-10"}`,children:c.jsx(XN,{className:"h-5 w-5"})}),c.jsx("button",{onClick:()=>_("list"),className:`p-2 rounded-lg transition-colors duration-200 ${E==="list"?"bg-white bg-opacity-20":"hover:bg-white hover:bg-opacity-10"}`,children:c.jsx(YN,{className:"h-5 w-5"})}),c.jsx("button",{onClick:()=>_("compact"),className:`p-2 rounded-lg transition-colors duration-200 ${E==="compact"?"bg-white bg-opacity-20":"hover:bg-white hover:bg-opacity-10"}`,children:c.jsx(JN,{className:"h-5 w-5"})})]})]})]})]}),c.jsx("div",{className:"p-6",children:X||A?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Loading activities..."})]}):z.length===0?c.jsxs("div",{className:"text-center py-12",children:[c.jsx(Ls,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No activities found"}),c.jsx("p",{className:"text-gray-600",children:h||m!=="all"||x!=="all"?"Try adjusting your search or filters":"No activities available in the library. Create a new activity or import activities to get started."}),(h||m!=="all"||x!=="all")&&c.jsx("button",{onClick:()=>{d(""),k("all"),p("all")},className:"mt-4 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg text-sm",children:"Clear Filters"}),!h&&m==="all"&&x==="all"&&c.jsxs("button",{onClick:()=>V(!0),className:"mt-4 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg text-sm flex items-center space-x-2 mx-auto",children:[c.jsx(ka,{className:"h-4 w-4"}),c.jsx("span",{children:"Create First Activity"})]})]}):c.jsx("div",{className:`
            ${E==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6":E==="list"?"space-y-4":"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"}
          `,children:z.map((se,be)=>c.jsx("div",{className:"h-full",children:c.jsx(Ole,{activity:se,onUpdate:Y,onDelete:le,onDuplicate:ne,isEditing:xe(se),onEditToggle:()=>Fe(se),categoryColor:u(se.category),viewMode:E==="grid"?"detailed":E==="list"?"compact":"minimal",onActivityClick:Me,onResourceClick:qe,draggable:!0})},D(se,be)))})}),I&&c.jsx(Ju,{activity:I,onClose:()=>{S(null),T(null),L(null)},onAddToLesson:()=>{e(I),S(null)},isEditing:I===F,onUpdate:se=>{Y(se),T(null),S(null)},initialResource:C,onDelete:l}),G&&c.jsx(Dle,{onSave:Be,onClose:()=>V(!1),categories:U,levels:P}),R&&c.jsx(jle,{onImport:he,onClose:()=>W(!1)}),K&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[c.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Delete Activity"}),c.jsx("p",{className:"text-gray-700 mb-6",children:"Are you sure you want to delete this activity? This action cannot be undone."}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx("button",{onClick:()=>H(null),className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg transition-colors",children:"Cancel"}),c.jsxs("button",{onClick:we,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors flex items-center space-x-2",children:[c.jsx(_i,{className:"h-4 w-4"}),c.jsx("span",{children:"Delete Activity"})]})]})]})})]})}const qS=e=>e?{__html:e}:{__html:""},zS=e=>{if(!e)return"";const t=document.createElement("div");t.innerHTML=e;let r=t.textContent||t.innerText||"";return r=r.replace(/\s+/g," ").trim(),r},XS=[{id:"A1",name:"Autumn 1",months:"Sep-Oct"},{id:"A2",name:"Autumn 2",months:"Nov-Dec"},{id:"SP1",name:"Spring 1",months:"Jan-Feb"},{id:"SP2",name:"Spring 2",months:"Mar-Apr"},{id:"SM1",name:"Summer 1",months:"Apr-May"},{id:"SM2",name:"Summer 2",months:"Jun-Jul"}];function Qle({onLessonSelect:e,onLessonEdit:t,className:r="",onAssignToUnit:n}){var he;const{lessonNumbers:i,allLessonsData:a,currentSheetInfo:s,halfTerms:o,getLessonsForHalfTerm:l,updateLessonData:A,allActivities:u}=oi(),{getThemeForClass:f,categories:h}=Gi(),[d,m]=ve.useState(""),[g,x]=ve.useState("all"),[p,v]=ve.useState("number"),[y,w]=ve.useState("asc"),[B,E]=ve.useState("grid"),[_,F]=ve.useState(null),[T,I]=ve.useState(null),[S,C]=ve.useState(null),[L,R]=ve.useState([]),[W,G]=ve.useState(!1),[V,X]=ve.useState(!1),[Q,K]=ve.useState(""),[H,k]=ve.useState("all"),U=f(r),P=Be=>{for(const xe of o)if(xe.lessons.includes(Be))return xe.id;return null},D=Be=>{const xe=a[Be];if(xe){const se=Object.values(xe.grouped).flat().map((be,Te)=>({...be,_editId:`${Be}-${Te}-${Date.now()}`}));R(se),C(Be),G(!0)}},O=()=>{if(S&&L.length>=0){const Be=L.reduce((se,be)=>{const Te=be.category||"Other";return se[Te]||(se[Te]=[]),se[Te].push(be),se},{}),xe={...a[S],grouped:Be,categoryOrder:Object.keys(Be),totalTime:L.reduce((se,be)=>se+(be.time||0),0)};A&&A(S,xe),z()}},z=()=>{C(null),R([]),G(!1),X(!1),K(""),k("all")},J=Be=>{R(xe=>xe.filter((se,be)=>be!==Be))},Y=(Be,xe)=>{R(se=>{const be=[...se],[Te]=be.splice(Be,1);return be.splice(xe,0,Te),be})},le=Be=>{const xe={...Be,_editId:`new-${Date.now()}-${Math.random().toString(36).substring(2,9)}`};R(se=>[...se,xe]),X(!1),K(""),k("all")},we=ve.useMemo(()=>u?u.filter(Be=>{const xe=!Q||Be.activity.toLowerCase().includes(Q.toLowerCase())||zS(Be.description).toLowerCase().includes(Q.toLowerCase()),se=H==="all"||Be.category===H;return xe&&se}):[],[u,Q,H]),ne=ve.useMemo(()=>{let Be=i.filter(xe=>{const se=a[xe];return!(!se||d&&!(xe.includes(d)||se.title&&se.title.toLowerCase().includes(d.toLowerCase())||Object.values(se.grouped).some(Te=>Te.some(pe=>pe.activity.toLowerCase().includes(d.toLowerCase())||zS(pe.description).toLowerCase().includes(d.toLowerCase()))))||g!=="all"&&P(xe)!==g)});return Be.sort((xe,se)=>{const be=a[xe],Te=a[se];if(!be||!Te)return 0;let pe=0;switch(p){case"number":pe=parseInt(xe)-parseInt(se);break;case"title":pe=(be.title||`Lesson ${xe}`).localeCompare(Te.title||`Lesson ${se}`);break;case"activities":const je=Object.values(be.grouped).reduce((We,ft)=>We+ft.length,0),Ve=Object.values(Te.grouped).reduce((We,ft)=>We+ft.length,0);pe=je-Ve;break;case"time":pe=be.totalTime-Te.totalTime;break}return y==="asc"?pe:-pe}),Be},[i,a,d,g,p,y,o]),Me=Be=>{p===Be?w(y==="asc"?"desc":"asc"):(v(Be),w("asc"))},qe=Be=>{e?e(Be):I(Be)},Fe=(Be,xe)=>{console.log("LessonLibrary: Assigning lesson",Be,"to half-term",xe),n&&n(Be,xe)};return c.jsxs("div",{className:`bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden ${r}`,children:[c.jsxs("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-green-600 to-teal-600 text-white",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(Ls,{className:"h-6 w-6"}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold",children:"Lesson Library"}),c.jsxs("p",{className:"text-green-100 text-sm",children:[ne.length," of ",i.length," lessons"]})]})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("button",{onClick:()=>E("grid"),className:`p-2 rounded-lg transition-colors duration-200 ${B==="grid"?"bg-white bg-opacity-20":"hover:bg-white hover:bg-opacity-10"}`,children:c.jsx(XN,{className:"h-5 w-5"})}),c.jsx("button",{onClick:()=>E("list"),className:`p-2 rounded-lg transition-colors duration-200 ${B==="list"?"bg-white bg-opacity-20":"hover:bg-white hover:bg-opacity-10"}`,children:c.jsx(YN,{className:"h-5 w-5"})}),c.jsx("button",{onClick:()=>E("compact"),className:`p-2 rounded-lg transition-colors duration-200 ${B==="compact"?"bg-white bg-opacity-20":"hover:bg-white hover:bg-opacity-10"}`,children:c.jsx(JN,{className:"h-5 w-5"})})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"relative",children:[c.jsx(rA,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-green-300"}),c.jsx("input",{type:"text",placeholder:"Search lessons...",value:d,onChange:Be=>m(Be.target.value),className:"w-full pl-10 pr-4 py-2 bg-white bg-opacity-20 border border-white border-opacity-30 rounded-lg text-white placeholder-green-200 focus:ring-2 focus:ring-white focus:ring-opacity-50 focus:border-transparent",dir:"ltr"})]}),c.jsxs("select",{value:g,onChange:Be=>x(Be.target.value),className:"px-3 py-2 bg-white bg-opacity-20 border border-white border-opacity-30 rounded-lg text-white focus:ring-2 focus:ring-white focus:ring-opacity-50 focus:border-transparent",dir:"ltr",children:[c.jsx("option",{value:"all",className:"text-gray-900",children:"All Half-Terms"}),XS.map(Be=>c.jsxs("option",{value:Be.id,className:"text-gray-900",children:[Be.name," (",Be.months,")"]},Be.id))]}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsxs("button",{onClick:()=>Me("number"),className:`flex items-center space-x-1 px-3 py-2 rounded-lg transition-colors duration-200 ${p==="number"?"bg-white bg-opacity-20":"hover:bg-white hover:bg-opacity-10"}`,children:[c.jsx("span",{className:"text-sm",children:"#"}),p==="number"&&(y==="asc"?c.jsx(Jh,{className:"h-4 w-4"}):c.jsx(Yh,{className:"h-4 w-4"}))]}),c.jsxs("button",{onClick:()=>Me("time"),className:`flex items-center space-x-1 px-3 py-2 rounded-lg transition-colors duration-200 ${p==="time"?"bg-white bg-opacity-20":"hover:bg-white hover:bg-opacity-10"}`,children:[c.jsx(_a,{className:"h-4 w-4"}),p==="time"&&(y==="asc"?c.jsx(Jh,{className:"h-4 w-4"}):c.jsx(Yh,{className:"h-4 w-4"}))]}),c.jsxs("button",{onClick:()=>Me("activities"),className:`flex items-center space-x-1 px-3 py-2 rounded-lg transition-colors duration-200 ${p==="activities"?"bg-white bg-opacity-20":"hover:bg-white hover:bg-opacity-10"}`,children:[c.jsx(Pn,{className:"h-4 w-4"}),p==="activities"&&(y==="asc"?c.jsx(Jh,{className:"h-4 w-4"}):c.jsx(Yh,{className:"h-4 w-4"}))]})]})]})]}),c.jsx("div",{className:"p-6",children:ne.length===0?c.jsxs("div",{className:"text-center py-12",children:[c.jsx(Ls,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No lessons found"}),c.jsx("p",{className:"text-gray-600",children:d||g!=="all"?"Try adjusting your search or filters":"No lessons available in the library"}),(d||g!=="all")&&c.jsx("button",{onClick:()=>{m(""),x("all")},className:"mt-4 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm",children:"Clear Filters"})]}):c.jsx("div",{className:`
            ${B==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6":B==="list"?"space-y-4":"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"}
          `,children:ne.map((Be,xe)=>{const se=a[Be];return se?c.jsx(wT,{lessonNumber:Be,displayNumber:xe+1,lessonData:se,viewMode:B,onClick:()=>qe(Be),theme:U,onAssignToUnit:Fe,halfTerms:XS,onEdit:()=>D(Be)},Be):null})})}),V&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[80vh] overflow-hidden",children:[c.jsxs("div",{className:"p-4 border-b border-gray-200 bg-gradient-to-r from-blue-500 to-indigo-600 text-white",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h3",{className:"text-lg font-semibold",children:"Add Activity to Lesson"}),c.jsx("button",{onClick:()=>X(!1),className:"p-1 hover:bg-white hover:bg-opacity-20 rounded",children:c.jsx(Zr,{className:"h-5 w-5"})})]}),c.jsxs("div",{className:"flex space-x-3 mt-3",children:[c.jsxs("div",{className:"relative flex-1",children:[c.jsx(rA,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-blue-300"}),c.jsx("input",{type:"text",placeholder:"Search activities...",value:Q,onChange:Be=>K(Be.target.value),className:"w-full pl-10 pr-4 py-2 bg-white bg-opacity-20 border border-white border-opacity-30 rounded-lg text-white placeholder-blue-200 focus:ring-2 focus:ring-white focus:ring-opacity-50"})]}),c.jsxs("select",{value:H,onChange:Be=>k(Be.target.value),className:"px-3 py-2 bg-white bg-opacity-20 border border-white border-opacity-30 rounded-lg text-white focus:ring-2 focus:ring-white focus:ring-opacity-50",children:[c.jsx("option",{value:"all",className:"text-gray-900",children:"All Categories"}),h==null?void 0:h.map(Be=>c.jsx("option",{value:Be.name,className:"text-gray-900",children:Be.name},Be.name))]})]})]}),c.jsxs("div",{className:"p-4 max-h-96 overflow-y-auto",children:[c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:we.map((Be,xe)=>c.jsx("button",{onClick:()=>le(Be),className:"text-left p-4 bg-gray-50 hover:bg-blue-50 rounded-lg border border-gray-200 hover:border-blue-300 transition-all duration-200",children:c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("h4",{className:"font-medium text-gray-900 text-sm mb-1",children:Be.activity}),c.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[c.jsx("span",{className:"text-xs px-2 py-1 bg-gray-200 rounded-full text-gray-600",children:Be.category}),Be.time>0&&c.jsxs("span",{className:"text-xs text-gray-500 flex items-center",children:[c.jsx(_a,{className:"h-3 w-3 mr-1"}),Be.time,"m"]})]}),c.jsx("div",{className:"text-xs text-gray-600 line-clamp-2 prose prose-xs max-w-none",dangerouslySetInnerHTML:qS(Be.description)})]}),c.jsx(ka,{className:"h-5 w-5 text-blue-600 ml-2 flex-shrink-0"})]})},`${Be.id||xe}-${Be.activity}`))}),we.length===0&&c.jsx("div",{className:"text-center py-8 text-gray-500",children:c.jsx("p",{children:"No activities found"})})]})]})}),W&&S&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-hidden",children:[c.jsx("div",{className:"p-4 border-b border-gray-200 bg-gradient-to-r from-green-500 to-emerald-600 text-white",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ki,{className:"h-5 w-5"}),c.jsxs("h3",{className:"text-lg font-semibold",children:["Editing: ",((he=a[S])==null?void 0:he.title)||`Lesson ${S}`]})]}),c.jsxs("div",{className:"flex space-x-2",children:[c.jsxs("button",{onClick:O,className:"px-4 py-2 bg-white bg-opacity-20 hover:bg-opacity-30 text-white font-medium rounded-lg flex items-center space-x-2 transition-colors",children:[c.jsx(Ea,{className:"h-4 w-4"}),c.jsx("span",{children:"Save Changes"})]}),c.jsxs("button",{onClick:z,className:"px-4 py-2 bg-white bg-opacity-20 hover:bg-opacity-30 text-white font-medium rounded-lg flex items-center space-x-2 transition-colors",children:[c.jsx(Zr,{className:"h-4 w-4"}),c.jsx("span",{children:"Cancel"})]})]})]})}),c.jsxs("div",{className:"flex-1 overflow-hidden",children:[c.jsxs("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:[c.jsx("div",{className:"space-y-4",children:L.map((Be,xe)=>c.jsx("div",{className:"bg-gray-50 rounded-lg border border-gray-200 p-4 hover:bg-gray-100 transition-colors",children:c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("h4",{className:"font-semibold text-gray-900 text-base mb-2",children:Be.activity}),c.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[c.jsx("span",{className:"text-sm px-3 py-1 bg-blue-100 text-blue-800 rounded-full font-medium",children:Be.category}),Be.time>0&&c.jsxs("span",{className:"text-sm text-gray-600 flex items-center",children:[c.jsx(_a,{className:"h-4 w-4 mr-1"}),Be.time," minutes"]})]}),c.jsx("div",{className:"text-sm text-gray-700 prose prose-sm max-w-none",dangerouslySetInnerHTML:qS(Be.description)})]}),c.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[xe>0&&c.jsx("button",{onClick:()=>Y(xe,xe-1),className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Move up",children:c.jsx(h0,{className:"h-5 w-5"})}),xe<L.length-1&&c.jsx("button",{onClick:()=>Y(xe,xe+1),className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Move down",children:c.jsx(f0,{className:"h-5 w-5"})}),c.jsx("button",{onClick:()=>J(xe),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete activity",children:c.jsx(Zr,{className:"h-5 w-5"})})]})]})},Be._editId))}),L.length===0&&c.jsxs("div",{className:"text-center py-12 text-gray-500",children:[c.jsx(Ls,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),c.jsx("p",{className:"text-lg",children:"No activities in this lesson"}),c.jsx("p",{className:"text-sm",children:"Add activities to build your lesson"})]})]}),c.jsx("div",{className:"border-t border-gray-200 p-4 bg-gray-50",children:c.jsxs("button",{onClick:()=>X(!0),className:"w-full px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200 flex items-center justify-center space-x-2",children:[c.jsx(ka,{className:"h-5 w-5"}),c.jsx("span",{children:"Add Activity to Lesson"})]})})]})]})}),_&&c.jsx(uw,{lessonNumber:_,onClose:()=>F(null)}),T&&c.jsx(Dm,{lessonNumber:T,onClose:()=>I(null),theme:U,onExport:()=>{F(T),I(null)}})]})}const s2=[{id:"A1",name:"Autumn 1",months:"Sep-Oct"},{id:"A2",name:"Autumn 2",months:"Nov-Dec"},{id:"SP1",name:"Spring 1",months:"Jan-Feb"},{id:"SP2",name:"Spring 2",months:"Mar-Apr"},{id:"SM1",name:"Summer 1",months:"Apr-May"},{id:"SM2",name:"Summer 2",months:"Jun-Jul"}];function Rle(){cf();const{currentSheetInfo:e,allLessonsData:t,updateHalfTerm:r,getLessonsForHalfTerm:n}=oi(),{getThemeForClass:i}=Gi(),[a,s]=ve.useState("unit-viewer");ve.useState(null);const[o,l]=ve.useState([]),[A,u]=ve.useState("all"),[f,h]=ve.useState([]),d=i(e.sheet),m=(p,v)=>[...n(v)].sort((B,E)=>parseInt(B)-parseInt(E)).indexOf(p)+1;es.useEffect(()=>{const p=localStorage.getItem("lesson-plans");if(p){const y=JSON.parse(p).map(w=>({...w,date:new Date(w.date),createdAt:new Date(w.createdAt),updatedAt:new Date(w.updatedAt)}));l(y)}const v=localStorage.getItem("units");if(v)try{const y=JSON.parse(v).map(w=>({...w,createdAt:new Date(w.createdAt),updatedAt:new Date(w.updatedAt)}));h(y)}catch(y){console.error("Error parsing saved units:",y),h([])}else{const y=[{id:"unit-1",name:"Welcome Songs",description:"A collection of welcome songs and activities to start the lesson.",lessonNumbers:["1","2","3"],color:"#3B82F6",term:"A1",createdAt:new Date,updatedAt:new Date},{id:"unit-2",name:"Rhythm Activities",description:"Activities focused on developing rhythm skills using percussion instruments.",lessonNumbers:["4","5","6"],color:"#F59E0B",term:"A2",createdAt:new Date,updatedAt:new Date},{id:"unit-3",name:"Movement and Dance",description:"Activities that combine music with movement and dance elements.",lessonNumbers:["7","8","9"],color:"#10B981",term:"SP1",createdAt:new Date,updatedAt:new Date}];h(y),localStorage.setItem("units",JSON.stringify(y))}},[]);const g=p=>{console.log("Activity added:",p)},x=(p,v)=>{var B,E;console.log("Dashboard: Assigning lesson",p,"to half-term",v);const y=n(v),w=s2.find(_=>n(_.id).includes(p));if(w){const _=m(p,w.id);alert(`Lesson ${_} is already assigned to ${w.name}.`);return}if(y.includes(p)){const _=m(p,v),F=(E=s2.find(T=>T.id===v))==null?void 0:E.name;alert(`Lesson ${_} is already assigned to ${F}.`)}else{const _=[...y,p];r(v,_,!1);const F=(B=s2.find(I=>I.id===v))==null?void 0:B.name,T=_.sort((I,S)=>parseInt(I)-parseInt(S)).indexOf(p)+1;alert(`Lesson ${T} has been added to the ${F} half-term.`)}};return c.jsx(s5,{backend:o5,children:c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-blue-50",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsxs(gz,{value:a,onValueChange:s,className:"mb-8",children:[c.jsxs(mz,{className:"bg-white shadow-md rounded-xl p-1 border border-gray-200 w-full",children:[c.jsx(Dp,{value:"unit-viewer",className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-indigo-600 data-[state=active]:text-white rounded-lg px-4 py-2 transition-all duration-200",style:{"--tw-gradient-from":d.primary,"--tw-gradient-to":d.secondary},"data-tab":"unit-viewer",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx($W,{className:"h-5 w-5"}),c.jsx("span",{children:"Unit Viewer"})]})}),c.jsx(Dp,{value:"lesson-library",className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-green-500 data-[state=active]:to-teal-600 data-[state=active]:text-white rounded-lg px-4 py-2 transition-all duration-200","data-tab":"lesson-library",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(KW,{className:"h-5 w-5"}),c.jsx("span",{children:"Lesson Library"})]})}),c.jsx(Dp,{value:"lesson-builder",className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-green-500 data-[state=active]:to-emerald-600 data-[state=active]:text-white rounded-lg px-4 py-2 transition-all duration-200","data-tab":"lesson-builder",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ki,{className:"h-5 w-5"}),c.jsx("span",{children:"Lesson Builder"})]})}),c.jsx(Dp,{value:"activity-library",className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-pink-500 data-[state=active]:to-rose-600 data-[state=active]:text-white rounded-lg px-4 py-2 transition-all duration-200","data-tab":"activity-library",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Pn,{className:"h-5 w-5"}),c.jsx("span",{children:"Activity Library"})]})})]}),c.jsx(Pp,{value:"unit-viewer",className:"mt-3",children:c.jsx(Tle,{})}),c.jsx(Pp,{value:"lesson-library",className:"mt-3",children:c.jsx(Qle,{className:e.sheet,onAssignToUnit:x})}),c.jsx(Pp,{value:"lesson-builder",className:"mt-3",children:c.jsx(Ule,{})}),c.jsx(Pp,{value:"activity-library",className:"mt-3",children:c.jsx(Ple,{onActivitySelect:g,selectedActivities:[],className:e.sheet,selectedCategory:A,onCategoryChange:u})})]})})})})}function AL({size:e="md",className:t}){return c.jsx("div",{className:w1("animate-spin rounded-full border-2 border-gray-300 border-t-blue-600",{"h-4 w-4":e==="sm","h-8 w-8":e==="md","h-12 w-12":e==="lg"},t)})}function Mle(){const{login:e,loading:t}=cf(),[r,n]=ve.useState(""),[i,a]=ve.useState(""),[s,o]=ve.useState(!1),[l,A]=ve.useState(""),f=void 0,h=async d=>{d.preventDefault(),A("");try{await e(r,i)}catch(m){A(m instanceof Error?m.message:"Login failed")}};return c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-teal-400 via-cyan-300 to-teal-200 flex items-center justify-center p-4",children:c.jsxs("div",{className:"w-full max-w-md",children:[c.jsx("div",{className:"text-center mb-8",children:c.jsx("img",{src:"/cdlogo.png",alt:"Curriculum Designer Logo",width:728,height:472,className:"mx-auto mb-6 object-contain"})}),c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 border border-gray-100",children:[c.jsxs("form",{onSubmit:h,className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(XW,{className:"h-5 w-5 text-gray-400"})}),c.jsx("input",{id:"username",type:"email",value:r,onChange:d=>n(d.target.value),required:!0,className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 text-gray-900 placeholder-gray-500",placeholder:"Enter your email address"})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(xy,{className:"h-5 w-5 text-gray-400"})}),c.jsx("input",{id:"password",type:s?"text":"password",value:i,onChange:d=>a(d.target.value),required:!0,className:"block w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 text-gray-900 placeholder-gray-500",placeholder:"Enter your password"}),c.jsx("button",{type:"button",onClick:()=>o(!s),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 transition-colors duration-200",children:s?c.jsx(zN,{className:"h-5 w-5"}):c.jsx(Yu,{className:"h-5 w-5"})})]})]}),l&&c.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg flex items-center space-x-2",children:[c.jsx(DA,{className:"h-4 w-4 text-red-600 flex-shrink-0"}),c.jsx("p",{className:"text-sm text-red-700",children:l})]}),c.jsx("button",{type:"submit",disabled:t,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center space-x-2",children:t?c.jsxs(c.Fragment,{children:[c.jsx(AL,{size:"sm"}),c.jsx("span",{children:"Signing in..."})]}):c.jsx("span",{children:"Sign In"})})]}),f]}),c.jsx("div",{className:"mt-8 text-center",children:c.jsx("p",{className:"text-sm text-gray-500",children:"Curriculum Designer • From Rhythmstix"})})]})})}function Hle(){return c.jsx("footer",{className:"bg-blue-900 text-white py-3 mt-16",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between space-y-2 md:space-y-0",children:[c.jsx("div",{className:"flex items-center space-x-4 text-sm",children:c.jsx("a",{href:"mailto:info@rhythmstix.co.uk",className:"text-gray-300 hover:text-blue-300 transition-colors duration-200",children:"✉️ Contact Us"})}),c.jsxs("div",{className:"flex items-center space-x-6",children:[c.jsx("a",{href:"https://www.youtube.com/channel/UCooHhU7FKALUQ4CtqjDFMsw",className:"text-white hover:text-red-400 transition-colors duration-200 p-3 rounded-md hover:bg-blue-800",target:"_blank",rel:"noopener noreferrer","aria-label":"YouTube",children:c.jsx(i$,{className:"h-6 w-6"})}),c.jsx("a",{href:"https://www.linkedin.com/in/robert-reich-storer-974449144",className:"text-white hover:text-blue-300 transition-colors duration-200 p-3 rounded-md hover:bg-blue-800",target:"_blank",rel:"noopener noreferrer","aria-label":"LinkedIn",children:c.jsx(zW,{className:"h-6 w-6"})}),c.jsx("a",{href:"https://www.facebook.com/Rhythmstix-Music-108327688309431",className:"text-white hover:text-blue-300 transition-colors duration-200 p-3 rounded-md hover:bg-blue-800",target:"_blank",rel:"noopener noreferrer","aria-label":"Facebook",children:c.jsx(VW,{className:"h-6 w-6"})})]}),c.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[c.jsx("a",{href:"https://www.rhythmstix.co.uk/policy",className:"text-gray-300 hover:text-blue-300 transition-colors duration-200",target:"_blank",rel:"noopener noreferrer",children:"Privacy"}),c.jsx("span",{className:"text-gray-500",children:"•"}),c.jsx("a",{href:"https://www.rhythmstix.co.uk",className:"text-gray-300 hover:text-blue-300 transition-colors duration-200",target:"_blank",rel:"noopener noreferrer",children:"© 2025 Rhythmstix"})]})]})})})}function Kle(){const{user:e,loading:t}=cf(),[r,n]=ve.useState(!0),[i,a]=ve.useState(void 0);return t?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx(AL,{size:"lg"})}):e?c.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[c.jsx(c$,{}),c.jsx("main",{className:"flex-1 pt-16",children:c.jsx(Rle,{})}),c.jsx(Hle,{}),c.jsx(ZN,{isOpen:r,onClose:()=>n(!1),initialSection:i})]}):c.jsx(Mle,{})}function Gle(){return c.jsx(Oj,{children:c.jsx(PW,{children:c.jsx(DW,{children:c.jsx(Kle,{})})})})}uk(document.getElementById("root")).render(c.jsx(ve.StrictMode,{children:c.jsx(Gle,{})}));export{_r as _,kr as c,fw as g};
